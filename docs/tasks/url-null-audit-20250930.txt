# URL Null Audit - 2025-10-01T02:47:32Z

## URL Builders and Redirects

### redirect()->to
app/Controllers/SocialAuthController.php:43:        return redirect()->to('/');
app/Controllers/AuthController_old.php:64:            return redirect()->to('/Dashboard');
app/Controllers/AuthController_old.php:113:        return redirect()->to('/Dashboard');
app/Controllers/AuthController_old.php:114:        // return redirect()->to('/Dashboard')->with('message' . ' ' . $user->username . '!', lang('Auth.loginSuccess'));
app/Controllers/AuthController_old.php:130:        return redirect()->to(site_url('/'));
app/Controllers/AuthControllerCustom.php:167:            return redirect()->to(route_to('reset-password') . '?token=' . $this->auth->user()->reset_hash)->withCookies();
app/Controllers/AuthControllerCustom.php:190:        return redirect()->to(site_url('/'));
app/Filters/LoginFilter.php:20:            return redirect()->to('/login');
app/Filters/EmailVerifiedFilter.php:32:            return redirect()->to('/Account/verify-email')->with('error', 'Please verify your email.');
app/Filters/AuthCheckFilter.php:18:            return redirect()->to('/login')->with('error', 'You must log in to access this page.');
app/Filters/FeatureFlagFilter.php:31:        if ($mode === '404') return redirect()->to('/')->with('error','Not available');
app/Filters/FeatureFlagFilter.php:32:        return redirect()->to('/status')->with('error','Service temporarily unavailable');
app/Libraries/test.txt:161:                            return redirect()->to('/dashboard')->with('error', 'Trade alert not found.');
app/Libraries/test.txt:165:                        return redirect()->to('/dashboard')->with('error', 'Invalid Trade Alert Request.');
app/Libraries/test.txt:187:                            return redirect()->to('/dashboard')->with('error', 'Trade alert not found.');
app/Libraries/test.txt:440:            return redirect()->to('/login');
app/Libraries/test.txt:444:        return redirect()->to('/dashboard/onboarding')->with('success', ucfirst(str_replace('_', ' ', $step)) . ' completed.');
app/Libraries/test.txt:809:            return redirect()->to('/Profile')->with('error', 'No username provided.');
app/Libraries/test.txt:2192:        //     return redirect()->to('/login')->with('redirect_url', current_url())->send();
app/Libraries/test.txt:2348:                            return redirect()->to('/Management/Marketing/Schedule')->with('success', 'Schedule added successfully');
app/Libraries/test.txt:2393:                            return redirect()->to('/Management/Marketing/Campaigns')->with('success', 'Campaign added successfully');
app/Libraries/test.txt:2436:            return redirect()->to('/Management/Marketing')->with('error', 'No type provided');
app/Libraries/test.txt:2464:            return redirect()->to(base_url('Management/Marketing/Schedule'))->with('success', 'New schedule added successfully.');
app/Libraries/test.txt:2612:            return redirect()->to('/Management/Marketing/upcomingEarnings')->with('success', 'Logo approved and saved successfully.');
app/Libraries/test.txt:2669:            return redirect()->to('/Management/Marketing')->with('error', 'No generated content available for review.');
app/Libraries/test.txt:2804:                return redirect()->to(site_url('Management/Marketing/Exchanges/Edit/' . $id));
app/Libraries/test.txt:3018:        return redirect()->to("\Management\Marketing\Schedule")->with('success', 'Content generated successfully.');
app/Libraries/test.txt:3164:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Libraries/test.txt:3442:        return redirect()->to('/Management/Marketing/Blogs')->with('success', 'Blog published successfully.');
app/Libraries/test.txt:3479:        return redirect()->to('/Management/Marketing/ContentReview')->with('success', count($generatedContent) . ' content items generated successfully. Please review and approve.');
app/Libraries/test.txt:3517:        return redirect()->to('/Management/Marketing/ContentReview')->with('success', 'Content updated successfully.');
app/Libraries/test.txt:3573:            return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Libraries/test.txt:3792:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Libraries/test.txt:3862:            return redirect()->to('/Marketing/Success')->with('success', 'Marketing content submitted successfully.');
app/Libraries/test.txt:3967:            return redirect()->to('/dashboard')->with('success', 'Campaign submitted successfully.');
app/Modules/APIs/Controllers/DripCampaignController.php:34:        return redirect()->to($url);
app/Modules/APIs/Controllers/AlertsController.php:2251:        return redirect()->to('/manageTradeAlert');
app/Modules/APIs/Controllers/ManagementController.php:993:        return redirect()->to('/Management/Users')->with('message', $summary);
app/Modules/APIs/Controllers/ManagementController.php:1041:        return redirect()->to('/Management/Marketing')->with('message', 'Content generation completed.');
app/Modules/APIs/Controllers/DoorDashController.php:36:            return redirect()->to('/login');
app/Modules/APIs/Controllers/DoorDashController.php:74:        return redirect()->to($authUrl);
app/Modules/APIs/Controllers/DoorDashController.php:105:            return redirect()->to('/Account/Connected-Accounts');
app/Modules/APIs/Controllers/DoorDashController.php:141:                return redirect()->to('/budget');
app/Modules/APIs/Controllers/DoorDashController.php:144:                return redirect()->to("/budget/recurring-account/schedule/{$accountId}");
app/Modules/APIs/Controllers/DoorDashController.php:148:            return redirect()->to("/budget/edit/{$accountId}");
app/Modules/APIs/Controllers/DoorDashController.php:161:                    return redirect()->to('/budget');
app/Modules/APIs/Controllers/DoorDashController.php:164:                    return redirect()->to("/budget/edit/{$accountId}");
app/Modules/APIs/Controllers/DoorDashController.php:169:                    return redirect()->to("/budget/edit/{$accountId}");
app/Modules/APIs/Controllers/DoorDashController.php:172:                    return redirect()->to("/budget/recurring-account/schedule/{$accountId}");
app/Modules/APIs/Controllers/AlertsController-06162025.php:1673:        return redirect()->to('/manageTradeAlert');
app/Modules/chatgpt.txt:1:<?php namespace App\Modules\Management\Controllers;use CodeIgniter\Controller;use Config\Services;use App\Config\{APIs,Auth,SiteSettings,SocialMedia};use App\Controllers\UserController;use App\Libraries\{BaseLoader,HtmlFormatter,MyMIAnalytics,MyMIAlerts,MyMIBudget,MyMIDashboard,MyMIExchange,MyMIMarketing,MyMIUser};use App\Models\{AlertsModel,AnnouncementModel,InvestmentModel,ManagementModel,MarketingModel,MyMIGoldModel,SolanaModel,UserModel};use App\Services\{DashboardService,GoalTrackingService,MarketingService,SolanaService,UserService};use CodeIgniter\API\ResponseTrait;use GuzzleHttp\Client;use GuzzleHttp\Exception\RequestException;use voku\helper\HtmlDomParser;class MarketingController extends UserController{use ResponseTrait;use BaseLoader;protected $API;protected $auth;protected $cuID;protected $data;protected $debug;protected $helpers=['auth','form','url'];protected $logger;protected $request;protected $session;protected $uri;protected $siteSettings;protected $NewsEmail;protected $HtmlFormatter;protected $MyMIAnalytics;protected $MyMIAlerts;protected $MyMIBudget;protected $MyMIDashboard;protected $MyMIExchange;protected $MyMIMarketing;protected $MyMIUser;protected $dashboardService;protected $goalTrackingService;protected $marketingService;protected $solanaService;protected $userService;protected $alertsModel;protected $investmentModel;protected $marketingModel;protected $userModel;protected $userAccount;protected $userDashboard;protected $getBlogPosts;protected $departmentTasks;protected $marketing;protected $reporting;public function __construct(){$this->API=config('APIs');$this->auth=service('authentication');$this->logger=service('logger');$this->NewsEmail=config('NewsEmailServer');$this->request=service('request');$this->session=Services::session();$this->siteSettings=config('SiteSettings');$this->debug=$this->siteSettings->debug;$this->uri=$this->request->getUri();$this->alertsModel=new AlertsModel();$this->investmentModel=new InvestmentModel();$this->marketingModel=new MarketingModel();$this->userDashboard=$this->getMyMIDashboard()->dashboardInfo($this->cuID);$this->departmentTasks=$this->getMyMIAnalytics()->get_department_tasks($this->uri->getSegment(2),['Page SEO Edit']);$this->getBlogPosts=$this->getMyMIMarketing()->getBlogPosts();$this->cuID=$this->session->get('user_id')?? $this->auth->id();if(!$this->cuID){log_message('error','Investments ControllerFailed to retrieve valid User ID in MyMIInvestments');throw new \RuntimeException('User ID could not be retrieved.');}log_message('debug',"InvestmentsController: cuID initialized as {$this->cuID}");$this->userAccount=$this->getMyMIUser()->getUserInformation($this->cuID);$userBudget=$this->getMyMIBudget()->getUserBudget($this->cuID);log_message('info','DashboardController L72 - $checkingSummary: '.$userBudget['checkingSummary']);$this->data['checkingSummary']=$userBudget['checkingSummary'];}public function commonData(): array{$this->data=$this->data ??[];$userData=$this->getuserService()->commonData();$this->data=array_merge($this->data,$userData);$this->data['siteSettings']=$this->siteSettings;$this->data['beta']=(string)$this->siteSettings->beta;$this->data['uri']=$this->request->getUri();$this->data['date']=$this->siteSettings->date;$this->data['time']=$this->siteSettings->time;$this->data['hostTime']=$this->siteSettings->hostTime;$dashboardInfo=$this->getDashboardService()->getDashboardInfo($this->cuID);$this->data['completedGoals']=$this->getGoalTrackingService()->getCompletedGoals($this->cuID);$this->data['pendingGoals']=$this->getGoalTrackingService()->getPendingGoals($this->cuID);$this->data['promotionalBanners']=$dashboardInfo['promotionalBanners'];$userBudget=$this->getBudgetService()->getUserBudget($this->cuID);$this->data['totalAccountBalance']=$userBudget['totalAccountBalance']?? 0;$this->data['totalAccountBalanceFMT']=$userBudget['totalAccountBalanceFMT']?? '0.00';$userSolanaData=$this->getSolanaService()->getSolanaData($this->cuID);$this->data['cuSolanaDW']=$userSolanaData['userSolanaWallets']['cuSolanaDW']?? null;$this->data['solanaNetworkStatus']=$userSolanaData['solanaNetworkStatus'];$this->data['cuSolanaTotal']=$userSolanaData['userSolanaWallets']['cuSolanaTotal']?? 0;$this->data['cuSolanaValue']=$userSolanaData['userSolanaWallets']['cuSolanaValue']?? 0;$this->data=array_merge($this->data,$userData);if($this->debug===1){}}public function index(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['recentMarketingPosts']=$this->getMyMIMarketing()->getRecentPosts(5);if(empty($this->data['recentMarketingPosts'])){log_message('info','ðŸ“­ No recent posts found. Running fallback generation...');$this->getMyMIMarketing()->generateFromTempScraper(5);$this->data['recentMarketingPosts']=$this->getMyMIMarketing()->getRecentPosts(25);}$this->data['todaysStory']=$this->marketingModel->getTodaysStory();$this->data['generatedSummaries']=$this->marketingModel->getLatestGeneratedSummaries(25);$this->data['marketingBuffer']=$this->marketingModel->getMarketingBuffer();if(empty($this->data['todaysStory'])){log_message('info','ðŸ“… No content generated today. Triggering summary fallback...');$this->getMyMIMarketing()->generateFromTempScraper(5);$this->data['todaysStory']=$this->marketingModel->where('DATE(created_at)',date('Y-m-d'))->orderBy('created_at','DESC')->findAll();}$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\index',$this->data);}public function add($type=null){log_message('debug','MarketingController L183 - add() method called with type: '.(is_null($type)?'null':$type));if(!empty($type)){if($this->request->getMethod()==='POST'){log_message('debug','Handling POST request for type: '.$type);if($type==='Schedule'){log_message('info','Processing Schedule submission');try{$this->marketingModel->addMarketingSchedule($this->request->getPost());log_message('info','Schedule data saved successfully');if($this->request->isAJAX()){return $this->response->setJSON(['success'=>true,'message'=>'Schedule added successfully']);}else{return redirect()->to('/Management/Marketing/Schedule')->with('success','Schedule added successfully');}}catch(\Exception $e){log_message('error','Error saving schedule: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to save schedule.']);}}elseif($type==='Campaign'){log_message('info','Processing Campaign submission');try{$campaignData=['beta'=>$this->request->getPost('beta'),'config_mode'=>$this->request->getPost('config_mode'),'form_mode'=>$this->request->getPost('form_mode'),'escalated'=>$this->request->getPost('escalated'),'user_id'=>$this->request->getPost('user_id'),'user_email'=>$this->request->getPost('user_email'),'username'=>$this->request->getPost('username'),'assigned_to'=>$this->request->getPost('assigned_to'),'date'=>$this->siteSettings->date,'time'=>$this->siteSettings->time,'campaign_name'=>$this->request->getPost('campaign_name'),'promotionalLinks'=>json_encode($this->request->getPost('promotionalLinks')),'overall_campaign_description'=>$this->request->getPost('overall_campaign_description'),'voice_script'=>$this->request->getPost('voice_script'),'facebookMessage'=>$this->request->getPost('facebookMessage'),'linkedinMessage'=>$this->request->getPost('linkedinMessage'),'discordMessage'=>$this->request->getPost('discordMessage'),'stocktwitsMessage'=>$this->request->getPost('stocktwitsMessage'),'tiktokMessage'=>$this->request->getPost('tiktokMessage'),'youtubeMessage'=>$this->request->getPost('youtubeMessage'),'emailMessage'=>$this->request->getPost('emailMessage'),'additionalInfo'=>$this->request->getPost('additionalInfo'),'hashtags'=>$this->request->getPost('hashtags'),];$this->marketingModel->addMarketingCampaign($campaignData);log_message('info','Campaign data saved successfully');if($this->request->isAJAX()){log_message('info','MarketingController L251 - This is using the $this->request->isAJAX() Form Submission');return $this->response->setJSON(['success'=>true,'message'=>'Campaign added successfully']);}else{log_message('info','MarketingController L251 - This is NOT using the $this->request->isAJAX() Form Submission');return redirect()->to('/Management/Marketing/Campaigns')->with('success','Campaign added successfully');}}catch(\Exception $e){log_message('error','Error saving campaign: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to save campaign.']);}}else{log_message('error','Unrecognized type in POST request: '.$type);return $this->response->setJSON(['error'=>'Unrecognized type in POST request']);}}if($this->request->getMethod()==='get'){log_message('debug','Handling GET request for type: '.$type);if($type==='Schedule'){log_message('debug','Loading view for Schedule');try{$response=$this->renderTheme('ManagementModule\Views\Marketing\Schedule\Add',$this->data);log_message('debug','View for Schedule loaded successfully');return $response;}catch(\Exception $e){log_message('error','Failed to load view for Schedule: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to load view for Schedule']);}}elseif($type==='Campaign'){log_message('debug','Loading view for Campaign');try{$response=$this->renderTheme('ManagementModule\Views\Marketing\Campaign\Add',$this->data);log_message('debug','View for Campaign loaded successfully');return $response;}catch(\Exception $e){log_message('error','Failed to load view for Campaign: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to load view for Campaign']);}}else{log_message('error','Unrecognized type in GET request: '.$type);return $this->response->setJSON(['error'=>'Unrecognized type in GET request']);}}}else{log_message('warning','No type provided; redirecting to /Management/Marketing');return redirect()->to('/Management/Marketing')->with('error','No type provided');}}public function addSchedule(){if($this->request->getMethod()==='post'){$additionalInfo=$this->request->getPost('additional_info');$jsonData=null;if(!empty($additionalInfo)){$jsonData=json_decode($additionalInfo,true);if(json_last_error()!==JSON_ERROR_NONE){return redirect()->back()->withInput()->with('error','Invalid JSON format in Additional Information.');}}$scheduleData=['day'=>$this->request->getPost('day'),'time'=>$this->request->getPost('time'),'activity'=>$this->request->getPost('activity'),'link'=>$this->request->getPost('link'),'additional_info'=>json_encode($jsonData)];$this->marketingModel->addMarketingSchedule($scheduleData);return redirect()->to(base_url('Management/Marketing/Schedule'))->with('success','New schedule added successfully.');}$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Schedule\Add');}public function addSubscriber(){helper('email');$rawRequestBody=$this->request->getBody();$jsonData=json_decode($rawRequestBody,true);$marketingModel=new MarketingModel();$subscriberData=['email'=>$jsonData['email'],'category'=>$jsonData['category'],'referral'=>$jsonData['referral'],'beta'=>$this->siteSettings->beta,'date'=>date('Y-m-d H:i:s'),'hostTime'=>date('Y-m-d H:i:s'),'time'=>date('H:i:s'),'user_id'=>session('user_id'),'user_ip'=>$this->request->getIPAddress()];if($marketingModel->addSubscriber($subscriberData)){$emailService=\Config\Services::email();$emailService->setTo($subscriberData['email']);$emailService->setSubject('ðŸŽ‰ Welcome to Investorâ€™s Talk | MyMI Wallet');$emailService->setMessage(view('emails/welcomeInvestor',['siteSettings'=>$this->siteSettings,'socialMedia'=>config('SocialMedia'),]));if($emailService->send()){log_message('info','Management/MarketingController L346 - $emailService: '.print_r($emailService,true));return $this->response->setJSON(['success'=>true,'message'=>'Subscriber email sent successfully']);}else{log_message('error','Management/MarketingController L346 - Error Submitting: $emailService: '.print_r($emailService,true));return $this->response->setJSON(['success'=>false,'message'=>'Failed to send Welcome Email']);}}else{return $this->response->setJSON(['success'=>false,'message'=>'Failed to add subscriber']);}}public function approveBufferItem($id){$this->marketingModel->updateBufferStatus($id,'approved');return $this->respond(['status'=>'success','message'=>'Approved']);}public function approveLogo(){$symbol=$this->request->getPost('symbol');$imageUrl=$this->request->getPost('imageUrl');try{$this->marketingModel->saveApprovedLogo($symbol,$imageUrl);return $this->response->setJSON(['success'=>true,'message'=>'Logo approved successfully.',]);}catch(\Exception $e){log_message('error','Failed to approve logo: '.$e->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to approve logo.',]);}}public function approveAndDownloadLogo(){$imageUrl=$this->request->getPost('selectedImage');$symbol=$this->request->getPost('symbol');try{$imageContent=file_get_contents($imageUrl);$imagePath=WRITEPATH.'uploads/Company-Logos/'.$symbol.'.png';file_put_contents($imagePath,$imageContent);$publicPath=FCPATH.'assets/images/Company-Logos/'.$symbol.'.png';rename($imagePath,$publicPath);return redirect()->to('/Management/Marketing/upcomingEarnings')->with('success','Logo approved and saved successfully.');}catch(\Exception $e){log_message('error','Failed to download or save logo: '.$e->getMessage());return redirect()->back()->with('error','Failed to save the logo.');}}public function approveContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['status'=>'approved']);return redirect()->back()->with('success','Content approved successfully.');}public function blogs(){$this->data['pageTitle']='MyMI Blogs | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['blogs']=$this->marketingModel->getBlogs();$this->data['totalBlogs']=$this->marketingModel->countBlogs();$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Blogs',$this->data);}public function campaigns(){$this->data['pageTitle']='Marketing Campaigns | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['getActiveCampaigns']=$this->marketing['department']['getActiveCampaigns'];$this->data['getActivePriorityCampaigns']=$this->marketing['department']['getActivePriorityCampaigns'];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\campaigns',$this->data);}public function contentGenerator(){try{$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\contentGenerator',$this->data);}catch(\Throwable $th){log_message('error','MarketingController contentGenerator error: '.$th->getMessage());}}public function contentReview(){$generatedContent=$this->session->get('generatedContent');if(empty($generatedContent)){return redirect()->to('/Management/Marketing')->with('error','No generated content available for review.');}return $this->renderTheme('ManagementModule\Views\Marketing\Content_Review',['generatedContent'=>$generatedContent]);}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);log_message('debug','âœ… Content digest completed.');}public function cronFetchAndStoreEmails(){try{log_message('debug','Starting cronFetchAndStoreEmails');$this->marketingService->scrapeAndStoreEmailsToTemp();log_message('debug','Finished cronFetchAndStoreEmails');return $this->respond(['status'=>'success']);}catch(\Throwable $e){log_message('error','cronFetchAndStoreEmails Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();log_message('debug','âœ… Inbox scrape completed.');}public function cronFetchMarketingEmails(){log_message('info','CRON: Starting Marketing Email Fetch');$service=new MarketingService();$emailsFetched=$this->getMyMIMarketing()->fetchAndStoreEmails('newsletters');log_message('info','CRON: Fetched '.$emailsFetched.' marketing emails');return $this->respond(['status'=>'success','fetched'=>$emailsFetched]);}public function cronGenerateContentFromTemp(){try{log_message('debug','Starting cronGenerateContentFromTemp');$this->marketingService->generateFinalContentFromTemp();log_message('debug','Finished cronGenerateContentFromTemp');return $this->respond(['status'=>'success']);}catch(\Throwable $e){log_message('error','cronGenerateContentFromTemp Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function cronSendDailyLog(){date_default_timezone_set('America/Chicago');$contentData=$this->getLogsOrFallback();$emailView=view('emails/daily_log_summary',['contentData'=>$contentData['data'],'contentType'=>$contentData['type'],]);$subject=($contentData['type']==='logs')?'Daily Log Summary for '.date('F j, Y'):'Fallback Content - Daily Summary '.date('F j, Y');$this->email->setTo('community@mymiwallet.com')->setSubject($subject)->setMessage($emailView)->send();$this->email->setTo('team@mymiwallet.com')->setSubject('Reminder: Daily Log Email Pending Confirmation')->setMessage('The daily log email is scheduled to be sent at 3 PM CST. Please review the content to ensure everything is accurate.')->send();}public function edit($id=null){if($id===null){throw new \CodeIgniter\Exceptions\PageNotFoundException('Exchange ID not provided');}$tokenData=$this->marketingModel->getExchangeTokenById($id);if(!$tokenData){throw new \CodeIgniter\Exceptions\PageNotFoundException('Token not found');}if($this->request->getMethod()==='post'){$validation=\Config\Services::validation();$validation->setRules(['coin_name'=>'required','market_cap'=>'required|numeric','website'=>'required|valid_url','discord'=>'permit_empty|valid_url','facebook'=>'permit_empty|valid_url','telegram'=>'permit_empty|valid_url','twitter'=>'permit_empty|valid_url',]);if($validation->withRequest($this->request)->run()){$updatedData=['coin_name'=>$this->request->getPost('coin_name'),'market_cap'=>$this->request->getPost('market_cap'),'website'=>$this->request->getPost('website'),'discord'=>$this->request->getPost('discord'),'facebook'=>$this->request->getPost('facebook'),'telegram'=>$this->request->getPost('telegram'),'twitter'=>$this->request->getPost('twitter'),];if($this->marketingModel->updateExchangeToken($id,$updatedData)){$this->session->setFlashdata('success','Exchange token updated successfully');}else{$this->session->setFlashdata('error','Failed to update the exchange token');}return redirect()->to(site_url('Management/Marketing/Exchanges/Edit/'.$id));}else{$this->session->setFlashdata('validation_errors',$validation->getErrors());}}return $this->renderTheme('ManagementModule\Views\Marketing\Exchanges\edit',['token'=>$tokenData,'validation'=>$this->session->getFlashdata('validation_errors'),'redirectURL'=>site_url('Management/Marketing/Exchanges'),]);}public function editContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}return $this->renderTheme('ManagementModule\Views\Marketing\Content_Edit',['content'=>$content]);}public function fetchBufferPaginated(){$page=(int) $this->request->getGet('page')?:1;$limit=(int) $this->request->getGet('limit')?:20;$data=$this->marketingModel->fetchBufferPaginated($page,$limit);return $this->respond($data);}public function fetchLatestSummaries(){$generatedSummaries=$this->marketingModel->getLatestGeneratedSummaries(25);return $this->renderTheme('ManagementModule\Views\Marketing\resources\generatedSummaries',['generatedSummaries'=>$generatedSummaries]);}public function fetchMissingLogos(){$postData=$this->request->getJSON(true);$csrfName=csrf_token();$csrfHash=csrf_hash();if(!isset($postData[$csrfName])||$postData[$csrfName]!==$csrfHash){log_message('error','fetchMissingLogos: CSRF validation failed');return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['error'=>'Invalid CSRF token.']);}$symbols=$postData['symbols']?? null;if(empty($symbols)||!is_array($symbols)){log_message('error','fetchMissingLogos: Invalid symbols input');return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['error'=>'Invalid symbols input.']);}$results=[];foreach($symbols as $symbol){$results[]=['symbol'=>$symbol,'status'=>'not_found',];}return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['results'=>$results]);}public function financialNews(){$symbols=$this->investmentModel->getAllSymbolsByEarnings();$approvedLogos=$this->marketingModel->getApprovedLogos();$existingSymbols=array_column($approvedLogos,'symbol');$missingSymbols=array_filter($symbols,function($symbol)use($existingSymbols){return!in_array($symbol['symbol'],$existingSymbols);});$this->data['approvedLogos']=$approvedLogos ??[];$this->data['missingSymbols']=$missingSymbols ??[];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\financialNews',$this->data);}public function generateAudio(){$text=$this->request->getPost('text');$fileName=$this->request->getPost('fileName')?:uniqid('tts_',true);$directory=WRITEPATH.'uploads/';$outputFile=$directory.$fileName.'.mp3';if(empty($text)){return $this->response->setJSON(['status'=>'error','message'=>'Text cannot be empty.',]);}if(!is_dir($directory)){mkdir($directory,0777,true);}$command=sprintf('python3 gtts_script.py %s %s',escapeshellarg($text),escapeshellarg($outputFile));exec($command,$output,$status);if($status===0&&file_exists($outputFile)){$fileUrl=base_url('uploads/'.basename($outputFile));return $this->response->setJSON(['status'=>'success','message'=>'Audio file generated successfully.','file_url'=>$fileUrl,]);}else{return $this->response->setJSON(['status'=>'error','message'=>'Failed to generate audio.',]);}}private function generateAutomatedContent(){$scraperContent=$this->marketingModel->getRecentScrapes();$tempContent=$this->marketingModel->getRecentTempScrapes();$campaigns=$this->marketingModel->getActiveCampaignsLimited(50);$allContent=array_merge($scraperContent,$tempContent,$campaigns);$generatedContent=[];foreach($allContent as $content){$generatedContent[]=$this->getMarketingService()->generateContentFromPost($content->title ?? 'Untitled',$content->content ?? '',$content->tags?explode(',',$content->tags):[]);}foreach($generatedContent as $content){$slug=$this->marketingModel->createSlug($content['title']);$this->db->table('bf_marketing_blog_posts')->insert(['title'=>$content['title']?? 'Generated Content','content'=>$content['summary']?? '','slug'=>$slug,'tags'=>implode(',',$content['keywords']??[]),'created_on'=>date('Y-m-d H:i:s'),]);$this->marketingModel->saveDailyLog(['title'=>$content['title'],'content'=>$content['summary'],'type'=>'Automated','tags'=>implode(',',$content['keywords']),'date_time'=>date('Y-m-d H:i:s'),'author_information'=>'MyMI Automated System','created_on'=>date('Y-m-d H:i:s'),]);}return $generatedContent;}public function generateContent($platform,$postId){$post=$this->marketingModel->getSchedulePostById($postId);if(!$post){return redirect()->back()->with('error','Post not found.');}$content=$this->getMyMIMarketing()->generateContentFromGPT($post['subjects'],$post['descriptions'],$platform);$contentData=['post_id'=>$postId,'platform'=>$platform,'generated_content'=>$content,];$this->marketingModel->storeGeneratedContent($contentData);return redirect()->to("\Management\Marketing\Schedule")->with('success','Content generated successfully.');}public function generateContentDigestFromStored(){log_message('info','Marketing: Starting summary generation from stored marketing emails.');$model=new MarketingModel();$records=$model->getRecentUnprocessedTempEmails(5);$results=[];foreach($records as $record){if(empty($record['content'])||strlen($record['content'])<1000){log_message('debug',"âš ï¸ Skipping record ID {$record['id']} due to insufficient content length.");continue;}if(empty($record['title'])||empty($record['content'])){log_message('debug','Skipped record due to missing title/content ID: '.$record['id']);continue;}try{$summary=$this->getMarketingService()->generateContentFromRaw($record['title'],$record['content']);$model->storeFinalMarketingContent(['source_id'=>$record['id'],'title'=>$record['title'],'summary'=>$summary,'created_at'=>date('Y-m-d H:i:s')]);$model->markTempRecordAsProcessed($record['id']);$results[]=$record['title'];}catch(\Throwable $e){log_message('error','Failed to process record ID '.$record['id'].': '.$e->getMessage());}}return $this->respond(['status'=>'complete','processed_titles'=>$results]);}public function generateContentFromTweet($tweetId){$tweet=$this->marketingModel->getTweetById($tweetId);if(!$tweet){return $this->failNotFound('Tweet not found');}$generatedContent=$this->getMyMIMarketing()->generateContentFromTweets([$tweet]);$this->marketingModel->storeGeneratedContent(['tweet_id'=>$tweetId,'content'=>json_encode($generatedContent),'created_at'=>date('Y-m-d H:i:s')]);$this->getMyMIMarketing()->postToTwitter($generatedContent['platform_content']['Twitter']);return $this->respond(['message'=>'Content generated and posted successfully']);}public function generateDailyContentDigest(){log_message('debug','ðŸ§  Start Memory Usage: '.memory_get_usage(true));@ini_set('memory_limit','768M');$limit=5;$summary=[];$rawRecords=$this->marketingModel->getLatestUnprocessedEmails($limit);foreach($rawRecords as $record){$content=$record['content']?? '';if(empty($content)||strlen($content)<500){log_message('debug',"â­ï¸ Skipped record ID {$record['id']} - insufficient content.");continue;}$contentSize=strlen($content);log_message('debug','ðŸ“Œ Processing record ID '.$record['id'].' with content size: '.$contentSize);log_message('debug','Management/MarketingController L770 - $record Array: '.print_r($record,true));if($contentSize===0){log_message('debug',"â­ï¸ Skipped record ID {$record['id']} - empty content.");continue;}try{gc_collect_cycles();$processed=$this->getMarketingService()->generateContentFromRaw($record);if($processed===null){log_message('debug',"âš ï¸ Skipped record ID {$record['id']} - generateContentFromRaw() returned null.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$summary[]=['title'=>$processed['headline'],'summary'=>$processed['summary'],'subtopics'=>$processed['subtopics'],'platform_posts'=>$processed['posts'],];}catch(\Throwable $e){log_message('error',"âŒ generateDailyContentDigest failed on record ID {$record['id']}: {$e->getMessage()}");}}$this->marketingModel->markEmailsAsProcessed(array_column($rawRecords,'id'));log_message('debug','ðŸ Peak Memory Usage: '.memory_get_peak_usage(true));return $this->response->setJSON(['digest'=>$summary]);}public function generateNewsletterContent(){$emailContents=$this->marketingModel->getEmailContentsForNewsletter();$content=$this->getMyMIMarketing()->generateNewsletterContent($emailContents);$newsletterData=['title'=>'Monthly Financial Newsletter - '.date('F Y'),'content'=>$content,'status'=>'draft','created_at'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeNewsletterDraft($newsletterData);return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Newsletter content generated successfully');}private function generateSummarizedFallbackContent($contentArray){$summarizedContent=[];$summarizer=new \App\Libraries\ContentSummarizer();foreach($contentArray as $content){$summarizedContent[]=['title'=>$content->title ?? 'Untitled','summary'=>$summarizer->summarize($content->content ?? '',200),'url'=>$content->url ?? null,];}return $summarizer->combineSummaries($summarizedContent);}private function getLogsOrFallback(){$logs=$this->marketingModel->getDailyLogsByDate(date('Y-m-d'));if(!empty($logs)){return['type'=>'logs','data'=>$logs];}$scrapedContent=$this->marketingModel->getRecentScrapes();$campaigns=$this->marketingModel->getActiveCampaignsLimited(50);$combinedContent=array_merge($scrapedContent,$campaigns['result']);$fallbackContent=$this->generateSummarizedFallbackContent($combinedContent);foreach($fallbackContent as $content){$this->marketingModel->saveDailyLog(['title'=>$content['title']?? 'Automated Content','content'=>$content['summary']?? '','type'=>'Automated','tags'=>implode(',',$content['keywords']??[]),'date_time'=>date('Y-m-d H:i:s'),'author_information'=>'MyMI Automated System','created_on'=>date('Y-m-d H:i:s'),]);}return['type'=>'fallback','data'=>$fallbackContent];}public function getRecentScrapes(){try{$scrapes=$this->marketingModel->getRecentScrapes();return $this->response->setJSON(['success'=>true,'scrapes'=>$scrapes]);}catch(\Throwable $th){log_message('error','getRecentScrapes: Exception - '.$th->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to fetch recent scrapes.']);}}private function handleMediaUpload($mediaFiles){$uploadedMedia=[];foreach($mediaFiles as $file){if($file->isValid()&&!$file->hasMoved()){$newFileName=$file->getRandomName();$file->move(WRITEPATH.'uploads/media/',$newFileName);$uploadedMedia[]=['file_name'=>$file->getClientName(),'file_path'=>WRITEPATH.'uploads/media/'.$newFileName,'file_size'=>$file->getSize(),'file_type'=>$file->getMimeType(),];}}return $uploadedMedia;}public function ideas(){$this->data['pageTitle']='Marketing Campaigns | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['getActiveIdeas']=$this->marketingModel->getActiveIdeas();$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\ideas',$this->data);}public function importScheduleCSV(){if($this->request->getMethod()==='post'){$file=$this->request->getFile('csv_file');if($file->isValid()&&!$file->hasMoved()){$filePath=WRITEPATH.'uploads/'.$file->store();$csvData=array_map('str_getcsv',file($filePath));foreach($csvData as $row){$scheduleData=['day'=>$row[0],'time'=>$row[1],'activity'=>$row[2],];$scheduleId=$this->marketingModel->addMarketingSchedule($scheduleData);$campaignData=['sched_id'=>$scheduleId,'title'=>$row[3],'platform'=>$row[4],'content'=>$row[5],];$this->marketingModel->addMarketingCampaign($campaignData);}return redirect()->back()->with('success','Schedule and campaigns imported successfully.');}return redirect()->back()->with('error','Invalid CSV file.');}return $this->renderTheme('ManagementModule\Views\Marketing\importCSV');}public function previewBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Item not found.");return $this->renderTheme('ManagementModule\Views\Marketing\modals\bufferPreview',['item'=>$record]);}public function previewGeneratedPost($id){try{$post=$this->marketingModel->find($id);if(!$post){return $this->failNotFound('Post not found.');}return $this->renderTheme('App\Modules\Management\Views\Marketing\modals/previewGeneratedPost',['post'=>$post]);}catch(\Throwable $e){log_message('error','âŒ Failed to load post preview: '.$e->getMessage());return $this->failServerError('Unable to preview post.');}}public function previewPendingSummaries(){try{$pendingSummaries=$this->marketingModel->getPendingScraperSummaries(10);return $this->renderTheme('App\Modules\Management\Views\Marketing\partials\previewPendingSummaries',['pendingSummaries'=>$pendingSummaries]);}catch(\Throwable $e){log_message('error','âŒ previewPendingSummaries failed: '.$e->getMessage());return $this->failServerError('Could not load summaries.');}}public function previewVideoScript($id){$post=$this->marketingModel->getGeneratedPostById($id);if(!$post)return $this->failNotFound('Post not found.');$posts=json_decode($post['posts'],true);$videoScript=$posts['video']?? 'No video script generated yet.';return $this->renderTheme('MarketingModule\Views\Marketing\modals\video_preview_modal',['title'=>$post['title'],'videoScript'=>$videoScript,]);}public function processScheduledPosts(){$currentTimestamp=date('Y-m-d H:i:s');$scheduledPosts=$this->marketingModel->getPendingScheduledPosts($currentTimestamp);foreach($scheduledPosts as $post){$payload=['platform'=>$post->platform,'content'=>$post->content,'media_url'=>$post->media_url,];try{$response=$this->sendToZapier($post->zapier_webhook_url,$payload);if($response->getStatusCode()===200){$this->marketingModel->updatePostStatus($post->id,'posted');}else{throw new Exception("Zapier response error: {$response->getBody()}");}}catch(Exception $e){$this->handlePostFailure($post,$e->getMessage());}}}private function sendToZapier($webhookUrl,$payload){$client=new \GuzzleHttp\Client();return $client->post($webhookUrl,['headers'=>['Content-Type'=>'application/json'],'json'=>$payload,]);}private function handlePostFailure($post,$error){$this->marketingModel->incrementRetryCount($post->id);log_message('error',"Failed to post to Zapier for Post ID {$post->id}: {$error}");if($post->retry_count>=3){$this->marketingModel->updatePostStatus($post->id,'failed');}}public function postCreator(){try{$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\index',$this->data);}catch(\Throwable $th){log_message('error','MarketingController postCreator error: '.$th->getMessage());}}public function promote(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['exchangeAssets']=[];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Promote',$this->data);}public function publishBlog($blogId){$blog=$this->marketingModel->getBlogPostDetails($blogId);if(!$blog){return redirect()->back()->with('error','Blog post not found.');}$this->marketingModel->update($blogId,['status'=>'published']);return redirect()->to('/Management/Marketing/Blogs')->with('success','Blog published successfully.');}public function rejectBufferItem($id){$this->marketingModel->updateBufferStatus($id,'rejected');return $this->respond(['status'=>'success','message'=>'Rejected']);}public function rejectContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['status'=>'rejected']);return redirect()->back()->with('success','Content rejected successfully.');}public function reviewBuffer(){$buffer=$this->marketingModel->getBufferItems();$this->data['pageTitle']='Marketing Buffer Dashboard';$this->data['buffer']=$buffer;return $this->renderTheme('ManagementModule\Views\Marketing\BufferDashboard',$this->data);}public function runContentGeneration(){$generatedContent=$this->generateAutomatedContent();$this->session->set('generatedContent',$generatedContent);return redirect()->to('/Management/Marketing/ContentReview')->with('success',count($generatedContent).' content items generated successfully. Please review and approve.');}private function sanitizeContent($content){$content=preg_replace('#<script(.*?)>(.*?)</script>#is','',$content);$content=preg_replace('#<style(.*?)>(.*?)</style>#is','',$content);$content=strip_tags($content);$content=preg_replace('/\s+/',' ',$content);return trim($content);}private function saveCampaign($formData){$data=['title'=>$formData['title'],'description'=>$formData['description'],];$this->marketingModel->addMarketingCampaign($data);}public function saveContentEdit($id){$postData=$this->request->getPost();$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['content'=>$postData['content'],'status'=>'pending',]);return redirect()->to('/Management/Marketing/ContentReview')->with('success','Content updated successfully.');}private function saveSchedule($formData){$scheduleModel=new \App\Models\ScheduleModel();$data=['title'=>$formData['title'],'description'=>$formData['description'],];$scheduleModel->insert($data);}public function schedule($day=null){if(!empty($day)){$this->data['marketingSchedule']=$this->marketingModel->getScheduleByDay($day);foreach($this->data['marketingSchedule']as&$schedule){$schedule['campaigns']=$this->marketingModel->getCampaignsBySchedId($schedule['id']);}$this->data['scheduleByDay']='Yes';}else{$this->data['marketingSchedule']=$this->marketingModel->getUpcomingSchedule();foreach($this->data['marketingSchedule']as&$schedule){$schedule['campaigns']=$this->marketingModel->getCampaignsBySchedId($schedule['id']);}$this->data['scheduleByDay']='No';}$this->commonData();$this->data['pageTitle']='Daily Schedule | Management | MyMI Wallet';return $this->renderTheme('ManagementModule\Views\Marketing\Schedule',$this->data);}public function scheduleNewsletterCampaign(){$newsletterDraft=$this->marketingModel->getLatestNewsletterDraft();if(!$newsletterDraft){return $this->response->setJSON(['success'=>false,'message'=>'No newsletter draft found']);}$campaignData=['title'=>$newsletterDraft['title'],'content'=>$newsletterDraft['content'],'status'=>'scheduled','send_date'=>$this->request->getPost('send_date'),'target_audience'=>'all_users','created_at'=>date('Y-m-d H:i:s'),];if($this->marketingModel->scheduleNewsletterCampaign($campaignData)){return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Newsletter campaign scheduled successfully');}else{return redirect()->back()->with('error','Failed to schedule newsletter campaign');}}private function scrapeGoogleSearch($query){$searchUrl='https://www.google.com/search?q='.urlencode($query);$client=new Client();try{$response=$client->get($searchUrl);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$dom=new \DOMDocument();libxml_use_internal_errors(true);$dom->loadHTML($html);libxml_clear_errors();$xpath=new \DOMXPath($dom);$results=[];foreach($xpath->query('//a[@href]')as $link){$href=$link->getAttribute('href');if(strpos($href,'/url?q=')===0){$href=substr($href,7,strpos($href,'&')-7);$text=$link->nodeValue;$results[]=['href'=>$href,'text'=>$text];}}return $results;}else{log_message('error','scrapeGoogleSearch: Could not retrieve content, HTTP status code - '.$response->getStatusCode());return['error'=>'Could not retrieve content, HTTP status code - '.$response->getStatusCode()];}}catch(RequestException $e){log_message('error','scrapeGoogleSearch: RequestException - '.$e->getMessage());return['error'=>'RequestException error: '.$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeGoogleSearch: General error - '.$e->getMessage());return['error'=>'General error: '.$e->getMessage()];}return[];}public function scrapeLink(){$rawRequestBody=$this->request->getBody();$jsonData=json_decode($rawRequestBody,true);$url=$jsonData['url']?? null;if(!$url){log_message('error','scrapeLink: URL is missing');return $this->response->setJSON(['success'=>false,'message'=>'URL is required.']);}try{log_message('debug','scrapeLink: Scraping URL - '.$url);$scrapedData=$this->scrapeWebsiteWithFallback($url);if(isset($scrapedData['error'])){log_message('error','scrapeLink: '.$scrapedData['error']);return $this->response->setJSON(['success'=>true,'message'=>'Partially scraped data, proceeding with available data.']);}if(!empty($scrapedData['content'])){$this->marketingModel->storeTempScrapedData(['title'=>$scrapedData['title'],'content'=>$scrapedData['content'],'links'=>json_encode($scrapedData['links']),'url'=>$scrapedData['url'],'scraped_at'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),]);return $this->response->setJSON(['success'=>true,'message'=>'Scraped data stored successfully.','data'=>$scrapedData]);}else{log_message('error','scrapeLink: Scraped data is empty');return $this->response->setJSON(['success'=>false,'message'=>'Scraping failed. Please check the URL and try again.']);}}catch(\Throwable $th){log_message('error','scrapeLink: Exception - '.$th->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'An error occurred during scraping.']);}}private function scrapeLinks($links){$scrapedLinksData=[];foreach($links as $link){$url=filter_var($link['href'],FILTER_SANITIZE_URL);if(filter_var($url,FILTER_VALIDATE_URL)){$scrapedData=$this->scrapeWebsite($url);if(!empty($scrapedData['content'])){$scrapedLinksData[]=$scrapedData;}}}return $scrapedLinksData;}private function scrapeWebsite($url){$client=new Client();try{$response=$client->get($url,['stream'=>true,'headers'=>['User-Agent'=>'MyMI Wallet Bot'],'timeout'=>10,'http_errors'=>false ]);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$dom=HtmlDomParser::str_get_html($html);if($dom instanceof \voku\helper\HtmlDomParser){$title=$dom->find('title',0)->text ?? 'No title found';$bodyNode=$dom->find('body',0);$bodyContent=$bodyNode?$this->sanitizeContent($bodyNode->innerHtml()):'No body content found';$links=[];foreach($dom->find('a')as $link){$href=$link->getAttribute('href');$text=$link->text;$links[]=['href'=>$href,'text'=>$text];}log_message('debug','scrapeWebsite: Scraping successful for URL - '.$url);return['title'=>$title,'content'=>$bodyContent,'links'=>$links,'url'=>$url];}else{log_message('error','scrapeWebsite: DOM parsing failed for URL - '.$url);return['error'=>'DOM parsing failed.'];}}else{log_message('error','scrapeWebsite: Could not retrieve content, HTTP status code - '.$response->getStatusCode());return['error'=>'Could not retrieve content, HTTP status code - '.$response->getStatusCode()];}}catch(RequestException $e){if($e->hasResponse()&&$e->getResponse()->getStatusCode()==401){log_message('error','scrapeWebsite: Unauthorized access for URL - '.$url);return['error'=>'Unauthorized access. Skipping URL.'];}log_message('error','scrapeWebsite: RequestException - '.$e->getMessage());return['error'=>'RequestException error: '.$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeWebsite: General error - '.$e->getMessage());return['error'=>'General error: '.$e->getMessage()];}}private function scrapeWebsiteWithFallback($url){try{log_message('debug','scrapeWebsiteWithFallback: Scraping URL - '.$url);$scrapedData=$this->scrapeWebsite($url);if(empty($scrapedData['content'])){log_message('debug','scrapeWebsiteWithFallback: Scraped data is empty, performing Google search fallback');$googleSearchResults=$this->scrapeGoogleSearch($url);$scrapedLinksData=$this->scrapeLinks($googleSearchResults);$scrapedData['google_search_results']=$scrapedLinksData;}return $scrapedData;}catch(RequestException $e){log_message('error','scrapeWebsiteWithFallback: RequestException - '.$e->getMessage());return['error'=>$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeWebsiteWithFallback: General error - '.$e->getMessage());return['error'=>$e->getMessage()];}}public function searchAndApproveLogo($symbol){$query=$symbol.' logo png transparent';$searchUrl='https://www.google.com/search?q='.urlencode($query).'&tbm=isch';try{$response=$this->client->request('GET',$searchUrl);$htmlContent=$response->getBody()->getContents();$dom=new \DOMDocument();@$dom->loadHTML($htmlContent);$xpath=new \DOMXPath($dom);$imageNodes=$xpath->query('//img');$imageUrls=[];foreach($imageNodes as $imageNode){$src=$imageNode->getAttribute('src');if($src){$imageUrls[]=$src;}}return $this->renderTheme('ManagementModule\Views\Marketing\approve_logo',['symbol'=>$symbol,'imageUrls'=>$imageUrls,]);}catch(RequestException $e){log_message('error','Google Search Request Failed: '.$e->getMessage());return redirect()->back()->with('error','Failed to fetch logo suggestions.');}}public function sendScheduledNewsletter(){$campaigns=$this->marketingModel->getScheduledCampaigns();foreach($campaigns as $campaign){$this->getMyMIMarketing()->sendNewsletter($campaign['content'],$campaign['target_audience']);$this->marketingModel->updateCampaignStatus($campaign['id'],'sent');}return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Scheduled newsletters sent successfully');}public function standaloneAddSubscriber(){$this->data['pageTitle']='Add Subscriber | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneAddSubscriber',$this->data);}public function standaloneScrape(){$this->data['pageTitle']='Quick Scraper | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneScraper',$this->data);}private function storeScrapedData($scrapedData){$db=\Config\Database::connect();$builder=$db->table('bf_marketing_temp_scraper');$data=['title'=>$scrapedData['title'],'content'=>$scrapedData['content'],'links'=>json_encode($scrapedData['links']),'url'=>$scrapedData['url'],'created_at'=>date('Y-m-d H:i:s'),'updated_at'=>date('Y-m-d H:i:s'),];$builder->insert($data);}public function submitContent(){$request=service('request');$validationRules=['campaignName'=>'required|min_length[3]','promotionalLinks'=>'required','facebookMessage'=>'required','linkedinMessage'=>'required','discordMessage'=>'required','stockTwitsMessage'=>'required','tiktokMessage'=>'required','youtubeMessage'=>'required','emailMessage'=>'required',];if(!$this->validate($validationRules)){return redirect()->back()->with('errors',$this->validator->getErrors())->withInput();}$campaignData=['name'=>$request->getPost('campaignName'),'promotional_links'=>json_encode($request->getPost('promotionalLinks')),'facebook_message'=>$request->getPost('facebookMessage'),'linkedin_message'=>$request->getPost('linkedinMessage'),'discord_message'=>$request->getPost('discordMessage'),'stocktwits_message'=>$request->getPost('stockTwitsMessage'),'tiktok_message'=>$request->getPost('tiktokMessage'),'youtube_message'=>$request->getPost('youtubeMessage'),'email_message'=>$request->getPost('emailMessage'),'additional_info'=>$request->getPost('additionalInfo'),'created_on'=>date('Y-m-d H:i:s'),'status'=>1,'stage'=>'draft',];$marketingModel=new MarketingModel();if($marketingModel->insert($campaignData)){return redirect()->to('/Marketing/Success')->with('success','Marketing content submitted successfully.');}else{return redirect()->back()->with('error','Failed to submit marketing content.')->withInput();}}public function submitDailyLog(){$data=['title'=>$this->request->getPost('subject'),'content'=>$this->request->getPost('log_content'),'subcontent'=>json_encode($this->request->getPost('subcontent')),'tags'=>$this->request->getPost('tags'),'type'=>$this->request->getPost('content_type'),'url'=>$this->request->getPost('url'),'author_information'=>$this->request->getPost('author_information'),'date_time'=>$this->request->getPost('date_time'),'trade_alert_subcategory'=>$this->request->getPost('trade_alert_subcategory'),'created_on'=>date('Y-m-d H:i:s'),];if($this->marketingModel->saveDailyLog($data)){return $this->response->setJSON(['success'=>true,'message'=>'Daily log submitted successfully!']);}else{return $this->response->setJSON(['success'=>false,'message'=>'Failed to submit daily log.']);}}public function submitLargeContent(){log_message('debug','submitLargeContent method called');try{$subject=$this->request->getPost('subject');$url=$this->request->getPost('url');$content=$this->request->getPost('large_content');$tags=$this->request->getPost('tags');$uploadedFiles=$this->request->getFiles();$contentType=$this->request->getPost('content_type');$mediaAssets=$this->handleMediaUpload($uploadedFiles['media_assets']);if(empty($content)||strlen($content)<50){throw new \Exception('Content too short or empty');}$generatedContent=$this->getMyMIMarketing()->generateContentFromLargeText($content,$tags);$keywords=is_array($generatedContent['keywords'])?$generatedContent['keywords']:[];$this->marketingModel->storeScrapedContent(['status'=>'pending','type'=>$contentType,'url'=>$url,'title'=>$subject,'summary'=>$generatedContent['summary'],'content'=>$content,'keywords'=>implode(', ',$keywords),'created_on'=>date('Y-m-d H:i:s'),]);return $this->response->setJSON(['success'=>true]);}catch(\Exception $e){log_message('error','submitLargeContent error: '.$e->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to submit content.']);}}public function submitLargeContentForm(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();$this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneLargeContentForm',$this->data);}public function submitMarketingCampaign(){helper(['form','url']);$data=['name'=>$this->request->getPost('campaignName'),'assigned_to'=>$this->request->getPost('assigned_to'),'promotional_links'=>json_encode($this->request->getPost('promotionalLinks')),'facebook_message'=>htmlentities($this->request->getPost('facebookMessage'),ENT_QUOTES,'UTF-8'),'linkedin_message'=>htmlentities($this->request->getPost('linkedinMessage'),ENT_QUOTES,'UTF-8'),'discord_message'=>htmlentities($this->request->getPost('discordMessage'),ENT_QUOTES,'UTF-8'),'stocktwits_message'=>htmlentities($this->request->getPost('stocktwitsMessage'),ENT_QUOTES,'UTF-8'),'tiktok_message'=>htmlentities($this->request->getPost('tiktokMessage'),ENT_QUOTES,'UTF-8'),'youtube_message'=>htmlentities($this->request->getPost('youtubeMessage'),ENT_QUOTES,'UTF-8'),'email_message'=>htmlentities($this->request->getPost('emailMessage'),ENT_QUOTES,'UTF-8'),'additional_info'=>htmlentities($this->request->getPost('additionalInfo'),ENT_QUOTES,'UTF-8'),'overall_campaign_description'=>htmlentities($this->request->getPost('overall_campaign_description'),ENT_QUOTES,'UTF-8'),'voice_script'=>htmlentities($this->request->getPost('voice_script'),ENT_QUOTES,'UTF-8')];if($this->validate(['name'=>'required','facebook_message'=>'required',])){$this->marketingModel->submitCampaignContent($data);return redirect()->to('/dashboard')->with('success','Campaign submitted successfully.');}else{return redirect()->back()->withInput()->with('errors',$this->validator->getErrors());}}public function submitMarketIdeas(){if($this->request->getMethod()==='post'){$data=['title'=>$this->request->getPost('title'),'description'=>htmlentities($this->request->getPost('description'),ENT_QUOTES,'UTF-8'),'created_by'=>session()->get('user_id'),'assigned_to'=>$this->request->getPost('assigned_to'),'priority'=>$this->request->getPost('priority'),'status'=>'draft','platforms'=>json_encode($this->request->getPost('platforms')),'additional_info'=>htmlentities($this->request->getPost('additional_info'),ENT_QUOTES,'UTF-8'),];$uploadedFiles=$this->request->getFiles();$filePaths=[];if($uploadedFiles&&isset($uploadedFiles['imageFiles'])){foreach($uploadedFiles['imageFiles']as $file){if($file->isValid()&&!$file->hasMoved()){$newName=$file->getRandomName();$file->move(FCPATH.'public/assets/images/Marketing/Ideas',$newName);$filePaths[]=base_url('assets/images/Marketing/Ideas/'.$newName);}}}if(!empty($filePaths)){$data['image_paths']=json_encode($filePaths);}if($this->validate(['title'=>'required','description'=>'required'])){$this->marketingModel->submitIdea($data);return redirect()->back()->with('success','Idea submitted successfully.');}else{return redirect()->back()->withInput()->with('errors',$this->validator->getErrors());}}}public function topCommunities($channel=null){$this->commonData();$MyMIExchange=new MyMIExchange();$exchangeTokens=$MyMIExchange->getSolanaTokens();if(!empty($channel)){if($channel==='Discord'){$this->data['tokens']=$exchangeTokens['discord'];$this->data['pageTitle']='Discord Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\discord',$this->data);}elseif($channel==='Facebook'){$this->data['tokens']=$exchangeTokens['facebook'];$this->data['pageTitle']='Facebook Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\facebook',$this->data);}elseif($channel==='Twitter'){$this->data['tokens']=$exchangeTokens['x_twitter'];$this->data['pageTitle']='Twitter Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\twitter',$this->data);}elseif($channel==='Website'){$this->data['tokens']=$exchangeTokens['website'];$this->data['pageTitle']='Website Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\website',$this->data);}else{$this->data['tokens']=$exchangeTokens['all'];$this->data['pageTitle']='All Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\all_tokens',$this->data);}}else{$this->data['tokens']=$exchangeTokens['all'];$this->data['pageTitle']='All Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\all_tokens',$this->data);}}public function triggerPostAutogenOnEmpty(){$today=date('Y-m-d');$existing=$this->marketingModel->getLatestGeneratedSummaries(5,$today);if(!empty($existing)){return $this->response->setJSON(['status'=>'skipped','message'=>'Summaries already exist for today.']);}try{$this->getMyMIMarketing()->generateFromTempScraper(5);return $this->response->setJSON(['status'=>'generated','message'=>'Generated new summaries.']);}catch(\Throwable $e){log_message('error','triggerPostAutogenOnEmpty error: '.$e->getMessage());return $this->failServerError('Failed to generate summaries.');}}public function twitterDashboard(){$data=['pageTitle'=>'Twitter Dashboard','hashtags'=>$this->request->getPost('hashtags')?? '','tweets'=>[]];if($this->request->getMethod()==='post'){$hashtags=$this->request->getPost('hashtags');$tweets=$this->getMyMIMarketing()->fetchTweets($hashtags);$data['tweets']=$tweets;}return $this->renderTheme('Management/Marketing/Twitter',$data);}public function upcomingEarnings(){$model=new \App\Models\EarningsModel();$upcomingEarnings=$model->getUpcomingEarnings();$this->data['upcomingEarnings']=$upcomingEarnings;return $this->renderTheme('ManagementModule\Views\Marketing\upcoming_earnings',$this->data);}public function updatePlatformToggle($id){$post=$this->request->getJSON(true);$platform=$post['platform'];$enabled=(bool) $post['enabled'];$record=$this->marketingModel->getBufferItem($id);$platforms=json_decode($record['platforms']?? '{}',true);$platforms[$platform]=$enabled;$this->marketingModel->updateBufferItem($id,['platforms'=>json_encode($platforms)]);return $this->respond(['status'=>'success']);}public function viewBlog($slug){$blogPost=$this->marketingModel->getBlogPostBySlug($slug);if(!$blogPost){throw new \CodeIgniter\Exceptions\PageNotFoundException('Blog post not found');}return $this->renderTheme('blog/view',['blogPost'=>$blogPost]);}public function viewCampaign($campaign_id){$campaignModel=new CampaignModel();$campaign=$this->marketingModel->getCampaignsById($campaign_id);if(!$campaign){throw new \CodeIgniter\Exceptions\PageNotFoundException("Campaign not found");}return $this->renderTheme('ManagementModule\Views\Marketing\Campaigns\View',['campaign'=>$campaign]);}public function viewDailyLogs($date=null){$date=$this->siteSettings->date ?? date('Y-m-d');$this->data['pageTitle']='Marketing Daily Log | '.$date.' | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['logs']=$this->marketingModel->getDailyLogsByDate($date);$this->commonData();return $this->renderTheme('ManagementModul\Views\Marketing\Daily_Logs',['logs'=>$logs,'date'=>$date]);}public function viewEmail($titleEncoded=null,$messageId=null){log_message('debug','ðŸ“§ ManagementController::viewEmail called');try{if(empty($messageId)){return redirect()->back()->with('error','Invalid email identifier.');}$emailRecord=$this->marketingModel->getEmailByMessageId($messageId);if(!$emailRecord){return redirect()->back()->with('error','Email not found.');}$socialMediaPosts=$this->getMarketingService()->generateContentFromRaw($emailRecord);$emailRecord['social_media']=$socialMediaPosts['posts']??[];return $this->renderTheme('Management/Marketing/EmailDetail',['email'=>$emailRecord]);}catch(\Throwable $e){log_message('error','âŒ viewEmail() failed: '.$e->getMessage());return $this->failServerError('Unable to load email.');}}public function viewGeneratedContent(){$contentData=$this->marketingModel->getLastGeneratedContent();$platformsContent=json_decode($contentData['platforms_content'],true);$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['platforms_content']=$platformsContent;$this->commonData();$this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneGeneratedContent',$this->data);}public function viewGeneratedSummaries(){$this->data['pageTitle']='Generated Summaries';$this->data['generatedSummaries']=$this->marketingModel->getLatestGeneratedSummaries(25);$this->renderTheme('ManagementModule\Views\Marketing\resources\generatedSummaries',$this->data);}} ?><?php namespace App\Modules\APIs\Controllers;use CodeIgniter\API\ResponseTrait;use CodeIgniter\Controller;use App\Libraries\{BaseLoader,MyMIMarketing};use App\Services\MarketingService;use App\Models\MarketingModel;class MarketingController extends Controller{use ResponseTrait;use BaseLoader;protected $MyMIMarketing;protected $marketingService;protected $marketingModel;public function __construct(){$this->MyMIMarketing=new MyMIMarketing();$this->marketingModel=new MarketingModel();}public function approveBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Record not found.");$this->marketingModel->updateBufferItem($id,['status'=>'approved']);$posts=$this->MyMIMarketing->generateSocialPost($record);$this->MyMIMarketing->distributeContent('discord',$posts['discord']);$this->MyMIMarketing->distributeContent('linkedin',$posts['linkedin']);return $this->respond(['status'=>'success','message'=>'Content approved & promoted!']);}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);return $this->respond(['status'=>'success','message'=>'Content analysis completed.']);}public function cronFetchAndGenerateNews(){try{$this->MyMIMarketing->cronFetchAndGenerateNews();return $this->respond(['status'=>'success','message'=>'News fetched and generated.']);}catch(\Throwable $e){return $this->failServerError($e->getMessage());}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();return $this->respond(['status'=>'success','message'=>'Inbox scraped.']);}public function cronFetchMarketingEmails(){log_message('info','ðŸ“¬ CRON: Fetching marketing emails via inbox scrape');try{$result=$this->getMyMIMarketing()->scrapeInboxAndStore();return $this->respond(['status'=>'success','message'=>'Marketing inbox scrape completed.','result'=>$result]);}catch(\Throwable $e){log_message('error','âŒ cronFetchMarketingEmails() failed: '.$e->getMessage());return $this->failServerError('Inbox fetch failed: '.$e->getMessage());}}public function distributeHighScoreContent(){try{$this->getMyMIMarketing()->autoSendToZapier(80);return $this->respond(['status'=>'success','message'=>'Top scoring posts sent to Zapier']);}catch(\Throwable $e){return $this->failServerError($e->getMessage());}}public function exportBufferPosts(){helper('text');$model=new \App\Models\MarketingModel();$bufferPosts=$model->fetchBufferPostsForScoring();$filename='buffer-posts-'.date('Ymd_His').'.csv';$csvHeader=['ID','Keyword','Summary','Score','Tag Score','Category','Status','Created At'];$csvData=[$csvHeader];foreach($bufferPosts as $post){$csvData[]=[$post['id'],$post['keyword'],word_limiter(strip_tags($post['summary']),10),$post['score'],$post['tag_score'],$post['category'],$post['status'],$post['created_at']?? '',];}header('Content-Type: text/csv');header("Content-Disposition: attachment; filename=\"$filename\"");$f=fopen('php://output','w');foreach($csvData as $row){fputcsv($f,$row);}fclose($f);exit;}public function fetchBufferPaginated(){$request=service('request');$page=(int) $request->getGet('page')?? 1;$limit=(int) $request->getGet('limit')?? 20;$keyword=$request->getGet('keyword');$category=$request->getGet('category');$minTagScore=$request->getGet('min_tag_score')?? 0;$onlySuggested=(bool) $request->getGet('only_suggested');$result=$this->marketingModel->fetchBufferPaginatedWithFilters(['page'=>$page,'limit'=>$limit,'keyword'=>$keyword,'category'=>$category,'min_tag_score'=>$minTagScore,'only_suggested'=>$onlySuggested]);return $this->respond(['status'=>'success','data'=>$result['data'],'pagination'=>$result['pagination']]);}public function fetchGeneratedSummaries(){try{$summaries=$this->marketingModel->getRecentPosts(5);return $this->respond(['status'=>'success','summaries'=>$summaries,]);}catch(\Throwable $e){log_message('error','âŒ fetchGeneratedSummaries Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function fetchGeneratedSummariesBlock(){try{helper('text');$todaysStory=$this->marketingModel->where('DATE(created_at)',date('Y-m-d'))->orderBy('created_at','desc')->findAll();return $this->renderTheme('App\Modules\Management\Views\Marketing\index/generatedSummariesBlock',['todaysStory'=>$todaysStory]);}catch(\Throwable $e){log_message('error','âŒ Failed to fetch summaries block: '.$e->getMessage());return $this->failServerError('Unable to refresh summaries.');}}public function generateContentFromScraper(){try{$this->getMyMIMarketing()->generateFromTempScraper(25);return $this->respond(['status'=>'success','message'=>'Content generated from scraper.']);}catch(\Throwable $e){log_message('error','âŒ generateContentFromScraper Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function generateContentDigestFromStored(){$records=$this->marketingModel->getRecentUnprocessedTempEmails(5);$processedTitles=[];foreach($records as $record){$recordId=$record['id']?? 0;try{if(empty($record['title'])){$record['title']='Fallback Title - ID '.$recordId;}$insertResult=$this->getMyMIMarketing()->generateContentAndInsert($record);if($insertResult){$this->marketingModel->markTempScraperProcessed($recordId);$processedTitles[]=$insertResult['title'];log_message('info',"âœ… Inserted content for ID {$recordId}");}else{log_message('warning',"âš ï¸ Skipped record ID {$recordId} â€” summary not stored");}}catch(\Throwable $e){log_message('error',"âŒ Exception on record ID {$recordId}: {$e->getMessage()}");}}return $this->respond(['status'=>'complete','processed_titles'=>$processedTitles]);}public function generateDailyContentDigest(){@ini_set('memory_limit','768M');$records=$this->marketingModel->getValidUnprocessedEmails(5);$insertedSummaries=[];foreach($records as $record){if(!is_array($record)){log_message('error','âŒ Invalid record structure: Expected array, got '.gettype($record));continue;}try{log_message('debug','ðŸ” Processing record ID '.$record['id']);$result=$this->getMyMIMarketing()->generateContentAndInsert($record);if($result){$this->marketingModel->markTempScraperProcessed($record['id']);$insertedSummaries[]=$result['title']?? '(no title)';log_message('info',"âœ… Successfully processed and inserted record ID {$record['id']}");}else{log_message('warning',"âš ï¸ Skipped or failed to insert record ID {$record['id']}");}}catch(\Throwable $e){log_message('error',"âŒ Exception on record ID {$record['id']}: ".$e->getMessage());}}return $this->respond(['status'=>'success','inserted'=>$insertedSummaries]);}public function generatePostsFromSummary($summaryId=null){try{$summary=$this->marketingModel->find($summaryId);if(!$summary){return $this->failNotFound('Summary not found.');}$decodedTitleRaw=$summary['title']?? '';$decodedSummaryRaw=$summary['summary']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$decodedSummary=quoted_printable_decode($decodedSummaryRaw);$decodedSummary=preg_replace('/=\r?\n/','',$decodedSummary);$decodedSummary=html_entity_decode($decodedSummary,ENT_QUOTES|ENT_HTML5,'UTF-8');$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$decodedTitle);$cleanedSummary=html_entity_decode(strip_tags($decodedSummary));$keywords=$this->MyMIMarketing->extractKeywords($cleanedSummary);$posts=$this->MyMIMarketing->generateSocialPosts($cleanedSummary,$keywords);$this->marketingModel->update($summaryId,['keywords'=>json_encode($keywords),'posts'=>json_encode($posts),]);return $this->respond(['status'=>'success','message'=>'Content generated and stored successfully.','original'=>$summary,'cleaned'=>['title'=>$cleanTitle,'summary'=>$cleanedSummary,'keywords'=>$keywords,'posts'=>$posts,],]);}catch(\Throwable $e){log_message('error','âŒ generatePostsFromSummary() failed: '.$e->getMessage());return $this->failServerError('Error generating posts.');}}public function generateScheduledPosts(){helper('text');$marketingModel=new MarketingModel();$marketing=new MyMIMarketing();$buffer=$marketingModel->getTopBufferPosts(3,6.5);if(empty($buffer)){return $this->respond(['status'=>'empty','message'=>'No queued posts available.']);}foreach($buffer as $post){$marketingModel->updateBufferItem($post['id'],['status'=>'promoted']);$generated=$marketing->generateSocialPost($post);if(json_decode($post['platforms'])->discord ?? false){$marketing->distributeContent('discord',$generated['discord']);}if(json_decode($post['platforms'])->linkedin ?? false){$marketing->distributeContent('linkedin',$generated['linkedin']);}$marketing->notifyModerators($post);}return $this->respond(['status'=>'success','message'=>'Posts published!']);}public function generateVoiceScriptManually(){try{log_message('info','ðŸŽ¤ generateVoiceScriptManually() triggered.');$script=$this->getMyMIMarketing()->generateVoiceoverScript();return $this->response->setJSON(['status'=>'success','script'=>$script]);}catch(\Throwable $e){log_message('error','âŒ Error in generateVoiceScriptManually: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()]);}}public function massResendActivationEmails(){$userModel=new \App\Models\UserModel();$users=$userModel->getPendingActivationUsers();$activator=service('activator');$success=0;$failure=0;foreach($users as $user){if($activator->send($user)){$success++;}else{$failure++;}}return $this->respond(['status'=>'success','message'=>"$success emails sent, $failure failed."]);}public function monitorKeywordsAndScrape(){log_message('info','ðŸ§  Keyword Monitor Started');$keywords=$this->getMyMIMarketing()->getKeywordCandidates();if(empty($keywords)){return $this->respond(['status'=>'no_keywords']);}$results=[];foreach($keywords as $keyword){try{$scrapedData=$this->getMyMIMarketing()->scrapeGoogleSearch($keyword);if(!empty($scrapedData)){$summary=$this->getMyMIMarketing()->generateContentFromScrapedData($scrapedData,'generic');if($summary){$score=$this->getMyMIMarketing()->scoreKeywordRelevance($keyword,$summary);$results[]=['keyword'=>$keyword,'summary'=>$summary,'score'=>$score];$this->marketingModel->storeFinalMarketingContent(['source_id'=>null,'title'=>"Keyword: $keyword",'summary'=>$summary,'keywords'=>$keyword,'score'=>$score,'created_at'=>date('Y-m-d H:i:s')]);}}}catch(\Throwable $e){log_message('error',"âŒ Failed keyword scrape for {$keyword}: ".$e->getMessage());}}return $this->respond(['status'=>'complete','processed'=>$results]);}public function processMarketingTempEmails($limit=5,$mode='daily',$id=null){try{log_message('debug',"ðŸ§  Running unified email processor with mode={$mode}, limit={$limit}, id={$id}");if($id){$record=$this->marketingModel->getEmailRecordById($id);if(!$record||empty($record['content'])){return $this->failNotFound("No valid temp email record found for ID {$id}");}$cleanText=strip_tags($record['content']);$summary=$this->getMyMIMarketing()->summarizeText($cleanText);$keywords=$this->getMyMIMarketing()->extractKeywords($cleanText);if(empty($summary)||empty($keywords)){return $this->fail("Failed to generate summary or keywords for record ID {$id}");}$testPosts=['discord'=>"ðŸ’¬ *{$record['title']}*: {$summary} #".implode(' #',$keywords),'linkedin'=>"ðŸ“¢ {$record['title']} â€” {$summary}",'email'=>"Subject: {$record['title']}\n\n{$summary}",'x'=>substr($summary,0,250).'...'];$generated=['summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts];$this->marketingModel->insertFinalScraper($record,$generated);$this->marketingModel->markTempScraperProcessed($id);return $this->respond(['status'=>'success','message'=>"âœ… Test record stored for ID {$id}",'summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts]);}$records=($mode==='backfill')?$this->marketingModel->getOlderUnprocessedEmails($limit):$this->marketingModel->getValidUnprocessedEmails($limit);$results=[];foreach($records as $record){$recordId=$record['id']?? 0;if(empty($record['title'])){$record['title']="Fallback Title - ID {$recordId}";}try{$insert=$this->getMyMIMarketing()->generateContentAndInsert($record);if($insert){$this->marketingModel->markTempScraperProcessed($recordId);log_message('info',"âœ… Inserted record ID {$recordId}");$results[]=$insert['title'];}else{log_message('warning',"âš ï¸ Skipped ID {$recordId} â€” No summary generated.");}}catch(\Throwable $e){log_message('error',"âŒ Exception on ID {$recordId}: ".$e->getMessage());}}return $this->respond(['status'=>'success','mode'=>$mode,'inserted'=>$results]);}catch(\Throwable $e){return $this->failServerError("ðŸ”¥ Unified content processor failed: ".$e->getMessage());}}public function rankBufferPostsDaily(){$marketingModel=new MarketingModel();$marketing=new MyMIMarketing();$threshold=getenv('MARKETING_TFIDF_THRESHOLD')?:7.5;$pendingPosts=$marketingModel->getPendingBufferItems();foreach($pendingPosts as $post){$scoreData=$marketing->getTopKeywordScores(['summary'=>$post['summary'],]);$update=['score'=>$scoreData['score']?? 0,'tag_score'=>$scoreData['tag_score']?? 0,'tfidf_score'=>$scoreData['tfidf_score']?? 0,'auto_suggest'=>($scoreData['tfidf_score']?? 0)>=$threshold?1:0,];$marketingModel->updateBufferItem($post['id'],$update);}return $this->respond(['status'=>'success','message'=>'Buffer ranks updated.']);}public function rejectBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Record not found.");$this->marketingModel->updateBufferItem($id,['status'=>'rejected']);return $this->respond(['status'=>'success','message'=>'Content rejected.']);}public function runBackfillForTempEmails(){try{log_message('info','[ðŸ”„ Backfill] Starting backfill for unprocessed temp emails...');$unprocessedRecords=$this->marketingModel->where('status',null)->orWhere('status','')->findAll(25);if(empty($unprocessedRecords)){return $this->respond(['status'=>'complete','message'=>'No unprocessed records found.']);}$processedTitles=[];foreach($unprocessedRecords as $record){try{$result=$this->MyMIMarketing->generateContentAndInsert($record);if($result){$this->marketingModel->markTempScraperProcessed($record['id']);$processedTitles[]=$result['title'];}}catch(\Throwable $e){log_message('error','[âŒ Backfill Error] ID '.$record['id'].' â€” '.$e->getMessage());}}return $this->respond(['status'=>'success','processed'=>$processedTitles]);}catch(\Throwable $e){return $this->failServerError('[ðŸ”¥ Backfill Failure] '.$e->getMessage());}}public function testGenerateFromTempEmail($id){try{helper('text');$record=$this->marketingModel->getEmailRecordById($id);if(!$record||empty($record['content'])){return $this->failNotFound("No valid temp email record found for ID {$id}");}log_message('info',"ðŸ§ª Starting test content generation for temp record ID: {$id}");$cleanText=strip_tags($record['content']);$summary=$this->getMyMIMarketing()->summarizeText($cleanText);$summary=quoted_printable_decode($summary);$summary=mb_convert_encoding($summary,'UTF-8','UTF-8');$keywords=$this->getMyMIMarketing()->extractKeywords($cleanText);if(empty($summary)||empty($keywords)){return $this->fail("Failed to generate summary or keywords for record ID {$id}");}$decodedTitleRaw=$record['title']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$decodedTitle);$testPosts=['discord'=>"ðŸ’¬ *{$cleanTitle}*: {$summary} #".implode(' #',$keywords),'linkedin'=>"ðŸ“¢ {$cleanTitle} â€” {$summary}",'email'=>"Subject: {$cleanTitle}\n\n{$summary}",'x'=>substr($summary,0,250).'...',];$generated=['summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts];$this->marketingModel->insertFinalScraper($record,$generated);$this->marketingModel->markTempScraperProcessed($id);log_message('info',"âœ… Test record stored in bf_marketing_scraper for temp ID {$id}");return $this->respond(['status'=>'success','message'=>"Content generated and stored successfully.",'summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts]);}catch(\Throwable $e){log_message('critical',"âŒ testGenerateFromTempEmail({$id}) failed: ".$e->getMessage());return $this->failServerError("An error occurred: ".$e->getMessage());}}public function testTfIdfEdgeCases(){$cases=['Empty String'=>'','Whitespace Only'=>'     ','Single Word'=>'Bitcoin','HTML Only'=>'<div><p></p></div>','Malformed UTF-8'=>"\xB1\x31",'Link-Only Spam'=>'http://marketwatch.com https://example.com','Token Noise'=>str_repeat('$$$!!!@@@###',10),];$results=[];foreach($cases as $label=>$input){try{log_message('info',"ðŸ§ª Running TF-IDF Test Case: $label");$cleanInput=is_string($input)?strip_tags(trim($input)):'';if(strlen($cleanInput)<10||substr_count($cleanInput,' ')<2){log_message('debug',"âš ï¸ Skipping test: $label â€” input too short or lacks structure.");$results[$label]='[Skipped â€” Too short or unstructured]';continue;}$summary=$this->MyMIMarketing->summarizeText($cleanInput);log_message('debug',"Result - Summary: $summary");$results[$label]=$summary;}catch(\Throwable $e){log_message('error',"âŒ $label threw error: ".$e->getMessage());$results[$label]='[Error: '.$e->getMessage().']';}}return $this->renderTheme('App\Modules\Management\Views\Marketing\debugTfIdfResults',['results'=>$results,]);}public function triggerPostAutogenOnEmpty(){try{$existingPosts=$this->marketingModel->where('DATE(scraped_at)',date('Y-m-d'))->countAllResults();if($existingPosts===0){log_message('debug','[ðŸª„ AutoGen Trigger] No posts found for today. Running fallback generatorâ€¦');$this->marketingService->generatePostsFromTodaysSummaries();return $this->respond(['status'=>'success','message'=>'No posts found. Generated fresh content.']);}else{return $this->respond(['status'=>'success','message'=>'Posts already exist for today. No action taken.']);}}catch(\Throwable $e){log_message('error','[âŒ AutoGen Trigger Error] '.$e->getMessage());return $this->respond(['status'=>'error','message'=>'Failed to trigger autogen.','error'=>$e->getMessage()]);}}public function updateBufferScheduleInterval($id){$data=$this->request->getJSON(true);$interval=(int)($data['interval']?? 0);$updated=$this->marketingModel->updateBufferItem($id,['schedule_interval'=>$interval,'scheduled_at'=>null ]);if($updated){return $this->respond(['status'=>'success']);}else{return $this->fail('Failed to update interval.');}}public function updatePlatformToggle($id){$data=$this->request->getJSON(true);$platform=$data['platform'];$enabled=$data['enabled'];$record=$this->marketingModel->find($id);if(!$record){return $this->failNotFound("Record not found.");}$platforms=json_decode($record['platforms']?? '{}',true);$platforms[$platform]=$enabled;$this->marketingModel->update($id,['platforms'=>json_encode($platforms)]);return $this->respond(['status'=>'success']);}} ?><?php namespace App\Libraries;use App\Config\{SiteSettings,SocialMedia};use App\Libraries\{BaseLoader,MyMIInvestments};use App\Libraries\Traits\TextProcessor;use App\Models\{AnalyticalModel,MarketingModel};use App\Services\{EmailService,MarketingService,SolanaService};use CodeIgniter\HTTP\RequestInterface;use CodeIgniter\Session\Session;use Myth\Auth\Authorization\GroupModel;use Exception;use HTMLPurifier;use HTMLPurifier_Config;use Phpml\FeatureExtraction\TokenCountVectorizer;use Phpml\Tokenization\WhitespaceTokenizer;use Phpml\FeatureExtraction\TfIdfTransformer;use NlpTools\Tokenizers\WhitespaceTokenizer as NlpWhitespaceTokenizer;use NlpTools\Similarity\CosineSimilarity;use Facebook\Facebook;use Abraham\TwitterOAuth\TwitterOAuth;use Happyr\LinkedIn\LinkedIn;use Discord\Discord;use Discord\Parts\Channel\Message;use GuzzleHttp\Client;use Scrapemax\ScrapemaxClient;use Pscrape\Pscrape\Scrape as PscrapeScraper;use Symfony\Component\DomCrawler\Crawler;use Google\Cloud\TextToSpeech\V1\TextToSpeechClient;use Google\Cloud\TextToSpeech\V1\SynthesisInput;use Google\Cloud\TextToSpeech\V1\VoiceSelectionParams;use Google\Cloud\TextToSpeech\V1\AudioConfig;use Google\Cloud\TextToSpeech\V1\AudioEncoding;class MyMIMarketing{use BaseLoader;use TextProcessor;protected $auth;protected $cuID;protected $data;protected $debug;protected $logger;protected $request;protected $session;protected $uri;protected $APIs;protected $emailService;protected $solanaService;protected $siteSettings;protected $marketingModel;protected $analyticalModel;protected $socialMedia;protected $facebook;protected $twitter;protected $linkedin;protected $discord;protected $scrapemax;protected $pscrape;public function __construct(){$this->auth=service('authentication');$this->logger=service('logger');$this->request=service('request');$this->session=service('session');$this->uri=$this->request->getUri();$this->APIs=config('APIs');$this->socialMedia=config('SocialMedia');$this->siteSettings=config('SiteSettings');$this->debug=$this->siteSettings->debug;$this->socialMedia=config('SocialMedia');$this->marketingModel=new MarketingModel();$this->analyticalModel=new AnalyticalModel();$this->emailService=service('email');$this->solanaService=new SolanaService();$this->scrapemax=new ScrapemaxClient('https://api.scrapemax.com',$this->APIs->scrapemax_api_key);$this->pscrape=new PscrapeScraper();}public function marketing(){$department=$this->department();$links=$this->social_media();return['links'=>$links,'department'=>$department];}public function distributeTradeAlert($alert,$action='BUY'){$message=$this->generateTradeAlertMessage($alert,$action);$this->postToDiscord($message);$this->postToTwitter($message);$this->postToFacebook($message);$this->postToLinkedIn($message);}public function generateRandomMarketingContent(array $tradeAlert):array{$intros=["ðŸš¨ Breaking Market Update!","ðŸ“¢ Urgent Trade Alert!","ðŸ”¥ High-Momentum Stock Pick!","ðŸš€ Skyrocketing Stocks!","ðŸ’° Smart Money Moves!","âš¡ Quick Market Insight!","ðŸ“ˆ Bullish Breakout Alert!","ðŸ“Š Technical Setup Unfolding!","ðŸ§ Deep Market Analysis!","ðŸ’¡ Pro-Level Trading Insight!"];$emoticons=['ðŸš€','ðŸ”¥','ðŸ’°','ðŸ“ˆ','ðŸ“Š','âš¡','âœ…','ðŸ¤–','ðŸŽ¯','ðŸ”'];$outros=["ðŸ“Š Stay ahead of the markets!","â³ Don't miss this setup!","ðŸ’° Trade smart & maximize gains!","ðŸš€ Follow for more trade alerts!","ðŸ“ˆ Watch this ticker closely!","ðŸ”¥ This could be the next big mover!","ðŸ’¡ Insights that matter. Stay tuned!","ðŸ’Ž Precision trading at its best!","âš¡ More insights coming soon!","ðŸ“¢ Tap in for more premium setups!"];$intro=$intros[array_rand($intros)];$outro=$outros[array_rand($outros)];$emote1=$emoticons[array_rand($emoticons)];$emote2=$emoticons[array_rand($emoticons)];$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$tradeDesc=trim($tradeAlert['trade_description']?? '');$news=trim($tradeAlert['financial_news']?? '');$details=trim($tradeAlert['details']?? '');$price=number_format($tradeAlert['price']?? 0,2);$link=trim($tradeAlert['tv_chart']?? $tradeAlert['tv_chart_link']?? '');$chartText=(!empty($link))?"ðŸ“‰ Chart: [View Here]({$link})\n":'';$fixedLength=strlen($intro)+strlen($outro)+strlen($emote1)+strlen($emote2)+strlen($chartText)+12;$maxMessageLength=2000-$fixedLength;$coreMessage="Trade Alert for **{$ticker}** ({$company}):\n"."Price: \${$price}\n"."Signal: {$tradeDesc}\n"."News: {$news}\n"."Details: {$details}\n".$chartText;if(strlen($coreMessage)>$maxMessageLength){$coreMessage=substr($coreMessage,0,$maxMessageLength-3)."...";}$finalMessage="{$emote1} {$intro}\n{$coreMessage}\n{$outro} {$emote2}";return['twitter'=>substr($finalMessage,0,280),'facebook'=>substr($finalMessage,0,2000),'linkedin'=>substr($finalMessage,0,2000),'discord'=>substr($finalMessage,0,2000)];}public function generateEmailContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$news=$tradeAlert['financial_news']?? '';$details=$tradeAlert['details']?? '';$content="Email Alert for {$ticker} ({$company}):\n"."Current Price: \${$price}\n"."Trade Signal: {$tradeDesc}\n"."Latest News: {$news}\n"."Analysis Details: {$details}\n"."For more information, visit our website.";return $content;}public function generateBlogContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$news=$tradeAlert['financial_news']?? '';$details=$tradeAlert['details']?? '';$content="Blog Post: In-depth Market Analysis on {$ticker} ({$company})\n\n"."Current Price: \${$price}\n\n"."Trade Analysis: {$tradeDesc}\n\n"."Financial News: {$news}\n\n"."Detailed Analysis: {$details}\n\n"."Stay tuned for more insights!";return $content;}public function generateVoiceoverScriptContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$script="Voiceover Script:\n"."Welcome to today's market update. Our focus is on {$ticker} from {$company}.\n"."The current trading price is \${$price}.\n"."Trade insight: {$tradeDesc}.\n"."Thank you for watching. Stay tuned for more updates.";return $script;}public function generateTradeAlertEmailContent(array $tradeAlert):string{$defaultTemplate=<<<S
app/Modules/chatgpt.txt:44:S;}public function formatSocialPost(string $headline,string $summary,string $platform='generic'):string{$hashtags='#MyMIWallet #InvestSmarter #FinancialFreedom';switch($platform){case 'facebook':case 'linkedin':return"{$headline}\n\n{$summary}\n\nStart your journey: https://www.mymiwallet.com\n\n{$hashtags}";case 'twitter':case 'x':$shortSummary=substr($summary,0,180);return"{$headline} â€” {$shortSummary}...\nhttps://www.mymiwallet.com\n{$hashtags}";default:return"{$headline}\n\n{$summary}\nhttps://www.mymiwallet.com";}}public function formatDiscordPost(string $headline,string $summary):string{return"**{$headline}**\n\n{$summary}\n\nðŸ‘‰ <https://www.mymiwallet.com>";}private function normalizeUtf8($text){return mb_convert_encoding($text,'UTF-8',mb_detect_encoding($text,'UTF-8, ISO-8859-1',true));}private function notifyAdminOnError($subject,$message){$this->emailService->setFrom('no-reply@mymiwallet.com','MyMI Wallet');$this->emailService->setTo('team@mymiwallet.com');$this->emailService->setSubject($subject);$this->emailService->setMessage($message);if(!$this->emailService->send()){$this->logger->error('Failed to send error notification email: '.print_r($this->emailService->printDebugger(),true));}}public function notifyModerators(array $post){$platforms=json_decode($post['platforms']?? '{}',true);$used=implode(', ',array_keys(array_filter($platforms)));$subject="ðŸ“¢ Buffer Post Promoted: {$post['keyword']}";$message="âœ… Post ID: {$post['id']}\n\n"."Summary: ".wordwrap($post['summary'],80)."\n\n"."Promoted Platforms: {$used}\n\n".site_url('Marketing/PreviewGeneratedPost/'.$post['id']);$email=\Config\Services::email();$email->setTo('moderators@mymiwallet.com');$email->setSubject($subject);$email->setMessage($message);$email->send();log_message('info',"ðŸ“¬ Sent moderator alert for Buffer ID {$post['id']}");}public function reprocessIncompleteEmails(){$incompleteRecords=$this->marketingModel->getEmailsMissingTitleOrUrl(20);log_message('debug','ðŸ“‹ MyMIMarketing L986 - Incomplete records fetched: '.count($incompleteRecords));foreach($incompleteRecords as $record){try{$emailId=$record['message_id']?? null;$content=$record['content']?? '';$title=$record['title']?? '';$url=$record['url']?? '';if(!$emailId)continue;$email=$this->fetchEmailByMessageId($emailId);if($email){$content=$email['body']?? $content;$title=$email['subject']?? $title;$url=$email['link']?? $url;}$title=$title?:'Untitled Email - '.date('Y-m-d H:i');$url=$url?:'https://mymiwallet.com/news/fallback';$this->marketingModel->updateEmailFields($record['id'],$title,$url,$content);}catch(\Throwable $e){log_message('error','âŒ Error backfilling email ID '.$record['id'].': '.$e->getMessage());}}}private function retry($function,$attempts=3,$delay=2000){$attempt=0;while($attempt<$attempts){try{return $function();}catch(Exception $e){$attempt++;if($attempt>=$attempts){throw $e;}sleep($delay/1000);}}}private function sanitizeContent($content){$content=preg_replace('#<script(.*?)>(.*?)</script>#is','',$content);$content=preg_replace('#<noscript(.*?)>(.*?)</noscript>#is','',$content);$content=strip_tags($content)?? '';$content=preg_replace('/\.\s*/','. ',$content);return $content;}public function sanitizeRawEmailContent(string $rawContent):string{log_message('debug','ðŸ§ª MyMIMarketing L1140 - Raw Email Before Cleaning: {raw}',['raw'=>$rawContent]);$clean=preg_replace("/=\r\n|\=\n/",'',$rawContent);$clean=quoted_printable_decode($clean);$clean=html_entity_decode($clean,ENT_QUOTES|ENT_HTML5,'UTF-8');$clean=strip_tags($clean);$clean=preg_replace('/\s+/',' ',$clean);$clean=mb_convert_encoding($clean,'UTF-8','UTF-8');log_message('debug','âœ… MyMIMarketing L1159 - Cleaned Email Output: {clean}',['clean'=>$clean]);return trim($clean);}private function sanitizeText(string $text):string{return strip_tags(html_entity_decode($text));}public function saveTradingViewChart($chartUrl,$ticker){$saveDir=FCPATH.'assets/images/Alerts/Charts/';if(!is_dir($saveDir)){mkdir($saveDir,0777,true);}$timestamp=time();$filename="{$ticker}_chart_{$timestamp}.jpg";$savePath=$saveDir.$filename;$ch=curl_init($chartUrl);$fp=fopen($savePath,'wb');curl_setopt($ch,CURLOPT_FILE,$fp);curl_setopt($ch,CURLOPT_HEADER,0);curl_exec($ch);curl_close($ch);fclose($fp);if(file_exists($savePath)){return $filename;}else{return null;}}public function scoreKeywordRelevance(string $keyword,string $summary):int{$keyword=strtolower($keyword);$summaryText=strtolower(strip_tags($summary));$totalWords=str_word_count($summaryText);if($totalWords===0)return 0;$matches=substr_count($summaryText,$keyword);$score=min(100,round(($matches/$totalWords)*500));return $score;}public function scrapeTokenContent($tokenInfo){$scrapedData=[];foreach($tokenInfo as $token){if(!empty($token['website'])){log_message('debug','MyMIMarketing L101 - $token[website]: '.$token['website']);$websiteData=$this->scrapeWebsite($token['website']);log_message('debug','MyMIMarketing L103 - $websiteData: '.print_r($websiteData,true));$this->storeTemporaryData($websiteData);$scrapedData[]=$websiteData;}if(!empty($token['facebook'])){log_message('debug','MyMIMarketing L109 - $token[facebook]: '.$token['facebook']);$facebookData=$this->scrapeFacebook($token['facebook']);log_message('debug','MyMIMarketing L111 - $facebookData: '.print_r($facebookData,true));$this->storeTemporaryData($facebookData);$scrapedData[]=$facebookData;}if(!empty($token['twitter'])){log_message('debug','MyMIMarketing L117 - $token[twitter]: '.$token['twitter']);$twitterData=$this->scrapeTwitter($token['twitter']);log_message('debug','MyMIMarketing L119 - $twitterData: '.print_r($twitterData,true));$this->storeTemporaryData($twitterData);$scrapedData[]=$twitterData;}log_message('debug','MyMIMarketing L117 - $token[symbol] $token[name]: '.$token['symbol'].' '.$token['coin_name']);$googleData=$this->scrapeGoogleSearch($token['symbol'].' '.$token['coin_name']);$this->storeTemporaryData($googleData);$scrapedData[]=$googleData;}return $scrapedData;}public function scrapeAndGenerateContent($accountid,$category,$platform=null){$generatedData=[];if($category==='Solana'){$this->solanaModel=new SolanaModel();$tokenInfo=$this->solanaModel->getTokenInfoByID($accountid);}else{$tokenInfo=[];}if(!empty($tokenInfo)){$scrapedData=[];try{log_message('debug','Attempting to scrape token content.');$scrapedData=$this->scrapeTokenContent($tokenInfo);log_message('debug','Scraped Data: '.print_r($scrapedData,true));}catch(\GuzzleHttp\Exception\ClientException $e){if($e->getResponse()->getStatusCode()==403){log_message('critical','403 Forbidden encountered while scraping website: '.$e->getMessage());}else{log_message('critical','ClientException: '.$e->getMessage());}}catch(\Exception $e){log_message('critical','An error occurred while scraping token content: '.$e->getMessage());}try{if(!empty($scrapedData)){log_message('debug','Attempting to generate content from scraped data.');$generatedData=$this->generateContentFromScrapedData($scrapedData,$platform);log_message('debug','Generated Data: '.print_r($generatedData,true));}else{log_message('debug','Scraped data is empty.');}}catch(\Exception $e){log_message('critical','An error occurred while generating content: '.$e->getMessage());}}else{log_message('debug','Token information is empty.');}return $generatedData;}private function scrapeWebsite($url){try{$client=new Client();$response=$client->get($url);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$crawler=new \Symfony\Component\DomCrawler\Crawler($html);return['title'=>$crawler->filter('title')->text(),'content'=>$this->sanitizeContent($crawler->filter('body')->html()),];}}catch(RequestException $e){$this->logger->error('Error scraping website: '.$e->getMessage());}return[];}private function scrapeFacebook($url){return $this->scrapeWithRetries('facebook',$url,function($content){return['title'=>$content['page_title']?? 'No title','content'=>$this->sanitizeContent($content['posts']?? 'No posts'),];});}private function scrapeTwitter($url){return $this->scrapeWithRetries('twitter',$url,function($content){return['title'=>$content['profile']?? 'No title','content'=>$this->sanitizeContent($content['tweets']?? 'No tweets'),];});}private function scrapeWithRetries($type,$url,$transform,$retries=3){$backoff=1;for($i=0;$i<$retries;$i++){try{$response=$this->scrapemax->scrape(['target_url'=>$url,'type'=>'data','js_enabled'=>1,'base64_encoded'=>0]);$content=json_decode($response->getBody()->getContents(),true);if(empty($content)){throw new \Exception("No content returned");}return $transform($content);}catch(ServerException $e){if($i<$retries-1){sleep($backoff);$backoff*=2;continue;}$this->logger->error("Error scraping $type: ".$e->getMessage());}catch(RequestException $e){$this->logger->error("Error scraping $type: ".$e->getMessage());break;}catch(\Exception $e){$this->logger->error("General error scraping $type: ".$e->getMessage());break;}}return['title'=>'No title','content'=>'No content'];}private function scrapeGoogleSearch($query){try{$results=$this->pscrape->rollingCurl('rollingCurl');$results->request('https://www.google.com/search?q='.urlencode($query));$content='';$resultsData=$results->execute();if(!is_array($resultsData)){throw new \Exception("Google search did not return an array");}foreach($resultsData as $result){$content.=$result['title'].' '.$result['link'].' ';}return['title'=>'Google Search Results for '.$query,'content'=>$this->sanitizeContent($content),];}catch(\Exception $e){$this->logger->error('Error scraping Google Search: '.$e->getMessage());}return[];}public function sendZapierTradeAlert($tradeAlert){$zapierWebhookUrl="YOUR_ZAPIER_WEBHOOK_URL";$payload=json_encode(['ticker'=>$tradeAlert['ticker'],'price'=>$tradeAlert['price'],'sentiment'=>$tradeAlert['market_sentiment'],'chart_link'=>$tradeAlert['link'],'created_on'=>$tradeAlert['created_on']]);$ch=curl_init($zapierWebhookUrl);curl_setopt($ch,CURLOPT_HTTPHEADER,['Content-Type: application/json']);curl_setopt($ch,CURLOPT_POST,1);curl_setopt($ch,CURLOPT_POSTFIELDS,$payload);curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);$response=curl_exec($ch);curl_close($ch);return $response;}public function standaloneScrapeWebsite($url){try{$client=new Client();$response=$client->get($url);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$crawler=new Crawler($html);$content=$crawler->filter('body')->each(function($node){return $node->text();});$content=array_filter($content,function($text){return!str_contains($text,'footer')&&!str_contains($text,'head');});$data=['url'=>$url,'content'=>implode(' ',$content),'scraped_at'=>date('Y-m-d H:i:s')];$this->saveTemporaryScrapedData($data);return $data;}else{log_message('error','Failed to scrape website. HTTP status code: '.$response->getStatusCode());}}catch(RequestException $e){log_message('error','RequestException while scraping website: '.$e->getMessage());}catch(\Throwable $th){log_message('error','Throwable error while scraping website: '.$th->getMessage());}return false;}public function saveTemporaryScrapedData($data){$marketingModel=new \App\Models\MarketingModel();return $this->marketingModel->insertTemporaryData($data);}private function storeTemporaryData($data){if(!empty($data)){$this->marketingModel->insertTemporaryData($data);}else{$this->logger->warning('Attempted to store empty data.');}}private function selectSummarySentences($sentences,$scores,$topN=5){arsort($scores,SORT_NUMERIC);$topSentenceIndexes=array_keys(array_slice($scores,0,$topN,true));$summary=array_intersect_key($sentences,array_flip($topSentenceIndexes));usort($summary,function($a,$b)use($sentences){return array_search($a,$sentences)-array_search($b,$sentences);});return $summary;}private function splitIntoSentences($content){$content=preg_replace('/\s+/',' ',trim($content));$sentences=preg_split('/(?<=[.!?])\s+/',$content,-1,PREG_SPLIT_NO_EMPTY);return array_filter($sentences,function($sentence){return strlen(trim($sentence))>0;});}public function summarize($text,$method='textrank',$charLimit=500){$text=$this->cleanText($text);if($method==='tfidf'){return $this->summarizeText($text);}else{return $this->summarizeContent($text,$charLimit);}}public function summarizeContent($content,$charLimit=500){if(empty(trim($content))){$this->logger->error('$content is Empty for summarizeContent() function');return[];}$sentences=$this->splitIntoSentences($content);if(empty($sentences)){log_message('warning','âš ï¸ MyMIMarketing L1306 - summarizeContent(): No valid sentences found in content.');return null;}if(empty($sentences)){$this->logger->error('No sentences found for summarization');return[];}$tokens=$this->tokenizeWithNlpTools($content);$features=$this->extractFeaturesWithPhpMl($content);$wordFrequencies=$this->calculateWordFrequencies($content,$this->getStopWords());$similarityMatrix=$this->buildSimilarityMatrix($sentences,$wordFrequencies);$scores=$this->pageRank($similarityMatrix);$summary=$this->buildSummaryToCharLimit($sentences,$scores,$charLimit);$finalSummary=$this->convertUrlsToLinks($summary);return!empty($finalSummary)?['sentences'=>$sentences,'tokens'=>$tokens,'features'=>$features,'wordFrequencies'=>$wordFrequencies,'similarityMatrix'=>$similarityMatrix,'scores'=>$scores,'summary'=>$finalSummary,]:$summary;}public function summarizeContentFromHtml(string $html,$recordId=null):array{$html=quoted_printable_decode($html);$html=html_entity_decode($html,ENT_QUOTES|ENT_HTML5,'UTF-8');$html=preg_replace('/=\r?\n/','',$html);$plainText=strip_tags(html_entity_decode($html));$cleaned=$this->sanitizeRawEmailContent($plainText);if(strlen($cleaned)<300||substr_count($cleaned,' ')<20){$logSuffix=$recordId?" (ID: $recordId)":'';log_message('info',"[MyMIMarketing] summarizeContentFromHtml(): Skipping â€” content too short or lacks structure{$logSuffix}");return['summary'=>'','keywords'=>[]];}$cleaned=preg_replace('/\s{2,}/',' ',$cleaned);$summaryData=$this->summarizeContent($cleaned);if(!is_array($summaryData)||empty($summaryData['summary'])){return['summary'=>'','keywords'=>[]];}$keywords=$this->marketingModel->extractKeywords($cleaned);return['summary'=>$summaryData['summary'],'keywords'=>$keywords ??[],'featureScore'=>$summaryData['featureScore']?? null,'keywordScore'=>$summaryData['keywordScore']?? null,'pageRankScore'=>$summaryData['pageRankScore']?? null,'semanticDiversityScore'=>$summaryData['semanticDiversityScore']?? null,];}public function summarizeContentTextRank($content){$sentences=$this->splitIntoSentences($content);$similarityMatrix=$this->buildSimilarityMatrix($sentences);$scores=$this->pageRank($similarityMatrix);return $this->extractTopSentences($sentences,$scores);}public function summarizeText($text,$maxSentences=5){if(!is_string($text)||empty(trim($text))){log_message('error','summarizeText(): Empty or invalid input text provided.');return 'Summary not available.';}$sentences=$this->splitIntoSentences($text);if(empty($sentences)||count($sentences)<2){log_message('warning','summarizeText(): Not enough content to summarize.');return implode(' ',$sentences);}$vectorizer=new TokenCountVectorizer(new WhitespaceTokenizer());$vectorizer->fit($sentences);$vectorizer->transform($sentences);$tfidf=new TfIdfTransformer();try{$tfidf->fit($sentences);$tfidf->transform($sentences);}catch(\Throwable $e){log_message('error','summarizeText(): TF-IDF transform failed â€” '.$e->getMessage());return 'Summary unavailable due to processing error.';}$scores=[];foreach($sentences as $i=>$vector){$score=0;foreach($vector as $value){$score+=(float)$value;}$scores[$i]=$score;}arsort($scores);$topIndexes=array_slice(array_keys($scores),0,$maxSentences);sort($topIndexes);$originalSentences=$this->splitIntoSentences($text);$summary=implode(' ',array_map(fn($i)=>$originalSentences[$i],$topIndexes));return $summary;}private function tokenizeSmart($text,$method='nlp'){return $method==='nlp'?$this->tokenizeWithNlpTools($text):$this->tokenizeText($text);}private function tokenizeText($text){$text=strtolower(strip_tags($text));return preg_split('/\W+/',$text,-1,PREG_SPLIT_NO_EMPTY);}public function tokenizeWithNlpTools($content){$tokenizer=new NlpWhitespaceTokenizer();$tokens=$tokenizer->tokenize($content);$this->logger->debug('Tokens: '.print_r($tokens,true));return $tokens;}public function insertFinalScraper($record,$summary){$model=new MarketingModel();if(!isset($record['id'])||!$summary){log_message('error','âŒ Missing record ID or summary when calling insertFinalScraper()');return false;}$existing=$model->where('source_id',$record['id'])->first();if($existing){log_message('info',"âš ï¸ Final scrape already exists for source_id: {$record['id']}");return false;}$cleanSummary=mb_convert_encoding($summary['summary'],'UTF-8','UTF-8');$cleanTitle=isset($record['title'])?$record['title']:word_limiter($cleanSummary,12);$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$cleanTitle);$data=['source_id'=>$record['id'],'title'=>trim($cleanTitle),'summary'=>trim($cleanSummary),'keywords'=>isset($summary['keywords'])?implode(',',$summary['keywords']):'','date_created'=>date('Y-m-d H:i:s'),];$result=$model->insert($data);if($result){log_message('info',"âœ… Final scraped content inserted for source_id: {$record['id']}");}else{log_message('error',"âŒ Failed to insert final scrape for source_id: {$record['id']}");}return $result;}private function cleanText($text){$text=$this->decodeSpecialCharacters($text);$text=$this->sanitizeRawEmailContent($text);return $this->normalizeUtf8(strip_tags($text));}private function combineScores($featureScore,$keywordScore,$pageRankScore,$semanticDiversityScore){$featureScore=is_numeric($featureScore)?(float)$featureScore:0.0;$keywordScore=is_numeric($keywordScore)?(float)$keywordScore:0.0;$pageRankScore=is_numeric($pageRankScore)?(float)$pageRankScore:0.0;$semanticDiversityScore=is_numeric($semanticDiversityScore)?(float)$semanticDiversityScore:0.0;$combinedScore=0.4*$featureScore+0.2*$keywordScore+0.3*$pageRankScore+0.1*$semanticDiversityScore;$this->logger->debug('âœ… Combined Score for sentence: '.$combinedScore);return $combinedScore;}private function buildSimilarityMatrix($sentences,$wordFrequencies){$matrix=[];$sentenceLength=count($sentences);for($i=0;$i<$sentenceLength;$i++){for($j=0;$j<$sentenceLength;$j++){if($i!=$j){$matrix[$i][$j]=$this->calculateSimilarity($sentences[$i],$sentences[$j],$wordFrequencies);}}}return $matrix;}private function calculateSimilarity($sentence1,$sentence2,$wordFrequencies){$sentence1=is_string($sentence1)?strtolower($sentence1):'';$sentence2=is_string($sentence2)?strtolower($sentence2):'';$words1=array_unique(str_word_count($sentence1,1));$words2=array_unique(str_word_count($sentence2,1));$commonWords=array_intersect($words1,$words2);$score=0;foreach($commonWords as $word){$score+=(float)($wordFrequencies[$word]?? 0);}$logWordCount1=count($words1)>0?log(count($words1)):0;$logWordCount2=count($words2)>0?log(count($words2)):0;if($logWordCount1+$logWordCount2==0){return 0;}return $score/($logWordCount1+$logWordCount2);}private function calculateWordFrequencies($content,$stopWords){$frequencies=[];$words=preg_split('/\s+/',strtolower($content));foreach($words as $word){if(!in_array($word,$stopWords)&&strlen($word)>1){$frequencies[$word]=($frequencies[$word]?? 0)+1;}}arsort($frequencies);return $frequencies;}public function decodeMimeHeaderSafe($string){try{return mb_decode_mimeheader($string);}catch(\Throwable $e){log_message('error','decodeMimeHeaderSafe() failed: '.$e->getMessage());return $string;}}private function decodeSpecialCharacters($text){return html_entity_decode($text,ENT_QUOTES|ENT_HTML5,'UTF-8');}public function getScrapesByKeyword($keyword){return $this->marketingModel->getScrapesByKeyword($keyword);}private function getStopWords(){return["a","the","and","of","in","to","is","you","that","it","he","was","for","on","are","as","with","his","they","I","at","be","this","have","from","or","one","had","by","word","but","not","what","all","were","we","when","your","can","said","there","use","an","each","which","she","do","how","their","if","will","up","other","about","out","many","then","them","these","so","some","her","would","make","like","him","into","time","has","look","two","more","write","go","see","number","no","way","could","people","my","than","first","water","been","call","who","oil","its","now","find","long","down","day","did","get","come","made","may","part"];}public function getTopKeywordScores($content,$max=10){if(!is_string($content)){log_message('error','MyMIMarketing L1706 - getTopKeywordScores(): Content must be a string');return[];}$content=$this->normalizeUtf8($content);$sentences=$this->splitIntoSentences($content);if(empty($sentences)){log_message('error','MyMIMarketing L1713 - getTopKeywordScores(): No valid sentences to process');return[];}$tfIdf=new TfIdfTransformer();$tokenized=array_values(array_filter(array_map(function($sentence){$cleaned=strtolower($this->normalizeUtf8(trim($sentence)));$tokens=array_filter(explode(' ',$cleaned),fn($w)=>strlen($w)>1);return count($tokens)>0?$tokens:null;},$sentences)));if(empty($tokenized)||!isset($tokenized[0])||!is_array($tokenized[0])||empty($tokenized[0])){log_message('error','âŒ MyMIMarketing L1725 - Tokenized input invalid for TF-IDF. Tokenized: '.json_encode($tokenized));return[];}try{$tfIdf->fit($tokenized);log_message('debug','ðŸ“Š MyMIMarketing L1731 - TF-IDF Document Preview: '.json_encode(array_slice($tokenized,0,1)));$tfIdf->transform($tokenized);}catch(\Throwable $e){log_message('error','âŒ MyMIMarketing L1734 - TF-IDF error: '.$e->getMessage());return[];}$scores=[];foreach($tokenized as $docIndex=>$tokens){foreach($tokens as $token){if(!is_string($token))continue;if(!isset($scores[$token])){$scores[$token]=0.0;}$scores[$token]+=1.0;}}if(empty($scores)){log_message('error','âŒ MyMIMarketing L1752 - No TF-IDF scores generated');return[];}arsort($scores);return array_keys(array_slice($scores,0,$max,true));}private function isSemanticallyDifferent($sentence1,$sentence2,$tokens){$tokens1=array_intersect($tokens,str_word_count(strtolower($sentence1),1));$tokens2=array_intersect($tokens,str_word_count(strtolower($sentence2),1));$overlap=count(array_intersect($tokens1,$tokens2));$threshold=2;return $overlap<$threshold;}private function pageRank($matrix,$dampingFactor=0.85,$maxIterations=100,$tolerance=1e-6){$numSentences=count($matrix);if($numSentences==0){return[];}$pagerank=array_fill(0,$numSentences,1/$numSentences);$tempRank=array_fill(0,$numSentences,0);for($iter=0;$iter<$maxIterations;$iter++){for($i=0;$i<$numSentences;$i++){$tempRank[$i]=(1-$dampingFactor)/$numSentences;for($j=0;$j<$numSentences;$j++){if($i!=$j&&isset($matrix[$j][$i])){$matrixRowSum=array_sum($matrix[$j]);if($matrixRowSum!=0){$tempRank[$i]+=$dampingFactor*($matrix[$j][$i]*$pagerank[$j]/$matrixRowSum);}}}}$diff=0;for($i=0;$i<$numSentences;$i++){$diff+=abs($tempRank[$i]-$pagerank[$i]);}if($diff<$tolerance){break;}$pagerank=$tempRank;}return $pagerank;}private function extractTopSentences($sentences,$scores,$topN=5){asort($scores,SORT_NUMERIC);$topSentenceIndexes=array_keys(array_slice($scores,-$topN,$topN,true));$summary=[];foreach($topSentenceIndexes as $index){$summary[]=trim($sentences[$index]);}return $summary;}public function enqueueEmailJob($emailData){$data=['type'=>'email_processing','data'=>json_encode($emailData)];$this->marketingModel->insertJobQueue($data);}private function stripHtmlTags($htmlContent){return strip_tags($htmlContent);}public function social_media(){return['discord'=>$this->socialMedia->discord,'facebook_page'=>$this->socialMedia->facebook_page,'facebook_group'=>$this->socialMedia->facebook_group,'linkedin'=>$this->socialMedia->linkedin,'twitter'=>$this->socialMedia->twitter,'youtube'=>$this->socialMedia->youtube,];}public function department(){$activeCampaigns=$this->marketingModel->getActiveCampaigns();$totalActiveCampaigns=$activeCampaigns['num_rows'];$activePriorityCampaigns=$this->marketingModel->getActivePriorityCampaigns();$totalActivePriorityCampaigns=$activePriorityCampaigns['num_rows'];return['getActiveCampaigns'=>$activeCampaigns['result'],'totalActiveCampaigns'=>$totalActiveCampaigns,'getActivePriorityCampaigns'=>$activePriorityCampaigns['result'],'totalActivePriorityCampaigns'=>$totalActivePriorityCampaigns,];}public function seoCheck(){$uri_string=$this->request->getUri()->getPath();$query=$this->marketingModel->where('url',$uri_string)->first();if(!$query){$data=['url'=>$uri_string,'title'=>str_replace(['_','/'],[' ',' - '],$uri_string),'description'=>"Experience the future of personal finance with MyMI Wallet. We provide advanced budgeting and investment portfolio management solutions, empowering individuals to better manage their finances. Streamline your financial journey with our intuitive online fintech application and service.",'image'=>base_url('/assets/images/Company/MyMI-Wallet-White.png'),];$this->marketingModel->insert($data);$insert_id=$this->marketingModel->getInsertID();$task_info=['task'=>'Page SEO Edit','title'=>str_replace(['_','/'],[' ',' - '],$uri_string),'seo_id'=>$insert_id,'url'=>$uri_string,];$this->assignMarketingTask($task_info);}}public function assignMarketingTask($task_info){$data=['status'=>'Pending','group'=>'Marketing','task'=>$task_info['task'],'title'=>$task_info['title'],'description'=>'Complete SEO for '.$task_info['url'],'url'=>site_url('/Management/Marketing/Page-SEO/'.$task_info['seo_id']),];$this->marketingModel->insertManagementTask($data);}public function autoDistributeHighRelevanceSummaries($minScore=75){$posts=$this->marketingModel->getRecentPosts(10);foreach($posts as $post){if(($post['score']?? 0)>=$minScore){$message="**{$post['title']}**\n\n".word_limiter(strip_tags($post['summary']),60);$this->sendToDiscordNotification($message);}}}public function autoSendToZapier($minScore=75){$posts=$this->marketingModel->getRecentPosts(10);foreach($posts as $post){if(($post['score']?? 0)>=$minScore){$this->sendToZapier('facebook',$post['summary']);}}}public function getPageHeaders(){$getPageSEO=$this->marketingModel->getMarketingPageSeo();$pageSEOData=[];foreach($getPageSEO as $pageSEO){$pageSEOData[]=['page_id'=>$pageSEO['id'],'page_name'=>$pageSEO['page_name'],'page_title'=>$pageSEO['page_title'],'page_url'=>$pageSEO['page_url'],'page_sitemap_url'=>$pageSEO['page_sitemap_url'],'page_internal_url'=>$pageSEO['page_internal_url'],'page_controller'=>$pageSEO['page_controller'],'page_controller_url'=>$pageSEO['page_controller_url'],'page_controller_directory'=>$pageSEO['page_controller_directory'],'page_file_directory'=>$pageSEO['page_file_directory'],'page_image'=>$pageSEO['page_image'],'page_description'=>$pageSEO['page_description'],'page_address'=>$pageSEO['page_address'],'page_city'=>$pageSEO['page_city'],'page_state'=>$pageSEO['page_state'],'page_country'=>$pageSEO['page_country'],'page_zipcode'=>$pageSEO['page_zipcode'],'page_facebook'=>$pageSEO['page_facebook'],'linked'=>$pageSEO['linked'],'functionality'=>$pageSEO['functionality'],'design'=>$pageSEO['design'],'seo'=>$pageSEO['seo'],'ext_links'=>$pageSEO['ext_links'],'grammar'=>$pageSEO['grammar'],'d_optimize'=>$pageSEO['d_optimize'],'load_perf'=>$pageSEO['load_perf'],'additional_notes'=>$pageSEO['additional_notes'],];}return $pageSEOData;}public function getPageHeadersByName($pageName){$getPageSEO=$this->marketingModel->getMarketingPageSeoByName($pageName);$pageSEOData=[];foreach($getPageSEO as $pageSEO){$pageSEOData[]=['page_id'=>$pageSEO['id'],'page_name'=>$pageSEO['page_name'],'page_title'=>$pageSEO['page_title'],'page_url'=>$pageSEO['page_url'],'page_sitemap_url'=>$pageSEO['page_sitemap_url'],'page_internal_url'=>$pageSEO['page_internal_url'],'page_controller'=>$pageSEO['page_controller'],'page_controller_url'=>$pageSEO['page_controller_url'],'page_controller_directory'=>$pageSEO['page_controller_directory'],'page_file_directory'=>$pageSEO['page_file_directory'],'page_image'=>$pageSEO['page_image'],'page_description'=>$pageSEO['page_description'],'page_address'=>$pageSEO['page_address'],'page_city'=>$pageSEO['page_city'],'page_state'=>$pageSEO['page_state'],'page_country'=>$pageSEO['page_country'],'page_zipcode'=>$pageSEO['page_zipcode'],'page_facebook'=>$pageSEO['page_facebook'],'linked'=>$pageSEO['linked'],'functionality'=>$pageSEO['functionality'],'design'=>$pageSEO['design'],'seo'=>$pageSEO['seo'],'ext_links'=>$pageSEO['ext_links'],'grammar'=>$pageSEO['grammar'],'d_optimize'=>$pageSEO['d_optimize'],'load_perf'=>$pageSEO['load_perf'],'additional_notes'=>$pageSEO['additional_notes'],];}return $pageSEOData;}public function postToDiscord($message){$discordWebhookUrl=getenv('DISCORD_WEBHOOK_URL');if(strlen($message)>2000){$message=substr($message,0,1997)."...";}$payload=json_encode(["content"=>$message]);$ch=curl_init($discordWebhookUrl);curl_setopt($ch,CURLOPT_HTTPHEADER,['Content-Type: application/json']);curl_setopt($ch,CURLOPT_POST,1);curl_setopt($ch,CURLOPT_POSTFIELDS,$payload);curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);$response=curl_exec($ch);curl_close($ch);return $response;}public function postToFacebookPage($pageId,$message){try{$response=$this->facebook->post("/{$pageId}/feed",['message'=>$message,],$this->facebook->getAccessToken());return $response->getGraphNode();}catch(Facebook\Exceptions\FacebookResponseException $e){log_message('error','Graph returned an error: '.$e->getMessage());return false;}catch(Facebook\Exceptions\FacebookSDKException $e){log_message('error','Facebook SDK returned an error: '.$e->getMessage());return false;}}public function postToFacebookGroup($groupId,$message){try{$response=$this->facebook->post("/{$groupId}/feed",['message'=>$message,],$this->facebook->getAccessToken());return $response->getGraphNode();}catch(Facebook\Exceptions\FacebookResponseException $e){log_message('error','Graph returned an error: '.$e->getMessage());return false;}catch(Facebook\Exceptions\FacebookSDKException $e){log_message('error','Facebook SDK returned an error: '.$e->getMessage());return false;}}public function sendNotification($type,$viewPath,$data,$targetGroup=null,$socialMedia=[]){$userModel=new UserModel();if($targetGroup){$users=$userModel->where('group',$targetGroup)->findAll();}else{$users=$userModel->findAll();}$viewContent=view($viewPath,$data);$notoCount=0;$emailNotoCount=0;if(in_array('in-app',$type)){foreach($users as $user){$this->sendInAppNotification($user,$viewContent);$notoCount++;}}if(in_array('email',$type)){foreach($users as $user){$this->sendEmailNotification($user,$viewContent);$emailNotoCount++;}}foreach($socialMedia as $platform){switch($platform){case 'facebook':$this->postToFacebook($data['message']);break;case 'twitter':$this->postToTwitter($data['message']);break;case 'linkedin':$this->postToLinkedIn($data['message']);break;case 'discord':$this->postToDiscord($data['message']);break;}}$notificationData=['active'=>1,'message'=>$viewContent,'created_at'=>date('Y-m-d H:i:s'),'created_by'=>session('user_id'),'noto_count'=>$notoCount,'email_noto_count'=>$emailNotoCount,];$this->marketingModel->storeNotification($notificationData);}private function sendInAppNotification($user,$content){$db=\Config\Database::connect();$db->table('user_notifications')->insert(['user_id'=>$user->id,'content'=>$content,'created_at'=>date('Y-m-d H:i:s')]);}private function sendEmailNotification($user,$content){$email=\Config\Services::email();$email->setTo($user->email);$email->setSubject('Notification');$email->setMessage($content);$email->send();}public function postToSocialMedia($content){try{$this->postToFacebook($content);$this->postToTwitter($content);$this->postToLinkedIn($content);}catch(\Throwable $e){$this->logger->error('âŒ postToSocialMedia() failed: '.$e->getMessage());}}private function postToFacebook($message){try{$response=$this->facebook->post('/me/feed',['message'=>$message],$this->socialMedia->facebook_access_token);return $response->getGraphNode();}catch(Facebook\Exceptions\FacebookResponseException $e){$this->logger->error('Facebook Graph returned an error: '.$e->getMessage());return false;}catch(Facebook\Exceptions\FacebookSDKException $e){$this->logger->error('Facebook SDK returned an error: '.$e->getMessage());return false;}}public function fetchTweets($query,$count=100){try{$tweets=$this->twitter->get('search/tweets',['q'=>$query,'count'=>$count]);if($this->twitter->getLastHttpCode()===200){$processedTweets=[];foreach($tweets->statuses as $tweet){$processedTweets[]=['tweet_id'=>$tweet->id_str,'content'=>$tweet->text,'author'=>$tweet->user->screen_name,'created_at'=>$tweet->created_at,'url'=>"https://twitter.com/{$tweet->user->screen_name}/status/{$tweet->id_str}"];}foreach($processedTweets as $tweetData){$this->marketingModel->storeScrapedContent(['title'=>$tweetData['content'],'url'=>$tweetData['url'],'content'=>$tweetData['content'],'keywords'=>json_encode([$tweetData['author']]),'scraped_at'=>date('Y-m-d H:i:s')]);}return $processedTweets;}else{throw new \Exception('Failed to fetch tweets: '.$this->twitter->getLastBody());}}catch(\Throwable $th){log_message('error','Error fetching tweets: '.$th->getMessage());return[];}}public function generateContentFromTweets($tweets){$summary=$this->summarizeText(implode(' ',array_column($tweets,'content')));$keywords=$this->extractKeywords($summary);return['summary'=>$summary,'keywords'=>$keywords,'platform_content'=>$this->generatePlatformContent($summary,$keywords)];}public function generateFromTempScraper($limit=5){$records=$this->marketingModel->getLatestTempRecords($limit);if(empty($records)){log_message('info','No temp scraper records found to process.');return;}foreach($records as $record){try{log_message('debug','ðŸ§ª Processing record ID '.$record['id']);$summary=$this->generateContentFromRaw($record);if($summary){$this->marketingModel->markTempScraperProcessed($record['id']);log_message('info','âœ… Processed and stored content for record ID '.$record['id']);}else{log_message('warning','âš ï¸ Summary was null/empty for record ID '.$record['id']);}}catch(\Throwable $e){log_message('error','âŒ Error generating content for record ID '.$record['id'].': '.$e->getMessage());}}}public function postToTwitter($content){try{$response=$this->twitter->post('statuses/update',['status'=>$content]);if($this->twitter->getLastHttpCode()===200){log_message('info','Successfully posted to Twitter: '.$content);return $response;}else{throw new \Exception('Failed to post to Twitter: '.json_encode($response));}}catch(\Throwable $th){log_message('error','Error posting to Twitter: '.$th->getMessage());return false;}}private function postToLinkedIn($message){try{$response=$this->linkedin->post('/people/~/shares',['comment'=>$message,'visibility'=>['code'=>'anyone']],$this->socialMedia->linkedin_access_token);return $response;}catch(Exception $e){$this->logger->error('LinkedIn API returned an error: '.$e->getMessage());return false;}}private function postToBlog($content){$client=new Client(['base_uri'=>$this->siteSettings->wordpress_site_url,]);try{$response=$client->post('/wp-json/wp/v2/posts',['auth'=>[$this->siteSettings->wordpress_username,$this->siteSettings->wordpress_password],'json'=>['title'=>substr($content,0,50),'content'=>$content,'status'=>'publish',],]);if($response->getStatusCode()==201){$this->logger->info('Posted to blog: '.$content);return json_decode($response->getBody(),true);}else{$this->logger->error('Failed to post to blog: '.$response->getBody());return false;}}catch(RequestException $e){$this->logger->error('Blog post request error: '.$e->getMessage());return false;}}public function distributeContentToSocialMedia($content){$twitterPost="ï¿½ **Stock Market Highlights** ï¿½\n";$facebookPost="ï¿½ **Market Movers Update** ï¿½\n";$linkedinPost="ï¿½ **Today's Market Summary** ï¿½\n";$discordPost="ï¿½ **TRADE ALERTS UPDATE!** ï¿½\n";foreach($content['expandedContent']as $post){$twitterPost.=$post."\n";$facebookPost.=$post."\n";$linkedinPost.=$post."\n";$discordPost.=$post."\n";}$this->postToTwitter($twitterPost);$this->postToFacebook($facebookPost);$this->postToLinkedIn($linkedinPost);$this->postToDiscord($discordPost);return['twitter'=>$twitterPost,'facebook'=>$facebookPost,'linkedin'=>$linkedinPost,'discord'=>$discordPost];}public function generateAndPostContent(){$emailSummaries=$this->marketingModel->getEmailSummariesForReview();foreach($emailSummaries as $summary){log_message('info','Generating content for email summary: '.$summary['email_subject']);$content=$this->generateMarketingContent($summary['summary']);log_message('debug','Generated content: '.print_r($content,true));$this->postToSocialMedia($content);$this->postToBlog($content);$this->marketingModel->updateEmailStatus($summary['email_identifier'],'Posted');log_message('info','Updated email status to Posted for: '.$summary['email_subject']);}}public function generateMarketingContent():void{$topStories=$this->marketingModel->getTopStories(10);$count=0;foreach($topStories as $story){if(empty(trim($story['title']?? ''))){log_message('debug','â­ Skipped record ID '.$story['id'].' - no title provided.');continue;}if($count>=5){break;}$headline=$story['title'];$url=$story['source_url']?? '#';$summary=$this->generateSummary($story);$hashtags=$this->extractHashtags($story['title'].' '.$story['email_body']);$platformPosts=['discord'=>"**{$headline}**\n{$summary}\nðŸ”— {$url}\n{$hashtags}",'twitter'=>"{$headline} {$url} {$hashtags}",'linkedin'=>"{$headline}\n{$summary}\nRead more: {$url} {$hashtags}",'facebook'=>"{$headline}\n{$summary}\n{$url} {$hashtags}",'email'=>['subject'=>$headline,'body'=>"{$summary}\n\nRead More: {$url}\n{$hashtags}",],];$this->marketingModel->storeGeneratedContent($story['id'],$platformPosts);$count++;}}private function logScrapeError($url,$error){log_message('error',"Scraping failed for URL: $url, Error: $error");}public function generateContentFromData($title,$content,$tags){$summary=$this->summarizeContent($content);return $title." - ".$summary." Tags: ".implode(', ',$tags);}public function generateContentFromScrapedData($scrapedData,$platform=null){if(empty($scrapedData)||!is_array($scrapedData)){log_message('error','âŒ generateContentFromScrapedData() called with empty or invalid $scrapedData');return[];}$cleanedSummaries=[];foreach($scrapedData as $record){$rawContent=$record['content']?? '';$cleaned=$this->sanitizeRawEmailContent($rawContent);if(strlen($cleaned)<300||substr_count($cleaned,' ')<20){log_message('warning','[MyMIMarketing] Skipped record due to short or unstructured content (Title: '.($record['title']?? 'Untitled').')');continue;}try{$summaryData=$this->summarizeContent($cleaned);if(!is_array($summaryData)||empty($summaryData['summary'])){log_message('warning','âš ï¸ generateContentFromScrapedData(): Summary was null/empty for record title: '.($record['title']?? 'Untitled'));continue;}$headline=$this->generateHeadline($summaryData['summary']);$platformPosts=$this->generatePlatformContent($summaryData['summary'],$summaryData['tokens']??[]);$payload=['title'=>$record['title']?? $headline,'source'=>$record['url']?? 'unknown','summary'=>$summaryData['summary'],'keywords'=>$summaryData['tokens']??[],'headline'=>$headline,'platform_content'=>$platformPosts,'platform'=>$platform,'created_on'=>date("Y-m-d H:i:s"),];$this->marketingModel->storeGeneratedContent($record['id']?? null,$platformPosts);$cleanedSummaries[]=$payload;}catch(\Throwable $e){log_message('error','âŒ Exception in generateContentFromScrapedData(): '.$e->getMessage());}}return $cleanedSummaries;}public function generateContentFromLargeText($content,$tags){if(empty($content)){log_message('error','Content is empty in generateContentFromLargeText.');return['summary'=>'','keywords'=>[],'platforms_content'=>[],];}$tokenizer=new WhitespaceTokenizer();$samples=[$tokenizer->tokenize($content)];log_message('debug','Tokenized samples: '.print_r($samples,true));if(empty($samples)||!isset($samples[0])||!is_array($samples[0])||empty($samples[0])){log_message('error','ðŸš« Empty or malformed document array before TF-IDF.');return['summary'=>'','keywords'=>[],'platforms_content'=>[],];}try{$tfidf=new TfIdfTransformer();$tfidf->fit($samples);$tfidf->transform($samples);log_message('debug','TfIdf transformation successful.');}catch(\Exception $e){log_message('error','TfIdfTransformer failed: '.$e->getMessage());return['summary'=>'','keywords'=>[],'platforms_content'=>[],];}$summary=$this->summarizeText($content);$keywords=$this->extractKeywords($content);$platforms_content=$this->generatePlatformContent($summary,$keywords);return['summary'=>$summary,'keywords'=>$keywords,'platforms_content'=>$platforms_content,];}public function generateCanvaVideo(){$scriptResponse=$this->generateVoiceoverScript();if(!$scriptResponse['status']==='success'){return $this->respond(['status'=>'error','message'=>'Voiceover script not found'],404);}$scriptText=$scriptResponse['script'];$canvaApiUrl="https://api.canva.com/v1/projects";$headers=['Authorization: Bearer YOUR_CANVA_API_KEY','Content-Type: application/json'];$payload=['title'=>'MyMI Trade Alerts Video','template'=>'YOUR_CANVA_TEMPLATE_ID','elements'=>['text'=>$scriptText,'voiceover'=>base_url('uploads/voiceover.mp3')]];$ch=curl_init($canvaApiUrl);curl_setopt($ch,CURLOPT_HTTPHEADER,$headers);curl_setopt($ch,CURLOPT_POST,true);curl_setopt($ch,CURLOPT_POSTFIELDS,json_encode($payload));curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);$response=curl_exec($ch);curl_close($ch);return $this->respond(['status'=>'success','message'=>'Video generated','video_url'=>json_decode($response)->video_url]);}public function generateEnhancedContent($voiceScript){$summary=$this->summarizeContent($voiceScript);$checkedContent=$this->spellCheckAndRefine($summary);$expandedContent=$this->contentGenerator($checkedContent);return['summary'=>$summary,'checkedContent'=>$checkedContent,'expandedContent'=>$expandedContent];}private function generatePrimaryContent($scrapedData){$content="";foreach($scrapedData as $data){$content.="Source: {$data['source']}\n";$content.="Title: {$data['title']}\n";$content.="Content: ".substr($data['content'],0,200)."...\n";$content.="Link: ".($data['url']?? 'N/A')."\n\n";}return $content;}public function generatePlatformContent($summary,$keywords,$mediaAssets=[]){$facebookContent="Facebook Post: ".$summary."\n\n"."Related: #".implode(' #',$keywords);$twitterContent="Twitter: ".substr($summary,0,280)."\n\n#".implode(' #',$keywords);$stocktwitsContent="StockTwits: ".substr($summary,0,250)."\n\n".implode(' ',$keywords);$discordContent="Discord: ".$summary."\n\nJoin the discussion! #".implode(' #',$keywords);$blogContent="Blog Post\n\n".$summary."\n\nKeywords: ".implode(', ',$keywords);$emailContent="Email Notification: ".$summary."\n\nRead more on our blog.";$browserNotificationContent="New Update: ".substr($summary,0,100)."... Click to learn more.";$tiktokScript=$this->generateTikTokScript($summary,$keywords,$mediaAssets);$youtubeScript=$this->generateYouTubeScript($summary,$keywords,$mediaAssets);return['Facebook'=>$facebookContent,'Twitter'=>$twitterContent,'StockTwits'=>$stocktwitsContent,'Discord'=>$discordContent,'Blog'=>$blogContent,'Email'=>$emailContent,'BrowserNotification'=>$browserNotificationContent,'TikTok'=>$tiktokScript,'YouTube'=>$youtubeScript];}public function generateSocialPost(array $summary):array{$text=$summary['summary']?? '';$keywords=$summary['keywords']??[];$hashtags=implode(' ',array_map(function($word){return '#'.ucfirst(trim($word));},array_slice($keywords,0,5)));return['twitter'=>substr("{$text} {$hashtags}",0,280),'facebook'=>"{$text}\n\n{$hashtags}",'linkedin'=>"{$text}\n\n#StayInformed {$hashtags}",'discord'=>"**News Summary:**\n{$text}\n\n{$hashtags}",];}private function generateSocialMediaContent($scrapedData){$facebookContent="Facebook: ";$twitterContent="Twitter: ";$linkedinContent="LinkedIn: ";foreach($scrapedData as $data){$facebookContent.=$data['title']." ".($data['url']?? '')."\n";$twitterContent.=$data['title']." ".($data['url']?? '')."\n";$linkedinContent.=$data['title']." ".($data['url']?? '')."\n";}return['Facebook'=>$facebookContent,'Twitter'=>$twitterContent,'LinkedIn'=>$linkedinContent,];}protected function generateSummary(array $story):string{return substr(strip_tags($story['email_body']?? ''),0,250).'...';}public function generateTikTokScript($summary,$keywords,$mediaAssets=[]){$hook="Did you know?";$cta="Follow us for more updates!";$mediaInclusion=!empty($mediaAssets)?"Include these images/videos: ".implode(", ",$mediaAssets):"";return"TikTok Video Script:\n1. Hook: \"{$hook}\"\n2. Summary: {$summary}\n3. Media: {$mediaInclusion}\n4. CTA: {$cta}";}public function generateYouTubeScript($summary,$keywords,$mediaAssets=[]){$hook="Breaking news in the world of finance...";$cta="Like, subscribe, and share for more updates!";$mediaInclusion=!empty($mediaAssets)?"Include these images/videos: ".implode(", ",$mediaAssets):"";return"YouTube Video Script:\n1. Hook: \"{$hook}\"\n2. Detailed Summary: {$summary}\n3. Media: {$mediaInclusion}\n4. CTA: {$cta}";}public function generateVoiceoverAudio($text){$client=new TextToSpeechClient();$input=new SynthesisInput();$input->setText($text);$voice=new VoiceSelectionParams();$voice->setLanguageCode('en-US');$voice->setSsmlGender('MALE');$audioConfig=new AudioConfig();$audioConfig->setAudioEncoding(AudioEncoding::MP3);$response=$client->synthesizeSpeech($input,$voice,$audioConfig);$audioContent=$response->getAudioContent();$filePath=WRITEPATH.'uploads/voiceover.mp3';file_put_contents($filePath,$audioContent);return base_url('uploads/voiceover.mp3');}public function generateVoiceoverScript(){$tradeAlerts=$this->alertsModel->getFilteredTradeAlerts(['start'=>date('Y-m-d 00:00:00'),'end'=>date('Y-m-d 23:59:59')])->get()->getResultArray();if(empty($tradeAlerts)){return $this->respond(['status'=>'error','message'=>'No trade alerts found for today.'],404);}$script="**Voiceover Script: MyMI Trade Alerts - Top Stock Movers**\n\n[INTRO]\n";$script.="Welcome to todayâ€™s MyMI Trade Alerts! Weâ€™re breaking down the hottest stocks in the market based on momentum, volume, and breakout potential. Letâ€™s jump right in!\n\n";foreach($tradeAlerts as $alert){$script.="**[{$alert['ticker']} - {$alert['company']}]**\n";$script.="**Price:** \${$alert['price']}  |  **% Change:** {$alert['change']}%  |  **Volume:** {$alert['volume']}M\n";$script.="ï¿½ 52-Week High: \${$alert['high']}  |  ï¿½ 52-Week Low: \${$alert['low']}\n";$script.="Market Cap: {$alert['market_cap']}\n\n";}$script.="[OUTRO]\nThatâ€™s it for todayâ€™s MyMI Trade Alerts! Donâ€™t forget to like, subscribe, and stay tuned for more market insights. Drop your thoughts in the commentsâ€”whatâ€™s your top stock pick today? See you in the next update!\n";return $this->respond(['status'=>'success','script'=>$script]);}public function generateStockInformation($cuID){$MyMIInvestments=new MyMIInvestments();$investmentData=$MyMIInvestments->getInvestmentDashboard($cuID);$symbols=$this->getSymbolsByAssetType($investmentData['getSymbols']);$forecastData=[];$riskData=[];foreach($symbols as $type=>$symbolList){switch($type){case 'stocks':$forecastData['stocks']=$MyMIInvestments->performARIMAForecast($symbolList);$riskData['stocks']=$MyMIInvestments->generateRiskManagementTools($cuID,'stocks');break;case 'etfs':$forecastData['etfs']=$MyMIInvestments->performARIMAForecast($symbolList);$riskData['etfs']=$MyMIInvestments->generateRiskManagementTools($cuID,'etfs');break;case 'crypto':$forecastData['crypto']=$MyMIInvestments->performARIMAForecast($symbolList);$riskData['crypto']=$MyMIInvestments->generateRiskManagementTools($cuID,'crypto');break;}}$content=$this->generateContent($forecastData,$riskData);return $content;}private function getSymbolsByAssetType($symbols){$result=['stocks'=>[],'etfs'=>[],'crypto'=>[]];foreach($symbols as $symbol){if(preg_match('/^[A-Z]{1,5}$/',$symbol)){$result['stocks'][]=$symbol;}elseif(preg_match('/^[A-Z]{1,5}$/',$symbol)){$result['etfs'][]=$symbol;}else{$result['crypto'][]=$symbol;}}return $result;}private function generateContent($forecastData,$riskData){$content="";if(!empty($forecastData['stocks'])){$content.="### Stock Investment Forecast\n";foreach($forecastData['stocks']as $symbol=>$forecast){$content.="- **{$symbol}**: ".json_encode($forecast)."\n";}}if(!empty($forecastData['etfs'])){$content.="### ETF Investment Forecast\n";foreach($forecastData['etfs']as $symbol=>$forecast){$content.="- **{$symbol}**: ".json_encode($forecast)."\n";}}if(!empty($forecastData['crypto'])){$content.="### Crypto Investment Forecast\n";foreach($forecastData['crypto']as $symbol=>$forecast){$content.="- **{$symbol}**: ".json_encode($forecast)."\n";}}$content.="\n### Risk Management Insights\n";foreach($riskData as $type=>$riskMetrics){$content.="#### ".ucfirst($type)." Risks\n";foreach($riskMetrics as $riskMetric=>$details){$content.="- **{$riskMetric}**: ".json_encode($details)."\n";}}return $content;}public function getRecentPosts($limit=5){return $this->marketingModel->getRecentPosts($limit);}public function pullFinancialNews():void{$response=$this->client->get('https://www.marketaux.com/api/v1/news/all',['query'=>['api_token'=>getenv('marketaux.apiKey'),'language'=>'en','country'=>'us','published_after'=>date('Y-m-d\TH:i:s\Z',strtotime('-1 hour')),'limit'=>50,],]);$data=json_decode($response->getBody(),true);if(isset($data['data'])){foreach($data['data']as $story){$this->marketingModel->saveNews($story);}}}public function rankBufferCandidates(){$buffer=$this->marketingModel->fetchBufferPostsForScoring();foreach($buffer as $post){$keywords=$this->extractKeywords($post['summary']);$score=array_sum(array_column($keywords,'score'));$tagScore=min($score/10,10);$this->marketingModel->updateBufferItem($post['id'],['tag_score'=>$tagScore]);}}public function rankNewsArticles():void{$unrankedNews=$this->marketingModel->getUnrankedNews();foreach($unrankedNews as $news){$content=strtolower(($news['title']?? '').' '.($news['email_subject']?? '').' '.($news['email_body']?? ''));$words=str_word_count(strip_tags($content),1);$wordFreq=array_count_values($words);$filtered=array_filter($wordFreq,fn($freq,$word)=>strlen($word)>3&&$freq>1,ARRAY_FILTER_USE_BOTH);arsort($filtered);$score=array_sum(array_values($filtered));$topKeywords=array_slice(array_keys($filtered),0,5);$this->marketingModel->updateRankedNews($news['id'],$score,implode(',',$topKeywords));}}public function summarizeMultipleArticles(array $articles):string{$allContent='';foreach($articles as $article){$content=$article['content']?? '';$allContent.=strip_tags($content).' ';}if(empty(trim($allContent))){log_message('error','summarizeMultipleArticles() received empty content.');return 'No content available to summarize.';}$summaryData=$this->summarizeContent($allContent);return is_array($summaryData)&&isset($summaryData['summary'])?$summaryData['summary']:substr($allContent,0,300).'...';}} ?><?php namespace App\Models;use CodeIgniter\Model;use Phpml\FeatureExtraction\TfIdfTransformer;use Phpml\Tokenization\WhitespaceTokenizer;class MarketingModel extends Model{protected $table='bf_marketing_scraper';protected $primaryKey='id';protected $useAutoIncrement=true;protected $returnType='object';protected $useSoftDeletes=false;protected $allowedFields=['title','description','created_on','modified_on','status','type','day','time','activity','link','url','summary','content','email_identifier','email_date','email_sender','email_subject','email_body','email_attachments','keywords','scraped_at','links','images','videos','metadata','structured_data','sched_id','escalated','audience_type','stage','name','assigned_on','assigned_to','completed_on','scheduled_at','primary_content','secondary_content','html_content','voice_script','shared','shared_users','blog','in_app','email','discord','facebook','linkedin','telegram','twitter','website','promotional_links','facebook_message','linkedin_message','discord_message','stocktwits_message','tiktok_message','youtube_message','email_message','additional_info','image_paths'];protected $useTimestamps=true;protected $createdField='created_on';protected $updatedField='modified_on';public function addMarketingCampaign($campaignData){log_message('debug','MarketingModel L206 - $marketingData: '.(print_r($campaignData,true)));$dbData=['beta'=>$campaignData['beta'],'config_mode'=>$campaignData['config_mode'],'form_mode'=>$campaignData['form_mode'],'escalated'=>$campaignData['escalated'],'created_by'=>$campaignData['user_id'],'user_id'=>$campaignData['user_id'],'user_email'=>$campaignData['user_email'],'username'=>$campaignData['username'],'assigned_to'=>$campaignData['assigned_to'],'assigned_on'=>$campaignData['date'].' - '.$campaignData['time'],'name'=>$campaignData['campaign_name'],'promotional_links'=>$campaignData['promotionalLinks'],'overall_campaign_description'=>$campaignData['overall_campaign_description'],'voice_script'=>$campaignData['voice_script'],'facebook_message'=>$campaignData['facebookMessage'],'linkedin_message'=>$campaignData['linkedinMessage'],'discord_message'=>$campaignData['discordMessage'],'stocktwits_message'=>$campaignData['stocktwitsMessage'],'tiktok_message'=>$campaignData['tiktokMessage'],'youtube_message'=>$campaignData['youtubeMessage'],'email_message'=>$campaignData['emailMessage'],'additional_info'=>$campaignData['additionalInfo'],'hashtags'=>$campaignData['hashtags'],];log_message('debug','MarketingModel L206 - $marketingData: '.(print_r($dbData,true)));if($this->db->table('bf_marketing_campaigns')->insert($dbData)){log_message('info','Campaign created successfully.');return $this->getInsertID();}else{log_message('error','DB Insert Error: '.json_encode($this->errors()));return false;}}public function addMarketingSchedule($data){$data['zapier_webhook_url']=$data['zapier_webhook_url']?? null;$data['post_status']='pending';$this->db->table('bf_marketing_schedule')->insert($data);return $this->db->insertID();}public function addSubscriber($subscriberData){if($this->db->table('bf_users_subscribers')->insert($subscriberData)){log_message('info','Subscriber added successfully.');return true;}else{log_message('error','DB Insert Error: '.json_encode($this->errors()));return false;}}public function cleanHtmlEmailContent($raw):string{$raw=is_string($raw)?$raw:'';$decoded=quoted_printable_decode($raw);$decoded=is_string($decoded)?$decoded:'';$text=strip_tags($decoded);$text=preg_replace('/\s+/',' ',str_replace(["\r","\n","\t",'&nbsp;'],' ',$text));return trim(substr($text,0,5000));}public function copyMarketingCampaign($marketingData){unset($marketingData['id']);if($this->insert($marketingData)){log_message('info','Campaign copied successfully.');return $this->getInsertID();}else{log_message('error','DB Insert Error: '.json_encode($this->errors()));return false;}}public function countBlogs(){return $this->db->table('bf_marketing_blog_posts')->countAllResults();}public function countNewlyInsertedToday():int{return $this->where('DATE(scraped_at)',date('Y-m-d'))->countAllResults();}public function createSlug($title){$slug=url_title($title,'-',true);$existing=$this->db->table('bf_marketing_blog_posts')->where('slug',$slug)->countAllResults();return $existing?$slug.'-'.uniqid():$slug;}public function deleteMarketingCampaign($id){if($this->delete($id)){log_message('info','Campaign deleted successfully.');return true;}else{log_message('error','DB Delete Error: '.json_encode($this->errors()));return false;}}public function deleteSchedule($id){return $this->db->table('bf_marketing_schedule')->where('id',$id)->delete();}public function editMarketingCampaign($marketingData){if($this->update($marketingData['id'],$marketingData)){log_message('info','Campaign updated successfully.');return true;}else{log_message('error','DB Update Error: '.json_encode($this->errors()));return false;}}public function extractKeywords($text){if(empty($text)||strlen(trim($text))<50){return[];}$tokenizer=new WhitespaceTokenizer();$tokens=array_filter($tokenizer->tokenize($text));if(empty($tokens)){return[];}$documents=[$tokens];$tfidf=new TfIdfTransformer();try{$tfidf->transform($documents);}catch(\Exception $e){log_message('error','TfIdfTransformer failed: '.$e->getMessage());return[];}$keywordScores=[];foreach($documents[0]as $word=>$score){$keywordScores[$word]=$score;}arsort($keywordScores);return array_slice(array_keys($keywordScores),0,10);}public function fetchBufferPaginated($page=1,$limit=20){$offset=($page-1)*$limit;$builder=$this->db->table('bf_marketing_buffer')->where('status !=','promoted')->orderBy('tag_score','DESC')->limit($limit,$offset);$results=$builder->get()->getResultArray();$total=$this->db->table('bf_marketing_buffer')->where('status !=','promoted')->countAllResults();return['data'=>$results,'pagination'=>['page'=>$page,'pages'=>ceil($total/$limit),]];}public function fetchBufferPaginatedWithFilters(array $params=[]){$page=$params['page']?? 1;$limit=$params['limit']?? 20;$offset=($page-1)*$limit;$keyword=$params['keyword']?? null;$category=$params['category']?? null;$minTagScore=$params['min_tag_score']?? 0;$onlySuggested=$params['only_suggested']?? false;$builder=$this->db->table('bf_marketing_buffer')->where('status !=','promoted');if(!empty($keyword)){$builder->like('keyword',$keyword);}if(!empty($category)){$builder->where('category',$category);}if(!empty($minTagScore)){$builder->where('tag_score >=',$minTagScore);}if($onlySuggested){$builder->where('auto_suggest',1);}$totalQuery=clone $builder;$total=$totalQuery->countAllResults(false);$results=$builder->orderBy('tag_score','DESC')->limit($limit,$offset)->get()->getResultArray();return['data'=>$results,'pagination'=>['page'=>$page,'limit'=>$limit,'pages'=>ceil($total/$limit),'total'=>$total,],];}public function fetchBufferPostsForReview($limit=25){return $this->db->table('bf_marketing_buffer')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getBufferItem($id){return $this->db->table('bf_marketing_buffer')->where('id',$id)->get()->getRowArray();}public function getPendingAutoSuggested($limit=5){return $this->db->table('bf_marketing_buffer')->where('status','pending')->where('auto_suggest',1)->orderBy('tfidf_score','DESC')->limit($limit)->get()->getResultArray();}public function getPendingScheduledPosts($currentTimestamp){return $this->db->table('bf_marketing_schedule')->where('post_time <=',$currentTimestamp)->where('post_status','pending')->get()->getResult();}public function getPendingScraperSummaries($limit=10){return $this->db->table('bf_marketing_scraper')->where('status',null)->orWhere('status','')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getProcessedEmails($date=null){$builder=$this->select('email_identifier');if($date){$builder->where('DATE(email_date)',$date);}$results=$builder->get()->getResultArray();$identifiers=[];foreach($results as $row){if(!empty($row->email_identifier)){$identifiers[]=$row->email_identifier;}}return $identifiers;}public function findBufferItem($id){return $this->db->table('bf_marketing_buffer')->where('id',$id)->get()->getRowArray();}public function findFinalizedById($id){return $this->db->table('bf_marketing_scraper')->where('id',$id)->get()->getRowArray();}public function getActiveCampaigns(){$builder=$this->db->table('bf_marketing_campaigns');$num_rows=$builder->where('status',1)->countAllResults(false);$result=$builder->where('status',1)->get()->getResultArray();return['result'=>$result,'num_rows'=>$num_rows];}public function getActiveIdeas(){return $this->db->table('bf_marketing_ideas')->where('status !=','approved')->get()->getResultArray();}public function getActivePriorityCampaigns(){$builder=$this->db->table('bf_marketing_campaigns');$num_rows=$builder->where('status',1)->where('escalated',1)->countAllResults(false);$result=$builder->where('status',1)->where('escalated',1)->get()->getResultArray();return['result'=>$result,'num_rows'=>$num_rows];}public function getApprovedBufferWithoutSchedule(){return $this->db->table('bf_marketing_buffer')->where('status','approved')->where('scheduled_at IS NULL',null,false)->where('schedule_interval >',0)->orderBy('tag_score','DESC')->limit(10)->get()->getResultArray();}public function getApprovedLogos(){return $this->db->table('bf_company_logos')->get()->getResultArray();}public function getBlogPostBySlug($slug){return $this->db->table('bf_marketing_blog_posts')->where('slug',$slug)->get()->getRow();}public function getBlogPostDetails($id){return $this->find($id);}public function getBlogPosts(){return $this->where('type','Email/Newsletters')->limit(50)->get()->getResultArray();}public function getBlogs(){return $this->db->table('bf_marketing_blog_posts')->orderBy('created_on','DESC')->get()->getResult();}public function getBufferItems($limit=50){return $this->builder()->where('status','pending')->orderBy('score','DESC')->limit($limit)->get()->getResultArray();}public function getCampaignById($campaign_id){return $this->db->table('bf_marketing_campaigns')->where('id',$campaign_id)->get()->getResultArray();}public function getCampaignsBySchedId($accountid){return $this->db->table('bf_marketing_campaigns')->where('sched_id',$accountid)->get()->getResultArray();}public function getDailyLogsByDate($date){return $this->db->table('bf_marketing_scraper')->where('DATE(created_on)',$date)->get()->getResult();}public function getEmailRecordById($id){return $this->db->table('bf_marketing_temp_scraper')->where('id',$id)->get()->getRowArray();}public function getEmailByMessageId($messageId){return $this->db->table('bf_marketing_temp_scraper')->where('email_identifier',$messageId)->get()->getRowArray();}public function getEmailContentsForNewsletter(){return $this->where('include_newsletter',false)->limit(50)->get()->getResultArray();}public function getEmailsMissingTitleOrUrl($limit=20){return $this->db->table('bf_marketing_temp_scraper')->where('(title IS NULL OR title = "" OR url IS NULL OR url = "")',null,false)->orderBy('date_scraped','DESC')->limit($limit)->get()->getResultArray();}public function getEmailSummariesForReview(){return $this->where('status','In Review')->limit(50)->get()->getResultArray();}public function getExchangeTokenById($id){return $this->db->table('bf_exchanges_assets')->where('id',$id)->get()->getRowArray();}public function getExistingLogoBySymbol($symbol){return $this->db->table('bf_company_logos')->where('symbol',$symbol)->get()->getRow();}public function getFeatures(){return $this->db->table('bf_users_memberships')->where('active',1)->orderBy('feature_level','ASC')->orderBy('feature_name','ASC')->get()->getResultArray();}public function getGeneratedContent($postId){return $this->db->table('bf_marketing_campaigns')->where('sched_id',$postId)->get()->getRowArray();}public function getGeneratedPostsBySourceId($id){$row=$this->db->table('bf_marketing_scraper')->where('source_id',$id)->get()->getRowArray();if(!$row||empty($row['platforms']))return[];$decoded=json_decode($row['platforms'],true);if(!is_array($decoded))return[];return $decoded;}public function getLatestGeneratedSummaries($limit=25){return $this->db->table('bf_marketing_scraper')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getLatestNewsletterDraft(){return $this->db->table('bf_marketing_newsletters')->orderBy('created_at','DESC')->first();}public function getLatestTempRecords($limit=5){return $this->db->table('bf_marketing_temp_scraper')->where('status','In Review')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getLatestUnprocessedEmails($limit=10){return $this->db->table('bf_marketing_temp_scraper')->where('status','In Review')->orderBy('scraped_at','DESC')->limit($limit)->get()->getResultArray();}public function getMarketingBuffer($status='Pending'){return $this->builder()->where('status',$status)->orderBy('created_at','DESC')->get()->getResultArray();}public function getMarketingPageSeoByName($pageTitle){return $this->where('page_name',$pageTitle)->get()->getResultArray();}public function getMarketingTeam(){$result=$this->db->table('bf_management_positions')->where('department','Marketing')->get()->getResultArray();return $result;}public function getNewsArticles(){$result=$this->select('articles_json')->first();return json_decode($result->articles_json ?? '[]',true);}public function getNewEmails(){return $this->db->table('bf_marketing_raw_emails')->where('status','unprocessed')->get()->getResultArray();}public function getNewsPosts(){return $this->where('type','news_post')->limit(50)->get()->getResultArray();}public function getNextScheduledPost(){return $this->db->table('bf_marketing_buffer')->where('status','approved')->where('tag_score >=',7.0)->orderBy('tag_score','DESC')->limit(1)->get()->getRowArray();}public function getRecentPosts($limit=5){$results=$this->asObject()->select("id, title, category, created_at, blog_content")->orderBy('created_at','DESC')->limit($limit)->findAll();log_message('info','MarketingModel L437 - $result Array: '.(print_r($results,true)));foreach($results as $r){$r->short_description=substr(strip_tags($r->blog_content ?? 0),0,150);}return $results;}public function getRecentScrapes(){return $this->db->table('bf_marketing_temp_scraper')->orderBy('scraped_at','DESC')->limit(5)->get()->getResult();}public function getRecentSummaries($limit=5){return $this->db->table('bf_marketing_scraper')->select('id, title, summary, keywords, scraped_at')->where("CHAR_LENGTH(summary) >=",100)->where("summary LIKE",'% % % % % % % % % %')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getRecentUnprocessedTempEmails($limit=5){return $this->db->table('bf_marketing_temp_scraper')->where('status','In Review')->orderBy('id','DESC')->limit($limit)->get()->getResultArray();}public function getScheduledBufferPosts($timestamp){return $this->db->table('bf_marketing_buffer')->where('status','approved')->where('scheduled_at <=',$timestamp)->orderBy('scheduled_at','ASC')->limit(3)->get()->getResultArray();}public function getScheduledCampaigns(){return $this->db->table('bf_marketing_newsletters')->where('status','scheduled')->where('scheduled_date <=',date('Y-m-d H:i:s'))->get()->getResultArray();}public function getScheduleByDay($day){return $this->db->table('bf_marketing_calendar')->where('day',ucfirst($day))->get()->getResultArray();}public function getScheduleById($id){return $this->db->table('bf_marketing_schedule')->where('id',$id)->get()->getRow();}public function getScrapesByDate($date){return $this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',$date)->orderBy('scraped_at','DESC');if($limit){$builder->limit($limit);}return $builder->get()->getResultArray();}public function getScrapesByKeyword($keyword){return $this->db->table('bf_marketing_scraper')->like('summary',$keyword)->orLike('keywords',$keyword)->orderBy('created_on','DESC')->limit(10)->get()->getResultArray();}public function getTodaysNewsContent($limit=10){$builder=$this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',date('Y-m-d'))->where('type !=','todays_story')->orderBy('scraped_at','DESC')->limit($limit);$query=$builder->get();$results=$query->getResultArray();if(empty($results)){log_message('info','No scraped content found for today.');}return $results;}public function getTodaysScrapedContent(){return $this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',date('Y-m-d'))->orderBy('feature_score','DESC')->get()->getResultArray();}public function getTodaysStory(){return $this->db->table('bf_marketing_temp_scraper')->where('type','todays_story')->where('DATE(scraped_at)',date('Y-m-d'))->orderBy('scraped_at','DESC')->get()->getRowArray();}public function getTopBufferPosts($limit=5,$minTagScore=7.5){return $this->builder('bf_marketing_buffer')->where('status','approved')->where('tag_score >=',$minTagScore)->orderBy('tag_score','DESC')->limit($limit)->get()->getResultArray();}public function getTopStories($limit=10){return $this->db->table('bf_marketing_scraper')->where('status','pending')->where('title IS NOT NULL')->where('title !=','')->orderBy('feature_score','DESC')->limit($limit)->get()->getResultArray();}public function getTopTempRecords($limit=5){return $this->db->table('bf_marketing_temp_scraper')->where('title IS NOT NULL')->orderBy('created_at','desc')->limit($limit)->get()->getResultArray();}public function getUpcomingSchedule(){return $this->db->table('bf_marketing_schedule')->select('id, post_date, completed, GROUP_CONCAT(DISTINCT platform ORDER BY platform ASC SEPARATOR ", ") as platforms, MIN(content_subject) as subjects, MIN(content_description) as descriptions')->where('post_date >=',date('Y-m-d'))->groupBy('post_date')->orderBy('post_date','ASC')->get()->getResultArray();}public function getUpcomingEarnings(){$builder=$this->db->where('bf_investment_calendar')->where('date >=',date('Y-m-d'))->where('event_type','Earnings')->orderBy('date','ASC')->get()->getResultArray();log_message('debug','MarketingModel L211 - getUpcomingEvents $builder Array: '.(print_r($builder,true)));return $builder;}public function getValidUnprocessedEmails($limit=10){$builder=$this->db->table('bf_marketing_temp_scraper');$builder->where('processed',0);$builder->limit($limit*2);$query=$builder->get();$results=$query->getResultArray();$valid=[];foreach($results as $row){$id=$row['id'];if(empty($row['title'])){log_message('debug',"ðŸª“ Skipping record ID {$id} â€” Missing title.");continue;}if(empty($row['content'])||strlen(strip_tags($row['content']))<100){log_message('debug',"ðŸª“ Skipping record ID {$id} â€” Content empty or too short.");continue;}$textContent=strip_tags($row['content']);$htmlRatio=strlen($textContent)/strlen($row['content']?? '');if($htmlRatio<0.3){log_message('debug',"ðŸª“ Skipping record ID {$id} â€” HTML-dominant content ({$htmlRatio}).");continue;}$valid[]=$row;if(count($valid)>=$limit){break;}}return $valid;}public function getValidUnprocessedEmailsFromToday($limit=10){return $this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',date('Y-m-d'))->where('content IS NOT NULL',null,false)->where('title IS NOT NULL',null,false)->where('CHAR_LENGTH(content) >',250)->orderBy('id','DESC')->limit($limit)->get()->getResultArray();}public function incrementRetryCount($id){return $this->db->table('bf_marketing_schedule')->where('id',$id)->set('retry_count','retry_count + 1',false)->update(['last_attempt_at'=>date('Y-m-d H:i:s')]);}public function insertBufferItem(array $summary){$MyMIMarketing=new \App\Libraries\MyMIMarketing();$scoreData=$MyMIMarketing->getTopKeywordScores($summary['summary']);$threshold=getenv('MARKETING_TFIDF_THRESHOLD')?:7.5;$bufferRecord=['keyword'=>$scoreData['top_keyword']?? 'general','summary'=>$summary['summary'],'score'=>$scoreData['score']?? 0,'tag_score'=>$scoreData['tag_score']?? 0,'category'=>$scoreData['category']?? 'Uncategorized','status'=>'pending','tfidf_score'=>$scoreData['tfidf_score']?? 0,'auto_suggest'=>($scoreData['tfidf_score']?? 0)>=$threshold?1:0,'platforms'=>json_encode(['discord'=>true,'linkedin'=>true,'x'=>false,'email'=>false,]),'created_at'=>date('Y-m-d H:i:s'),];return $this->insert($bufferRecord);}public function insertFinalScraper(array $record,array $summary){$data=['source_id'=>$record['id'],'title'=>$record['title']?? '(No Title)','summary'=>$summary['summary']?? '','keywords'=>json_encode($summary['keywords']??[]),'platforms'=>json_encode($summary['posts']??[]),'status'=>'ready','created_on'=>date('Y-m-d H:i:s'),];return $this->db->table('bf_marketing_scraper')->insert($data);}public function insertNewsContent(array $newsItem,string $ticker){$data=['title'=>$newsItem['title']?? '','summary'=>$newsItem['summary']?? '','content'=>$newsItem['content']?? '','type'=>'financial_news','status'=>'Published','created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),'scraped_at'=>date('Y-m-d H:i:s'),'keywords'=>json_encode($newsItem['keywords']??[]),'links'=>json_encode($newsItem['links']??[]),'audience_type'=>'investor','activity'=>$ticker,];return $this->db->table('bf_marketing_scraper')->insert($data);}public function insertTempScraper($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function idleFetchEmails(){$config=config('NewsEmailServer');$connectionString="{$config->host}:{$config->port}/imap/{$config->encryption}";$inbox=@imap_open($connectionString,$config->username,$config->password);if(!$inbox){log_message('error','Cannot connect to email server: '.imap_last_error());return;}try{while(true){if(function_exists('imap_idle')){$status=imap_idle($inbox);}else{log_message('warning','ðŸ“­ imap_idle not supported on this server. Falling back to polling.');sleep(30);continue;}$status=imap_idle($inbox);if($status){$emails=imap_search($inbox,'ALL');if($emails){foreach($emails as $email_number){$overview=imap_fetch_overview($inbox,$email_number,0)[0];$sender=$overview->from;$subject=$overview->subject;$body=imap_fetchbody($inbox,$email_number,1);$data=['status'=>'In Review','type'=>'Email/Newsletters','email_identifier'=>md5($subject.$sender.$overview->date),'email_date'=>date('Y-m-d H:i:s',strtotime($overview->date)),'email_sender'=>$sender,'email_subject'=>$subject,'email_body'=>$body,'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];if($this->isEmailProcessed($data['email_identifier'])){log_message('debug','Email already processed: '.$data['email_identifier']);}else{$this->storeEmailContent($data);}}}else{log_message('debug','No new emails found or imap_search returned false');}}sleep(30);}}catch(\Exception $e){log_message('error','An exception occurred during email fetching: '.$e->getMessage());}finally{imap_close($inbox);}}public function isEmailProcessed($emailIdentifier){return $this->where('email_identifier',$emailIdentifier)->countAllResults()>0;}private function mapToContextualHashtags($keywords){return array_map(fn($keyword)=>'#'.preg_replace('/\s+/','',ucfirst($keyword)),$keywords);}public function markEmailsAsProcessed($ids=[]){if(!empty($ids)){return $this->db->table('bf_marketing_temp_scraper')->whereIn('id',$ids)->update(['status'=>'Processed']);}return false;}public function markTempRecordAsProcessed($id){return $this->db->table('bf_marketing_temp_scraper')->where('id',$id)->update(['status'=>'Processed','updated_at'=>date('Y-m-d H:i:s')]);}public function markTempScraperProcessed($id){$this->db->table('bf_marketing_temp_scraper')->where('id',$id)->update(['status'=>'Processed']);}public function processText($emailBody){$summary=$this->summarizeText($emailBody);$keywords=$this->extractKeywords($emailBody);$hashtags=$this->mapToContextualHashtags($keywords);if(empty($summary)||empty($hashtags)){log_message('error','Text processing failed');return false;}return $summary.' '.implode(' ',$hashtags);}public function saveApprovedLogo($symbol,$imageUrl){$symbol=strtoupper(trim($symbol));$data=['symbol'=>$symbol,'image_url'=>$imageUrl,'approved_at'=>date('Y-m-d H:i:s'),'updated_at'=>date('Y-m-d H:i:s'),];try{$existingLogo=$this->db->table('bf_company_logos')->where('symbol',$symbol)->get()->getRow();if($existingLogo){if($existingLogo->image_url!==$imageUrl){$this->db->table('bf_company_logos')->where('symbol',$symbol)->update($data);log_message('info',"Logo for symbol {$symbol} updated in bf_company_logos.");}else{log_message('info',"Logo for symbol {$symbol} already exists and is up to date.");}}else{$this->db->table('bf_company_logos')->insert($data);log_message('info',"Logo for symbol {$symbol} added to bf_company_logos.");}}catch(\Exception $e){log_message('error',"Failed to save or update logo for symbol {$symbol}: ".$e->getMessage());}}public function saveDailyLog($data){return $this->db->table('bf_marketing_scraper')->insert($data);}public function saveLogo($data){$symbol=strtoupper(trim($data['symbol']));$existing=$this->db->table('bf_company_logos')->where('symbol',$symbol)->get()->getRow();$data['symbol']=$symbol;$data['updated_at']=date('Y-m-d H:i:s');if($existing){$this->db->table('bf_company_logos')->where('symbol',$symbol)->update($data);log_message('info',"Logo for symbol {$symbol} updated in bf_company_logos.");}else{$data['created_at']=date('Y-m-d H:i:s');$this->db->table('bf_company_logos')->insert($data);log_message('info',"Logo for symbol {$symbol} added to bf_company_logos.");}}public function scheduleNewsletterCampaign($data){return $this->db->table('bf_marketing_newsletters')->insert($data);}public function storeContentAnalytics(array $data){return $this->db->table('bf_marketing_analysis')->insert($data);}public function storeEmail($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function storeEmailContent($data){return $this->insert($data);}public function storeFinalMarketingContent($data){return $this->db->table('bf_marketing_scraper')->insert($data);}public function storeTodaysStory($title,$content){$data=['title'=>$title,'content'=>$content,'links'=>json_encode([]),'url'=>'','type'=>'todays_story','scraped_at'=>date('Y-m-d H:i:s'),'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function submitCampaignContent($data){if(isset($data['promotional_links'])&&is_array($data['promotional_links'])){$data['promotional_links']=json_encode($data['promotional_links']);}$data['status']=$data['status']?? 1;$data['stage']=$data['stage']?? 'draft';$data['created_on']=date('Y-m-d H:i:s');return $this->save($data);}public function storeNewsletterDraft($data){return $this->db->table('bf_marketing_newsletters')->insert($data);}public function storeNotification($data){return $this->db->table('bf_users_promotional_messages')->insert($data);}public function storeScrapedContent($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function storeTempScrapedData($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function summarizeText($text){if(empty($text)){return '';}$sentences=explode('.',$text);if(count($sentences)<=1){return substr($text,0,200);}$tokenizer=new WhitespaceTokenizer();$documents=array_map([$tokenizer,'tokenize'],$sentences);$documents=array_filter($documents);if(empty($documents)){return '';}$tfidf=new TfIdfTransformer();try{$tfidf->transform($documents);}catch(\Exception $e){log_message('error','TfIdfTransformer failed: '.$e->getMessage());return '';}$sentenceScores=[];foreach($documents as $index=>$document){$sentenceScores[$index]=array_sum($document);}arsort($sentenceScores);$numSentences=min(5,count($sentenceScores));$summarySentences=array_slice(array_keys($sentenceScores),0,$numSentences);return implode('. ',array_intersect_key($sentences,array_flip($summarySentences)));}public function updateBufferItem($id,$data){return $this->db->table('bf_marketing_buffer')->where('id',$id)->update($data);}public function updateBufferStatus($id,$status){return $this->db->table('bf_marketing_buffer')->where('id',$id)->update(['status'=>$status]);}public function updateCampaignStatus($id,$status){return $this->db->table('bf_marketing_newsletters')->where('id',$id)->update(['status'=>$status]);}public function updateEmailFields($id,$title,$url,$content=null){$data=['title'=>$title,'url'=>$url];if(!empty($content)){$data['content']=$content;}return $this->db->table('bf_marketing_temp_scraper')->where('id',$id)->update($data);}public function updateExchangeToken($id,$data){return $this->update($id,$data);}public function updateNotification($data){return $this->db->table('bf_users_promotional_messages')->update($data);}public function updateSchedule($id,$data){return $this->db->table('bf_marketing_schedule')->where('id',$id)->update($data);}public function updatePostStatus($id,$status){return $this->db->table('bf_marketing_schedule')->where('id',$id)->update(['post_status'=>$status,'last_attempt_at'=>date('Y-m-d H:i:s')]);}} ?><?php namespace App\Services;use App\Libraries\{BaseLoader,MyMIMarketing};use App\Models\{MarketingModel};use GuzzleHttp\Client;class MarketingService{use BaseLoader;protected $MyMIMarketing;protected $marketingModel;protected $httpClient;public function __construct(){$this->MyMIMarketing=new MyMIMarketing();$this->marketingModel=new MarketingModel();$this->httpClient=new Client(['timeout'=>5,'stream'=>true,'http_errors'=>false,'headers'=>['User-Agent'=>'MyMI Content Bot','Accept-Encoding'=>'gzip, deflate, br',]]);}public function distributeContent($platform,$message){switch($platform){case 'discord':return $this->sendToDiscordWebhook($message);case 'facebook':return $this->sendToZapier('facebook',$message);case 'linkedin':return $this->sendToZapier('linkedin',$message);default:return false;}}public function extractTopKeywords($summary){return $this->getMyMIMarketing()->extractKeywords($summary['summary']);}public function fetchUnprocessedEmailSummaries(){return $this->getMyMIMarketing()->getEmailSummariesForReview();}public function getEmailRecordById($id){return $this->marketingModel->getEmailRecordById($id);}public function getFeatures(){$getFeatures=$this->getMyMIMarketing()->getFeatures();return $getFeatures;}public function gatherKeywordBasedContent($keywords){$allContent=[];foreach($keywords as $keyword){$secData=$this->getMyMIMarketing()->scrapeGoogleSearch("SEC filings {$keyword}");$alphaVantageData=$this->getMyMIMarketing()->scrapeGoogleSearch("AlphaVantage {$keyword}");$googleData=$this->getMyMIMarketing()->scrapeGoogleSearch($keyword,$this->httpClient);$internalData=$this->getMyMIMarketing()->getScrapesByKeyword($keyword);$allContent[]=array_merge([$secData],[$alphaVantageData],[$googleData],$internalData);}return $allContent;}public function generateContentFromPost($title,$content,$tags){$summaryData=$this->getMyMIMarketing()->summarizeContent($content);if(empty($summaryData)||empty($summaryData['summary'])){log_message('error','generateContentFromPost() failed to generate summary.');return null;}return $this->getMyMIMarketing()->generatePlatformContent($summaryData['summary'],$tags);}public function generateFinalContentFromTemp(){$records=$this->marketingModel->getTopTempRecords(5);foreach($records as $record){if(empty($record['title'])||empty($record['content']))continue;$summary=$this->summarizeContent($record['content']);$socialMediaPost=$this->generateSocialPost($summary);$final=['title'=>$record['title'],'content'=>$summary,'post_text'=>$socialMediaPost,'source'=>'email','created_at'=>date('Y-m-d H:i:s'),];$this->marketingModel->insertFinalScraper($final);}}public function generatePlatformPosts($content){$summaryText=implode(" ",array_column($content,'content'));return $this->getMyMIMarketing()->generateContentFromLargeText($summaryText,[]);}public function getManagementTeam(){$getManagementTeam=$this->getMyMIMarketing()->getManagementTeam();return $getManagementTeam;}public function getMarketingData($accountid,$category,$platform){$data=[];if($category&&$accountid){$scrapedData=$this->getMyMIMarketing()->scrapeTokenContentByAccountId($accountid);if($scrapedData){$data['generatedData']=$this->getMyMIMarketing()->generateContentFromScrapedData($scrapedData,$platform);}else{$data['generatedData']=[];}}return $data;}public function getPromotionalBanners($userId){return $this->getMyMIMarketing()->fetchPromotionalBanners($userId);}public function getRecentGeneratedContent($limit=10){return $this->db->table('bf_marketing_scraper')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function regeneratePostsFromEmailId($id){$record=$this->getEmailRecordById($id);if(!$record||empty($record['content'])){log_message('error',"âŒ Email record not found or empty for ID: $id");return null;}$processed=$this->getMyMIMarketing()->generateContentFromRaw($record);if($processed){$this->marketingModel->insertFinalScraper($record,$processed);$this->marketingModel->markEmailsAsProcessed([$id]);return $processed;}return null;}public function sanitizeAndSummarize($content){$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($content);return $this->getMyMIMarketing()->summarizeContent($cleanedBody);}public function storeGeneratedPostsForDashboard($posts){$this->getMyMIMarketing()->storeGeneratedContent(['primary_content'=>$posts['summary'],'social_media_content'=>json_encode($posts['platforms_content']),'status'=>'Generated','created_on'=>date('Y-m-d H:i:s'),]);}protected function sendToDiscordWebhook($message){$webhook=getenv('DISCORD_WEBHOOK_URL');if(!$webhook)return false;$client=\Config\Services::curlrequest();$payload=['content'=>$message];$response=$client->post($webhook,['json'=>$payload]);return $response->getStatusCode()===204;}protected function sendToZapier($platform,$message){$zapierHooks=['facebook'=>getenv('ZAPIER_FACEBOOK_WEBHOOK'),'linkedin'=>getenv('ZAPIER_LINKEDIN_WEBHOOK'),];$hook=$zapierHooks[$platform]?? null;if(!$hook)return false;$client=\Config\Services::curlrequest();$payload=['message'=>$message,'platform'=>$platform];$response=$client->post($hook,['json'=>$payload]);return $response->getStatusCode()===200;}public function storeScrapedContent($content){foreach($content as $data){$this->getMyMIMarketing()->storeTempScrapedData(['title'=>$data['title'],'content'=>$data['content'],'scraped_at'=>date('Y-m-d H:i:s'),'type'=>'keyword_summary',]);}}} ?><?php namespace App\Modules\APIs\Controllers;use CodeIgniter\Controller;use App\Modules\APIs\Controllers\MarketingController;use App\Libraries\{BaseLoader,MyMIAlerts,MyMIMarketing};use App\Models\{AlertsModel,ExchangeModel,MarketingModel,ReferralModel,SupportModel,UserModel};use App\Services\{MarketingService};use CodeIgniter\API\ResponseTrait;class ManagementController extends UserController{use BaseLoader;use ResponseTrait;protected $alertManager;protected $MyMIMarketing;protected $marketingService;protected $alertsModel;protected $exchangeModel;protected $marketingModel;protected $userModel;protected $referralModel;protected $supportModel;public function __construct(){$this->alertManager=new MyMIAlerts();$this->MyMIMarketing=new MyMIMarketing();$this->alertsModel=new AlertsModel();$this->exchangeModel=new ExchangeModel();$this->marketingModel=new MarketingModel();$this->marketingService=new MarketingService();$this->referralModel=new ReferralModel();$this->supportModel=new SupportModel();$this->userModel=new UserModel();}public function runCRONTasks(){log_message('info','ðŸ› ï¸ ManagementController::runCRONTasks() initiated.');$marketingController=new MarketingController();log_message('info','ðŸ“Œ Step 1: cronFetchAndGenerateNews()');try{$marketingController->cronFetchAndGenerateNews();}catch(\Throwable $e){log_message('error','âŒ cronFetchAndGenerateNews failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 3: generateDailyContentDigest()');try{$todayNews=$this->marketingModel->getTodaysScrapedContent();if(!empty($todayNews)){$marketingController->generateDailyContentDigest();}else{log_message('info','ðŸ›‘ Skipping summary generation â€” no scraped news available today.');}}catch(\Throwable $e){log_message('error','âŒ generateDailyContentDigest() failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 4: cronFetchInbox()');try{$marketingController->cronFetchInbox();}catch(\Throwable $e){log_message('error','âŒ cronFetchInbox() failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 5: cronAnalyzeContent()');try{$marketingController->cronAnalyzeContent();}catch(\Throwable $e){log_message('error','âŒ cronAnalyzeContent() failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 6: reprocessIncompleteEmails()');try{$marketingController->runBackfillForTempEmails();}catch(\Throwable $e){log_message('error','âŒ reprocessIncompleteEmails() failed: '.$e->getMessage());}log_message('info','âœ… ManagementController::runCRONTasks() completed.');}public function ajaxGetActiveUsers(){log_message('debug','ðŸ“¥ ajaxGetActiveUsers() called.');$request=service('request');$post=$request->getPost();log_message('debug','ðŸ“¦ Incoming POST: '.print_r($post,true));$start=$post['start']?? 0;$length=$post['length']?? 10;$search=$post['search']['value']?? '';$records=$this->userModel->getUsersByStatus(1,$search);$totalRecords=count($records);$records=array_slice($records,$start,$length);$data=[];foreach($records as $user){try{$actionView=view('ManagementModule\Views\Users\partials\action_buttons',['user'=>$user]);}catch(\Throwable $e){log_message('error','âŒ Error rendering action_buttons view for user ID '.$user['id'].': '.$e->getMessage());$actionView='<span class="text-danger">View Error</span>';}$data[]=['id'=>'<a href="'.site_url('Management/Users/Profile/'.$user['username']).'">'.$user['id'].'</a>','type'=>$user['type'],'name'=>$user['first_name'].' '.$user['last_name'].' '.$user['name_suffix'],'email'=>'<a href="mailto:'.$user['email'].'">'.$user['email'].'</a>','location'=>$user['city'].', '.$user['state'],'referral_code'=>$user['referral_code'],'actions'=>$actionView,];}return $this->response->setJSON(['draw'=>intval($post['draw']?? 1),'recordsTotal'=>$totalRecords,'recordsFiltered'=>$totalRecords,'data'=>$data,]);}public function ajaxGetInactiveUsers(){log_message('debug','ðŸ“¥ ajaxGetInactiveUsers() called.');$request=service('request');$post=$request->getPost();log_message('debug','ðŸ“¦ Incoming POST: '.print_r($post,true));$start=$post['start']?? 0;$length=$post['length']?? 10;$search=$post['search']['value']?? '';$records=$this->userModel->getUsersByStatus(0,$search);$totalRecords=count($records);$records=array_slice($records,$start,$length);$data=[];foreach($records as $user){try{$actionView=view('ManagementModule\Views\Users\partials\action_buttons',['user'=>$user]);}catch(\Throwable $e){log_message('error','âŒ Error rendering action_buttons view for user ID '.$user['id'].': '.$e->getMessage());$actionView='<span class="text-danger">View Error</span>';}$data[]=['id'=>'<a href="'.site_url('Management/Users/Profile/'.$user['username']).'">'.$user['id'].'</a>','type'=>$user['type'],'name'=>$user['first_name'].' '.$user['last_name'].' '.$user['name_suffix'],'email'=>'<a href="mailto:'.$user['email'].'">'.$user['email'].'</a>','location'=>$user['city'].', '.$user['state'],'referral_code'=>$user['referral_code'],'actions'=>$actionView,];}return $this->response->setJSON(['draw'=>intval($post['draw']?? 1),'recordsTotal'=>$totalRecords,'recordsFiltered'=>$totalRecords,'data'=>$data,]);}protected function arrayToXml(array $data,\SimpleXMLElement $xml){foreach($data as $key=>$value){is_array($value)?$this->arrayToXml($value,$xml->addChild($key)):$xml->addChild($key,htmlspecialchars($value));}return $xml;}public function checkForSpamUsers(){try{$MyMIUser=new \App\Libraries\MyMIUser();$spamAccounts=$MyMIUser->findPotentialSpamUsers();return $this->response->setJSON(['status'=>'success','message'=>count($spamAccounts).' spam accounts detected.','data'=>$spamAccounts]);}catch(\Throwable $e){log_message('error','âŒ Error checking spam users: '.$e->getMessage());return $this->failServerError('Failed to check for spam accounts.');}}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);log_message('debug','âœ… Content digest completed.');}public function cronFetchAndGenerateNews(){try{$this->getMyMIMarketing()->cronFetchAndGenerateNews();return $this->response->setJSON(['status'=>'success','message'=>'MarketAux news pulled, ranked, and content generated.']);}catch(\Throwable $e){return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();log_message('debug','âœ… Inbox scrape completed.');}public function cronFetchMarketingEmails(){log_message('info','CRON: Starting Marketing Email Fetch');$service=new MarketingService();$emailsFetched=$service->fetchAndStoreMarketingEmails();log_message('info','CRON: Fetched '.$emailsFetched.' marketing emails');return $this->respond(['status'=>'success','fetched'=>$emailsFetched]);}public function cronFetchAndStoreEmails(){try{$this->logMessage('ðŸ“¥ [CRON] Started cronFetchAndStoreEmails');$marketingService=$this->getMarketingService();$fetched=$marketingService->scrapeInboxAndStore();$this->logMessage("ðŸ“© [CRON] Fetched and stored {$fetched} emails into bf_marketing_temp_scraper");return $this->respond(['status'=>'success','stored'=>$fetched]);}catch(\Throwable $e){log_message('error','[CRON] Error in cronFetchAndStoreEmails: '.$e->getMessage());return $this->failServerError('Failed to fetch emails');}}public function distributeTodaysNewsContent(){$generated=$this->generateTodaysNewsSummary();$result=$this->getMyMIMarketing()->sendToZapier($generated['content']);return $this->response->setJSON(['status'=>'success','message'=>'Content distributed via Zapier.','zapier_result'=>$result]);}public function exportPostJson($id){$post=$this->marketingModel->getGeneratedPostById($id);if(!$post||empty($post['posts'])){return $this->failNotFound('Post not found.');}$posts=json_decode($post['posts'],true);$export=['title'=>$post['title'],'summary'=>$post['summary'],'cta'=>'Check it out at https://mymiwallet.com','keywords'=>explode(',',$post['keywords']?? ''),'platform_captions'=>$posts,];return $this->response->setHeader('Content-Type','application/json')->setHeader('Content-Disposition','attachment; filename="canva_post_'.$id.'.json"')->setJSON($export);}public function fetchAlphaVantageNewsForTradeAlerts(){$alerts=$this->alertsModel->getTradeAlertsWithCreatedFlag();log_message('info','ðŸ“ˆ Processing '.count($alerts).' trade alerts.');foreach($alerts as $alert){try{log_message('info','ðŸ” Fetching AlphaVantage news for: '.$alert['ticker']);$newsItems=$this->alertManager->fetchAlphaVantageNews($alert['ticker']);log_message('info','ðŸ“° '.count($newsItems).' news items fetched for '.$alert['ticker']);foreach($newsItems as $news){$this->marketingModel->insertNewsContent($news,$alert['ticker']);}}catch(\Throwable $e){log_message('error','âŒ AlphaVantage fetch failed for '.$alert['ticker'].': '.$e->getMessage());}}return $this->response->setJSON(['status'=>'success','message'=>'Financial news processed for alerts.']);}public function fetchEmailsToTempScraper(){try{log_message('info','ðŸ“¥ Starting email scrape to bf_marketing_temp_scraper...');$this->getMyMIMarketing()->fetchAndStoreEmails('news');log_message('info','ðŸ“¬ Number of emails fetched: '.count($emails));return $this->response->setJSON(['status'=>'success','message'=>'Emails stored successfully.']);}catch(\Throwable $e){log_message('error','âŒ fetchEmailsToTempScraper error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function fetchNewsEmails(){log_message('info','ðŸ“¥ fetchNewsEmails - Started.');try{$this->getMyMIMarketing()->fetchAndStoreEmails('news');return $this->response->setJSON(['status'=>'success','message'=>'News emails fetched successfully.']);}catch(\Exception $e){log_message('error','âŒ fetchNewsEmails - Error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function forceFetchEmails(){try{$result=$this->alertManager->fetchAndStoreEmails();return $this->response->setJSON(['status'=>'success','message'=>'Emails fetched and processed successfully.']);}catch(\Exception $e){return $this->response->setJSON(['status'=>'error','message'=>'Error fetching emails: '.$e->getMessage()],500);}}public function generateContentDigestFromStored(){log_message('info','Marketing: Starting summary generation from stored marketing emails.');$model=new MarketingModel();$records=$model->getRecentUnprocessedTempEmails(5);$results=[];foreach($records as $record){if(empty($record['title'])||empty($record['content'])){log_message('debug','Skipped record due to missing title/content ID: '.$record['id']);continue;}try{$summary=$this->getMarketingService()->generateContentFromRaw($record['title'],$record['content']);$model->storeFinalMarketingContent(['source_id'=>$record['id'],'title'=>$record['title'],'summary'=>$summary,'created_at'=>date('Y-m-d H:i:s')]);$model->markTempRecordAsProcessed($record['id']);$results[]=$record['title'];}catch(\Throwable $e){log_message('error','Failed to process record ID '.$record['id'].': '.$e->getMessage());}}return $this->respond(['status'=>'complete','processed_titles'=>$results]);}public function generateContentFromScraper(){log_message('debug','ðŸ” API::MarketingController::generateContentFromScraper called');try{$limit=$this->request->getGet('limit')?? 5;$records=[];$allRecords=$this->marketingModel->getValidUnprocessedEmails($limit);if(!is_array($allRecords)){log_message('error','âŒ $allRecords is not an array or null. Cannot proceed.');return $this->respond(['status'=>'error','message'=>'Failed to fetch records.']);}foreach($allRecords as $record){$titleOk=!empty($record['title']);$contentOk=strlen(strip_tags($record['content']?? ''))>1000;if($titleOk&&$contentOk){$records[]=$record;if(count($records)>=$limit)break;}else{log_message('debug',"âš ï¸ Skipping invalid record ID {$record['id']} during prefilter (Title or content missing/too short).");$this->marketingModel->markEmailsAsProcessed([$record['id']]);}}if(empty($records)){return $this->respond(['status'=>'no_data','message'=>'No unprocessed records found.']);}$processedSummaries=[];foreach($records as $record){$content=$record['content']?? '';$title=$record['title']?? '';$recordId=$record['id']?? 0;if(empty(trim($content))||strlen($content)<1000){log_message('debug',"â­ï¸ Skipping record ID {$recordId} - content too short or empty.");continue;}if(empty(trim($title))){log_message('debug',"â­ï¸ Skipping record ID {$recordId} - missing title.");continue;}if(stripos($content,'<html')!==false&&substr_count($content,'<')>50){log_message('debug',"â­ï¸ Skipping record ID {$recordId} - content likely raw HTML.");continue;}try{$processed=$this->getMarketingService()->generateContentFromRaw($record);if(!is_array($processed)){log_message('debug',"âš ï¸ Skipped record ID {$recordId} - generateContentFromRaw() returned invalid structure.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$this->marketingModel->markEmailsAsProcessed([$recordId]);$processedSummaries[]=['id'=>$recordId,'title'=>$processed['headline']?? $title,'summary'=>$processed['summary']?? '','keywords'=>$processed['keywords']??[],];}catch(\Throwable $e){log_message('error',"âŒ Failed to process record ID {$recordId}: {$e->getMessage()}");}}return $this->respond(['status'=>'success','message'=>count($processedSummaries).' records processed successfully.','data'=>$processedSummaries]);}catch(\Throwable $e){log_message('error','âŒ API::generateContentFromScraper error - '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function generateDailyContentDigest(){log_message('debug','ðŸ§  Start Memory Usage: '.memory_get_usage(true));@ini_set('memory_limit','768M');$limit=5;$summary=[];try{$records=$this->marketingModel->getValidUnprocessedEmails($limit);if(!is_array($records)||empty($records)){log_message('info','ðŸš« No valid records returned from getValidUnprocessedEmails().');return $this->response->setJSON(['status'=>'no_data','message'=>'No valid records to process.']);}foreach($records as $record){$recordId=$record['id']?? 0;$title=$record['title']?? '';$content=$record['content']?? '';$contentSize=strlen(strip_tags($content));if(empty(trim($title))||$contentSize<1000){log_message('debug',"âš ï¸ Skipping record ID {$recordId} â€” title missing or content too short ({$contentSize} chars).");$this->marketingModel->markEmailsAsProcessed([$recordId]);continue;}if(stripos($content,'<html')!==false&&substr_count($content,'<')>50){log_message('debug',"â­ï¸ Skipping record ID {$recordId} â€” likely raw HTML content.");$this->marketingModel->markEmailsAsProcessed([$recordId]);continue;}try{gc_collect_cycles();$processed=$this->getMarketingService()->generateContentFromRaw($record);if(!is_array($processed)){log_message('warning',"âš ï¸ Skipped record ID {$recordId} â€” generateContentFromRaw() returned invalid result.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$this->marketingModel->markEmailsAsProcessed([$recordId]);$summary[]=['title'=>$processed['headline']?? 'Untitled','summary'=>$processed['summary']?? '','subtopics'=>$processed['subtopics']??[],'platform_posts'=>$processed['posts']??[],];}catch(\Throwable $e){log_message('error',"âŒ Error processing record ID {$recordId}: {$e->getMessage()}");}}log_message('debug','ðŸ Peak Memory Usage: '.memory_get_peak_usage(true));return $this->response->setJSON(['status'=>'success','digest'=>$summary]);}catch(\Throwable $e){log_message('error','âŒ generateDailyContentDigest fatal error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function generateRankedMarketingContent(){$this->getMyMIMarketing()->generateRankedMarketingContent();return $this->response->setJSON(['status'=>'success','message'=>'Ranked content generated.']);}public function getBalanceSheet($symbol,$apikey){$url="https://www.alphavantage.co/query?function=BALANCE_SHEET&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getCashFlowStatement($symbol,$apikey){$url="https://www.alphavantage.co/query?function=CASH_FLOW&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getCompanyOverview($symbol,$apikey){$url="https://www.alphavantage.co/query?function=OVERVIEW&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getEarningsCalendar($apikey,$horizon='3month'){$url="https://www.alphavantage.co/query?function=EARNINGS_CALENDAR&horizon=".$horizon."&apikey=".$apikey;$csv=file_get_contents($url);$lines=explode("\n",trim($csv));$data=array_map('str_getcsv',$lines);return $data;}public function getFixedWindowAnalytics($symbols,$rangeStart,$rangeEnd,$calculations,$apikey){$url="https://alphavantageapi.co/timeseries/analytics?SYMBOLS=".urlencode($symbols);$url.="&RANGE=".$rangeStart."&RANGE=".$rangeEnd;$url.="&INTERVAL=DAILY&OHLC=close";$url.="&CALCULATIONS=".urlencode($calculations)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getIncomeStatement($symbol,$apikey){$url="https://www.alphavantage.co/query?function=INCOME_STATEMENT&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getInsiderTransactions($symbol,$apikey){$url="https://www.alphavantage.co/query?function=INSIDER_TRANSACTIONS&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getNewsSentiment($apikey,$tickers='',$topics='',$time_from='',$time_to='',$sort='LATEST',$limit=50){$url="https://www.alphavantage.co/query?function=NEWS_SENTIMENT";$url.="&tickers=".urlencode($tickers);$url.="&topics=".urlencode($topics);if($time_from)$url.="&time_from=".$time_from;if($time_to)$url.="&time_to=".$time_to;$url.="&sort=".$sort."&limit=".$limit."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getSlidingWindowAnalytics($symbols,$range,$windowSize,$calculations,$apikey){$url="https://alphavantageapi.co/timeseries/running_analytics?SYMBOLS=".urlencode($symbols);$url.="&RANGE=".$range."&INTERVAL=DAILY&OHLC=close";$url.="&WINDOW_SIZE=".$windowSize;$url.="&CALCULATIONS=".urlencode($calculations)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function generatePostsFromSummary($summaryId=null){try{$summary=$this->marketingModel->find($summaryId);if(!$summary){return $this->failNotFound('Summary not found.');}$decodedTitleRaw=$summary['title']?? '';$decodedSummaryRaw=$summary['summary']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$decodedSummary=quoted_printable_decode($decodedSummaryRaw);$cleanedSummary=html_entity_decode(strip_tags($decodedSummary));$keywords=$this->MyMIMarketing->extractKeywords($cleanedSummary);$posts=$this->MyMIMarketing->generateSocialPosts($cleanedSummary,$keywords);$this->marketingModel->update($summaryId,['keywords'=>json_encode($keywords),'posts'=>json_encode($posts),]);return $this->respond(['status'=>'success','message'=>'Content generated and stored successfully.','original'=>$summary,'cleaned'=>['title'=>$decodedTitle,'summary'=>$cleanedSummary,'keywords'=>$keywords,'posts'=>$posts,],]);}catch(\Throwable $e){log_message('error','âŒ generatePostsFromSummary() failed: '.$e->getMessage());return $this->failServerError('Error generating posts.');}}public function testTfIdfPipeline(){$samples=['Short unstructured','This is a valid test document with enough content and structure to process correctly.','     ','<html><body>Broken HTML without substance</body></html>','Here is another test input to validate TF-IDF scoring logic.',];foreach($samples as $i=>$text){$summary=$this->MyMIMarketing->summarizeText($text);$keywords=$this->MyMIMarketing->extractKeywords($text);$scorePreview=$this->MyMIMarketing->getTopKeywordScores($text,5);log_message('debug',"ðŸ§ª Test #{$i} | Summary: {$summary}");log_message('debug',"ðŸ§ª Test #{$i} | Keywords: ".implode(',',$keywords));log_message('debug',"ðŸ“Š Test #{$i} | TF-IDF Scores: ".print_r($scorePreview,true));}return $this->respond(['status'=>'ok','message'=>'TF-IDF test pipeline ran successfully.']);}public function generateTodaysNewsSummary(){$todayNews=$this->marketingModel->getTodaysNewsContent();$summary=$this->getMyMIMarketing()->summarizeMultipleArticles($todayNews);$content=$this->getMyMIMarketing()->generateMarketingContent($summary);return $this->response->setJSON(['status'=>'success','summary'=>$summary,'content'=>$content]);}public function generateTodaysStory(){ini_set('memory_limit','1024M');try{log_message('info','ðŸ” Starting email scrape for news@mymiwallet.com...');$this->getMyMIMarketing()->fetchAndStoreEmails('news');$today=date('Y-m-d');$scrapes=$this->marketingModel->getScrapesByDate($today,10);if(empty($scrapes)){log_message('info','No scraped emails found for today.');return $this->response->setJSON(['status'=>'error','message'=>'No emails found for today.'],404);}$summaries=[];foreach(array_chunk($scrapes,10)as $scrapeChunk){foreach($scrapeChunk as $scrape){$content=$scrape['email_body']?? $scrape['content']?? '';log_message('info','Content size: '.strlen($content));$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($content);$summary=$this->getMyMIMarketing()->summarizeContent($cleanedBody);log_message('debug','Memory after summary: '.memory_get_usage(true));if(is_array($summary)){$summary=$summary['summary']?? implode('. ',array_map('strval',$summary));}$summaries[]=$summary;}}$combinedSummary=implode("\n\n",$summaries);if(strlen($combinedSummary)>500000){log_message('warning','Combined summary too long. Truncating...');$combinedSummary=substr($combinedSummary,0,500000);}$todayTitle="Today's Top Stories - ".date('F j, Y');$data=['title'=>$todayTitle,'content'=>$combinedSummary,'links'=>json_encode([]),'url'=>'','type'=>'todays_story','scraped_at'=>date('Y-m-d H:i:s'),'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeTempScrapedData($data);log_message('info','âœ… Todayâ€™s story generated and stored.');return $this->response->setJSON(['status'=>'success','message'=>'Todayâ€™s story generated and stored successfully!','title'=>$todayTitle,'summary'=>$combinedSummary]);}catch(\Throwable $e){log_message('error','âŒ generateTodaysStory error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function generateVoiceScriptManually(){try{log_message('info','ðŸŽ¤ generateVoiceScriptManually() triggered.');$script=$this->getMyMIMarketing()->generateVoiceoverScript();return $this->response->setJSON(['status'=>'success','script'=>$script]);}catch(\Throwable $e){log_message('error','âŒ Error in generateVoiceScriptManually: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()]);}}public function getAlerts(){log_message('debug','ðŸ” getAlerts called');try{$alerts=$this->alertsModel->getAllTradeAlerts();log_message('debug','âœ… getAlerts retrieved '.count($alerts).' alerts.');return $this->response->setJSON($alerts);}catch(\Throwable $e){log_message('error','âŒ getAlerts error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getAssets(){log_message('debug','ðŸ“Š getAssets called');try{$assets=$this->exchangeModel->getManagementAssets();log_message('debug','âœ… getAssets retrieved '.count($assets).' assets.');return $this->response->setJSON($assets);}catch(\Throwable $e){log_message('error','âŒ getAssets error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getNews(){log_message('debug','ðŸ“° getNews called');try{$news=$this->marketingModel->getNewsAlerts();log_message('debug','âœ… getNews retrieved '.count($news).' news records.');return $this->response->setJSON($news);}catch(\Throwable $e){log_message('error','âŒ getNews error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getReferrals(){log_message('debug','ðŸ” getReferrals called');try{$referrals=$this->referralModel->getAllReferrals();log_message('debug','âœ… getReferrals retrieved '.count($referrals).' referrals.');return $this->response->setJSON($referrals);}catch(\Throwable $e){log_message('error','âŒ getReferrals error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getSupport(){log_message('debug','ðŸ§¾ getSupport called');try{$support=$this->supportModel->getManagementSupport();log_message('debug','âœ… getSupport retrieved '.count($support).' support records.');return $this->response->setJSON($support);}catch(\Throwable $e){log_message('error','âŒ getSupport error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getTopMovers($apikey){$url="https://www.alphavantage.co/query?function=TOP_GAINERS_LOSERS&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getUpcomingIPOs($apikey){$url="https://www.alphavantage.co/query?function=IPO_CALENDAR&apikey=".$apikey;$csv=file_get_contents($url);$lines=explode("\n",trim($csv));$data=array_map('str_getcsv',$lines);return $data;}public function getUsers(){log_message('debug','ðŸ” getUsers called');}public function massResendActivationEmails(){$users=$this->userModel->getPendingActivationUsers();$activator=service('activator');$emailer=\Config\Services::email();$successCount=0;$failureCount=0;foreach($users as $user){$sent=$activator->send($user);if($sent){$successCount++;log_message('info',"Activation email sent to: {$user->email}");}else{$failureCount++;log_message('error',"Failed to send activation email to: {$user->email}");}}$summary="{$successCount} emails sent successfully, {$failureCount} failed.";return redirect()->to('/Management/Users')->with('message',$summary);}public function processAllTradeAlerts(){try{log_message('info','âš¡ Management API - processAllTradeAlerts triggered.');$this->alertManager->fetchAndStoreAlertsEmails();$this->alertManager->processTradeAlertsInBatches(50);$this->alertManager->updateAlerts();return $this->response->setJSON(['status'=>'success','message'=>'All trade alerts processed successfully.']);}catch(\Exception $e){log_message('error','âŒ Management API - Error processing trade alerts: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function processAndGenerateMarketingContent(){$emails=$this->getMarketingService()->fetchUnprocessedEmailSummaries();if(!empty($emails)&&is_array($emails)){foreach($emails as $email){$cleanContent=$this->getMarketingService()->sanitizeAndSummarize($email['email_body']);$keywords=$this->getMyMIMarketing()->extractTopKeywords($cleanContent);$externalContent=$this->getMarketingService()->gatherKeywordBasedContent($keywords);$this->getMarketingService()->storeScrapedContent($externalContent);$generatedPosts=$this->getMarketingService()->generatePlatformPosts($externalContent);$this->getMarketingService()->storeGeneratedPostsForDashboard($generatedPosts);}}return redirect()->to('/Management/Marketing')->with('message','Content generation completed.');}public function processTempEmailsToScraper(){try{log_message('info','âš™ï¸ Starting content generation from bf_marketing_temp_scraper...');$tempEmails=$this->marketingModel->getRecentScrapes();foreach($tempEmails as $email){$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($email->email_body);$summary=$this->getMyMIMarketing()->summarizeContent($cleanedBody);$keywords=$this->marketingModel->extractKeywords($email->email_body);$hashtags=$this->marketingModel->mapToContextualHashtags($keywords);$data=['title'=>$email->email_subject ?? 'Generated Content','summary'=>is_array($summary)?implode("\n",$summary):$summary,'content'=>$email->email_body,'tags'=>implode(',',$keywords),'type'=>'Email/Newsletters','status'=>'pending','created_on'=>date('Y-m-d H:i:s'),'author_information'=>$email->email_sender,];$this->marketingModel->saveDailyLog($data);}log_message('info','âœ… Finished processing and saving to bf_marketing_scraper.');return $this->response->setJSON(['status'=>'success','message'=>'Content generated and saved to bf_marketing_scraper.',]);}catch(\Throwable $e){log_message('error','âŒ processTempEmailsToScraper error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function reprocessIncompleteEmails(){try{$this->getMyMIMarketing()->reprocessIncompleteEmails();return $this->response->setJSON(['status'=>'success','message'=>'Backfilled incomplete emails.']);}catch(\Throwable $e){log_message('error','âŒ reprocessIncompleteEmails error: '.$e->getMessage());return $this->failServerError('Failed to reprocess incomplete emails.');}}public function runCronManually(){$this->runCRONTasks();return $this->response->setJSON(['status'=>'success','message'=>'Manual CRON execution complete.']);}public function runDailyAlphaVantageDataPipeline(){$symbols=$this->alertsModel->getTopWatchlistSymbols();$apikey=getenv('ALPHA_VANTAGE_KEY');foreach($symbols as $symbol){$this->fetchAlphaVantageNewsForTradeAlerts($symbol['symbol'],$apikey);$this->getCompanyOverview($symbol['symbol'],$apikey);$this->getIncomeStatement($symbol['symbol'],$apikey);}return $this->response->setJSON(['status'=>'success','message'=>'Daily Alpha Vantage data pipeline completed.']);}public function sendToZapierManually(){$summary=$this->generateTodaysNewsSummary();$result=$this->getMyMIMarketing()->sendToZapier($summary['content']);return $this->response->setJSON(['status'=>'success','message'=>'Sent manually to Zapier.','result'=>$result]);}public function scrapeAndGenerateTodaysStoryFromInbox(){try{log_message('info','ðŸ“¥ Starting inbox scrape for news@mymiwallet.com...');$this->getMyMIMarketing()->fetchAndStoreEmails('news');$today=date('Y-m-d');$scrapes=$this->marketingModel->getScrapesByDate($today);if(empty($scrapes)){log_message('info','ðŸ“­ No emails found for today.');return $this->response->setJSON(['status'=>'error','message'=>'No emails found for today.'],404);}$summaries=[];foreach($scrapes as $scrape){$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($scrape['content']);$summary=$this->getMyMIMarketing()->summarizeContent($cleanedBody);if(is_array($summary)){$summary=$summary['summary']?? implode('. ',array_map('strval',$summary));}$summaries[]=$summary;}$combinedSummary=implode("\n\n",$summaries);if(strlen($combinedSummary)>500000){log_message('warning','Combined summary too long. Truncating...');$combinedSummary=substr($combinedSummary,0,500000);}$todayTitle="Today's News Highlights - ".date('F j, Y');$data=['title'=>$todayTitle,'content'=>$combinedSummary,'links'=>json_encode([]),'url'=>'','type'=>'todays_story','scraped_at'=>date('Y-m-d H:i:s'),'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeTempScrapedData($data);log_message('info','âœ… Todayâ€™s story generated and stored.');return $this->response->setJSON(['status'=>'success','message'=>'Todayâ€™s story generated and stored successfully!','title'=>$todayTitle,'summary'=>$combinedSummary]);}catch(\Throwable $e){log_message('error','âŒ scrapeAndGenerateTodaysStoryFromInbox error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function sharePost($id,$platform){try{$post=$this->marketingModel->getGeneratedPostById($id);if(!$post||empty($post['posts'])){return $this->failNotFound('Post not found or invalid.');}$posts=json_decode($post['posts'],true);$message=$posts[$platform]?? null;if(!$message){return $this->failValidationError("No formatted message found for platform: $platform");}$success=$this->getMarketingService()->distributeContent($platform,$message);if($success){return $this->respond(['status'=>'success','message'=>'Post shared.']);}else{return $this->failServerError('Failed to dispatch post.');}}catch(\Throwable $e){log_message('error',"[PostShare] Error: ".$e->getMessage());return $this->failServerError('An unexpected error occurred.');}}public function sendAllDiscordAlerts(){$alerts=$this->alertsModel->getAlertsWithNewTVChart();if(empty($alerts)){return $this->response->setJSON(['status'=>'error','message'=>'No new alerts to send.'],404);}foreach($alerts as $alert){$this->alertManager->sendDiscordNotification($alert);}return $this->response->setJSON(['status'=>'success','message'=>'All Discord notifications sent.']);}public function updateMarketDataForAlerts(){try{$this->alertManager->updateAlerts();return $this->response->setJSON(['status'=>'success','message'=>'Trade alerts updated with market data.']);}catch(\Exception $e){return $this->response->setJSON(['status'=>'error','message'=>'Failed to update market data: '.$e->getMessage()],500);}}} ?><?php $managementActionItems=$siteSettings->managementActionItems;$department=$uri->getSegment(2);$viewFileData=['managementActionItems'=>$managementActionItems,'targetUsers'=>$targetUsers ?? 0,'totalActiveUsers'=>$totalActiveUsers ?? 0,'totalActivePartners'=>$totalActivePartners ?? 0,'totalActiveCampaigns'=>$totalActiveCampaigns ??[],'getTasksByDepartment'=>$getTasksByDepartment ??[],'totalDepartmentTasks'=>$totalDepartmentTasks ??[],'totalPageSEOTasks'=>$totalPageSEOTasks ??[],'totalTransFees'=>$totalTransFees ?? 0,'totalLastTransFees'=>$totalLastTransFees ?? 0,'usersPercentage'=>$usersPercentage ?? 0,'getActiveCampaigns'=>$getActiveCampaigns ??[],'totalApprovedAssets'=>$totalApprovedAssets ?? 0,'totalPendingAssets'=>$totalPendingAssets ?? 0,'userGoals'=>$userGoals ??[],'newsUpdates'=>$newsUpdates ??[],'getBlogPosts'=>$getBlogPosts ??[],'recentMarketingPosts'=>$recentMarketingPosts ??[],'todaysStory'=>$todaysStory ??[],]; ?><div class="nk-block"><div class="row gy-gs"><div class="col-lg-12"><div class="nk-block-head-xs"><div class="nk-block-head-content"><h1 class="title nk-block-title">MyMI Management -<?=esc($department)?></h1><a href="<?=site_url('/Management')?>">â† Back to Management Dashboard</a></div></div></div><div class="col-12 col-xxl-4"><?=view('ManagementModule\Views\Marketing\index\action_center_new',$viewFileData)?></div><div class="col-12 col-xxl-8"><?=view('ManagementModule\Views\Marketing\index\most_recent_content',$viewFileData)?></div><div class="col-12"><?php  ?></div><div class="col-12"><?php  ?></div><div class="col-12 col-xxl-6"><?=view('ManagementModule\Views\Marketing\resources\controlPanelBlock',$viewFileData)?><?php  ?></div><div class="col-12 col-xxl-6"><?=view('ManagementModule\Views\Marketing\resources\ctaRecommenderModule',$viewFileData)?></div><div class="col-12 col-xxl-12 px-2"><div class="generated-summaries"id="generatedSummariesBlock"><?=view('ManagementModule\Views\Marketing\resources\generatedSummaries',$viewFileData)?></div></div><div class="col-12 mt-3 col-xxl-12"><div class="card card-bordered"><div class="card-inner"><h5 class="title">ðŸ“° Recent Marketing Posts</h5><?php $validPosts=array_filter($recentMarketingPosts,fn($p)=>!empty($p->title));if(!empty($validPosts)): ?><ul class="list-group"><?php foreach($validPosts as $post): ?><li class="d-flex justify-content-between align-items-start flex-column list-group-item"><div class="w-100"><strong><?=esc($post->title?:'(Untitled Post)')?></strong><br><small class="text-muted"><?=date('M d, Y h:i A',strtotime($post->created_at))?></small><br><?php if(!empty($post->short_description)): ?><small class="text-secondary"><?=esc($post->short_description)?>...</small><?php else: ?><small class="text-secondary">No description available.</small><?php endif; ?></div><div class="mt-2"><button class="btn btn-primary btn-sm"onclick='dynamicModalLoader("Marketing","PreviewGeneratedPost","<?=$post->id?>")'>Preview</button></div></li><?php endforeach; ?></ul><?php else: ?><p>No posts with valid titles available yet. Click 'Generate' to create one!</p><?php endif; ?></div></div></div><div class="col-12 mt-3 col-xxl-4"><?=view('ManagementModule\Views\Marketing\index\exchange_action_center',$viewFileData)?></div><div class="col-12 mt-3 col-xxl-8"><?=view('ManagementModule\Views\Marketing\index\target_users',$viewFileData)?></div></div></div><script <?= $nonce['script'] ?? '' ?>></script><div class="nk-block"><div class="nk-block-head"><div class="d-flex justify-content-between align-items-center nk-block-head-content"><h4 class="nk-block-title">ðŸ“¢ Generated Marketing Summaries</h4><div><div class="d-flex justify-content-end mt-3"><label class="form-check form-switch ml-2"><input class="btn btn-lg form-check-input"id="liveModeToggle"type="checkbox"> <span class="form-check-label">Live Mode</span></label></div></div></div><p class="text-soft">This section shows finalized summaries ready for distribution across platforms.</p></div><div class="row"id="generatedSummariesBlock"><?php if(!empty($todaysStory)): ?><?php foreach($todaysStory as $summary): ?><div class="mb-4 col-lg-4 col-md-6"><div class="card h-100 shadow-sm"><div class="d-flex flex-column card-body"><h6 class="title mb-1"><?=esc($summary['title'])?></h6><p class="small mb-2 text-soft"><?=date('F j, Y g:i A',strtotime($summary['created_at']))?></p><div class="small mb-2"><?=esc($summary['summary'])?></div><?php if(!empty($summary['keywords'])): ?><div class="small mb-2 text-muted"><strong>#Tags:</strong><?php foreach(explode(',',$summary['keywords'])as $tag): ?><span class="badge bg-light me-1 text-dark">#<?=trim($tag)?></span><?php endforeach; ?></div><?php endif; ?><?php if(!empty($summary['cta'])): ?><div class="small mb-2 text-primary"><strong>ðŸ“£ CTA:</strong><?=esc($summary['cta'])?></div><?php endif; ?><a href="javascript:void(0);"class="btn btn-primary btn-sm mt-auto"onclick='dynamicModalLoader("/API/Management/PreviewGeneratedPost/<?=$summary['id']?>")'>ðŸ” Preview Post</a></div></div></div><?php endforeach; ?><?php else: ?><div class="col-12"><div class="alert alert-warning">âš ï¸ No summaries available. Click "Generate Todayâ€™s Content" to begin.</div></div><?php endif; ?></div></div><script <?= $nonce['script'] ?? '' ?>>const liveToggle = document.getElementById('liveModeToggle');
app/Modules/Support/Controllers/Support.php:63:                    return redirect()->to('/Customer-Support')->with('message', 'Support request submitted successfully');
app/Modules/Support/Controllers/Support.php:95:                    return redirect()->to('/Customer-Support/Response/' . $inputData['res_id'])->with('message', 'Response submitted successfully');
app/Modules/Support/Controllers/Support.php:113:            return redirect()->to('/Customer-Support/Requests')->with('message', 'Request closed successfully');
app/Modules/Support/Controllers/Support.php:116:            return redirect()->to('/Customer-Support/Requests')->with('error', 'Error closing request');
app/Modules/Docs/Controllers/DocsController.php:24:        if (!is_file($file)) return redirect()->to('/Docs');
app/Modules/User/Controllers/AccountController.php:126:                return redirect()->to('/budget');
app/Modules/User/Controllers/AccountController.php:129:                return redirect()->to("/budget/recurring-account/schedule/{$accountId}");
app/Modules/User/Controllers/AccountController.php:133:            return redirect()->to("/budget/edit/{$accountId}");
app/Modules/User/Controllers/AccountController.php:147:                    return redirect()->to('/budget');
app/Modules/User/Controllers/AccountController.php:150:                    return redirect()->to("/budget/edit/{$accountId}");
app/Modules/User/Controllers/AccountController.php:155:                    return redirect()->to("/budget/edit/{$accountId}");
app/Modules/User/Controllers/AccountController.php:158:                    return redirect()->to("/budget/recurring-account/schedule/{$accountId}");
app/Modules/User/Controllers/DashboardController.php:180:                            return redirect()->to('/dashboard')->with('error', 'Trade alert not found.');
app/Modules/User/Controllers/DashboardController.php:227:                            return redirect()->to('/dashboard')->with('error', 'Trade alert not found.');
app/Modules/User/Controllers/DashboardController.php:636:            return redirect()->to('/login');
app/Modules/User/Controllers/DashboardController.php:640:        return redirect()->to('/dashboard/onboarding')->with('success', ucfirst(str_replace('_', ' ', $step)) . ' completed.');
app/Modules/User/Controllers/DashboardController.php:1025:            return redirect()->to('/Profile')->with('error', 'No username provided.');
app/Modules/User/Controllers/TradeTracker.php:97:                return redirect()->to('/Trade-Tracker/Add/' . $stock_one . '/' . $alert_type);
app/Modules/User/Controllers/TradeTracker.php:155:                return redirect()->to('/Wallet-Details/' . $trading_account);
app/Modules/User/Controllers/TradeTracker.php:214:                return redirect()->to('/Wallet-Details/' . $trading_account)->with('message', 'Trade Submitted Successfully');
app/Modules/User/Controllers/TradeTracker.php:278:                    return redirect()->to('/Wallet-Details/' . $trading_account);
app/Modules/User/Controllers/TradeTracker.php:357:                return redirect()->to('/Wallet-Details/' . $trading_account)->with('message', 'Trade Update Submitted Successfully');
app/Modules/User/Controllers/TradeTracker.php:468:                    return redirect()->to('/Wallet-Details/' . $trading_account)
app/Modules/User/Controllers/TradeTracker.php:472:                    return redirect()->to('/Wallet-Details/' . $trading_account);
app/Modules/User/Controllers/TradeTracker.php:490:            return redirect()->to('/Trade-Tracker');
app/Modules/User/Controllers/TradeTracker.php:516:                return redirect()->to('/User/Trade_Tracker/Search');
app/Modules/User/Controllers/AlertsController.php:272:            return redirect()->to('/Users/Alerts')->with('error', 'Alert not found or not sent.');
app/Modules/User/Controllers/ProjectsController.php:648:                return redirect()->to("/projects/view/$projectId")
app/Modules/User/Controllers/EmailController.php:54:        return redirect()->to('/')->with('success', 'Email verified!');
app/Modules/User/Controllers/WalletsController-09072024.php:366:            return redirect()->to('/login');
app/Modules/User/Controllers/WalletsController-09072024.php:512:            return redirect()->to('/Wallets')->with('message', 'Wallet and account added successfully');
app/Modules/User/Controllers/WalletsController-09072024.php:575:                return redirect()->to('/Wallets')->with('message', ucfirst($accountType) . ' account copied successfully');
app/Modules/User/Controllers/WalletsController-09072024.php:639:                return redirect()->to('/Wallets/Confirm-Deposit/' . $wallet_id);
app/Modules/User/Controllers/WalletsController-09072024.php:892:                            return redirect()->to('/Wallets')->with('message', 'Wallet updated successfully');
app/Modules/User/Controllers/WalletsController-09072024.php:978:            return redirect()->to('/Wallets');
app/Modules/User/Controllers/WalletsController-09072024.php:982:            return redirect()->to('/Wallets');
app/Modules/User/Controllers/WalletsController-09072024.php:1037:                    return redirect()->to($redirectURL);
app/Modules/User/Controllers/WalletsController-09072024.php:1056:                // return redirect()->to('Add-Wallet-Withdraw/' . $wallet_id);
app/Modules/User/Controllers/WalletsController-09072024.php:1091:            return redirect()->to('/Budget');
app/Modules/User/Controllers/WalletsController-09072024.php:1094:            return redirect()->to('/Budget');
app/Modules/User/Controllers/WalletsController-09072024.php:1120:                    return redirect()->to('Wallets/Link-Account/Successful/' . $wallet_id);
app/Modules/User/Controllers/WalletsController-09072024.php:1125:                    return redirect()->to('Wallets');
app/Modules/User/Controllers/WalletsController-09072024.php:1129:                return redirect()->to('Wallets/Link-Account/Edit/' . $wallet_id);
app/Modules/User/Controllers/WalletsController-09072024.php:1226:        return redirect()->to('/Wallets/Purchase/MyMIGold/Complete/' . $transactionID);
app/Modules/User/Controllers/WalletsController-09072024.php:1259:            return redirect()->to('/purchase-complete')->with('message', 'Purchase successful!');
app/Modules/User/Controllers/WalletsController-09072024.php:1299:            return redirect()->to('/Wallets/Purchase/MyMIGold/Security/' . $transactionID);
app/Modules/User/Controllers/WalletsController-09072024.php:1412:            return redirect()->to('/wallets');
app/Modules/User/Controllers/WalletsController-09072024.php:1415:            return redirect()->to('/wallets');
app/Modules/User/Controllers/SupportController.php:234:            return redirect()->to('/Support')->with('message', 'Test email sent successfully.');
app/Modules/User/Controllers/SupportController.php:237:            return redirect()->to('/Support')->with('error', 'Failed to send test email.');
app/Modules/User/Controllers/SupportController.php:380:                    return redirect()->to('Customer-Support/Response/' . $formData['res_id']);
app/Modules/User/Controllers/SupportController.php:397:            return redirect()->to('/Customer-Support/Requests')->with('message', 'Request Closed Successfully');
app/Modules/User/Controllers/BudgetController.new.php:140:        return redirect()->to('/Budget');
app/Modules/User/Controllers/BudgetController.new.php:147:            return redirect()->to('/Budget');
app/Modules/User/Controllers/BudgetController.new.php:150:            return redirect()->to('/Budget');
app/Modules/User/Controllers/BudgetController.new.php:158:            return redirect()->to('/Budget');
app/Modules/User/Controllers/BudgetController.new.php:161:            return redirect()->to('/Budget');
app/Modules/User/Controllers/BudgetController.new.php:204:                    return redirect()->to('/Budget');
app/Modules/User/Controllers/BudgetController.new.php:207:                    return redirect()->to("/Budget/Edit/{$accountID}");
app/Modules/User/Controllers/BudgetController.new.php:212:                    return redirect()->to("/Budget/Edit/{$accountID}");
app/Modules/User/Controllers/BudgetController.new.php:215:                    return redirect()->to("/Budget/Recurring-Account/Schedule/{$accountID}");
app/Modules/User/Controllers/BudgetController.new.php:242:        return redirect()->to($referer);
app/Modules/User/Controllers/AccountController-09102024.php:117:                return redirect()->to('/budget');
app/Modules/User/Controllers/AccountController-09102024.php:120:                return redirect()->to("/budget/recurring-account/schedule/{$accountId}");
app/Modules/User/Controllers/AccountController-09102024.php:124:            return redirect()->to("/budget/edit/{$accountId}");
app/Modules/User/Controllers/AccountController-09102024.php:137:                    return redirect()->to('/budget');
app/Modules/User/Controllers/AccountController-09102024.php:140:                    return redirect()->to("/budget/edit/{$accountId}");
app/Modules/User/Controllers/AccountController-09102024.php:145:                    return redirect()->to("/budget/edit/{$accountId}");
app/Modules/User/Controllers/AccountController-09102024.php:148:                    return redirect()->to("/budget/recurring-account/schedule/{$accountId}");
app/Modules/User/Controllers/AccountController-09102024.php:161:            return redirect()->to($referer);
app/Modules/User/Controllers/AccountController-09102024.php:164:            return redirect()->to($referer);
app/Modules/User/Controllers/InvestmentsController-09102024.php:480:            return redirect()->to('/investments/manageTrades');
app/Modules/User/Controllers/InvestmentsController-09102024.php:493:        return redirect()->to('/investments/manageTrades');
app/Modules/User/Controllers/InvestmentsController-09102024.php:503:                return redirect()->to('/investments');
app/Modules/User/Controllers/InvestmentsController-09102024.php:515:            return redirect()->to('/investments/retirementPlanner');
app/Modules/User/Controllers/InvestmentsController-09102024.php:558:            return redirect()->to('/investments/setAlerts');
app/Modules/User/Controllers/InvestmentsController-09102024.php:599:            return redirect()->to('/investments/retirementPlannerManual');
app/Modules/User/Controllers/InvestmentsController-09102024.php:618:            return redirect()->to('/investments/retirementPlannerPremium');
app/Modules/User/Controllers/InvestmentsController-09102024.php:650:            return redirect()->to('/investments/goalBasedInvesting');
app/Modules/User/Controllers/InvestmentsController-09102024.php:1346:        return redirect()->to('/investment-strategies');
app/Modules/User/Controllers/InvestmentsController-09102024.php:1361:        return redirect()->to('/investment-strategies');
app/Modules/User/Controllers/InvestmentsController-09102024.php:1368:        return redirect()->to('/investment-strategies');
app/Modules/User/Controllers/InvestmentsController-09102024.php:1384:        return redirect()->to('/financial-goals');
app/Modules/User/Controllers/InvestmentsController-09102024.php:1399:        return redirect()->to('/financial-goals');
app/Modules/User/Controllers/InvestmentsController-09102024.php:1406:        return redirect()->to('/financial-goals');
app/Modules/User/Controllers/WalletsController.php:186:    //     //     return redirect()->to('/login')->with('redirect_url', current_url())->send();
app/Modules/User/Controllers/WalletsController.php:268:        return redirect()->to('/login')->with('redirect_url', current_url());
app/Modules/User/Controllers/WalletsController.php:745:            return redirect()->to('/Wallets')->with('message', ucfirst($walletType) . ' wallet added successfully.');
app/Modules/User/Controllers/WalletsController.php:902:    //                 return redirect()->to('/Wallets')->with('message', ucfirst($accountType) . ' wallet updated successfully.');
app/Modules/User/Controllers/WalletsController.php:1004:            return redirect()->to('/Wallets')->with('message', ucfirst($walletType) . ' wallet updated successfully.');
app/Modules/User/Controllers/WalletsController.php:1046:                return redirect()->to('/Wallets')->with('message', ucfirst($accountType) . ' wallet updated successfully.');
app/Modules/User/Controllers/WalletsController.php:1127:            return redirect()->to('/Wallets')->with('message', ucfirst($accountType) . ' account copied successfully');
app/Modules/User/Controllers/WalletsController.php:1151:            return redirect()->to('/Wallets')->with('message', 'Deposit successful.');
app/Modules/User/Controllers/WalletsController.php:1177:            return redirect()->to('/Wallets')->with('message', 'Withdrawal successful.');
app/Modules/User/Controllers/WalletsController.php:1202:            return redirect()->to('/Wallets')->with('message', 'Currency exchanged successfully.');
app/Modules/User/Controllers/WalletsController.php:1416:        return redirect()->to('/Wallets/Purchase/MyMIGold/Complete/' . $transactionID);
app/Modules/User/Controllers/WalletsController.php:1482:            return redirect()->to('/Wallets/Purchase/MyMIGold/Security/' . $trans_id);
app/Modules/User/Controllers/WalletsController.php:1528:    //         return redirect()->to('/Wallets/Purchase/MyMIGold/Security/' . $trans_id);
app/Modules/User/Controllers/WalletsController.php:1553:            return redirect()->to('/Wallets');
app/Modules/User/Controllers/WalletsController.php:1556:            return redirect()->to('/Wallets');
app/Modules/User/Controllers/WalletsController.php:1583:            return redirect()->to('/Wallets')->with('warning', 'Suspicious activity detected in your wallet. Please review.');
app/Modules/User/Controllers/WalletsController.php:1585:            return redirect()->to('/Wallets')->with('message', 'No suspicious activity detected.');
app/Modules/User/Controllers/WalletsController.php:1614:            return redirect()->to('/Wallets')->with('message', 'Wallet has been frozen successfully.');
app/Modules/User/Controllers/WalletsController.php:1616:            return redirect()->to('/Wallets')->with('error', 'Failed to freeze the wallet.');
app/Modules/User/Controllers/WalletsController.php:1623:            return redirect()->to('/Wallets')->with('message', 'Wallet has been unfrozen successfully.');
app/Modules/User/Controllers/WalletsController.php:1625:            return redirect()->to('/Wallets')->with('error', 'Failed to unfreeze the wallet.');
app/Modules/User/Controllers/BudgetController-06012024.php:358:        return redirect()->to('/Budget');
app/Modules/User/Controllers/BudgetController-06012024.php:589:        return redirect()->to($referer);
app/Modules/User/Controllers/BudgetController-06012024.php:600:                    return redirect()->to('/Budget');
app/Modules/User/Controllers/BudgetController-06012024.php:603:                    return redirect()->to("/Budget/Edit/{$accountID}");
app/Modules/User/Controllers/BudgetController-06012024.php:608:                    return redirect()->to("/Budget/Edit/{$accountID}");
app/Modules/User/Controllers/BudgetController-06012024.php:611:                    return redirect()->to("/Budget/Recurring-Account/Schedule/{$accountID}");
app/Modules/User/Controllers/BudgetController-06012024.php:621:            return redirect()->to('/Budget');
app/Modules/User/Controllers/BudgetController-06012024.php:625:            return redirect()->to('/Budget');
app/Modules/User/Controllers/BudgetController-06012024.php:633:            return redirect()->to('/Budget');
app/Modules/User/Controllers/BudgetController-06012024.php:637:            return redirect()->to('/Budget');
app/Modules/User/Controllers/PredictionsController.php:15:        return redirect()->to(site_url('Predictions/Markets'));
app/Modules/User/Controllers/BudgetController.php:763:            return redirect()->to('/Budget');
app/Modules/User/Controllers/BudgetController.php:800:                    return redirect()->to('/Budget');
app/Modules/User/Controllers/BudgetController.php:803:                    return redirect()->to("/Budget/Edit/{$accountID}");
app/Modules/User/Controllers/BudgetController.php:808:                    return redirect()->to("/Budget/Edit/{$accountID}");
app/Modules/User/Controllers/BudgetController.php:811:                    return redirect()->to("/Budget/Recurring-Account/Schedule/{$accountID}");
app/Modules/User/Controllers/BudgetController.php:1361:            return redirect()->to('/Budget')->with('error', 'Account not found.');
app/Modules/User/Controllers/InstitutesController.php:92:            return redirect()->to('/Institutes');
app/Modules/User/Controllers/InstitutesController.php:123:            return redirect()->to('/Institutes/view/' . $id);
app/Modules/User/Controllers/InstitutesController.php:135:        return redirect()->to('/Institutes');
app/Modules/User/Controllers/AdvisorController.php:96:            return redirect()->to('/Advisors');
app/Modules/User/Controllers/AdvisorController.php:128:            return redirect()->to('/Advisors/view/' . $id);
app/Modules/User/Controllers/AdvisorController.php:140:        return redirect()->to('/Advisors');
app/Modules/User/Controllers/InvestmentsController.php:327:            return redirect()->to('/Investments');
app/Modules/User/Controllers/InvestmentsController.php:336:        return redirect()->to('/Investments');
app/Modules/User/Controllers/ReferralController.php:369:                return redirect()->to('/Referral-Program/Applications')->with('message', 'Submitted Successfully');
app/Modules/User/Controllers/ReferralController.php:385:            return redirect()->to('/Referral-Program/Applications')->with('message', 'Affiliate Activated Successfully');
app/Modules/ScriptStudio/Controllers/ScriptStudioController.php:90:        return redirect()->to('ScriptStudio')->with('message', 'Script created successfully.');
app/Modules/ScriptStudio/Controllers/ScriptStudioController.php:124:        return redirect()->to('ScriptStudio')->with('message', 'Script updated successfully.');
app/Modules/Exchange/Controllers/SolanaController.php:370:            return redirect()->to('/Exchange/Solana')->with('error', 'Transaction not found.');
app/Modules/Exchange/Controllers/SolanaController.php:383:            return redirect()->to('/Exchange/Solana')->with('message', 'Wallet disconnected successfully.');
app/Modules/Exchange/Controllers/SolanaController.php:386:            return redirect()->to('/Exchange/Solana')->with('error', 'Failed to disconnect the wallet.');
app/Modules/Exchange/Controllers/ExchangeController.php:297:            return redirect()->to('/dashboard');
app/Modules/Exchange/Controllers/ExchangeController.php:299:            return redirect()->to('/dashboard')->with('error', 'Order Could Not Be Submitted!');
app/Modules/Exchange/Controllers/ExchangeController.php:353:            return redirect()->to('/dashboard')->with('error', 'Amount Must Be Larger Than Minimum Requirement');
app/Modules/Exchange/Controllers/ExchangeController.php:407:            return redirect()->to('/dashboard')->with('error', 'Amount Must Be Larger Than Minimum Requirement');
app/Modules/Exchange/Controllers/ExchangeController.php:445:                return redirect()->to('/exchange/kyc_registration_reward/' . $formData['user_id'])->with('success', 'Account Information Updated Successfully');
app/Modules/Exchange/Controllers/ExchangeController.php:447:                return redirect()->to('/exchange/account_information')->with('error', 'Submission Unsuccessful');
app/Modules/Exchange/Controllers/ExchangeController.php:482:            return redirect()->to('/exchange')->with('success', 'Account Information Submitted Successfully');
app/Modules/Exchange/Controllers/ExchangeController.php:484:            return redirect()->to('/exchange')->with('error', 'Reward Not Submitted');
app/Modules/Exchange/Controllers/ExchangeController.php:607:            return redirect()->to('/exchange/success');
app/Modules/Exchange/Controllers/ExchangeController.php:609:            return redirect()->to('/exchange/failure');
app/Modules/Management/Views/Marketing/dashboard.txt:924:        return redirect()->to('/Management/Users')->with('message', $summary);
app/Modules/Management/Views/Marketing/dashboard.txt:972:        return redirect()->to('/Management/Marketing')->with('message', 'Content generation completed.');
app/Modules/Management/Views/Marketing/dashboard.txt:1257:        //     return redirect()->to('/login')->with('redirect_url', current_url())->send();
app/Modules/Management/Views/Marketing/dashboard.txt:1348:                            return redirect()->to('/Management/Marketing/Schedule')->with('success', 'Schedule added successfully');
app/Modules/Management/Views/Marketing/dashboard.txt:1393:                            return redirect()->to('/Management/Marketing/Campaigns')->with('success', 'Campaign added successfully');
app/Modules/Management/Views/Marketing/dashboard.txt:1436:            return redirect()->to('/Management/Marketing')->with('error', 'No type provided');
app/Modules/Management/Views/Marketing/dashboard.txt:1464:            return redirect()->to(base_url('Management/Marketing/Schedule'))->with('success', 'New schedule added successfully.');
app/Modules/Management/Views/Marketing/dashboard.txt:1549:            return redirect()->to('/Management/Marketing/upcomingEarnings')->with('success', 'Logo approved and saved successfully.');
app/Modules/Management/Views/Marketing/dashboard.txt:1606:            return redirect()->to('/Management/Marketing')->with('error', 'No generated content available for review.');
app/Modules/Management/Views/Marketing/dashboard.txt:1739:                return redirect()->to(site_url('Management/Marketing/Exchanges/Edit/' . $id));
app/Modules/Management/Views/Marketing/dashboard.txt:1938:        return redirect()->to("\Management\Marketing\Schedule")->with('success', 'Content generated successfully.');
app/Modules/Management/Views/Marketing/dashboard.txt:2073:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Views/Marketing/dashboard.txt:2280:        return redirect()->to('/Management/Marketing/Blogs')->with('success', 'Blog published successfully.');
app/Modules/Management/Views/Marketing/dashboard.txt:2303:        return redirect()->to('/Management/Marketing/ContentReview')->with('success', count($generatedContent) . ' content items generated successfully. Please review and approve.');
app/Modules/Management/Views/Marketing/dashboard.txt:2341:        return redirect()->to('/Management/Marketing/ContentReview')->with('success', 'Content updated successfully.');
app/Modules/Management/Views/Marketing/dashboard.txt:2397:            return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Views/Marketing/dashboard.txt:2616:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Views/Marketing/dashboard.txt:2686:            return redirect()->to('/Marketing/Success')->with('success', 'Marketing content submitted successfully.');
app/Modules/Management/Views/Marketing/dashboard.txt:2791:            return redirect()->to('/dashboard')->with('success', 'Campaign submitted successfully.');
app/Modules/Management/Controllers/DripCampaignController.php:75:            return redirect()->to("/Management/Drip-Campaigns/{$campaignId}/Steps")->with('success', 'Step added.');
app/Modules/Management/Controllers/DripCampaignController.php:104:            return redirect()->to('/Management/DripCampaigns')->with('success', 'Campaign created.');
app/Modules/Management/Controllers/HowTosController.php:48:            return redirect()->to('/login')->with('redirect_url', current_url())->send();
app/Modules/Management/Controllers/HowTosController.php:379:        return redirect()->to('/Budget');
app/Modules/Management/Controllers/HowTosController.php:623:                    return redirect()->to('/Budget');
app/Modules/Management/Controllers/HowTosController.php:626:                    return redirect()->to("/Budget/Edit/{$accountID}");
app/Modules/Management/Controllers/HowTosController.php:631:                    return redirect()->to("/Budget/Edit/{$accountID}");
app/Modules/Management/Controllers/HowTosController.php:634:                    return redirect()->to("/Budget/Recurring-Account/Schedule/{$accountID}");
app/Modules/Management/Controllers/HowTosController.php:644:            return redirect()->to('/Budget');
app/Modules/Management/Controllers/HowTosController.php:648:            return redirect()->to('/Budget');
app/Modules/Management/Controllers/HowTosController.php:656:            return redirect()->to('/Budget');
app/Modules/Management/Controllers/HowTosController.php:660:            return redirect()->to('/Budget');
app/Modules/Management/Controllers/HowTosController.php:716:            redirect()->to('/login')->with('redirect_url', current_url())->send();
app/Modules/Management/Controllers/Marketing/EmailQueueController.php:40:        return redirect()->to('/email-queue');
app/Modules/Management/Controllers/Marketing/EmailQueueController.php:71:        return redirect()->to('/email-queue');
app/Modules/Management/Controllers/Marketing/EmailTemplateController.php:41:        return redirect()->to('/email-templates');
app/Modules/Management/Controllers/AlertsController.php:86:            return redirect()->to('/login')->with('redirect_url', current_url())->send();
app/Modules/Management/Controllers/AlertsController.php:966:            return redirect()->to('/Management/Alerts')->with('message', 'Tickers imported successfully');
app/Modules/Management/Controllers/AlertsController.php:1068:            return redirect()->to('/TradeAlerts/Test')->with('message', 'Test email sent successfully.');
app/Modules/Management/Controllers/AlertsController.php:1071:            return redirect()->to('/TradeAlerts/Test')->with('error', 'Failed to send test email.');
app/Modules/Management/Controllers/AlertsController.php:1166:            return redirect()->to(site_url('Management/Alerts'))->with('message', 'TradingView post submitted.');
app/Modules/Management/Controllers/AdminController.php:358:        return redirect()->to('/Budget');
app/Modules/Management/Controllers/AdminController.php:602:                    return redirect()->to('/Budget');
app/Modules/Management/Controllers/AdminController.php:605:                    return redirect()->to("/Budget/Edit/{$accountID}");
app/Modules/Management/Controllers/AdminController.php:610:                    return redirect()->to("/Budget/Edit/{$accountID}");
app/Modules/Management/Controllers/AdminController.php:613:                    return redirect()->to("/Budget/Recurring-Account/Schedule/{$accountID}");
app/Modules/Management/Controllers/AdminController.php:623:            return redirect()->to('/Budget');
app/Modules/Management/Controllers/AdminController.php:627:            return redirect()->to('/Budget');
app/Modules/Management/Controllers/AdminController.php:635:            return redirect()->to('/Budget');
app/Modules/Management/Controllers/AdminController.php:639:            return redirect()->to('/Budget');
app/Modules/Management/Controllers/MarketingController.php:118:        //     return redirect()->to('/login')->with('redirect_url', current_url())->send();
app/Modules/Management/Controllers/MarketingController.php:276:                            return redirect()->to('/Management/Marketing/Schedule')->with('success', 'Schedule added successfully');
app/Modules/Management/Controllers/MarketingController.php:321:                            return redirect()->to('/Management/Marketing/Campaigns')->with('success', 'Campaign added successfully');
app/Modules/Management/Controllers/MarketingController.php:364:            return redirect()->to('/Management/Marketing')->with('error', 'No type provided');
app/Modules/Management/Controllers/MarketingController.php:392:            return redirect()->to(base_url('Management/Marketing/Schedule'))->with('success', 'New schedule added successfully.');
app/Modules/Management/Controllers/MarketingController.php:622:            return redirect()->to('/Management/Marketing/upcomingEarnings')->with('success', 'Logo approved and saved successfully.');
app/Modules/Management/Controllers/MarketingController.php:692:            return redirect()->to('/Management/Marketing')->with('error', 'No generated content available for review.');
app/Modules/Management/Controllers/MarketingController.php:827:                return redirect()->to(site_url('Management/Marketing/Exchanges/Edit/' . $id));
app/Modules/Management/Controllers/MarketingController.php:1041:        return redirect()->to("\Management\Marketing\Schedule")->with('success', 'Content generated successfully.');
app/Modules/Management/Controllers/MarketingController.php:1187:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Controllers/MarketingController.php:1499:        return redirect()->to('/Management/Marketing/Blogs')->with('success', 'Blog published successfully.');
app/Modules/Management/Controllers/MarketingController.php:1536:        return redirect()->to('/Management/Marketing/ContentReview')->with('success', count($generatedContent) . ' content items generated successfully. Please review and approve.');
app/Modules/Management/Controllers/MarketingController.php:1574:        return redirect()->to('/Management/Marketing/ContentReview')->with('success', 'Content updated successfully.');
app/Modules/Management/Controllers/MarketingController.php:1630:            return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Controllers/MarketingController.php:1851:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Controllers/MarketingController.php:1921:            return redirect()->to('/Marketing/Success')->with('success', 'Marketing content submitted successfully.');
app/Modules/Management/Controllers/MarketingController.php:2026:            return redirect()->to('/dashboard')->with('success', 'Campaign submitted successfully.');
app/Modules/Management/Controllers/EmailController.php:177:        return redirect()->to('/Management/Email/campaigns')->with('success', 'Campaign scheduled successfully.');
app/Modules/Management/Controllers/UsersController.php:195:            return redirect()->to('/Management/Users')->with('message', 'User Blocked Successfully');
app/Modules/Management/Controllers/UsersController.php:217:            return redirect()->to('/Management/Users')->with('message', 'User Forced Reset Submitted Successfully');
app/Modules/Management/Controllers/UsersController.php:243:            return redirect()->to("/Management/Users/Profile/{$userID}")->with('error', $logMsg);
app/Modules/Management/Controllers/UsersController.php:249:            return redirect()->to("/Management/Users/Profile/{$userID}")->with('error', $logMsg);
app/Modules/Management/Controllers/UsersController.php:272:                return redirect()->to("/Management/Users/Profile/{$userID}")->with('message', $logMsg);
app/Modules/Management/Controllers/UsersController.php:276:                return redirect()->to("/Management/Users/Profile/{$userID}")->with('error', $logMsg);
app/Modules/Management/Controllers/UsersController.php:281:            return redirect()->to("/Management/Users/Profile/{$userID}")->with('error', $message);
app/Modules/Management/Controllers/SupportController.php:281:        return redirect()->to('/Web-Design/Test-Page-Email');
app/Modules/Management/Controllers/APIController.php:273:        return redirect()->to('/Web-Design/Test-Page-Email')->with('success', 'Updated Successfully');
app/Modules/Management/Controllers/ManagementController.php:55:            return redirect()->to('/login')->with('redirect_url', current_url())->send();
app/Modules/Management/Controllers/ManagementController.php:76:        //     return redirect()->to('/login')->with('redirect_url', current_url())->send();
app/Modules/Management/Controllers/ManagementController.php:374:        return redirect()->to('/Budget');
app/Modules/Management/Controllers/ManagementController.php:635:                    return redirect()->to('/Budget');
app/Modules/Management/Controllers/ManagementController.php:638:                    return redirect()->to("/Budget/Edit/{$accountID}");
app/Modules/Management/Controllers/ManagementController.php:643:                    return redirect()->to("/Budget/Edit/{$accountID}");
app/Modules/Management/Controllers/ManagementController.php:646:                    return redirect()->to("/Budget/Recurring-Account/Schedule/{$accountID}");
app/Modules/Management/Controllers/ManagementController.php:656:            return redirect()->to('/Budget');
app/Modules/Management/Controllers/ManagementController.php:660:            return redirect()->to('/Budget');
app/Modules/Management/Controllers/ManagementController.php:668:            return redirect()->to('/Budget');
app/Modules/Management/Controllers/ManagementController.php:672:            return redirect()->to('/Budget');
app/Modules/Management/Controllers/ManagementController.php:728:            redirect()->to('/login')->with('redirect_url', current_url())->send();
app/Modules/Management/Controllers/MarketingController.11202024.php:61:                // return redirect()->to('/login')->send();
app/Modules/Management/Controllers/MarketingController.11202024.php:97:                return redirect()->to('/login')->with('redirect_url', current_url())->send();
app/Modules/Management/Controllers/MarketingController.11202024.php:230:                            return redirect()->to('/Management/Marketing/Schedule')->with('success', 'Schedule added successfully');
app/Modules/Management/Controllers/MarketingController.11202024.php:275:                            return redirect()->to('/Management/Marketing/Campaigns')->with('success', 'Campaign added successfully');
app/Modules/Management/Controllers/MarketingController.11202024.php:318:            return redirect()->to('/Management/Marketing')->with('error', 'No type provided');
app/Modules/Management/Controllers/MarketingController.11202024.php:364:                return redirect()->to(site_url('Management/Marketing/Exchanges/Edit/' . $id));
app/Modules/Management/Controllers/MarketingController.11202024.php:431:            return redirect()->to('/Marketing/Success')->with('success', 'Marketing content submitted successfully.');
app/Modules/Management/Controllers/MarketingController.11202024.php:466:            return redirect()->to('/dashboard')->with('success', 'Campaign submitted successfully.');
app/Modules/Management/Controllers/MarketingController.11202024.php:644:        return redirect()->to("\Management\Marketing\Schedule")->with('success', 'Content generated successfully.');
app/Modules/Management/Controllers/MarketingController.11202024.php:682:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Controllers/MarketingController.11202024.php:727:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Controllers/MarketingController.11202024.php:1033:            return redirect()->to(base_url('Management/Marketing/Schedule'))->with('success', 'New schedule added successfully.');
app/Modules/Management/Controllers/MarketingController.11202024.php:1060:            return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Controllers/MarketingController.11202024.php:1118:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Controllers/TradovateController.php:31:        return redirect()->to($authUrl);
app/Modules/Management/Controllers/TradovateController.php:57:        return redirect()->to('/dashboard');
app/Modules/Management/Controllers/WebDesignController.php:259:        return redirect()->to('/Web-Design/Test-Page-Email')->with('message', 'Updated Successfully');
app/Modules/Management/Controllers/BudgetingController.php:133:            return redirect()->to('/Management')->with('message', 'Recurring Account updated to \'is_debt\' = 1.')->with('message_type', 'success');
app/Modules/Management/Controllers/BudgetingController.php:135:            return redirect()->to('/Management')->with('message', 'Account could not be deleted')->with('message_type', 'error');
app/Modules/Blog/Controllers/EarningsController.php:243:            return redirect()->to('/error-page'); // Error handling if format is invalid
app/Modules/Blog/Controllers/EarningsController.php:264:            return redirect()->to('/Blog/Earnings');
app/Config/Routes.php:22://     return redirect()->to('/login');  // change to 'Home::index' once that exists

### site_url

### base_url
app/Views/errors/html/error_403.php:52:    <meta http-equiv="refresh" content="5;url=<?= site_url('/Support') ?>">
app/Views/errors/html/error_403.php:85:    <a href="<?= site_url('/Dashboard') ?>" class="btn btn-primary mt-3">Return to Dashboard</a>
app/Views/errors/html/error_504.php:119:                    $href = site_url($firstSegment === '' ? '/Dashboard' : ucfirst($firstSegment));
app/Views/errors/html/error_504.php:131:    <a href="<?= site_url('/Dashboard') ?>" class="btn btn-primary mt-4">Return to Dashboard</a>
app/Views/errors/html/production.php:27:        <a class="btn btn-md btn-primary" style="border:1px solid gray; margin-right: 1rem; background-color: blue; padding: 0.5rem; color: white;" href="<?php echo site_url('/Dashboard'); ?>">Dashboard <em class="icon ni ni-home"></em></a>
app/Views/errors/html/production.php:28:        <a class="btn btn-md btn-red" style="border:1px solid gray; background-color: red; padding: 0.5rem; color: white;" href="<?php echo site_url('/logout'); ?>">Logout <em class="icon ni ni-exit"></em></a>
app/Views/errors/html/error_500.php:55:    <meta http-equiv="refresh" content="5;url=<?= site_url('/Support') ?>">
app/Views/errors/html/error_500.php:86:    <a href="<?= site_url('/') ?>" class="btn btn-primary mt-4">Return to Dashboard</a>
app/Views/errors/html/error_404.php:112:    <a href="<?= site_url('/Dashboard') ?>" class="btn btn-primary mt-3">Return to Dashboard</a>
app/Views/errors/html/error_404.php:135:                        $href = site_url('/Dashboard');
app/Views/errors/html/error_404.php:138:                        $href = site_url(ucfirst($firstSegment));
app/Views/errors/html/error_404.orig.php:152:                            <a href="<?= site_url($route) ?>">
app/Views/emails/Marketing/reviewPostEmail.php:6:<a href="<?= site_url('Marketing/approveBufferItem/' . ($post['id'] ?? 0)) ?>" style="background:green;color:white;padding:10px;">âœ… Approve</a>
app/Views/emails/Marketing/reviewPostEmail.php:7:<a href="<?= site_url('Marketing/rejectBufferItem/' . ($post['id'] ?? 0)) ?>" style="background:red;color:white;padding:10px;margin-left:10px;">âŒ Reject</a>
app/Views/emails/welcomeInvestor.php:30:        <a href="<?= site_url('Dashboard') ?>" style="background-color:#28a745;color:white;padding:10px 20px;border-radius:5px;text-decoration:none;">ðŸš€ Go To My Dashboard</a>
app/Views/emails/welcomeInvestor.php:34:        <a href="<?= site_url('resend-activation') ?>" style="background-color:#007bff;color:white;padding:10px 20px;border-radius:5px;text-decoration:none;margin-right:5px;">ðŸ”‘ Activate Your Account</a><br><br>
app/Views/emails/welcomeInvestor.php:35:        <a href="<?= site_url('forgot-password') ?>" style="background-color:#ffc107;color:black;padding:10px 20px;border-radius:5px;text-decoration:none;margin-top:10px;">ðŸ›  Can't Login?</a><br><br>
app/Views/emails/welcomeInvestor.php:36:        <a href="<?= site_url('Support') ?>" style="background-color:#6c757d;color:white;padding:10px 20px;border-radius:5px;text-decoration:none;margin-top:10px;">ðŸ“© Contact Support</a>
app/Views/emails/welcomeInvestor.php:40:        <a href="<?= site_url('/ITT/register') ?>" style="background-color:#17a2b8;color:white;padding:10px 20px;border-radius:5px;text-decoration:none;">âœï¸ Create Your Free Account</a>
app/Views/emails/completeActivation.php:16:    <a href="<?= site_url('activate-account?token=' . ($activationToken ?? '')) ?>"
app/Views/emails/completeActivation.php:22:<p>If you continue to experience issues, you may <a href="<?= site_url('resend-activation') ?>">resend your activation</a> or <a href="<?= site_url('Support') ?>">contact our support team</a>.</p>
app/Views/Auth/resend_activation.php:14:					<form action="<?= site_url('/resend-activation') ?>" method="post">
app/Views/Auth/login.php:69:                    <p><a href="<?= site_url('/activate') ?>">Activate Account?</a></p>
app/Views/Auth/emails/activation.php:1:<p>This is activation email for your account on <?= site_url() ?>.</p>
app/Views/Auth/emails/forgot.php:1:<p>Someone requested a password reset at this email address for <?= site_url() ?>.</p>
app/Views/Auth/emails/activation_email.php:11:        <a href="<?= site_url('activate-account/' . $user->activate_hash) ?>">
app/Views/Auth/emails/activation_email.php:12:            <?= site_url('activate-account/' . $user->activate_hash) ?>
app/Views/Auth/register_form.php:98:                            <small>By registering an account, you are agreeing to our <br><a href="<?php echo site_url('/Legal/Terms-And-Conditions'); ?>">Terms &amp; Conditions</a> and <a href="<?php echo site_url('/Legal/Privacy-Policy'); ?>">Privacy Policy</a> at MyMI Wallet, LLC.</small>
app/Views/Auth/register/The-Mission.php:32:    <h1>Join The Mission. Begin Your Journey With <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a></h1>
app/Views/Auth/register/The-Mission.php:42:      <a href="<?php echo site_url('/register'); ?>" class="btn btn-primary btn-lg mt-3">Register Your Free Account</a>
app/Views/Auth/register/Jailin.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/register/MattCardon.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/register/Ken.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/register/LinkedIn.php:55:            <p><strong>Join MyMI Wallet today!</strong> Create a free account to access industry-leading financial tools and start managing your investments with confidence. <a href="<?= site_url('/LinkedIn/register'); ?>">Register on LinkedIn</a> now and take your financial management to the next level.</p>
app/Views/Auth/register/AnneAlicia.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/register/TBI.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/register/Jasmine.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/register/Earl.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/register/Jeremy.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/register/Alicia.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/register/Kristie.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/register/KenFlores.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/register/Manee.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/register/Apex.php:36:        <a href="<?php echo site_url('/Apex/register'); ?>" class="btn btn-lg btn-success mt-3 mb-4">
app/Views/Auth/register/Dubose.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/register/Deon.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/register/MattHill.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/register/Michael.php:36:            <h1 class="text-black">TBI Solutions Invites You To Join Us<br>At <a href="<?php echo site_url('/'); ?>">MyMI Wallet</a>!</h1>
app/Views/Auth/activate.php:13:                    <form action="<?= site_url('/activate-account') ?>" method="post">
app/Views/Auth/activate.php:42:                    <p><a href="<?= site_url('/resend-activation') ?>">Resend Activation Code?</a></p>
app/Views/themes/public/home.php:6:$btnURL                = empty($cuID) ? ($beta === 0 ? site_url('/Free/register') : site_url('/Beta/register')) : site_url('/Dashboard');
app/Views/themes/public/home.php:254:                                <a class="btn btn-primary btn-sm" href="<?php echo site_url('/How-It-Works/Personal-Budgeting'); ?>">Explore More</a>
app/Views/themes/public/home.php:290:                                <a class="btn btn-primary btn-sm" href="<?php echo site_url('/How-It-Works/Investment-Portfolio-Management'); ?>">Learn More</a>
app/Views/themes/public/home.php:355:                                <a class="btn btn-primary btn-sm" href="<?php echo site_url('/How-It-Works/Daily-Financial-News'); ?>">Subscribe Now</a>
app/Views/themes/public/home.php:401:                                <a class="btn btn-primary btn-sm" href="<?php echo site_url('/How-It-Works/Investor-Profile'); ?>">Manage Profile</a>
app/Views/themes/public/home.php:422:                                <a class="btn btn-primary btn-sm" href="<?php echo site_url('/How-It-Works/Investment-Dashboard'); ?>">View Dashboard</a>
app/Views/themes/public/home.php:486:                                <a class="btn btn-primary btn-sm" href="<?php echo site_url('/How-It-Works/Automated-Financial-Insights'); ?>">Learn More</a>
app/Views/themes/public/home.php:499:                    <a href="<?= site_url('/Dashboard'); ?>" class="btn btn-primary btn-lg">Access Dashboard</a>
app/Views/themes/public/home.php:500:                    <a href="<?= site_url('/How-It-Works'); ?>" class="btn btn-outline-primary btn-lg">Learn More</a>
app/Views/themes/public/home.php:538:                        <a class="intro-feature-item" href="<?php echo site_url('/How-It-Works/Registering-An-Account'); ?>">
app/Views/themes/public/home.php:581:                        <a class="intro-feature-item" href="<?php echo site_url('/How-It-Works/Personal-Budgeting'); ?>">
app/Views/themes/public/home.php:611:                        <a class="intro-feature-item" href="<?php echo site_url('/How-It-Works/Investment-Dashboard'); ?>">
app/Views/themes/public/home.php:631:                        <a class="intro-feature-item" href="<?php echo site_url('/How-It-Works/Setting-Financial-Goals'); ?>">
app/Views/themes/public/home.php:677:                        <a class="intro-feature-item" href="<?php echo site_url('/How-It-Works/MyMI-Gold'); ?>">
app/Views/themes/public/home.php:713:                        <a class="intro-feature-item" href="<?php echo site_url('/How-It-Works/MyMI-Exchange'); ?>">
app/Views/themes/public/home.php:760:          'url' => site_url('/How-It-Works/Registering-An-Account'),
app/Views/themes/public/home.php:794:          'url' => site_url('/How-It-Works/Personal-Budgeting'),
app/Views/themes/public/home.php:815:          'url' => site_url('/How-It-Works/Investment-Dashboard'),
app/Views/themes/public/home.php:826:          'url' => site_url('/How-It-Works/Setting-Financial-Goals'),
app/Views/themes/public/home.php:863:          'url' => site_url('/How-It-Works/MyMI-Gold'),
app/Views/themes/public/home.php:900:          'url' => site_url('/How-It-Works/MyMI-Exchange'),
app/Views/themes/public/resources/Getting-Started/Projects.php:27:                    <li class="breadcrumb-item"><a href="<?= site_url('/'); ?>">Home</a></li>
app/Views/themes/public/resources/Getting-Started/Projects.php:42:                    <li>Visit <a href="<?= site_url('/projects/create'); ?>">Create New Project</a>.</li>
app/Views/themes/public/resources/Getting-Started/Projects.php:82:                <p>If you have any questions, visit our <a href="<?= site_url('/support'); ?>">Support Page</a> or join our <a href="https://discord.gg/YourDiscordLink">Discord Community</a>.</p>
app/Views/themes/public/resources/Getting-Started/default.orig.php:28:                    <li class="breadcrumb-item"><a href="<?= site_url('/'); ?>">Home</a></li>
app/Views/themes/public/resources/Getting-Started/default.orig.php:43:                    <li>Visit <a href="<?= site_url('/register'); ?>">MyMI Wallet Registration</a>.</li>
app/Views/themes/public/resources/Getting-Started/default.orig.php:83:                <p>If you have any questions or need assistance, our support team is here to help. Visit our <a href="<?= site_url('/support'); ?>">Support Page</a> for more information.</p>
app/Views/themes/public/resources/Getting-Started/default.php:54:            <li class="breadcrumb-item"><a href="<?= site_url('/'); ?>">Home</a></li>
app/Views/themes/public/resources/Getting-Started/default.php:64:    ðŸš€ Start for Free â†’ <a href="<?= site_url('/register'); ?>" class="text-dark"><u>Create Account</u></a>
app/Views/themes/public/resources/Getting-Started/default.php:74:                    <li>Visit <a href="<?= site_url('/register'); ?>">Register Page</a>.</li>
app/Views/themes/public/resources/Getting-Started/default.php:95:                    <li>Use our <a href="<?= site_url('/Apex/Referral'); ?>">Apex Referral</a> to sign up.</li>
app/Views/themes/public/resources/Getting-Started/default.php:124:                <p><a href="<?= site_url('/support'); ?>">Visit Support</a> or ask in Discord for real-time help.</p>
app/Views/themes/public/resources/Getting-Started/default.php:131:                <a href="<?= site_url('/Pricing'); ?>" class="btn btn-warning">ðŸ’¼ View Membership Plans</a>
app/Views/themes/public/resources/Getting-Started/default.php:141:            <a href="<?= site_url('/register'); ?>" class="btn btn-success btn-lg">Get Started Now</a>
app/Views/themes/public/resources/stayConnected.php:48:                    <!-- <div class="g mt-4 mt-md-0"><a href="<?php echo site_url('Knowledgebase'); ?>" target="_blank" class="btn btn-lg btn-primary"><span>Learn More!</span></a></div> -->
app/Views/themes/public/resources/needSupport.php:6:            <p>If you have any questions or need assistance, our support team is here to help. Visit our <a href="<?= site_url('/support'); ?>">Support Page</a> for more information.</p>
app/Views/themes/public/home copy.php:7:    $btnURL = $beta === 0 ? site_url('/Free/register') : site_url('/Beta/register');
app/Views/themes/public/home copy.php:10:    $btnURL = site_url('/Dashboard'); 
app/Views/themes/public/home copy.php:54:                                        <!-- <a href="<?php echo site_url('/Knowledgebase'); ?>" class="link-to btn btn-lg btn-light">Learn How It Works</a> -->
app/Views/themes/public/home copy.php:109:                                <a class="btn btn-primary btn-sm" href="<?php echo site_url('/Free/register/MyMI-Budgeting-Tool'); ?>">Start FREE!</a>
app/Views/themes/public/home copy.php:121:                                <a class="btn btn-primary btn-sm" href="<?php echo site_url('/Subscribe/Investment-Portfolio-Management'); ?>">Learn More!</a>
app/Views/themes/public/home copy.php:133:                                <a class="btn btn-primary btn-sm" href="<?php echo site_url('/Subscribe/Daily-Financial-News'); ?>">Subscribe!</a>
app/Views/themes/public/home copy.php:167:                        <a class="intro-feature-item" href="<?php echo site_url('/How-It-Works/Registering-An-Account'); ?>">
app/Views/themes/public/home copy.php:178:                        <a class="intro-feature-item" href="<?php echo site_url('/How-It-Works/Personal-Budgeting'); ?>">
app/Views/themes/public/home copy.php:189:                        <a class="intro-feature-item" href="<?php echo site_url('/How-It-Works/Determining-Your-Financial-Goals'); ?>">
app/Views/themes/public/home copy.php:216:                            <!-- Utilize our <a href="<?php //echo site_url('/Marketplace'); ?>">MyMI Asset Marketplace</a> &amp; <a href="<?php //echo site_url('/Exchange'); ?>">Exchange</a> to profit from your investment data, build liquidity, and more at MyMI Wallet.  -->
app/Views/themes/public/home copy.php:219:                            To us, you are not just another customer!<br>You are a <a href="<?php echo site_url($btnURL); ?>">Partner</a> in the Future of Your Financial Growth.
app/Views/themes/public/home copy.php:233:                            <!-- Utilize our <a href="<?php //echo site_url('/Marketplace'); ?>">MyMI Asset Marketplace</a> &amp; <a href="<?php //echo site_url('/Exchange'); ?>">Exchange</a> to profit from your investment data, build liquidity, and more at MyMI Wallet.  -->
app/Views/themes/public/home copy.php:236:                            To us, you are not just another customer!<br>You are a <a href="<?php echo site_url($btnURL); ?>">Partner</a> in the Future of Your Financial Growth.
app/Views/themes/public/home copy.php:250:                            <!-- Utilize our <a href="<?php //echo site_url('/Marketplace'); ?>">MyMI Asset Marketplace</a> &amp; <a href="<?php //echo site_url('/Exchange'); ?>">Exchange</a> to profit from your investment data, build liquidity, and more at MyMI Wallet.  -->
app/Views/themes/public/home copy.php:253:                            To us, you are not just another customer!<br>You are a <a href="<?php echo site_url($btnURL); ?>">Partner</a> in the Future of Your Financial Growth.
app/Views/themes/public/home copy.php:267:                            <!-- Utilize our <a href="<?php //echo site_url('/Marketplace'); ?>">MyMI Asset Marketplace</a> &amp; <a href="<?php //echo site_url('/Exchange'); ?>">Exchange</a> to profit from your investment data, build liquidity, and more at MyMI Wallet.  -->
app/Views/themes/public/home copy.php:270:                            To us, you are not just another customer!<br>You are a <a href="<?php echo site_url($btnURL); ?>">Partner</a> in the Future of Your Financial Growth.
app/Views/themes/public/home copy.php:287:                            <!-- Utilize our <a href="<?php //echo site_url('/Marketplace'); ?>">MyMI Asset Marketplace</a> &amp; <a href="<?php //echo site_url('/Exchange'); ?>">Exchange</a> to profit from your investment data, build liquidity, and more at MyMI Wallet.  -->
app/Views/themes/public/home copy.php:307:                <li><a href="<?php echo site_url('Knowledgebase/Getting-Started'); ?>" class="link-to btn btn-lg btn-round btn-outline-primary">Get Started</a></li>
app/Views/themes/public/previewAlert.php:276:                            <p>ðŸ”’ <a href="<?= site_url('/Memberships') ?>">Sign Up for Premium</a> to Unlock Full Details!</p>
app/Views/themes/public/previewAlert.php:329:                                ? 'ðŸ”’ <a href="' . site_url('/Memberships') . '">Sign Up for Premium</a> to unlock this alert.'
app/Views/themes/public/previewAlert.php:330:                                : 'No alert on record yet. <a href="' . site_url('/register') . '">Create a free account</a> to follow ' . esc($tvTicker) . '.' ?>
app/Views/themes/public/previewAlert.php:368:                            <p>ðŸ”’ <a href="<?= site_url('/Memberships') ?>">Sign Up for Premium</a> to Unlock SEC Filings!</p>
app/Views/themes/public/previewAlert.php:411:                                <p>ðŸ”’ <a href="<?= site_url('/Memberships') ?>">Sign Up for Premium</a> to Unlock Details!</p>
app/Views/themes/public/previewAlert.php:428:                <a class="btn btn-primary" href="<?= site_url('/register') ?>">Register Now</a>
app/Views/themes/public/previewAlert.php:435:                <a class="btn btn-success" href="<?= site_url('/Promotions') ?>">Save More!</a>
app/Views/themes/public/previewAlert.php:480:            fetch("<?= site_url('/API/Users/Comments/Add') ?>", {
app/Views/themes/public/previewAlert.php:521:                fetch("<?= site_url('/API/Alerts/fetchMarketAuxNews/' . $ticker) ?>")
app/Views/themes/public/termsOfService.php:6:                    <li class="breadcrumb-item"><a href="<?= site_url('/'); ?>">Home</a></li>
app/Views/themes/public/economicCalendar.php:56:                    <li class="breadcrumb-item"><a href="<?= site_url('/'); ?>">Home</a></li>
app/Views/themes/public/economicCalendar.php:135:                <a href="<?= site_url('/register'); ?>" class="btn btn-primary">Register Now</a>
app/Views/themes/public/economicCalendar.php:142:                <a href="<?= site_url('/Promotions'); ?>" class="btn btn-success">Save More!</a>
app/Views/themes/public/memberships.php:21:                    <li class="breadcrumb-item"><a href="<?= site_url('/'); ?>">Home</a></li>
app/Views/themes/public/gettingStarted.php:28:                    <li class="breadcrumb-item"><a href="<?= site_url('/'); ?>">Home</a></li>
app/Views/themes/public/gettingStarted.php:46:                    <li>Visit <a href="<?= site_url('/register'); ?>">the Registration Page</a></li>
app/Views/themes/public/gettingStarted.php:71:                    <li><a href="<?= site_url('/Apex/Referral'); ?>">Click here to register with Apex Trader</a></li>
app/Views/themes/public/gettingStarted.php:88:                <p>Our support team is ready to assist you. Visit the <a href="<?= site_url('/support'); ?>">Support Center</a>.</p>
app/Views/themes/public/gettingStarted.php:103:            <a href="<?= site_url('/register'); ?>" class="btn btn-primary btn-lg px-5">Create My Account</a>
app/Views/themes/public/gettingStarted.php:104:            <p class="mt-3">Already have an account? <a href="<?= site_url('/login'); ?>">Log in here</a>.</p>
app/Views/themes/public/privacyPolicy.php:6:                    <li class="breadcrumb-item"><a href="<?= site_url('/'); ?>">Home</a></li>
app/Views/themes/public/layouts/footer.php:30:                    <li><a href="<?= site_url('/'); ?>#features" class="link-to">Features</a></li>
app/Views/themes/public/layouts/footer.php:31:                    <li><a href="<?= site_url('Knowledgebase'); ?>" target="_blank">Doc</a></li>
app/Views/themes/public/layouts/footer.php:32:                    <li><a href="<?= site_url('Privacy-Policy'); ?>" target="_blank">Privacy Policy</a></li>
app/Views/themes/public/layouts/footer.php:33:                    <li><a href="<?= site_url('Terms-Of-Service'); ?>" target="_blank">Terms of Service</a></li>
app/Views/themes/public/layouts/footer.php:34:                    <li><a href="<?= site_url('Support'); ?>" target="_blank">Need Help?</a></li>
app/Views/themes/public/layouts/_sitenav.php:14:$btnURL = ($beta === 0) ? site_url('/Free/register') : site_url('/Beta/register');
app/Views/themes/public/layouts/_sitenav.php:16:$dashboardURL = site_url('/Dashboard');
app/Views/themes/public/layouts/_sitenav.php:17:$loginURL = site_url('/login');
app/Views/themes/public/layouts/_sitenav.php:20:        $btnURL = site_url('/Free/register');
app/Views/themes/public/layouts/_sitenav.php:22:        $btnURL = site_url('/Beta/register');
app/Views/themes/public/layouts/_sitenav.php:26:    $btnURL = site_url('/Dashboard');
app/Views/themes/public/layouts/_sitenav.php:36:                <a href="<?php echo site_url('/'); ?>" class="logo-link w-100 mt-md-1">
app/Views/themes/public/layouts/_sitenav.php:57:                            <a href="' . site_url('/Dashboard') . '" class="btn btn-primary d-md-none">
app/Views/themes/public/layouts/_sitenav.php:63:                            <a href="' . site_url('/login') . '" class="btn btn-primary d-md-none">
app/Views/themes/public/layouts/_sitenav.php:76:                    <a href="<?php echo site_url(''); ?>" class="link-to nav-link intro-nav-link">Home <?= $currentUserID; ?></a>
app/Views/themes/public/layouts/_sitenav.php:79:                    <a href="<?php echo site_url(''); ?>#features" class="link-to nav-link intro-nav-link">Features</a>
app/Views/themes/public/layouts/_sitenav.php:86:                        <a class="dropdown-item" href="<?php echo site_url('/Blog'); ?>">Blog</a>
app/Views/themes/public/layouts/_sitenav.php:87:                        <a class="dropdown-item" href="<?php echo site_url('/How-It-Works'); ?>">How It Works</a>
app/Views/themes/public/layouts/_sitenav.php:88:                        <a class="dropdown-item" href="<?php echo site_url('/Knowledgebase'); ?>">Knowledgebase</a>
app/Views/themes/public/layouts/_sitenav.php:92:                    <a href="<?php echo site_url('Support'); ?>" target="_blank" class="nav-link intro-nav-link">Support</a>
app/Views/themes/public/layouts/_sitenav.php:98:                            <a href="' . site_url('/Dashboard') . '" class="btn btn-primary">
app/Views/themes/public/layouts/_sitenav.php:104:                            <a href="' . site_url('/login') . '" class="btn btn-primary">
app/Views/themes/public/layouts/index.php:28:    <body class="nk-body npc-landing bg-white intro" data-base-url="<?= esc(rtrim(site_url('/'), '/') . '/', 'attr') ?>">
app/Views/themes/public/layouts/_sitenav-new.php:14:$btnURL = ($beta === 0) ? site_url('/Free/register') : site_url('/Beta/register');
app/Views/themes/public/layouts/_sitenav-new.php:16:$dashboardURL = site_url('/Dashboard');
app/Views/themes/public/layouts/_sitenav-new.php:17:$loginURL = site_url('/login');
app/Views/themes/public/layouts/_sitenav-new.php:20:        $btnURL = site_url('/Free/register');
app/Views/themes/public/layouts/_sitenav-new.php:22:        $btnURL = site_url('/Beta/register');
app/Views/themes/public/layouts/_sitenav-new.php:26:    $btnURL = site_url('/Dashboard');
app/Views/themes/public/layouts/_sitenav-new.php:92:                    <a href="<?php echo site_url('/'); ?>" class="logo-link w-100 mt-md-1">
app/Views/themes/public/layouts/_sitenav-new.php:113:                                <a href="' . site_url('/Dashboard') . '" class="btn btn-primary d-md-none">
app/Views/themes/public/layouts/_sitenav-new.php:119:                                <a href="' . site_url('/login') . '" class="btn btn-primary d-md-none">
app/Views/themes/public/layouts/_sitenav-new.php:132:                        <a href="<?php echo site_url(''); ?>" class="link-to nav-link intro-nav-link">Home <?= $currentUserID; ?></a>
app/Views/themes/public/layouts/_sitenav-new.php:135:                        <a href="<?php echo site_url(''); ?>#features" class="link-to nav-link intro-nav-link">Features</a>
app/Views/themes/public/layouts/_sitenav-new.php:142:                            <a class="dropdown-item" href="<?php echo site_url('/Blog'); ?>">Blog</a>
app/Views/themes/public/layouts/_sitenav-new.php:143:                            <a class="dropdown-item" href="<?php echo site_url('/How-It-Works'); ?>">How It Works</a>
app/Views/themes/public/layouts/_sitenav-new.php:144:                            <a class="dropdown-item" href="<?php echo site_url('/Knowledgebase'); ?>">Knowledgebase</a>
app/Views/themes/public/layouts/_sitenav-new.php:148:                        <a href="<?php echo site_url('Support'); ?>" class="nav-link intro-nav-link">Support</a>
app/Views/themes/public/layouts/_sitenav-new.php:154:                                <a href="' . site_url('/Dashboard') . '" class="btn btn-primary">
app/Views/themes/public/layouts/_sitenav-new.php:160:                                <a href="' . site_url('/login') . '" class="btn btn-primary">
app/Views/themes/public/layouts/_sitenav-new.php:178:                    <a href="<?php echo site_url('/'); ?>" class="logo-link w-100 mt-md-1">
app/Views/themes/public/layouts/_sitenav-new.php:199:                                <a href="' . site_url('/Dashboard') . '" class="btn btn-primary d-md-none">
app/Views/themes/public/layouts/_sitenav-new.php:205:                                <a href="' . site_url('/login') . '" class="btn btn-primary d-md-none">
app/Views/themes/public/layouts/_sitenav-new.php:218:                        <a href="<?php echo site_url(''); ?>" class="link-to nav-link intro-nav-link">Home <?= $currentUserID; ?></a>
app/Views/themes/public/layouts/_sitenav-new.php:221:                        <a href="<?php echo site_url(''); ?>#features" class="link-to nav-link intro-nav-link">Features</a>
app/Views/themes/public/layouts/_sitenav-new.php:228:                            <a class="dropdown-item" href="<?php echo site_url('/Blog'); ?>">Blog</a>
app/Views/themes/public/layouts/_sitenav-new.php:229:                            <a class="dropdown-item" href="<?php echo site_url('/How-It-Works'); ?>">How It Works</a>
app/Views/themes/public/layouts/_sitenav-new.php:230:                            <a class="dropdown-item" href="<?php echo site_url('/Knowledgebase'); ?>">Knowledgebase</a>
app/Views/themes/public/layouts/_sitenav-new.php:234:                        <a href="<?php echo site_url('Support'); ?>" class="nav-link intro-nav-link">Support</a>
app/Views/themes/public/layouts/_sitenav-new.php:240:                                <a href="' . site_url('/Dashboard') . '" class="btn btn-primary">
app/Views/themes/public/layouts/_sitenav-new.php:246:                                <a href="' . site_url('/login') . '" class="btn btn-primary">
app/Views/themes/public/layouts/metadata-information copy.php:80:            //         'task_url'              => site_url('/Management/Marketing/Page-SEO/' . $insert_id),
app/Views/themes/public/layouts/metadata-information copy.php:169:    //         'task_url'              => site_url('/Management/Marketing/Page-SEO/' . $insert_id),
app/Views/themes/public/gettingStarted.orig.php:28:                    <li class="breadcrumb-item"><a href="<?= site_url('/'); ?>">Home</a></li>
app/Views/themes/public/gettingStarted.orig.php:43:                    <li>Visit <a href="<?= site_url('/register'); ?>">MyMI Wallet Registration</a>.</li>
app/Views/themes/public/gettingStarted.orig.php:83:                <p>If you have any questions or need assistance, our support team is here to help. Visit our <a href="<?= site_url('/support'); ?>">Support Page</a> for more information.</p>
app/Views/themes/public/corporateEarnings.php:57:                    <li class="breadcrumb-item"><a href="<?= site_url('/'); ?>">Home</a></li>
app/Views/themes/public/corporateEarnings.php:142:                <a href="<?= site_url('/register'); ?>" class="btn btn-primary">Register Now</a>
app/Views/themes/public/corporateEarnings.php:149:                <a href="<?= site_url('/Promotions'); ?>" class="btn btn-success">Save More!</a>
app/Views/themes/dashboard/partials/custom-js/modals.php:28:                <a type="button" class="btn btn-primary" href="<?php echo site_url('/Exchange/Solana'); ?>">Close</a>
app/Views/themes/dashboard/partials/custom-js/tradingview.php:48:            'largeChartUrl'  => site_url('Stock/' . $exchangeName . '/' . $symbol),
app/Views/themes/dashboard/layouts/sidebar-09092024.php:52:			<a href="<?php echo site_url('/Dashboard'); ?>" class="logo-link nk-sidebar-logo pt-xl-1 pr-xl-2">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:108:                                <a href="<?php echo site_url('/Add-Wallet-Deposit'); ?>" class="btn btn-lg btn-primary"><span>Add Deposit</span></a>
app/Views/themes/dashboard/layouts/sidebar-09092024.php:111:                                <a href="<?php echo site_url('/Add-Wallet-Withdraw'); ?>" class="btn btn-lg btn-warning"><span>Add Withdraw</span></a>
app/Views/themes/dashboard/layouts/sidebar-09092024.php:140:                                    echo $MyMIGCoinSum . ' <span class="currency currency-usd">MyMI GOLD</span> <a class="currency currency-usd" href="' . site_url('/Purchase/MyMIGold') . '">Purchase</a>';
app/Views/themes/dashboard/layouts/sidebar-09092024.php:168:                                    <a href="<?php echo site_url('Wallets/Purchase/Memberships'); ?>" class="nk-menu-link" title="">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:185:                                    <a href="<?php echo site_url('MyMI-Gold/Goals/Daily'); ?>" class="nk-menu-link" title="">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:192:                                    <a href="<?php echo site_url('MyMI-Gold/Goals/Weekly'); ?>" class="nk-menu-link" title="">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:199:                                    <a href="<?php echo site_url('MyMIGold/Goals/Monthly'); ?>" class="nk-menu-link" title="">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:208:							<a href="<?php //echo site_url('/Dashboard'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:213:							<a href="<?php echo site_url('/Account'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:221:							<a href="<?php echo site_url('/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:229:							<a href="<?php echo site_url('/Budget'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:237:							<a href="<?php echo site_url('/Wallets/Debt'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:248:							<a href="<?php echo site_url('/Investments'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:259:							<a href="<?php echo site_url('/Knowledgebase'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:277:                                    <a href="<?php echo site_url('/Exchange/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:290:                                    <a href="<?php echo site_url('/Exchange/Solana/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:295:                                    <a href="<?php echo site_url('/Exchange/Solana/Create'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:302:                                    <a href="<?php echo site_url('/Management/Marketing/Promote/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:328:                                    <a href="<?php //echo site_url('/Exchange/Solana/Wallet/Verify-Ownership'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:342:							<a href="<?php echo site_url('/Knowledgebase'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:353:							<a href="<?php echo site_url('/My-Retirement'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:364:							<a href="<?php echo site_url('/My-Retirement'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:375:							<a href="<?php echo site_url('/My-Referrals'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:386:							<a href="<?php echo site_url('/MyMISports'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:397:                                    <a href="<?php echo site_url('/MyMISports/NBA'); ?>" class="nk-menu-link" data-bs-original-title="" title=""><span class="nk-menu-text">NBA Stats</span></a>
app/Views/themes/dashboard/layouts/sidebar-09092024.php:400:                                    <a href="<?php echo site_url('/MyMISports/NFL'); ?>" class="nk-menu-link" data-bs-original-title="" title=""><span class="nk-menu-text">NFL Stats</span></a>
app/Views/themes/dashboard/layouts/sidebar-09092024.php:408:							<a href="<?php echo site_url('/Wallets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:413:							<a href="<?php echo site_url('/Support'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:424:                                    <a href="<?php echo site_url('/Support'); ?>" class="nk-menu-link" data-bs-original-title="" title=""><span class="nk-menu-text">Contact Support</span></a>
app/Views/themes/dashboard/layouts/sidebar-09092024.php:427:                                    <a href="<?php echo site_url('/Knowledgebase'); ?>" class="nk-menu-link" data-bs-original-title="" title=""><span class="nk-menu-text">Knowledge Base</span></a>
app/Views/themes/dashboard/layouts/sidebar-09092024.php:438:                            <a href="<?php echo site_url('/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:443:                            <a href="<?php echo site_url('/Marketplace'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:448:                            <a href="<?php echo site_url('/Exchange'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:460:                                    <a href="<?php echo site_url('/Exchange/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:467:                                    <a href="<?php echo site_url('/Exchange/Solana/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:474:                                    <a href="<?php echo site_url('/Exchange/Solana/Create'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:480:                                    <a href="<?php echo site_url('/Exchange/Solana/Import'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:486:                                    <a href="<?php echo site_url('/Management/Marketing/Promote/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:493:                                    <a href="<?php echo site_url('/Exchange/Solana/Swap'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:499:                                    <a href="<?php //echo site_url('/Exchange/Solana/Wallet/Verify-Ownership'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:519:                            <a href="<?php echo site_url('/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:524:                            <a href="<?php echo site_url('/Marketplace'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:529:                            <a href="<?php echo site_url('/Exchange'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:542:                                    <a href="<?php echo site_url('/Exchange/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:555:                                    <a href="<?php echo site_url('/Exchange/Solana/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:560:                                    <a href="<?php echo site_url('/Exchange/Solana/Create'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:586:                                    <a href="<?php //echo site_url('/Exchange/Solana/Wallet/Verify-Ownership'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:601:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Admin'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:611:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Alerts'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:616:							<a class="nk-menu-link" href="<?php echo site_url('/Management/API'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:621:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Assets'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:626:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Budgeting'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:631:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Budgets'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:636:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Content-Creator'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:641:							<a href="<?php echo site_url('Management/Exchange'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:646:							<a href="<?php //echo site_url('Management/Investment'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:651:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:663:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:668:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Schedule'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:675:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Promote/Solana'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:681:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Content/Generator'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:686:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Content/Listing'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:691:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Blog-Creator'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:696:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Post-Creator'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:701:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Video-Creator'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:708:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Partners'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:713:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Security'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:718:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Services'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:723:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Users'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:728:							<a href="<?php echo site_url('/Management/Wallets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:741:							<a href="<?php echo site_url('/Exchange'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:749:							<a href="<?php echo site_url('/Exchange/Personal-Information/' . $cuID); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:765:							<a href="<?php echo site_url('/Announcements'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09092024.php:797:							<a href="<?php echo site_url('Support'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:52:			<a href="<?php echo site_url('/Dashboard'); ?>" class="logo-link nk-sidebar-logo pt-xl-1 pr-xl-2">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:93:                                echo $MyMIGCoinSum . ' <span class="currency currency-usd">MyMI Gold</span> <a class="currency currency-usd" href="' . site_url('/Wallets/Purchase/MyMIGold') . '">Purchase</a>';
app/Views/themes/dashboard/layouts/sidebar-05172024.php:107:                                <a href="<?php echo site_url('/Add-Wallet-Deposit'); ?>" class="btn btn-lg btn-primary"><span>Add Deposit</span></a>
app/Views/themes/dashboard/layouts/sidebar-05172024.php:110:                                <a href="<?php echo site_url('/Add-Wallet-Withdraw'); ?>" class="btn btn-lg btn-warning"><span>Add Withdraw</span></a>
app/Views/themes/dashboard/layouts/sidebar-05172024.php:139:                                    echo $MyMIGCoinSum . ' <span class="currency currency-usd">MyMI GOLD</span> <a class="currency currency-usd" href="' . site_url('/Purchase/MyMIGold') . '">Purchase</a>';
app/Views/themes/dashboard/layouts/sidebar-05172024.php:154:							<a href="<?php //echo site_url('/Dashboard'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:159:							<a href="<?php echo site_url('/Account'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:167:							<a href="<?php echo site_url('/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:175:							<a href="<?php echo site_url('/Budget'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:183:							<a href="<?php echo site_url('/Wallets/Debt'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:194:							<a href="<?php echo site_url('/Investments'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:205:							<a href="<?php echo site_url('/Knowledgebase'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:216:							<a href="<?php echo site_url('/My-Marketplace'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:227:							<a href="<?php echo site_url('/Knowledgebase'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:238:							<a href="<?php echo site_url('/My-Retirement'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:249:							<a href="<?php echo site_url('/My-Retirement'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:260:							<a href="<?php echo site_url('/My-Referrals'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:271:							<a href="<?php echo site_url('/MyMISports'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:282:                                    <a href="<?php echo site_url('/MyMISports/NBA'); ?>" class="nk-menu-link" data-bs-original-title="" title=""><span class="nk-menu-text">NBA Stats</span></a>
app/Views/themes/dashboard/layouts/sidebar-05172024.php:285:                                    <a href="<?php echo site_url('/MyMISports/NFL'); ?>" class="nk-menu-link" data-bs-original-title="" title=""><span class="nk-menu-text">NFL Stats</span></a>
app/Views/themes/dashboard/layouts/sidebar-05172024.php:293:							<a href="<?php echo site_url('/Wallets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:298:							<a href="<?php echo site_url('/Support'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:313:                                    <a href="<?php echo site_url('Wallets/Purchase/Memberships'); ?>" class="nk-menu-link" title=""><span class="nk-menu-text">Memberships</span></a>
app/Views/themes/dashboard/layouts/sidebar-05172024.php:318:                                    <a href="<?php echo site_url('MyMI-Gold/Goals/Daily'); ?>" class="nk-menu-link" title=""><span class="nk-menu-text">Daily - 0 Free Left</span></a>
app/Views/themes/dashboard/layouts/sidebar-05172024.php:323:                                    <a href="<?php echo site_url('MyMI-Gold/Goals/Weekly'); ?>" class="nk-menu-link" title=""><span class="nk-menu-text">Weekly - 0 Free Left</span></a>
app/Views/themes/dashboard/layouts/sidebar-05172024.php:328:                                    <a href="<?php echo site_url('MyMIGold/Goals/Monthly'); ?>" class="nk-menu-link" title=""><span class="nk-menu-text">Monthly - 0 Free Left</span></a>
app/Views/themes/dashboard/layouts/sidebar-05172024.php:341:                                    <a href="<?php echo site_url('/Support'); ?>" class="nk-menu-link" data-bs-original-title="" title=""><span class="nk-menu-text">Contact Support</span></a>
app/Views/themes/dashboard/layouts/sidebar-05172024.php:344:                                    <a href="<?php echo site_url('/Knowledgebase'); ?>" class="nk-menu-link" data-bs-original-title="" title=""><span class="nk-menu-text">Knowledge Base</span></a>
app/Views/themes/dashboard/layouts/sidebar-05172024.php:355:							<a href="<?php echo site_url('/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:360:							<a href="<?php echo site_url('/Marketplace'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:365:							<a href="<?php echo site_url('/Exchange'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:381:							<a class="nk-menu-link" href="<?php echo site_url('/Management'); ?>">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:391:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Alerts'); ?>">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:396:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Assets'); ?>">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:401:							<a class="nk-menu-link" href="<?php echo site_url('/Content-Creator'); ?>">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:406:							<a href="<?php echo site_url('Management/Exchange'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:411:							<a href="<?php //echo site_url('Management/Investment'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:416:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing'); ?>">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:421:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Partners'); ?>">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:426:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Services'); ?>">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:431:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Services'); ?>">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:436:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Users'); ?>">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:441:							<a href="<?php echo site_url('/Management/Wallets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:454:							<a href="<?php echo site_url('/Exchange'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:462:							<a href="<?php echo site_url('/Exchange/Personal-Information/' . $cuID); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:480:							<a href="<?php echo site_url('/Announcements'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-05172024.php:512:							<a href="<?php echo site_url('Support'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:56:			<a href="<?php echo site_url('/Dashboard'); ?>" class="logo-link nk-sidebar-logo pt-xl-1 pr-xl-2">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:114:                                <a href="<?php echo site_url('/Add-Wallet-Deposit'); ?>" class="btn btn-lg btn-primary"><span>Add Deposit</span></a>
app/Views/themes/dashboard/layouts/sidebar-09012025.php:117:                                <a href="<?php echo site_url('/Add-Wallet-Withdraw'); ?>" class="btn btn-lg btn-warning"><span>Add Withdraw</span></a>
app/Views/themes/dashboard/layouts/sidebar-09012025.php:148:                                    echo $MyMIGCoinSum . ' <span class="currency currency-usd">MyMI GOLD</span> <a class="currency currency-usd" href="' . site_url('/Purchase/MyMIGold') . '">Purchase</a>';
app/Views/themes/dashboard/layouts/sidebar-09012025.php:176:                                    <a href="<?php echo site_url('Wallets/Purchase/Memberships'); ?>" class="nk-menu-link" title="">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:194:                                    <a href="<?php echo site_url('MyMI-Gold/Goals/Daily'); ?>" class="nk-menu-link" title="">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:201:                                    <a href="<?php echo site_url('MyMI-Gold/Goals/Weekly'); ?>" class="nk-menu-link" title="">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:208:                                    <a href="<?php echo site_url('MyMIGold/Goals/Monthly'); ?>" class="nk-menu-link" title="">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:217:							<a href="<?php //echo site_url('/Dashboard'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:228:                                    <a class="nk-menu-link" href="<?php echo site_url('/Account'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:233:                                    <a class="nk-menu-link" href="<?php echo site_url('/Account/Billing'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:238:                                    <a class="nk-menu-link" href="<?php echo site_url('/Account/Connected-Accounts'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:243:                                    <a class="nk-menu-link" href="<?php echo site_url('/Account/Notifications'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:248:                                    <a class="nk-menu-link" href="<?php echo site_url('/Account/Security'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:253:                                    <a class="nk-menu-link" href="<?php echo site_url('/Account/Social-Media'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:258:                                    <a class="nk-menu-link" href="<?php echo site_url('/logout'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:269:							<a href="<?php echo site_url('/Alerts'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:280:							<a href="<?php echo site_url('/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:288:							<a href="<?php echo site_url('/Budget'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:296:							<a href="<?php echo site_url('/Wallets/Debt'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:307:							<a href="<?php echo site_url('/Exchange/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:318:                                    <a href="<?php echo site_url('/Exchange/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:331:                                            <a href="<?php echo site_url('/Exchange/Solana/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:336:                                            <a href="<?php echo site_url('/Exchange/Solana/Create'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:343:                                            <a href="<?php echo site_url('/Management/Marketing/Promote/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:374:							<a href="<?php echo site_url('/Investments'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:385:							<a href="<?php echo site_url('/Knowledgebase'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:405:                                    <a href="<?php echo site_url('/Exchange/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:418:                                            <a href="<?php echo site_url('/Exchange/Solana/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:423:                                            <a href="<?php echo site_url('/Exchange/Solana/Create'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:430:                                            <a href="<?php echo site_url('/Management/Marketing/Promote/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:466:							<a href="<?php echo site_url('/Knowledgebase'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:477:							<a href="<?php echo site_url('/My-Retirement'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:488:							<a href="<?php echo site_url('/Projects'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:499:							<a href="<?php echo site_url('/My-Retirement'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:510:							<a href="<?php echo site_url('/My-Referrals'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:521:							<a href="<?php echo site_url('/MyMISports'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:532:                                    <a href="<?php echo site_url('/MyMISports/NBA'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:537:                                    <a href="<?php echo site_url('/MyMISports/NFL'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:547:							<a href="<?php echo site_url('/Wallets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:552:							<a href="<?php echo site_url('/Support'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:563:                                    <a href="<?php echo site_url('/Support'); ?>" class="nk-menu-link" data-bs-original-title="" title=""><span class="nk-menu-text">Contact Support</span></a>
app/Views/themes/dashboard/layouts/sidebar-09012025.php:566:                                    <a href="<?php echo site_url('/Knowledgebase'); ?>" class="nk-menu-link" data-bs-original-title="" title=""><span class="nk-menu-text">Knowledge Base</span></a>
app/Views/themes/dashboard/layouts/sidebar-09012025.php:577:                            <a href="<?php echo site_url('/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:583:                            <a href="<?php echo site_url('/Marketplace'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:589:                            <a href="<?php echo site_url('/Exchange'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:603:                                        <a href="<?php echo site_url('/Exchange/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:618:                                                <a href="<?php echo site_url('/Exchange/Solana/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:624:                                                <a href="<?php echo site_url('/Exchange/Solana/Create'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:670:                            <a href="<?php echo site_url('/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:676:                            <a href="<?php echo site_url('/Marketplace'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:682:                            <a href="<?php echo site_url('/Exchange'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:696:                                        <a href="<?php echo site_url('/Exchange/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:711:                                                <a href="<?php echo site_url('/Exchange/Solana/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:717:                                                <a href="<?php echo site_url('/Exchange/Solana/Create'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:757:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Admin'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:767:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Alerts'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:772:							<a class="nk-menu-link" href="<?php echo site_url('/Management/API'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:777:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Assets'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:782:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Budgeting'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:787:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Budgets'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:792:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Content-Creator'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:797:							<a href="<?php echo site_url('Management/Exchange'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:802:							<a href="<?php //echo site_url('Management/Investment'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:807:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:819:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:824:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Campaigns'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:829:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Ideas'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:834:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Schedule'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:841:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Promote/Solana'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:847:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Content/Generator'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:852:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Content/Listing'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:857:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Blog-Creator'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:862:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Post-Creator'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:867:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Video-Creator'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:874:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Partners'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:879:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Security'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:884:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Services'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:889:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Users'); ?>">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:894:							<a href="<?php echo site_url('/Management/Wallets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:907:							<a href="<?php echo site_url('/Exchange'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:915:							<a href="<?php echo site_url('/Exchange/Personal-Information/' . $cuID); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:931:							<a href="<?php echo site_url('/Announcements'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar-09012025.php:963:							<a href="<?php echo site_url('Support'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/footer.php:144:                        <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Budget'); ?>">My Budget</a></li>
app/Views/themes/dashboard/layouts/footer.php:145:                        <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Budget/Financial-Analysis'); ?>">My History</a></li>
app/Views/themes/dashboard/layouts/footer.php:146:                        <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Budget/Financial-Forecaster'); ?>">My Forecast</a></li>
app/Views/themes/dashboard/layouts/footer.php:147:                        <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Budget/Financial-Institute'); ?>">My Institutes</a></li>
app/Views/themes/dashboard/layouts/footer.php:148:                        <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Budget/Financial-Advisors'); ?>">My Sponsors</a></li>
app/Views/themes/dashboard/layouts/footer.php:154:                        <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Investments'); ?>">My Investments</a></li>
app/Views/themes/dashboard/layouts/footer.php:155:                        <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Trade-Tracker'); ?>">MyMI Trade Tracker</a></li>
app/Views/themes/dashboard/layouts/footer.php:156:                        <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Investments/News'); ?>">Market News</a></li>
app/Views/themes/dashboard/layouts/footer.php:157:                        <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Investments/Reports'); ?>">My Reports</a></li>
app/Views/themes/dashboard/layouts/footer.php:158:                        <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Investments/Watchlist'); ?>">My Watchlist</a></li>
app/Views/themes/dashboard/layouts/footer.php:164:                        <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Exchange/Solana'); ?>">Exchange</a></li>
app/Views/themes/dashboard/layouts/footer.php:168:                            <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Exchange/Solana/Assets'); ?>">Assets</a></li>
app/Views/themes/dashboard/layouts/footer.php:169:                            <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Exchange/Solana/Create'); ?>">Create</a></li>
app/Views/themes/dashboard/layouts/footer.php:183:                        <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Privacy-Policy'); ?>">Privacy Policy</a></li>
app/Views/themes/dashboard/layouts/footer.php:184:                        <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Terms-Of-Service'); ?>">Terms of Service</a></li>
app/Views/themes/dashboard/layouts/footer.php:190:                        <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Customer-Support'); ?>">Contact Us</a></li>
app/Views/themes/dashboard/layouts/footer.php:191:                        <li class="mb-1"><a class="text-sm reset-anchor" href="<?php echo site_url('/Knowledgebase'); ?>">Knowledgebase</a></li>
app/Views/themes/dashboard/layouts/metadata-information.php:97:                    'task_url'              => site_url('/Management/Marketing/Page-SEO/' . $insert_id),
app/Views/themes/dashboard/layouts/custom-js.php:160:                $.get('<?= site_url("/search"); ?>', { q: keyword }, function(data) {
app/Views/themes/dashboard/layouts/custom-js copy.php:152:                $.get('<?php echo site_url("/search"); ?>', { q: keyword }, function(data) {
app/Views/themes/dashboard/layouts/_sitenav.php:34:                <a href="<?php echo site_url('/Dashboard'); ?>" class="logo-link">
app/Views/themes/dashboard/layouts/_sitenav.php:53:                        <a href="<?php echo site_url('/Support'); ?>" class="btn btn-md btn-primary text-white">
app/Views/themes/dashboard/layouts/_sitenav.php:61:                            action="<?= site_url('Search'); ?>"
app/Views/themes/dashboard/layouts/_sitenav.php:106:                                    <li><a href="<?php echo site_url('/Profile/' . ($cuUsername ?? 0)); ?>"><em class="icon ni ni-user-alt"></em><span>View Profile</span></a></li>
app/Views/themes/dashboard/layouts/_sitenav.php:107:                                    <li><a href="<?php echo site_url('/Account'); ?>"><em class="icon ni ni-setting-alt"></em><span>Account Settings</span></a></li>
app/Views/themes/dashboard/layouts/_sitenav.php:108:                                    <li><a href="<?php echo site_url('/Account/Activity'); ?>"><em class="icon ni ni-activity-alt"></em><span>Login Activity</span></a></li>
app/Views/themes/dashboard/layouts/_sitenav.php:110:                                    <li><a href="<?php echo site_url('/Account/Activity'); ?>"><em class="icon ni ni-help"></em><span>Contact Support</span></a></li>
app/Views/themes/dashboard/layouts/_sitenav.php:115:                                    <li><a href="<?php echo site_url('/logout'); ?>"><em class="icon ni ni-signout"></em><span>Sign out</span></a></li>
app/Views/themes/dashboard/layouts/index.php:39:    <body class="nk-body npc-landing bg-white intro" data-base-url="<?= esc(rtrim(site_url('/'), '/') . '/', 'attr') ?>">
app/Views/themes/dashboard/layouts/sidebar.php:53:			<a href="<?php echo site_url('/Dashboard'); ?>" class="logo-link nk-sidebar-logo pt-xl-1 pr-xl-2">
app/Views/themes/dashboard/layouts/sidebar.php:101:                                <a href="<?php echo site_url('/Add-Wallet-Deposit'); ?>" class="btn btn-lg btn-primary"><span>Add Deposit</span></a>
app/Views/themes/dashboard/layouts/sidebar.php:104:                                <a href="<?php echo site_url('/Add-Wallet-Withdraw'); ?>" class="btn btn-lg btn-warning"><span>Add Withdraw</span></a>
app/Views/themes/dashboard/layouts/sidebar.php:134:                                      <?= esc($MyMIGCoinSum); ?> <span class="currency currency-usd">MyMI GOLD</span> <a class="currency currency-usd" href="<?= site_url('/Purchase/MyMIGold'); ?>">Purchase</a>
app/Views/themes/dashboard/layouts/sidebar.php:162:                                    <a href="<?php echo site_url('Wallets/Purchase/Memberships'); ?>" class="nk-menu-link" title="">
app/Views/themes/dashboard/layouts/sidebar.php:180:                                    <a href="<?php echo site_url('MyMI-Gold/Goals/Daily'); ?>" class="nk-menu-link" title="">
app/Views/themes/dashboard/layouts/sidebar.php:187:                                    <a href="<?php echo site_url('MyMI-Gold/Goals/Weekly'); ?>" class="nk-menu-link" title="">
app/Views/themes/dashboard/layouts/sidebar.php:194:                                    <a href="<?php echo site_url('MyMIGold/Goals/Monthly'); ?>" class="nk-menu-link" title="">
app/Views/themes/dashboard/layouts/sidebar.php:203:							<a href="<?php //echo site_url('/Dashboard'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:214:                                    <a class="nk-menu-link" href="<?php echo site_url('/Account'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:219:                                    <a class="nk-menu-link" href="<?php echo site_url('/Account/Billing'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:224:                                    <a class="nk-menu-link" href="<?php echo site_url('/Account/Connected-Accounts'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:229:                                    <a class="nk-menu-link" href="<?php echo site_url('/Account/Notifications'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:234:                                    <a class="nk-menu-link" href="<?php echo site_url('/Account/Security'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:239:                                    <a class="nk-menu-link" href="<?php echo site_url('/Account/Social-Media'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:244:                                    <a class="nk-menu-link" href="<?php echo site_url('/logout'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:255:							<a href="<?php echo site_url('/Alerts'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:266:							<a href="<?php echo site_url('/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:274:							<a href="<?php echo site_url('/Budget'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:282:							<a href="<?php echo site_url('/Wallets/Debt'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:293:							<a href="<?php echo site_url('/Exchange/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:304:                                    <a href="<?php echo site_url('/Exchange/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:317:                                            <a href="<?php echo site_url('/Exchange/Solana/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:322:                                            <a href="<?php echo site_url('/Exchange/Solana/Create'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:329:                                            <a href="<?php echo site_url('/Management/Marketing/Promote/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:360:							<a href="<?php echo site_url('/Investments'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:371:							<a href="<?php echo site_url('/Knowledgebase'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:391:                                    <a href="<?php echo site_url('/Exchange/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:404:                                            <a href="<?php echo site_url('/Exchange/Solana/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:409:                                            <a href="<?php echo site_url('/Exchange/Solana/Create'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:416:                                            <a href="<?php echo site_url('/Management/Marketing/Promote/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:452:							<a href="<?php echo site_url('/Knowledgebase'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:463:							<a href="<?php echo site_url('/My-Retirement'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:474:							<a href="<?php echo site_url('/Projects'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:485:							<a href="<?php echo site_url('/My-Retirement'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:496:							<a href="<?php echo site_url('/My-Referrals'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:507:							<a href="<?php echo site_url('/MyMISports'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:518:                                    <a href="<?php echo site_url('/MyMISports/NBA'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:523:                                    <a href="<?php echo site_url('/MyMISports/NFL'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:533:							<a href="<?php echo site_url('/Wallets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:538:							<a href="<?php echo site_url('/Support'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:549:                                    <a href="<?php echo site_url('/Support'); ?>" class="nk-menu-link" data-bs-original-title="" title=""><span class="nk-menu-text">Contact Support</span></a>
app/Views/themes/dashboard/layouts/sidebar.php:552:                                    <a href="<?php echo site_url('/Knowledgebase'); ?>" class="nk-menu-link" data-bs-original-title="" title=""><span class="nk-menu-text">Knowledge Base</span></a>
app/Views/themes/dashboard/layouts/sidebar.php:563:                            <a href="<?php echo site_url('/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:569:                            <a href="<?php echo site_url('/Marketplace'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:575:                            <a href="<?php echo site_url('/Exchange'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:589:                                        <a href="<?php echo site_url('/Exchange/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:604:                                                <a href="<?php echo site_url('/Exchange/Solana/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:610:                                                <a href="<?php echo site_url('/Exchange/Solana/Create'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:656:                            <a href="<?php echo site_url('/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:662:                            <a href="<?php echo site_url('/Marketplace'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:668:                            <a href="<?php echo site_url('/Exchange'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:682:                                        <a href="<?php echo site_url('/Exchange/Solana'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:697:                                                <a href="<?php echo site_url('/Exchange/Solana/Assets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:703:                                                <a href="<?php echo site_url('/Exchange/Solana/Create'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:743:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Admin'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:753:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Alerts'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:758:							<a class="nk-menu-link" href="<?php echo site_url('/Management/API'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:763:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Assets'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:768:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Budgeting'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:773:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Budgets'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:778:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Content-Creator'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:783:							<a href="<?php echo site_url('Management/Exchange'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:788:							<a href="<?php //echo site_url('Management/Investment'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:793:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:805:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:810:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Campaigns'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:815:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Ideas'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:820:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Schedule'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:827:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Promote/Solana'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:833:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Content/Generator'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:838:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Content/Listing'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:843:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Blog-Creator'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:848:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Post-Creator'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:853:                                    <a class="nk-menu-link" href="<?php echo site_url('/Management/Marketing/Video-Creator'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:860:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Partners'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:865:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Projects'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:870:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Security'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:875:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Services'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:880:							<a class="nk-menu-link" href="<?php echo site_url('/Management/Users'); ?>">
app/Views/themes/dashboard/layouts/sidebar.php:885:							<a href="<?php echo site_url('/Management/Wallets'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:898:							<a href="<?php echo site_url('/Exchange'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:906:							<a href="<?php echo site_url('/Exchange/Personal-Information/' . $cuID); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:922:							<a href="<?php echo site_url('/Announcements'); ?>" class="nk-menu-link">
app/Views/themes/dashboard/layouts/sidebar.php:954:							<a href="<?php echo site_url('Support'); ?>" class="nk-menu-link">
app/Controllers/AuthController_old.php:130:        return redirect()->to(site_url('/'));
app/Controllers/AuthControllerCustom.php:120:        $_SESSION['redirect_url'] = session('redirect_url') ?? previous_url() ?? site_url('/');
app/Controllers/AuthControllerCustom.php:160:            $resetUrl = site_url('forgot-password');
app/Controllers/AuthControllerCustom.php:190:        return redirect()->to(site_url('/'));
app/Commands/Sitemap.php:16:            site_url('/'),
app/Commands/Sitemap.php:17:            site_url('/Docs'),
app/Models/WalletModel.php:1544:            'redirectURL'      => $this->toStr(site_url('/Wallets')),
app/Models/EmailModel.php:264:        $data['unsubscribe_link'] = site_url('API/Email/unsubscribe/' . $unsubscribeToken);
app/Language/en/Auth.php:37:    'invalidPassword' => 'Unable to log you in. Please check your password or reset it by visting the following link: <a href="' . site_url('/reset-password') . '">Reset Password</a>',
app/Services/DripCampaignService.php:77:            'unsubscribe_link' => site_url("API/Email/unsubscribe/" . base64_encode("user:{$userId}")),
app/Services/DripCampaignService.php:172:            'unsubscribe_link' => site_url("API/Email/unsubscribe/" . base64_encode("user:{$userId}")),
app/Services/EmailService.php:49:            $unsubscribeLink = site_url('API/Email/unsubscribe/' . $unsubscribeToken);
app/Services/SearchService.php:48:                $results[] = new SearchResult('asset',(int)$r['id'],$title,$this->snippet($title,$needle),site_url('/Assets/view/'.$r['id']),(float)($r['score']??0),(string)($r['created_at']??null));
app/Services/SearchService.php:57:                $results[] = new SearchResult('post',(int)$r['id'],(string)$r['title'],$this->snippet($r['body']??'', $needle),site_url('/Blog/post/'.$r['id']),(float)($r['score']??0),(string)($r['created_at']??null));
app/Services/SearchService.php:68:                $results[] = new SearchResult('alert',(int)$r['id'],$title,$this->snippet($r['notes']??'', $needle),site_url('/Alerts/view/'.$r['id']),(float)($r['score']??0),(string)($r['created_at']??null));
app/Services/ReferralService.php:419:                'referral_link' => site_url('/Referral/Register/' . $referrerCode),
app/Helpers/url_safe_helper.php:7:        return site_url($uri ?? '', $protocol);
app/Libraries/MyMIMarketing-06162025.php:140:            'url' => site_url('/Management/Marketing/Page-SEO/' . $task_info['seo_id']),
app/Libraries/MyMIMarketing-06162025.php:500:            'link' => site_url('Blog/View/' . url_title($campaign['name'], '-', true)),
app/Libraries/MyMIMarketing-06162025.php:1032:                 . site_url('Marketing/PreviewGeneratedPost/' . $post['id']);
app/Libraries/MyMIMarketing-06162025.php:2003:        return site_url('Management/Marketing/Email/' . $safeSubject . '/' . md5($emailIdentifier));
app/Libraries/MyMIMarketing-06162025.php:4050:            'facebook_message' => "$summary\n\nðŸš€ Get started today with MyMI Wallet.\nðŸ‘‰ " . site_url("register") . "\n\n$hashtags",
app/Libraries/MyMIMarketing-06162025.php:4051:            'linkedin_message' => "$summary\n\nExplore MyMIâ€™s smart finance tools for budgeting, investing, and crypto.\nJoin the revolution: " . site_url("LinkedIn/register"),
app/Libraries/MyMIMarketing-06162025.php:4052:            'discord_message' => "ðŸ’¬ Join the conversation in the MyMI Discord!\n$summary\n" . site_url("Discord/join"),
app/Libraries/MyMIMarketing-06162025.php:4053:            'email_message' => "Subject: Your Journey to Financial Independence Starts Here\n\n$summary\n\nReady to take action? Click below:\n" . site_url("Email/register"),
app/Libraries/MyMIMarketing-06162025.php:4055:            'tiktok_message' => "ðŸŽ¥ Start fresh in 2025! MyMI Wallet helps you master money and investing.\n$hashtags\nðŸ‘‰ " . site_url("TikTok/register"),
app/Libraries/MyMIMarketing-06162025.php:4262:                'facebook' => $summary . "\n\n" . site_url('register') . "\n" . $hashtags,
app/Libraries/MyMIMarketing-06162025.php:4467:        return site_url('API/Marketing/downloadVoiceover/' . basename($filePath));
app/Libraries/MyMIMarketing-05122025.php:133:            'url' => site_url('/Management/Marketing/Page-SEO/' . $task_info['seo_id']),
app/Libraries/MyMIMarketing-05122025.php:329:            'link' => site_url('Blog/View/' . url_title($campaign['name'], '-', true)),
app/Libraries/MyMIMarketing-05122025.php:732:                 . site_url('Marketing/PreviewGeneratedPost/' . $post['id']);
app/Libraries/MyMIMarketing-05122025.php:1580:        return site_url('Management/Marketing/Email/' . $safeSubject . '/' . md5($emailIdentifier));
app/Libraries/MyMIMarketing.php:162:            'url' => site_url('/Management/Marketing/Page-SEO/' . $task_info['seo_id']),
app/Libraries/MyMIMarketing.php:524:            'link' => site_url('Blog/View/' . url_title($campaign['name'], '-', true)),
app/Libraries/MyMIMarketing.php:1156:                 . site_url('Marketing/PreviewGeneratedPost/' . $post['id']);
app/Libraries/MyMIMarketing.php:2214:        return site_url('Management/Marketing/Email/' . $safeSubject . '/' . md5($emailIdentifier));
app/Libraries/MyMIMarketing.php:4991:            'facebook_message' => "$summary\n\nðŸš€ Get started today with MyMI Wallet.\nðŸ‘‰ " . site_url("register") . "\n\n$hashtags",
app/Libraries/MyMIMarketing.php:4992:            'linkedin_message' => "$summary\n\nExplore MyMIâ€™s smart finance tools for budgeting, investing, and crypto.\nJoin the revolution: " . site_url("LinkedIn/register"),
app/Libraries/MyMIMarketing.php:4993:            'discord_message' => "ðŸ’¬ Join the conversation in the MyMI Discord!\n$summary\n" . site_url("Discord/join"),
app/Libraries/MyMIMarketing.php:4994:            'email_message' => "Subject: Your Journey to Financial Independence Starts Here\n\n$summary\n\nReady to take action? Click below:\n" . site_url("Email/register"),
app/Libraries/MyMIMarketing.php:4996:            'tiktok_message' => "ðŸŽ¥ Start fresh in 2025! MyMI Wallet helps you master money and investing.\n$hashtags\nðŸ‘‰ " . site_url("TikTok/register"),
app/Libraries/MyMIMarketing.php:5203:                'facebook' => $summary . "\n\n" . site_url('register') . "\n" . $hashtags,
app/Libraries/MyMIMarketing.php:5419:        return site_url('API/Marketing/downloadVoiceover/' . basename($filePath));
app/Libraries/test.txt:2804:                return redirect()->to(site_url('Management/Marketing/Exchanges/Edit/' . $id));
app/Libraries/test.txt:2814:            'redirectURL' => site_url('Management/Marketing/Exchanges'),
app/Libraries/test.txt:3164:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Libraries/test.txt:3573:            return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Libraries/test.txt:3792:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Libraries/test.txt:4357:            'url' => site_url('/Management/Marketing/Page-SEO/' . $task_info['seo_id']),
app/Libraries/test.txt:4553:            'link' => site_url('Blog/View/' . url_title($campaign['name'], '-', true)),
app/Libraries/test.txt:4956:                 . site_url('Marketing/PreviewGeneratedPost/' . $post['id']);
app/Libraries/test.txt:5791:        return site_url('Management/Marketing/Email/' . $safeSubject . '/' . md5($emailIdentifier));
app/Libraries/test.txt:9298:    fetch('<?= site_url("/API/Management/updateInsight") ?>', {
app/Libraries/test.txt:9323:    fetch('<?= site_url('/API/Marketing/generateLivePreview') ?>', {
app/Libraries/test.txt:9418:        <a href="<?= site_url('API/Management/exportGroupedSummariesCSV') ?>" class="btn btn-sm btn-outline-secondary">ðŸ“ Export CSV</a>
app/Libraries/test.txt:9419:        <a href="<?= site_url('API/Management/shareGroupedSummaries/discord') ?>" class="btn btn-sm btn-outline-primary">ðŸ“¤ Share to Discord</a>
app/Libraries/test.txt:9420:        <a href="<?= site_url('API/Management/shareGroupedSummaries/linkedin') ?>" class="btn btn-sm btn-outline-info">ðŸ“¤ Share to LinkedIn</a>
app/Libraries/test.txt:9436:                            <a href="<?= site_url('Marketing/PreviewGeneratedPost/' . $summary['id']) ?>" class="btn btn-sm btn-outline-primary" target="_blank">Preview</a>
app/Libraries/test.txt:9569:                        <button class="btn btn-primary btn-sm" onclick='dynamicModalLoader("ðŸ“‹ Preview Generated Post", "<?= site_url('Management/Marketing/previewGeneratedPost/' . $post->id) ?>", "modal-lg")'>ðŸ“‹ Preview</button>
app/Libraries/test.txt:9635:                            <a href="javascript:void(0);" onclick="dynamicModalLoader('<?= site_url('/Management/Marketing/previewGeneratedPost/' . $id) ?>')" class="btn btn-primary btn-sm mt-auto">ðŸ” Preview Post</a>
app/Libraries/test.txt:9691:    fetch('<?= site_url("API/Marketing/getTopKeywordChart/SUMMARY_ID_HERE") ?>')
app/Libraries/test.txt:9783:        const response = await fetch('<?=site_url('/API/Marketing/fetchGeneratedSummariesJson')?>');
app/Libraries/test.txt:9861:    previewBtn.onclick = () => dynamicModalLoader('<?php echo site_url('/Management/Marketing/previewGeneratedPost'); ?>' + summary.id);
app/Libraries/test.txt:9966:                    <a href="<?= site_url('/Management'); ?>">â† Back to Management Dashboard</a>
app/Libraries/test.txt:10060:        fetch("<?= site_url('Marketing/fetchGeneratedSummariesBlock') ?>", {
app/Libraries/test.txt:10092:            <a class="btn btn-warning" href="<?= site_url('API/Management/triggerBackfill'); ?>">
app/Libraries/test.txt:10095:            <a href="<?= site_url('Management/Marketing/View-Grouped-Summaries') ?>" class="btn btn-outline-info">
app/Libraries/test.txt:10098:            <a href="<?= site_url('API/Marketing/publishGroupedContentDraft') ?>" 
app/Libraries/test.txt:10127:            const response = await fetch("<?= site_url('API/Marketing/generateDailyContentDigest') ?>");
app/Libraries/test.txt:10152:                const response = await fetch("<?= site_url('API/Marketing/generateContentFromScraper') ?>");
app/Libraries/test.txt:10177:            const response = await fetch("<?= site_url('API/Marketing/massResendActivationEmails') ?>", {
app/Libraries/test.txt:10207:            const response = await fetch("<?= site_url('API/Marketing/reprocessIncompleteEmails') ?>");
app/Libraries/test.txt:10221:            const response = await fetch(`<?= site_url('API/Management/approveBufferItem/') ?>${id}`, {
app/Libraries/test.txt:10237:        window.open("<?= site_url('API/Management/exportBufferPosts') ?>", '_blank');
app/Libraries/test.txt:10245:            const res = await fetch("<?= site_url('API/Marketing/previewPendingSummaries') ?>");
app/Libraries/test.txt:10257:            const response = await fetch(`<?= site_url('API/Management/rejectBufferItem/') ?>${id}`, {
app/Modules/APIs/Controllers/EmailController.php:246:                    $unsubscribeLink = site_url('API/Email/unsubscribe/' . $unsubscribeToken);
app/Modules/APIs/Controllers/EmailController.php:307:            $unsubscribeLink = site_url('API/Email/unsubscribe/' . $unsubscribeToken);
app/Modules/APIs/Controllers/ManagementController.php:153:                'id'            => '<a href="' . site_url('Management/Users/Profile/' . $user['username']) . '">' . $user['id'] . '</a>',
app/Modules/APIs/Controllers/ManagementController.php:196:                'id'            => '<a href="' . site_url('Management/Users/Profile/' . $user['username']) . '">' . $user['id'] . '</a>',
app/Modules/APIs/Controllers/DoorDashController.php:68:        $redirectUri = urlencode(site_url('Account/Connect/DoorDash/Callback'));
app/Modules/APIs/Controllers/DoorDashController.php:84:        $redirectUri                = site_url('Account/Connect/DoorDash/Callback');
app/Modules/Template/Views/Dashboard_Template.php:75:                                    <a href="<?php echo site_url('Budget/Income'); ?>">Income Accounts</a> 
app/Modules/Template/Views/Dashboard_Template.php:79:                                        <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/Template/Views/Dashboard_Template.php:84:                            <a href="<?php echo site_url('Budget/Income'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Template/Views/Dashboard_Template.php:95:                                    <a href="<?php echo site_url('Budget/Expenses'); ?>">Expense Accounts</a> 
app/Modules/Template/Views/Dashboard_Template.php:99:                                        <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/Template/Views/Dashboard_Template.php:104:                            <a href="<?php echo site_url('Budget/Expenses'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Template/Views/Dashboard_Template.php:115:                                    <a href="<?php echo site_url('Wallets/Checking'); ?>">Checking Accounts</a> 
app/Modules/Template/Views/Dashboard_Template.php:118:                                        <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/Template/Views/Dashboard_Template.php:123:                            <a href="<?php echo site_url('/Wallets/Checking'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Template/Views/Dashboard_Template.php:133:                                    <a href="<?php echo site_url('/Wallets/Credit'); ?>">Credit</a> 
app/Modules/Template/Views/Dashboard_Template.php:136:                                        <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/Template/Views/Dashboard_Template.php:141:                            <a href="<?php echo site_url('/Wallets/Credit'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Template/Views/Dashboard_Template.php:151:                                    <a href="<?php echo site_url('/Wallets/Debt'); ?>">Debt</a> 
app/Modules/Template/Views/Dashboard_Template.php:154:                                        <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/Template/Views/Dashboard_Template.php:159:                            <a href="<?php echo site_url('/Wallets/Debt'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Template/Views/Dashboard_Template.php:170:                                    <!-- <a href="<?php echo site_url('/Wallets/Investments'); ?>">Investments</a>  -->
app/Modules/Template/Views/Dashboard_Template.php:173:                                        <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/Template/Views/Dashboard_Template.php:192:                                    <!-- <a href="<?php //echo site_url('/Wallets/Retirement'); ?>">Retirement</a>  -->
app/Modules/Template/Views/Dashboard_Template.php:195:                                        <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/Template/Views/Dashboard_Template.php:220:                                        <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/Template/Views/Dashboard_Template.php:239:                                    <a href="<?php //echo site_url('/Budget/Income/Accounts'); ?>">Investments / Assets</a> 
app/Modules/Template/Views/Dashboard_Template.php:242:                                        <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/Template/Views/Dashboard_Template.php:247:                            <a href="<?php //echo site_url('/Budget/Add/Expense'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Template/Views/Dashboard_Template.php:256:                                <p>View, manage and analyze your <a href="<?php //echo site_url('Budget/Forecast'); ?>"><strong><?php //echo $totalTransactions; ?> Financial Forecast &amp; 5-Year Projections</strong></a>.</p>
app/Modules/Template/Views/Dashboard_Template.php:258:                            <a href="<?php //echo site_url('Exchanges'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Template/Views/Dashboard_Template.php:336:                    <a href="<?php echo site_url('Budget/Income'); ?>">
app/Modules/Template/Views/Dashboard_Template.php:348:                    <a href="<?php echo site_url('Budget/Expenses'); ?>">
app/Modules/Template/Views/Dashboard_Template.php:387:                    <a href="<?php echo site_url('Budget/Income'); ?>">
app/Modules/Template/Views/Dashboard_Template.php:399:                    <a href="<?php echo site_url('Budget/Expenses'); ?>">
app/Modules/Template/Views/Dashboard_Template.php:470:                                        <a class="btn btn-success btn-sm text-white" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/Template/Views/Dashboard_Template.php:471:                                        <a class="btn btn-danger btn-sm text-white" href="' . site_url('/Budget/Add/Expense') . '"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/Template/Views/Dashboard_Template.php:473:                                        <a class="btn btn-outline-secondary btn-sm" href="' . site_url('/Budget/History') . '"><i class="icon ni ni-history"></i> History</a>
app/Modules/Template/Views/Dashboard_Template.php:480:                                                            <a class="" href="' . site_url('/Budget/Add/Income') . '">On</a>
app/Modules/Template/Views/Dashboard_Template.php:483:                                                            <a class="" href="' . site_url('/Budget/Add/Income') . '">Off</a>
app/Modules/Template/Views/Dashboard_Template.php:487:                                                            <a class="" href="' . site_url('/Budget/Add/Income') . '">On</a>
app/Modules/Template/Views/Dashboard_Template.php:490:                                                            <a class="" href="' . site_url('/Budget/Add/Income') . '">Off</a>
app/Modules/Template/Views/Dashboard_Template.php:497:                                                Include Credit Accounts: <a class="" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-toggle-off"></i></a>
app/Modules/Template/Views/Dashboard_Template.php:500:                                                Include Investment Accounts: <a class="" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-toggle-off"></i></a>
app/Modules/Template/Views/Dashboard_Template.php:507:                                        Include Credit Accounts: <a class="" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-toggle-off"></i></a>
app/Modules/Template/Views/Dashboard_Template.php:508:                                        Include Investment Accounts: <a class="" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-toggle-off"></i></a>
app/Modules/Template/Views/Dashboard_Template.php:549:                                        <a class="btn btn-success btn-xs text-white" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/Template/Views/Dashboard_Template.php:550:                                        <a class="btn btn-danger btn-xs text-white" href="' . site_url('/Budget/Add/Expense') . '"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/Advertise/Views/content_banner.php:61:            <!-- <div class="g mt-4 mt-md-0"><a href="' . site_url('Knowledgebase') . '" target="_blank" class="btn btn-lg btn-primary"><span>Learn More!</span></a></div> -->
app/Modules/chatgpt.txt:1:<?php namespace App\Modules\Management\Controllers;use CodeIgniter\Controller;use Config\Services;use App\Config\{APIs,Auth,SiteSettings,SocialMedia};use App\Controllers\UserController;use App\Libraries\{BaseLoader,HtmlFormatter,MyMIAnalytics,MyMIAlerts,MyMIBudget,MyMIDashboard,MyMIExchange,MyMIMarketing,MyMIUser};use App\Models\{AlertsModel,AnnouncementModel,InvestmentModel,ManagementModel,MarketingModel,MyMIGoldModel,SolanaModel,UserModel};use App\Services\{DashboardService,GoalTrackingService,MarketingService,SolanaService,UserService};use CodeIgniter\API\ResponseTrait;use GuzzleHttp\Client;use GuzzleHttp\Exception\RequestException;use voku\helper\HtmlDomParser;class MarketingController extends UserController{use ResponseTrait;use BaseLoader;protected $API;protected $auth;protected $cuID;protected $data;protected $debug;protected $helpers=['auth','form','url'];protected $logger;protected $request;protected $session;protected $uri;protected $siteSettings;protected $NewsEmail;protected $HtmlFormatter;protected $MyMIAnalytics;protected $MyMIAlerts;protected $MyMIBudget;protected $MyMIDashboard;protected $MyMIExchange;protected $MyMIMarketing;protected $MyMIUser;protected $dashboardService;protected $goalTrackingService;protected $marketingService;protected $solanaService;protected $userService;protected $alertsModel;protected $investmentModel;protected $marketingModel;protected $userModel;protected $userAccount;protected $userDashboard;protected $getBlogPosts;protected $departmentTasks;protected $marketing;protected $reporting;public function __construct(){$this->API=config('APIs');$this->auth=service('authentication');$this->logger=service('logger');$this->NewsEmail=config('NewsEmailServer');$this->request=service('request');$this->session=Services::session();$this->siteSettings=config('SiteSettings');$this->debug=$this->siteSettings->debug;$this->uri=$this->request->getUri();$this->alertsModel=new AlertsModel();$this->investmentModel=new InvestmentModel();$this->marketingModel=new MarketingModel();$this->userDashboard=$this->getMyMIDashboard()->dashboardInfo($this->cuID);$this->departmentTasks=$this->getMyMIAnalytics()->get_department_tasks($this->uri->getSegment(2),['Page SEO Edit']);$this->getBlogPosts=$this->getMyMIMarketing()->getBlogPosts();$this->cuID=$this->session->get('user_id')?? $this->auth->id();if(!$this->cuID){log_message('error','Investments ControllerFailed to retrieve valid User ID in MyMIInvestments');throw new \RuntimeException('User ID could not be retrieved.');}log_message('debug',"InvestmentsController: cuID initialized as {$this->cuID}");$this->userAccount=$this->getMyMIUser()->getUserInformation($this->cuID);$userBudget=$this->getMyMIBudget()->getUserBudget($this->cuID);log_message('info','DashboardController L72 - $checkingSummary: '.$userBudget['checkingSummary']);$this->data['checkingSummary']=$userBudget['checkingSummary'];}public function commonData(): array{$this->data=$this->data ??[];$userData=$this->getuserService()->commonData();$this->data=array_merge($this->data,$userData);$this->data['siteSettings']=$this->siteSettings;$this->data['beta']=(string)$this->siteSettings->beta;$this->data['uri']=$this->request->getUri();$this->data['date']=$this->siteSettings->date;$this->data['time']=$this->siteSettings->time;$this->data['hostTime']=$this->siteSettings->hostTime;$dashboardInfo=$this->getDashboardService()->getDashboardInfo($this->cuID);$this->data['completedGoals']=$this->getGoalTrackingService()->getCompletedGoals($this->cuID);$this->data['pendingGoals']=$this->getGoalTrackingService()->getPendingGoals($this->cuID);$this->data['promotionalBanners']=$dashboardInfo['promotionalBanners'];$userBudget=$this->getBudgetService()->getUserBudget($this->cuID);$this->data['totalAccountBalance']=$userBudget['totalAccountBalance']?? 0;$this->data['totalAccountBalanceFMT']=$userBudget['totalAccountBalanceFMT']?? '0.00';$userSolanaData=$this->getSolanaService()->getSolanaData($this->cuID);$this->data['cuSolanaDW']=$userSolanaData['userSolanaWallets']['cuSolanaDW']?? null;$this->data['solanaNetworkStatus']=$userSolanaData['solanaNetworkStatus'];$this->data['cuSolanaTotal']=$userSolanaData['userSolanaWallets']['cuSolanaTotal']?? 0;$this->data['cuSolanaValue']=$userSolanaData['userSolanaWallets']['cuSolanaValue']?? 0;$this->data=array_merge($this->data,$userData);if($this->debug===1){}}public function index(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['recentMarketingPosts']=$this->getMyMIMarketing()->getRecentPosts(5);if(empty($this->data['recentMarketingPosts'])){log_message('info','ðŸ“­ No recent posts found. Running fallback generation...');$this->getMyMIMarketing()->generateFromTempScraper(5);$this->data['recentMarketingPosts']=$this->getMyMIMarketing()->getRecentPosts(25);}$this->data['todaysStory']=$this->marketingModel->getTodaysStory();$this->data['generatedSummaries']=$this->marketingModel->getLatestGeneratedSummaries(25);$this->data['marketingBuffer']=$this->marketingModel->getMarketingBuffer();if(empty($this->data['todaysStory'])){log_message('info','ðŸ“… No content generated today. Triggering summary fallback...');$this->getMyMIMarketing()->generateFromTempScraper(5);$this->data['todaysStory']=$this->marketingModel->where('DATE(created_at)',date('Y-m-d'))->orderBy('created_at','DESC')->findAll();}$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\index',$this->data);}public function add($type=null){log_message('debug','MarketingController L183 - add() method called with type: '.(is_null($type)?'null':$type));if(!empty($type)){if($this->request->getMethod()==='POST'){log_message('debug','Handling POST request for type: '.$type);if($type==='Schedule'){log_message('info','Processing Schedule submission');try{$this->marketingModel->addMarketingSchedule($this->request->getPost());log_message('info','Schedule data saved successfully');if($this->request->isAJAX()){return $this->response->setJSON(['success'=>true,'message'=>'Schedule added successfully']);}else{return redirect()->to('/Management/Marketing/Schedule')->with('success','Schedule added successfully');}}catch(\Exception $e){log_message('error','Error saving schedule: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to save schedule.']);}}elseif($type==='Campaign'){log_message('info','Processing Campaign submission');try{$campaignData=['beta'=>$this->request->getPost('beta'),'config_mode'=>$this->request->getPost('config_mode'),'form_mode'=>$this->request->getPost('form_mode'),'escalated'=>$this->request->getPost('escalated'),'user_id'=>$this->request->getPost('user_id'),'user_email'=>$this->request->getPost('user_email'),'username'=>$this->request->getPost('username'),'assigned_to'=>$this->request->getPost('assigned_to'),'date'=>$this->siteSettings->date,'time'=>$this->siteSettings->time,'campaign_name'=>$this->request->getPost('campaign_name'),'promotionalLinks'=>json_encode($this->request->getPost('promotionalLinks')),'overall_campaign_description'=>$this->request->getPost('overall_campaign_description'),'voice_script'=>$this->request->getPost('voice_script'),'facebookMessage'=>$this->request->getPost('facebookMessage'),'linkedinMessage'=>$this->request->getPost('linkedinMessage'),'discordMessage'=>$this->request->getPost('discordMessage'),'stocktwitsMessage'=>$this->request->getPost('stocktwitsMessage'),'tiktokMessage'=>$this->request->getPost('tiktokMessage'),'youtubeMessage'=>$this->request->getPost('youtubeMessage'),'emailMessage'=>$this->request->getPost('emailMessage'),'additionalInfo'=>$this->request->getPost('additionalInfo'),'hashtags'=>$this->request->getPost('hashtags'),];$this->marketingModel->addMarketingCampaign($campaignData);log_message('info','Campaign data saved successfully');if($this->request->isAJAX()){log_message('info','MarketingController L251 - This is using the $this->request->isAJAX() Form Submission');return $this->response->setJSON(['success'=>true,'message'=>'Campaign added successfully']);}else{log_message('info','MarketingController L251 - This is NOT using the $this->request->isAJAX() Form Submission');return redirect()->to('/Management/Marketing/Campaigns')->with('success','Campaign added successfully');}}catch(\Exception $e){log_message('error','Error saving campaign: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to save campaign.']);}}else{log_message('error','Unrecognized type in POST request: '.$type);return $this->response->setJSON(['error'=>'Unrecognized type in POST request']);}}if($this->request->getMethod()==='get'){log_message('debug','Handling GET request for type: '.$type);if($type==='Schedule'){log_message('debug','Loading view for Schedule');try{$response=$this->renderTheme('ManagementModule\Views\Marketing\Schedule\Add',$this->data);log_message('debug','View for Schedule loaded successfully');return $response;}catch(\Exception $e){log_message('error','Failed to load view for Schedule: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to load view for Schedule']);}}elseif($type==='Campaign'){log_message('debug','Loading view for Campaign');try{$response=$this->renderTheme('ManagementModule\Views\Marketing\Campaign\Add',$this->data);log_message('debug','View for Campaign loaded successfully');return $response;}catch(\Exception $e){log_message('error','Failed to load view for Campaign: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to load view for Campaign']);}}else{log_message('error','Unrecognized type in GET request: '.$type);return $this->response->setJSON(['error'=>'Unrecognized type in GET request']);}}}else{log_message('warning','No type provided; redirecting to /Management/Marketing');return redirect()->to('/Management/Marketing')->with('error','No type provided');}}public function addSchedule(){if($this->request->getMethod()==='post'){$additionalInfo=$this->request->getPost('additional_info');$jsonData=null;if(!empty($additionalInfo)){$jsonData=json_decode($additionalInfo,true);if(json_last_error()!==JSON_ERROR_NONE){return redirect()->back()->withInput()->with('error','Invalid JSON format in Additional Information.');}}$scheduleData=['day'=>$this->request->getPost('day'),'time'=>$this->request->getPost('time'),'activity'=>$this->request->getPost('activity'),'link'=>$this->request->getPost('link'),'additional_info'=>json_encode($jsonData)];$this->marketingModel->addMarketingSchedule($scheduleData);return redirect()->to(base_url('Management/Marketing/Schedule'))->with('success','New schedule added successfully.');}$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Schedule\Add');}public function addSubscriber(){helper('email');$rawRequestBody=$this->request->getBody();$jsonData=json_decode($rawRequestBody,true);$marketingModel=new MarketingModel();$subscriberData=['email'=>$jsonData['email'],'category'=>$jsonData['category'],'referral'=>$jsonData['referral'],'beta'=>$this->siteSettings->beta,'date'=>date('Y-m-d H:i:s'),'hostTime'=>date('Y-m-d H:i:s'),'time'=>date('H:i:s'),'user_id'=>session('user_id'),'user_ip'=>$this->request->getIPAddress()];if($marketingModel->addSubscriber($subscriberData)){$emailService=\Config\Services::email();$emailService->setTo($subscriberData['email']);$emailService->setSubject('ðŸŽ‰ Welcome to Investorâ€™s Talk | MyMI Wallet');$emailService->setMessage(view('emails/welcomeInvestor',['siteSettings'=>$this->siteSettings,'socialMedia'=>config('SocialMedia'),]));if($emailService->send()){log_message('info','Management/MarketingController L346 - $emailService: '.print_r($emailService,true));return $this->response->setJSON(['success'=>true,'message'=>'Subscriber email sent successfully']);}else{log_message('error','Management/MarketingController L346 - Error Submitting: $emailService: '.print_r($emailService,true));return $this->response->setJSON(['success'=>false,'message'=>'Failed to send Welcome Email']);}}else{return $this->response->setJSON(['success'=>false,'message'=>'Failed to add subscriber']);}}public function approveBufferItem($id){$this->marketingModel->updateBufferStatus($id,'approved');return $this->respond(['status'=>'success','message'=>'Approved']);}public function approveLogo(){$symbol=$this->request->getPost('symbol');$imageUrl=$this->request->getPost('imageUrl');try{$this->marketingModel->saveApprovedLogo($symbol,$imageUrl);return $this->response->setJSON(['success'=>true,'message'=>'Logo approved successfully.',]);}catch(\Exception $e){log_message('error','Failed to approve logo: '.$e->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to approve logo.',]);}}public function approveAndDownloadLogo(){$imageUrl=$this->request->getPost('selectedImage');$symbol=$this->request->getPost('symbol');try{$imageContent=file_get_contents($imageUrl);$imagePath=WRITEPATH.'uploads/Company-Logos/'.$symbol.'.png';file_put_contents($imagePath,$imageContent);$publicPath=FCPATH.'assets/images/Company-Logos/'.$symbol.'.png';rename($imagePath,$publicPath);return redirect()->to('/Management/Marketing/upcomingEarnings')->with('success','Logo approved and saved successfully.');}catch(\Exception $e){log_message('error','Failed to download or save logo: '.$e->getMessage());return redirect()->back()->with('error','Failed to save the logo.');}}public function approveContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['status'=>'approved']);return redirect()->back()->with('success','Content approved successfully.');}public function blogs(){$this->data['pageTitle']='MyMI Blogs | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['blogs']=$this->marketingModel->getBlogs();$this->data['totalBlogs']=$this->marketingModel->countBlogs();$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Blogs',$this->data);}public function campaigns(){$this->data['pageTitle']='Marketing Campaigns | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['getActiveCampaigns']=$this->marketing['department']['getActiveCampaigns'];$this->data['getActivePriorityCampaigns']=$this->marketing['department']['getActivePriorityCampaigns'];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\campaigns',$this->data);}public function contentGenerator(){try{$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\contentGenerator',$this->data);}catch(\Throwable $th){log_message('error','MarketingController contentGenerator error: '.$th->getMessage());}}public function contentReview(){$generatedContent=$this->session->get('generatedContent');if(empty($generatedContent)){return redirect()->to('/Management/Marketing')->with('error','No generated content available for review.');}return $this->renderTheme('ManagementModule\Views\Marketing\Content_Review',['generatedContent'=>$generatedContent]);}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);log_message('debug','âœ… Content digest completed.');}public function cronFetchAndStoreEmails(){try{log_message('debug','Starting cronFetchAndStoreEmails');$this->marketingService->scrapeAndStoreEmailsToTemp();log_message('debug','Finished cronFetchAndStoreEmails');return $this->respond(['status'=>'success']);}catch(\Throwable $e){log_message('error','cronFetchAndStoreEmails Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();log_message('debug','âœ… Inbox scrape completed.');}public function cronFetchMarketingEmails(){log_message('info','CRON: Starting Marketing Email Fetch');$service=new MarketingService();$emailsFetched=$this->getMyMIMarketing()->fetchAndStoreEmails('newsletters');log_message('info','CRON: Fetched '.$emailsFetched.' marketing emails');return $this->respond(['status'=>'success','fetched'=>$emailsFetched]);}public function cronGenerateContentFromTemp(){try{log_message('debug','Starting cronGenerateContentFromTemp');$this->marketingService->generateFinalContentFromTemp();log_message('debug','Finished cronGenerateContentFromTemp');return $this->respond(['status'=>'success']);}catch(\Throwable $e){log_message('error','cronGenerateContentFromTemp Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function cronSendDailyLog(){date_default_timezone_set('America/Chicago');$contentData=$this->getLogsOrFallback();$emailView=view('emails/daily_log_summary',['contentData'=>$contentData['data'],'contentType'=>$contentData['type'],]);$subject=($contentData['type']==='logs')?'Daily Log Summary for '.date('F j, Y'):'Fallback Content - Daily Summary '.date('F j, Y');$this->email->setTo('community@mymiwallet.com')->setSubject($subject)->setMessage($emailView)->send();$this->email->setTo('team@mymiwallet.com')->setSubject('Reminder: Daily Log Email Pending Confirmation')->setMessage('The daily log email is scheduled to be sent at 3 PM CST. Please review the content to ensure everything is accurate.')->send();}public function edit($id=null){if($id===null){throw new \CodeIgniter\Exceptions\PageNotFoundException('Exchange ID not provided');}$tokenData=$this->marketingModel->getExchangeTokenById($id);if(!$tokenData){throw new \CodeIgniter\Exceptions\PageNotFoundException('Token not found');}if($this->request->getMethod()==='post'){$validation=\Config\Services::validation();$validation->setRules(['coin_name'=>'required','market_cap'=>'required|numeric','website'=>'required|valid_url','discord'=>'permit_empty|valid_url','facebook'=>'permit_empty|valid_url','telegram'=>'permit_empty|valid_url','twitter'=>'permit_empty|valid_url',]);if($validation->withRequest($this->request)->run()){$updatedData=['coin_name'=>$this->request->getPost('coin_name'),'market_cap'=>$this->request->getPost('market_cap'),'website'=>$this->request->getPost('website'),'discord'=>$this->request->getPost('discord'),'facebook'=>$this->request->getPost('facebook'),'telegram'=>$this->request->getPost('telegram'),'twitter'=>$this->request->getPost('twitter'),];if($this->marketingModel->updateExchangeToken($id,$updatedData)){$this->session->setFlashdata('success','Exchange token updated successfully');}else{$this->session->setFlashdata('error','Failed to update the exchange token');}return redirect()->to(site_url('Management/Marketing/Exchanges/Edit/'.$id));}else{$this->session->setFlashdata('validation_errors',$validation->getErrors());}}return $this->renderTheme('ManagementModule\Views\Marketing\Exchanges\edit',['token'=>$tokenData,'validation'=>$this->session->getFlashdata('validation_errors'),'redirectURL'=>site_url('Management/Marketing/Exchanges'),]);}public function editContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}return $this->renderTheme('ManagementModule\Views\Marketing\Content_Edit',['content'=>$content]);}public function fetchBufferPaginated(){$page=(int) $this->request->getGet('page')?:1;$limit=(int) $this->request->getGet('limit')?:20;$data=$this->marketingModel->fetchBufferPaginated($page,$limit);return $this->respond($data);}public function fetchLatestSummaries(){$generatedSummaries=$this->marketingModel->getLatestGeneratedSummaries(25);return $this->renderTheme('ManagementModule\Views\Marketing\resources\generatedSummaries',['generatedSummaries'=>$generatedSummaries]);}public function fetchMissingLogos(){$postData=$this->request->getJSON(true);$csrfName=csrf_token();$csrfHash=csrf_hash();if(!isset($postData[$csrfName])||$postData[$csrfName]!==$csrfHash){log_message('error','fetchMissingLogos: CSRF validation failed');return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['error'=>'Invalid CSRF token.']);}$symbols=$postData['symbols']?? null;if(empty($symbols)||!is_array($symbols)){log_message('error','fetchMissingLogos: Invalid symbols input');return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['error'=>'Invalid symbols input.']);}$results=[];foreach($symbols as $symbol){$results[]=['symbol'=>$symbol,'status'=>'not_found',];}return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['results'=>$results]);}public function financialNews(){$symbols=$this->investmentModel->getAllSymbolsByEarnings();$approvedLogos=$this->marketingModel->getApprovedLogos();$existingSymbols=array_column($approvedLogos,'symbol');$missingSymbols=array_filter($symbols,function($symbol)use($existingSymbols){return!in_array($symbol['symbol'],$existingSymbols);});$this->data['approvedLogos']=$approvedLogos ??[];$this->data['missingSymbols']=$missingSymbols ??[];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\financialNews',$this->data);}public function generateAudio(){$text=$this->request->getPost('text');$fileName=$this->request->getPost('fileName')?:uniqid('tts_',true);$directory=WRITEPATH.'uploads/';$outputFile=$directory.$fileName.'.mp3';if(empty($text)){return $this->response->setJSON(['status'=>'error','message'=>'Text cannot be empty.',]);}if(!is_dir($directory)){mkdir($directory,0777,true);}$command=sprintf('python3 gtts_script.py %s %s',escapeshellarg($text),escapeshellarg($outputFile));exec($command,$output,$status);if($status===0&&file_exists($outputFile)){$fileUrl=base_url('uploads/'.basename($outputFile));return $this->response->setJSON(['status'=>'success','message'=>'Audio file generated successfully.','file_url'=>$fileUrl,]);}else{return $this->response->setJSON(['status'=>'error','message'=>'Failed to generate audio.',]);}}private function generateAutomatedContent(){$scraperContent=$this->marketingModel->getRecentScrapes();$tempContent=$this->marketingModel->getRecentTempScrapes();$campaigns=$this->marketingModel->getActiveCampaignsLimited(50);$allContent=array_merge($scraperContent,$tempContent,$campaigns);$generatedContent=[];foreach($allContent as $content){$generatedContent[]=$this->getMarketingService()->generateContentFromPost($content->title ?? 'Untitled',$content->content ?? '',$content->tags?explode(',',$content->tags):[]);}foreach($generatedContent as $content){$slug=$this->marketingModel->createSlug($content['title']);$this->db->table('bf_marketing_blog_posts')->insert(['title'=>$content['title']?? 'Generated Content','content'=>$content['summary']?? '','slug'=>$slug,'tags'=>implode(',',$content['keywords']??[]),'created_on'=>date('Y-m-d H:i:s'),]);$this->marketingModel->saveDailyLog(['title'=>$content['title'],'content'=>$content['summary'],'type'=>'Automated','tags'=>implode(',',$content['keywords']),'date_time'=>date('Y-m-d H:i:s'),'author_information'=>'MyMI Automated System','created_on'=>date('Y-m-d H:i:s'),]);}return $generatedContent;}public function generateContent($platform,$postId){$post=$this->marketingModel->getSchedulePostById($postId);if(!$post){return redirect()->back()->with('error','Post not found.');}$content=$this->getMyMIMarketing()->generateContentFromGPT($post['subjects'],$post['descriptions'],$platform);$contentData=['post_id'=>$postId,'platform'=>$platform,'generated_content'=>$content,];$this->marketingModel->storeGeneratedContent($contentData);return redirect()->to("\Management\Marketing\Schedule")->with('success','Content generated successfully.');}public function generateContentDigestFromStored(){log_message('info','Marketing: Starting summary generation from stored marketing emails.');$model=new MarketingModel();$records=$model->getRecentUnprocessedTempEmails(5);$results=[];foreach($records as $record){if(empty($record['content'])||strlen($record['content'])<1000){log_message('debug',"âš ï¸ Skipping record ID {$record['id']} due to insufficient content length.");continue;}if(empty($record['title'])||empty($record['content'])){log_message('debug','Skipped record due to missing title/content ID: '.$record['id']);continue;}try{$summary=$this->getMarketingService()->generateContentFromRaw($record['title'],$record['content']);$model->storeFinalMarketingContent(['source_id'=>$record['id'],'title'=>$record['title'],'summary'=>$summary,'created_at'=>date('Y-m-d H:i:s')]);$model->markTempRecordAsProcessed($record['id']);$results[]=$record['title'];}catch(\Throwable $e){log_message('error','Failed to process record ID '.$record['id'].': '.$e->getMessage());}}return $this->respond(['status'=>'complete','processed_titles'=>$results]);}public function generateContentFromTweet($tweetId){$tweet=$this->marketingModel->getTweetById($tweetId);if(!$tweet){return $this->failNotFound('Tweet not found');}$generatedContent=$this->getMyMIMarketing()->generateContentFromTweets([$tweet]);$this->marketingModel->storeGeneratedContent(['tweet_id'=>$tweetId,'content'=>json_encode($generatedContent),'created_at'=>date('Y-m-d H:i:s')]);$this->getMyMIMarketing()->postToTwitter($generatedContent['platform_content']['Twitter']);return $this->respond(['message'=>'Content generated and posted successfully']);}public function generateDailyContentDigest(){log_message('debug','ðŸ§  Start Memory Usage: '.memory_get_usage(true));@ini_set('memory_limit','768M');$limit=5;$summary=[];$rawRecords=$this->marketingModel->getLatestUnprocessedEmails($limit);foreach($rawRecords as $record){$content=$record['content']?? '';if(empty($content)||strlen($content)<500){log_message('debug',"â­ï¸ Skipped record ID {$record['id']} - insufficient content.");continue;}$contentSize=strlen($content);log_message('debug','ðŸ“Œ Processing record ID '.$record['id'].' with content size: '.$contentSize);log_message('debug','Management/MarketingController L770 - $record Array: '.print_r($record,true));if($contentSize===0){log_message('debug',"â­ï¸ Skipped record ID {$record['id']} - empty content.");continue;}try{gc_collect_cycles();$processed=$this->getMarketingService()->generateContentFromRaw($record);if($processed===null){log_message('debug',"âš ï¸ Skipped record ID {$record['id']} - generateContentFromRaw() returned null.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$summary[]=['title'=>$processed['headline'],'summary'=>$processed['summary'],'subtopics'=>$processed['subtopics'],'platform_posts'=>$processed['posts'],];}catch(\Throwable $e){log_message('error',"âŒ generateDailyContentDigest failed on record ID {$record['id']}: {$e->getMessage()}");}}$this->marketingModel->markEmailsAsProcessed(array_column($rawRecords,'id'));log_message('debug','ðŸ Peak Memory Usage: '.memory_get_peak_usage(true));return $this->response->setJSON(['digest'=>$summary]);}public function generateNewsletterContent(){$emailContents=$this->marketingModel->getEmailContentsForNewsletter();$content=$this->getMyMIMarketing()->generateNewsletterContent($emailContents);$newsletterData=['title'=>'Monthly Financial Newsletter - '.date('F Y'),'content'=>$content,'status'=>'draft','created_at'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeNewsletterDraft($newsletterData);return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Newsletter content generated successfully');}private function generateSummarizedFallbackContent($contentArray){$summarizedContent=[];$summarizer=new \App\Libraries\ContentSummarizer();foreach($contentArray as $content){$summarizedContent[]=['title'=>$content->title ?? 'Untitled','summary'=>$summarizer->summarize($content->content ?? '',200),'url'=>$content->url ?? null,];}return $summarizer->combineSummaries($summarizedContent);}private function getLogsOrFallback(){$logs=$this->marketingModel->getDailyLogsByDate(date('Y-m-d'));if(!empty($logs)){return['type'=>'logs','data'=>$logs];}$scrapedContent=$this->marketingModel->getRecentScrapes();$campaigns=$this->marketingModel->getActiveCampaignsLimited(50);$combinedContent=array_merge($scrapedContent,$campaigns['result']);$fallbackContent=$this->generateSummarizedFallbackContent($combinedContent);foreach($fallbackContent as $content){$this->marketingModel->saveDailyLog(['title'=>$content['title']?? 'Automated Content','content'=>$content['summary']?? '','type'=>'Automated','tags'=>implode(',',$content['keywords']??[]),'date_time'=>date('Y-m-d H:i:s'),'author_information'=>'MyMI Automated System','created_on'=>date('Y-m-d H:i:s'),]);}return['type'=>'fallback','data'=>$fallbackContent];}public function getRecentScrapes(){try{$scrapes=$this->marketingModel->getRecentScrapes();return $this->response->setJSON(['success'=>true,'scrapes'=>$scrapes]);}catch(\Throwable $th){log_message('error','getRecentScrapes: Exception - '.$th->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to fetch recent scrapes.']);}}private function handleMediaUpload($mediaFiles){$uploadedMedia=[];foreach($mediaFiles as $file){if($file->isValid()&&!$file->hasMoved()){$newFileName=$file->getRandomName();$file->move(WRITEPATH.'uploads/media/',$newFileName);$uploadedMedia[]=['file_name'=>$file->getClientName(),'file_path'=>WRITEPATH.'uploads/media/'.$newFileName,'file_size'=>$file->getSize(),'file_type'=>$file->getMimeType(),];}}return $uploadedMedia;}public function ideas(){$this->data['pageTitle']='Marketing Campaigns | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['getActiveIdeas']=$this->marketingModel->getActiveIdeas();$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\ideas',$this->data);}public function importScheduleCSV(){if($this->request->getMethod()==='post'){$file=$this->request->getFile('csv_file');if($file->isValid()&&!$file->hasMoved()){$filePath=WRITEPATH.'uploads/'.$file->store();$csvData=array_map('str_getcsv',file($filePath));foreach($csvData as $row){$scheduleData=['day'=>$row[0],'time'=>$row[1],'activity'=>$row[2],];$scheduleId=$this->marketingModel->addMarketingSchedule($scheduleData);$campaignData=['sched_id'=>$scheduleId,'title'=>$row[3],'platform'=>$row[4],'content'=>$row[5],];$this->marketingModel->addMarketingCampaign($campaignData);}return redirect()->back()->with('success','Schedule and campaigns imported successfully.');}return redirect()->back()->with('error','Invalid CSV file.');}return $this->renderTheme('ManagementModule\Views\Marketing\importCSV');}public function previewBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Item not found.");return $this->renderTheme('ManagementModule\Views\Marketing\modals\bufferPreview',['item'=>$record]);}public function previewGeneratedPost($id){try{$post=$this->marketingModel->find($id);if(!$post){return $this->failNotFound('Post not found.');}return $this->renderTheme('App\Modules\Management\Views\Marketing\modals/previewGeneratedPost',['post'=>$post]);}catch(\Throwable $e){log_message('error','âŒ Failed to load post preview: '.$e->getMessage());return $this->failServerError('Unable to preview post.');}}public function previewPendingSummaries(){try{$pendingSummaries=$this->marketingModel->getPendingScraperSummaries(10);return $this->renderTheme('App\Modules\Management\Views\Marketing\partials\previewPendingSummaries',['pendingSummaries'=>$pendingSummaries]);}catch(\Throwable $e){log_message('error','âŒ previewPendingSummaries failed: '.$e->getMessage());return $this->failServerError('Could not load summaries.');}}public function previewVideoScript($id){$post=$this->marketingModel->getGeneratedPostById($id);if(!$post)return $this->failNotFound('Post not found.');$posts=json_decode($post['posts'],true);$videoScript=$posts['video']?? 'No video script generated yet.';return $this->renderTheme('MarketingModule\Views\Marketing\modals\video_preview_modal',['title'=>$post['title'],'videoScript'=>$videoScript,]);}public function processScheduledPosts(){$currentTimestamp=date('Y-m-d H:i:s');$scheduledPosts=$this->marketingModel->getPendingScheduledPosts($currentTimestamp);foreach($scheduledPosts as $post){$payload=['platform'=>$post->platform,'content'=>$post->content,'media_url'=>$post->media_url,];try{$response=$this->sendToZapier($post->zapier_webhook_url,$payload);if($response->getStatusCode()===200){$this->marketingModel->updatePostStatus($post->id,'posted');}else{throw new Exception("Zapier response error: {$response->getBody()}");}}catch(Exception $e){$this->handlePostFailure($post,$e->getMessage());}}}private function sendToZapier($webhookUrl,$payload){$client=new \GuzzleHttp\Client();return $client->post($webhookUrl,['headers'=>['Content-Type'=>'application/json'],'json'=>$payload,]);}private function handlePostFailure($post,$error){$this->marketingModel->incrementRetryCount($post->id);log_message('error',"Failed to post to Zapier for Post ID {$post->id}: {$error}");if($post->retry_count>=3){$this->marketingModel->updatePostStatus($post->id,'failed');}}public function postCreator(){try{$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\index',$this->data);}catch(\Throwable $th){log_message('error','MarketingController postCreator error: '.$th->getMessage());}}public function promote(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['exchangeAssets']=[];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Promote',$this->data);}public function publishBlog($blogId){$blog=$this->marketingModel->getBlogPostDetails($blogId);if(!$blog){return redirect()->back()->with('error','Blog post not found.');}$this->marketingModel->update($blogId,['status'=>'published']);return redirect()->to('/Management/Marketing/Blogs')->with('success','Blog published successfully.');}public function rejectBufferItem($id){$this->marketingModel->updateBufferStatus($id,'rejected');return $this->respond(['status'=>'success','message'=>'Rejected']);}public function rejectContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['status'=>'rejected']);return redirect()->back()->with('success','Content rejected successfully.');}public function reviewBuffer(){$buffer=$this->marketingModel->getBufferItems();$this->data['pageTitle']='Marketing Buffer Dashboard';$this->data['buffer']=$buffer;return $this->renderTheme('ManagementModule\Views\Marketing\BufferDashboard',$this->data);}public function runContentGeneration(){$generatedContent=$this->generateAutomatedContent();$this->session->set('generatedContent',$generatedContent);return redirect()->to('/Management/Marketing/ContentReview')->with('success',count($generatedContent).' content items generated successfully. Please review and approve.');}private function sanitizeContent($content){$content=preg_replace('#<script(.*?)>(.*?)</script>#is','',$content);$content=preg_replace('#<style(.*?)>(.*?)</style>#is','',$content);$content=strip_tags($content);$content=preg_replace('/\s+/',' ',$content);return trim($content);}private function saveCampaign($formData){$data=['title'=>$formData['title'],'description'=>$formData['description'],];$this->marketingModel->addMarketingCampaign($data);}public function saveContentEdit($id){$postData=$this->request->getPost();$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['content'=>$postData['content'],'status'=>'pending',]);return redirect()->to('/Management/Marketing/ContentReview')->with('success','Content updated successfully.');}private function saveSchedule($formData){$scheduleModel=new \App\Models\ScheduleModel();$data=['title'=>$formData['title'],'description'=>$formData['description'],];$scheduleModel->insert($data);}public function schedule($day=null){if(!empty($day)){$this->data['marketingSchedule']=$this->marketingModel->getScheduleByDay($day);foreach($this->data['marketingSchedule']as&$schedule){$schedule['campaigns']=$this->marketingModel->getCampaignsBySchedId($schedule['id']);}$this->data['scheduleByDay']='Yes';}else{$this->data['marketingSchedule']=$this->marketingModel->getUpcomingSchedule();foreach($this->data['marketingSchedule']as&$schedule){$schedule['campaigns']=$this->marketingModel->getCampaignsBySchedId($schedule['id']);}$this->data['scheduleByDay']='No';}$this->commonData();$this->data['pageTitle']='Daily Schedule | Management | MyMI Wallet';return $this->renderTheme('ManagementModule\Views\Marketing\Schedule',$this->data);}public function scheduleNewsletterCampaign(){$newsletterDraft=$this->marketingModel->getLatestNewsletterDraft();if(!$newsletterDraft){return $this->response->setJSON(['success'=>false,'message'=>'No newsletter draft found']);}$campaignData=['title'=>$newsletterDraft['title'],'content'=>$newsletterDraft['content'],'status'=>'scheduled','send_date'=>$this->request->getPost('send_date'),'target_audience'=>'all_users','created_at'=>date('Y-m-d H:i:s'),];if($this->marketingModel->scheduleNewsletterCampaign($campaignData)){return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Newsletter campaign scheduled successfully');}else{return redirect()->back()->with('error','Failed to schedule newsletter campaign');}}private function scrapeGoogleSearch($query){$searchUrl='https://www.google.com/search?q='.urlencode($query);$client=new Client();try{$response=$client->get($searchUrl);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$dom=new \DOMDocument();libxml_use_internal_errors(true);$dom->loadHTML($html);libxml_clear_errors();$xpath=new \DOMXPath($dom);$results=[];foreach($xpath->query('//a[@href]')as $link){$href=$link->getAttribute('href');if(strpos($href,'/url?q=')===0){$href=substr($href,7,strpos($href,'&')-7);$text=$link->nodeValue;$results[]=['href'=>$href,'text'=>$text];}}return $results;}else{log_message('error','scrapeGoogleSearch: Could not retrieve content, HTTP status code - '.$response->getStatusCode());return['error'=>'Could not retrieve content, HTTP status code - '.$response->getStatusCode()];}}catch(RequestException $e){log_message('error','scrapeGoogleSearch: RequestException - '.$e->getMessage());return['error'=>'RequestException error: '.$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeGoogleSearch: General error - '.$e->getMessage());return['error'=>'General error: '.$e->getMessage()];}return[];}public function scrapeLink(){$rawRequestBody=$this->request->getBody();$jsonData=json_decode($rawRequestBody,true);$url=$jsonData['url']?? null;if(!$url){log_message('error','scrapeLink: URL is missing');return $this->response->setJSON(['success'=>false,'message'=>'URL is required.']);}try{log_message('debug','scrapeLink: Scraping URL - '.$url);$scrapedData=$this->scrapeWebsiteWithFallback($url);if(isset($scrapedData['error'])){log_message('error','scrapeLink: '.$scrapedData['error']);return $this->response->setJSON(['success'=>true,'message'=>'Partially scraped data, proceeding with available data.']);}if(!empty($scrapedData['content'])){$this->marketingModel->storeTempScrapedData(['title'=>$scrapedData['title'],'content'=>$scrapedData['content'],'links'=>json_encode($scrapedData['links']),'url'=>$scrapedData['url'],'scraped_at'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),]);return $this->response->setJSON(['success'=>true,'message'=>'Scraped data stored successfully.','data'=>$scrapedData]);}else{log_message('error','scrapeLink: Scraped data is empty');return $this->response->setJSON(['success'=>false,'message'=>'Scraping failed. Please check the URL and try again.']);}}catch(\Throwable $th){log_message('error','scrapeLink: Exception - '.$th->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'An error occurred during scraping.']);}}private function scrapeLinks($links){$scrapedLinksData=[];foreach($links as $link){$url=filter_var($link['href'],FILTER_SANITIZE_URL);if(filter_var($url,FILTER_VALIDATE_URL)){$scrapedData=$this->scrapeWebsite($url);if(!empty($scrapedData['content'])){$scrapedLinksData[]=$scrapedData;}}}return $scrapedLinksData;}private function scrapeWebsite($url){$client=new Client();try{$response=$client->get($url,['stream'=>true,'headers'=>['User-Agent'=>'MyMI Wallet Bot'],'timeout'=>10,'http_errors'=>false ]);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$dom=HtmlDomParser::str_get_html($html);if($dom instanceof \voku\helper\HtmlDomParser){$title=$dom->find('title',0)->text ?? 'No title found';$bodyNode=$dom->find('body',0);$bodyContent=$bodyNode?$this->sanitizeContent($bodyNode->innerHtml()):'No body content found';$links=[];foreach($dom->find('a')as $link){$href=$link->getAttribute('href');$text=$link->text;$links[]=['href'=>$href,'text'=>$text];}log_message('debug','scrapeWebsite: Scraping successful for URL - '.$url);return['title'=>$title,'content'=>$bodyContent,'links'=>$links,'url'=>$url];}else{log_message('error','scrapeWebsite: DOM parsing failed for URL - '.$url);return['error'=>'DOM parsing failed.'];}}else{log_message('error','scrapeWebsite: Could not retrieve content, HTTP status code - '.$response->getStatusCode());return['error'=>'Could not retrieve content, HTTP status code - '.$response->getStatusCode()];}}catch(RequestException $e){if($e->hasResponse()&&$e->getResponse()->getStatusCode()==401){log_message('error','scrapeWebsite: Unauthorized access for URL - '.$url);return['error'=>'Unauthorized access. Skipping URL.'];}log_message('error','scrapeWebsite: RequestException - '.$e->getMessage());return['error'=>'RequestException error: '.$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeWebsite: General error - '.$e->getMessage());return['error'=>'General error: '.$e->getMessage()];}}private function scrapeWebsiteWithFallback($url){try{log_message('debug','scrapeWebsiteWithFallback: Scraping URL - '.$url);$scrapedData=$this->scrapeWebsite($url);if(empty($scrapedData['content'])){log_message('debug','scrapeWebsiteWithFallback: Scraped data is empty, performing Google search fallback');$googleSearchResults=$this->scrapeGoogleSearch($url);$scrapedLinksData=$this->scrapeLinks($googleSearchResults);$scrapedData['google_search_results']=$scrapedLinksData;}return $scrapedData;}catch(RequestException $e){log_message('error','scrapeWebsiteWithFallback: RequestException - '.$e->getMessage());return['error'=>$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeWebsiteWithFallback: General error - '.$e->getMessage());return['error'=>$e->getMessage()];}}public function searchAndApproveLogo($symbol){$query=$symbol.' logo png transparent';$searchUrl='https://www.google.com/search?q='.urlencode($query).'&tbm=isch';try{$response=$this->client->request('GET',$searchUrl);$htmlContent=$response->getBody()->getContents();$dom=new \DOMDocument();@$dom->loadHTML($htmlContent);$xpath=new \DOMXPath($dom);$imageNodes=$xpath->query('//img');$imageUrls=[];foreach($imageNodes as $imageNode){$src=$imageNode->getAttribute('src');if($src){$imageUrls[]=$src;}}return $this->renderTheme('ManagementModule\Views\Marketing\approve_logo',['symbol'=>$symbol,'imageUrls'=>$imageUrls,]);}catch(RequestException $e){log_message('error','Google Search Request Failed: '.$e->getMessage());return redirect()->back()->with('error','Failed to fetch logo suggestions.');}}public function sendScheduledNewsletter(){$campaigns=$this->marketingModel->getScheduledCampaigns();foreach($campaigns as $campaign){$this->getMyMIMarketing()->sendNewsletter($campaign['content'],$campaign['target_audience']);$this->marketingModel->updateCampaignStatus($campaign['id'],'sent');}return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Scheduled newsletters sent successfully');}public function standaloneAddSubscriber(){$this->data['pageTitle']='Add Subscriber | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneAddSubscriber',$this->data);}public function standaloneScrape(){$this->data['pageTitle']='Quick Scraper | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneScraper',$this->data);}private function storeScrapedData($scrapedData){$db=\Config\Database::connect();$builder=$db->table('bf_marketing_temp_scraper');$data=['title'=>$scrapedData['title'],'content'=>$scrapedData['content'],'links'=>json_encode($scrapedData['links']),'url'=>$scrapedData['url'],'created_at'=>date('Y-m-d H:i:s'),'updated_at'=>date('Y-m-d H:i:s'),];$builder->insert($data);}public function submitContent(){$request=service('request');$validationRules=['campaignName'=>'required|min_length[3]','promotionalLinks'=>'required','facebookMessage'=>'required','linkedinMessage'=>'required','discordMessage'=>'required','stockTwitsMessage'=>'required','tiktokMessage'=>'required','youtubeMessage'=>'required','emailMessage'=>'required',];if(!$this->validate($validationRules)){return redirect()->back()->with('errors',$this->validator->getErrors())->withInput();}$campaignData=['name'=>$request->getPost('campaignName'),'promotional_links'=>json_encode($request->getPost('promotionalLinks')),'facebook_message'=>$request->getPost('facebookMessage'),'linkedin_message'=>$request->getPost('linkedinMessage'),'discord_message'=>$request->getPost('discordMessage'),'stocktwits_message'=>$request->getPost('stockTwitsMessage'),'tiktok_message'=>$request->getPost('tiktokMessage'),'youtube_message'=>$request->getPost('youtubeMessage'),'email_message'=>$request->getPost('emailMessage'),'additional_info'=>$request->getPost('additionalInfo'),'created_on'=>date('Y-m-d H:i:s'),'status'=>1,'stage'=>'draft',];$marketingModel=new MarketingModel();if($marketingModel->insert($campaignData)){return redirect()->to('/Marketing/Success')->with('success','Marketing content submitted successfully.');}else{return redirect()->back()->with('error','Failed to submit marketing content.')->withInput();}}public function submitDailyLog(){$data=['title'=>$this->request->getPost('subject'),'content'=>$this->request->getPost('log_content'),'subcontent'=>json_encode($this->request->getPost('subcontent')),'tags'=>$this->request->getPost('tags'),'type'=>$this->request->getPost('content_type'),'url'=>$this->request->getPost('url'),'author_information'=>$this->request->getPost('author_information'),'date_time'=>$this->request->getPost('date_time'),'trade_alert_subcategory'=>$this->request->getPost('trade_alert_subcategory'),'created_on'=>date('Y-m-d H:i:s'),];if($this->marketingModel->saveDailyLog($data)){return $this->response->setJSON(['success'=>true,'message'=>'Daily log submitted successfully!']);}else{return $this->response->setJSON(['success'=>false,'message'=>'Failed to submit daily log.']);}}public function submitLargeContent(){log_message('debug','submitLargeContent method called');try{$subject=$this->request->getPost('subject');$url=$this->request->getPost('url');$content=$this->request->getPost('large_content');$tags=$this->request->getPost('tags');$uploadedFiles=$this->request->getFiles();$contentType=$this->request->getPost('content_type');$mediaAssets=$this->handleMediaUpload($uploadedFiles['media_assets']);if(empty($content)||strlen($content)<50){throw new \Exception('Content too short or empty');}$generatedContent=$this->getMyMIMarketing()->generateContentFromLargeText($content,$tags);$keywords=is_array($generatedContent['keywords'])?$generatedContent['keywords']:[];$this->marketingModel->storeScrapedContent(['status'=>'pending','type'=>$contentType,'url'=>$url,'title'=>$subject,'summary'=>$generatedContent['summary'],'content'=>$content,'keywords'=>implode(', ',$keywords),'created_on'=>date('Y-m-d H:i:s'),]);return $this->response->setJSON(['success'=>true]);}catch(\Exception $e){log_message('error','submitLargeContent error: '.$e->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to submit content.']);}}public function submitLargeContentForm(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();$this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneLargeContentForm',$this->data);}public function submitMarketingCampaign(){helper(['form','url']);$data=['name'=>$this->request->getPost('campaignName'),'assigned_to'=>$this->request->getPost('assigned_to'),'promotional_links'=>json_encode($this->request->getPost('promotionalLinks')),'facebook_message'=>htmlentities($this->request->getPost('facebookMessage'),ENT_QUOTES,'UTF-8'),'linkedin_message'=>htmlentities($this->request->getPost('linkedinMessage'),ENT_QUOTES,'UTF-8'),'discord_message'=>htmlentities($this->request->getPost('discordMessage'),ENT_QUOTES,'UTF-8'),'stocktwits_message'=>htmlentities($this->request->getPost('stocktwitsMessage'),ENT_QUOTES,'UTF-8'),'tiktok_message'=>htmlentities($this->request->getPost('tiktokMessage'),ENT_QUOTES,'UTF-8'),'youtube_message'=>htmlentities($this->request->getPost('youtubeMessage'),ENT_QUOTES,'UTF-8'),'email_message'=>htmlentities($this->request->getPost('emailMessage'),ENT_QUOTES,'UTF-8'),'additional_info'=>htmlentities($this->request->getPost('additionalInfo'),ENT_QUOTES,'UTF-8'),'overall_campaign_description'=>htmlentities($this->request->getPost('overall_campaign_description'),ENT_QUOTES,'UTF-8'),'voice_script'=>htmlentities($this->request->getPost('voice_script'),ENT_QUOTES,'UTF-8')];if($this->validate(['name'=>'required','facebook_message'=>'required',])){$this->marketingModel->submitCampaignContent($data);return redirect()->to('/dashboard')->with('success','Campaign submitted successfully.');}else{return redirect()->back()->withInput()->with('errors',$this->validator->getErrors());}}public function submitMarketIdeas(){if($this->request->getMethod()==='post'){$data=['title'=>$this->request->getPost('title'),'description'=>htmlentities($this->request->getPost('description'),ENT_QUOTES,'UTF-8'),'created_by'=>session()->get('user_id'),'assigned_to'=>$this->request->getPost('assigned_to'),'priority'=>$this->request->getPost('priority'),'status'=>'draft','platforms'=>json_encode($this->request->getPost('platforms')),'additional_info'=>htmlentities($this->request->getPost('additional_info'),ENT_QUOTES,'UTF-8'),];$uploadedFiles=$this->request->getFiles();$filePaths=[];if($uploadedFiles&&isset($uploadedFiles['imageFiles'])){foreach($uploadedFiles['imageFiles']as $file){if($file->isValid()&&!$file->hasMoved()){$newName=$file->getRandomName();$file->move(FCPATH.'public/assets/images/Marketing/Ideas',$newName);$filePaths[]=base_url('assets/images/Marketing/Ideas/'.$newName);}}}if(!empty($filePaths)){$data['image_paths']=json_encode($filePaths);}if($this->validate(['title'=>'required','description'=>'required'])){$this->marketingModel->submitIdea($data);return redirect()->back()->with('success','Idea submitted successfully.');}else{return redirect()->back()->withInput()->with('errors',$this->validator->getErrors());}}}public function topCommunities($channel=null){$this->commonData();$MyMIExchange=new MyMIExchange();$exchangeTokens=$MyMIExchange->getSolanaTokens();if(!empty($channel)){if($channel==='Discord'){$this->data['tokens']=$exchangeTokens['discord'];$this->data['pageTitle']='Discord Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\discord',$this->data);}elseif($channel==='Facebook'){$this->data['tokens']=$exchangeTokens['facebook'];$this->data['pageTitle']='Facebook Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\facebook',$this->data);}elseif($channel==='Twitter'){$this->data['tokens']=$exchangeTokens['x_twitter'];$this->data['pageTitle']='Twitter Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\twitter',$this->data);}elseif($channel==='Website'){$this->data['tokens']=$exchangeTokens['website'];$this->data['pageTitle']='Website Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\website',$this->data);}else{$this->data['tokens']=$exchangeTokens['all'];$this->data['pageTitle']='All Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\all_tokens',$this->data);}}else{$this->data['tokens']=$exchangeTokens['all'];$this->data['pageTitle']='All Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\all_tokens',$this->data);}}public function triggerPostAutogenOnEmpty(){$today=date('Y-m-d');$existing=$this->marketingModel->getLatestGeneratedSummaries(5,$today);if(!empty($existing)){return $this->response->setJSON(['status'=>'skipped','message'=>'Summaries already exist for today.']);}try{$this->getMyMIMarketing()->generateFromTempScraper(5);return $this->response->setJSON(['status'=>'generated','message'=>'Generated new summaries.']);}catch(\Throwable $e){log_message('error','triggerPostAutogenOnEmpty error: '.$e->getMessage());return $this->failServerError('Failed to generate summaries.');}}public function twitterDashboard(){$data=['pageTitle'=>'Twitter Dashboard','hashtags'=>$this->request->getPost('hashtags')?? '','tweets'=>[]];if($this->request->getMethod()==='post'){$hashtags=$this->request->getPost('hashtags');$tweets=$this->getMyMIMarketing()->fetchTweets($hashtags);$data['tweets']=$tweets;}return $this->renderTheme('Management/Marketing/Twitter',$data);}public function upcomingEarnings(){$model=new \App\Models\EarningsModel();$upcomingEarnings=$model->getUpcomingEarnings();$this->data['upcomingEarnings']=$upcomingEarnings;return $this->renderTheme('ManagementModule\Views\Marketing\upcoming_earnings',$this->data);}public function updatePlatformToggle($id){$post=$this->request->getJSON(true);$platform=$post['platform'];$enabled=(bool) $post['enabled'];$record=$this->marketingModel->getBufferItem($id);$platforms=json_decode($record['platforms']?? '{}',true);$platforms[$platform]=$enabled;$this->marketingModel->updateBufferItem($id,['platforms'=>json_encode($platforms)]);return $this->respond(['status'=>'success']);}public function viewBlog($slug){$blogPost=$this->marketingModel->getBlogPostBySlug($slug);if(!$blogPost){throw new \CodeIgniter\Exceptions\PageNotFoundException('Blog post not found');}return $this->renderTheme('blog/view',['blogPost'=>$blogPost]);}public function viewCampaign($campaign_id){$campaignModel=new CampaignModel();$campaign=$this->marketingModel->getCampaignsById($campaign_id);if(!$campaign){throw new \CodeIgniter\Exceptions\PageNotFoundException("Campaign not found");}return $this->renderTheme('ManagementModule\Views\Marketing\Campaigns\View',['campaign'=>$campaign]);}public function viewDailyLogs($date=null){$date=$this->siteSettings->date ?? date('Y-m-d');$this->data['pageTitle']='Marketing Daily Log | '.$date.' | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['logs']=$this->marketingModel->getDailyLogsByDate($date);$this->commonData();return $this->renderTheme('ManagementModul\Views\Marketing\Daily_Logs',['logs'=>$logs,'date'=>$date]);}public function viewEmail($titleEncoded=null,$messageId=null){log_message('debug','ðŸ“§ ManagementController::viewEmail called');try{if(empty($messageId)){return redirect()->back()->with('error','Invalid email identifier.');}$emailRecord=$this->marketingModel->getEmailByMessageId($messageId);if(!$emailRecord){return redirect()->back()->with('error','Email not found.');}$socialMediaPosts=$this->getMarketingService()->generateContentFromRaw($emailRecord);$emailRecord['social_media']=$socialMediaPosts['posts']??[];return $this->renderTheme('Management/Marketing/EmailDetail',['email'=>$emailRecord]);}catch(\Throwable $e){log_message('error','âŒ viewEmail() failed: '.$e->getMessage());return $this->failServerError('Unable to load email.');}}public function viewGeneratedContent(){$contentData=$this->marketingModel->getLastGeneratedContent();$platformsContent=json_decode($contentData['platforms_content'],true);$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['platforms_content']=$platformsContent;$this->commonData();$this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneGeneratedContent',$this->data);}public function viewGeneratedSummaries(){$this->data['pageTitle']='Generated Summaries';$this->data['generatedSummaries']=$this->marketingModel->getLatestGeneratedSummaries(25);$this->renderTheme('ManagementModule\Views\Marketing\resources\generatedSummaries',$this->data);}} ?><?php namespace App\Modules\APIs\Controllers;use CodeIgniter\API\ResponseTrait;use CodeIgniter\Controller;use App\Libraries\{BaseLoader,MyMIMarketing};use App\Services\MarketingService;use App\Models\MarketingModel;class MarketingController extends Controller{use ResponseTrait;use BaseLoader;protected $MyMIMarketing;protected $marketingService;protected $marketingModel;public function __construct(){$this->MyMIMarketing=new MyMIMarketing();$this->marketingModel=new MarketingModel();}public function approveBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Record not found.");$this->marketingModel->updateBufferItem($id,['status'=>'approved']);$posts=$this->MyMIMarketing->generateSocialPost($record);$this->MyMIMarketing->distributeContent('discord',$posts['discord']);$this->MyMIMarketing->distributeContent('linkedin',$posts['linkedin']);return $this->respond(['status'=>'success','message'=>'Content approved & promoted!']);}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);return $this->respond(['status'=>'success','message'=>'Content analysis completed.']);}public function cronFetchAndGenerateNews(){try{$this->MyMIMarketing->cronFetchAndGenerateNews();return $this->respond(['status'=>'success','message'=>'News fetched and generated.']);}catch(\Throwable $e){return $this->failServerError($e->getMessage());}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();return $this->respond(['status'=>'success','message'=>'Inbox scraped.']);}public function cronFetchMarketingEmails(){log_message('info','ðŸ“¬ CRON: Fetching marketing emails via inbox scrape');try{$result=$this->getMyMIMarketing()->scrapeInboxAndStore();return $this->respond(['status'=>'success','message'=>'Marketing inbox scrape completed.','result'=>$result]);}catch(\Throwable $e){log_message('error','âŒ cronFetchMarketingEmails() failed: '.$e->getMessage());return $this->failServerError('Inbox fetch failed: '.$e->getMessage());}}public function distributeHighScoreContent(){try{$this->getMyMIMarketing()->autoSendToZapier(80);return $this->respond(['status'=>'success','message'=>'Top scoring posts sent to Zapier']);}catch(\Throwable $e){return $this->failServerError($e->getMessage());}}public function exportBufferPosts(){helper('text');$model=new \App\Models\MarketingModel();$bufferPosts=$model->fetchBufferPostsForScoring();$filename='buffer-posts-'.date('Ymd_His').'.csv';$csvHeader=['ID','Keyword','Summary','Score','Tag Score','Category','Status','Created At'];$csvData=[$csvHeader];foreach($bufferPosts as $post){$csvData[]=[$post['id'],$post['keyword'],word_limiter(strip_tags($post['summary']),10),$post['score'],$post['tag_score'],$post['category'],$post['status'],$post['created_at']?? '',];}header('Content-Type: text/csv');header("Content-Disposition: attachment; filename=\"$filename\"");$f=fopen('php://output','w');foreach($csvData as $row){fputcsv($f,$row);}fclose($f);exit;}public function fetchBufferPaginated(){$request=service('request');$page=(int) $request->getGet('page')?? 1;$limit=(int) $request->getGet('limit')?? 20;$keyword=$request->getGet('keyword');$category=$request->getGet('category');$minTagScore=$request->getGet('min_tag_score')?? 0;$onlySuggested=(bool) $request->getGet('only_suggested');$result=$this->marketingModel->fetchBufferPaginatedWithFilters(['page'=>$page,'limit'=>$limit,'keyword'=>$keyword,'category'=>$category,'min_tag_score'=>$minTagScore,'only_suggested'=>$onlySuggested]);return $this->respond(['status'=>'success','data'=>$result['data'],'pagination'=>$result['pagination']]);}public function fetchGeneratedSummaries(){try{$summaries=$this->marketingModel->getRecentPosts(5);return $this->respond(['status'=>'success','summaries'=>$summaries,]);}catch(\Throwable $e){log_message('error','âŒ fetchGeneratedSummaries Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function fetchGeneratedSummariesBlock(){try{helper('text');$todaysStory=$this->marketingModel->where('DATE(created_at)',date('Y-m-d'))->orderBy('created_at','desc')->findAll();return $this->renderTheme('App\Modules\Management\Views\Marketing\index/generatedSummariesBlock',['todaysStory'=>$todaysStory]);}catch(\Throwable $e){log_message('error','âŒ Failed to fetch summaries block: '.$e->getMessage());return $this->failServerError('Unable to refresh summaries.');}}public function generateContentFromScraper(){try{$this->getMyMIMarketing()->generateFromTempScraper(25);return $this->respond(['status'=>'success','message'=>'Content generated from scraper.']);}catch(\Throwable $e){log_message('error','âŒ generateContentFromScraper Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function generateContentDigestFromStored(){$records=$this->marketingModel->getRecentUnprocessedTempEmails(5);$processedTitles=[];foreach($records as $record){$recordId=$record['id']?? 0;try{if(empty($record['title'])){$record['title']='Fallback Title - ID '.$recordId;}$insertResult=$this->getMyMIMarketing()->generateContentAndInsert($record);if($insertResult){$this->marketingModel->markTempScraperProcessed($recordId);$processedTitles[]=$insertResult['title'];log_message('info',"âœ… Inserted content for ID {$recordId}");}else{log_message('warning',"âš ï¸ Skipped record ID {$recordId} â€” summary not stored");}}catch(\Throwable $e){log_message('error',"âŒ Exception on record ID {$recordId}: {$e->getMessage()}");}}return $this->respond(['status'=>'complete','processed_titles'=>$processedTitles]);}public function generateDailyContentDigest(){@ini_set('memory_limit','768M');$records=$this->marketingModel->getValidUnprocessedEmails(5);$insertedSummaries=[];foreach($records as $record){if(!is_array($record)){log_message('error','âŒ Invalid record structure: Expected array, got '.gettype($record));continue;}try{log_message('debug','ðŸ” Processing record ID '.$record['id']);$result=$this->getMyMIMarketing()->generateContentAndInsert($record);if($result){$this->marketingModel->markTempScraperProcessed($record['id']);$insertedSummaries[]=$result['title']?? '(no title)';log_message('info',"âœ… Successfully processed and inserted record ID {$record['id']}");}else{log_message('warning',"âš ï¸ Skipped or failed to insert record ID {$record['id']}");}}catch(\Throwable $e){log_message('error',"âŒ Exception on record ID {$record['id']}: ".$e->getMessage());}}return $this->respond(['status'=>'success','inserted'=>$insertedSummaries]);}public function generatePostsFromSummary($summaryId=null){try{$summary=$this->marketingModel->find($summaryId);if(!$summary){return $this->failNotFound('Summary not found.');}$decodedTitleRaw=$summary['title']?? '';$decodedSummaryRaw=$summary['summary']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$decodedSummary=quoted_printable_decode($decodedSummaryRaw);$decodedSummary=preg_replace('/=\r?\n/','',$decodedSummary);$decodedSummary=html_entity_decode($decodedSummary,ENT_QUOTES|ENT_HTML5,'UTF-8');$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$decodedTitle);$cleanedSummary=html_entity_decode(strip_tags($decodedSummary));$keywords=$this->MyMIMarketing->extractKeywords($cleanedSummary);$posts=$this->MyMIMarketing->generateSocialPosts($cleanedSummary,$keywords);$this->marketingModel->update($summaryId,['keywords'=>json_encode($keywords),'posts'=>json_encode($posts),]);return $this->respond(['status'=>'success','message'=>'Content generated and stored successfully.','original'=>$summary,'cleaned'=>['title'=>$cleanTitle,'summary'=>$cleanedSummary,'keywords'=>$keywords,'posts'=>$posts,],]);}catch(\Throwable $e){log_message('error','âŒ generatePostsFromSummary() failed: '.$e->getMessage());return $this->failServerError('Error generating posts.');}}public function generateScheduledPosts(){helper('text');$marketingModel=new MarketingModel();$marketing=new MyMIMarketing();$buffer=$marketingModel->getTopBufferPosts(3,6.5);if(empty($buffer)){return $this->respond(['status'=>'empty','message'=>'No queued posts available.']);}foreach($buffer as $post){$marketingModel->updateBufferItem($post['id'],['status'=>'promoted']);$generated=$marketing->generateSocialPost($post);if(json_decode($post['platforms'])->discord ?? false){$marketing->distributeContent('discord',$generated['discord']);}if(json_decode($post['platforms'])->linkedin ?? false){$marketing->distributeContent('linkedin',$generated['linkedin']);}$marketing->notifyModerators($post);}return $this->respond(['status'=>'success','message'=>'Posts published!']);}public function generateVoiceScriptManually(){try{log_message('info','ðŸŽ¤ generateVoiceScriptManually() triggered.');$script=$this->getMyMIMarketing()->generateVoiceoverScript();return $this->response->setJSON(['status'=>'success','script'=>$script]);}catch(\Throwable $e){log_message('error','âŒ Error in generateVoiceScriptManually: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()]);}}public function massResendActivationEmails(){$userModel=new \App\Models\UserModel();$users=$userModel->getPendingActivationUsers();$activator=service('activator');$success=0;$failure=0;foreach($users as $user){if($activator->send($user)){$success++;}else{$failure++;}}return $this->respond(['status'=>'success','message'=>"$success emails sent, $failure failed."]);}public function monitorKeywordsAndScrape(){log_message('info','ðŸ§  Keyword Monitor Started');$keywords=$this->getMyMIMarketing()->getKeywordCandidates();if(empty($keywords)){return $this->respond(['status'=>'no_keywords']);}$results=[];foreach($keywords as $keyword){try{$scrapedData=$this->getMyMIMarketing()->scrapeGoogleSearch($keyword);if(!empty($scrapedData)){$summary=$this->getMyMIMarketing()->generateContentFromScrapedData($scrapedData,'generic');if($summary){$score=$this->getMyMIMarketing()->scoreKeywordRelevance($keyword,$summary);$results[]=['keyword'=>$keyword,'summary'=>$summary,'score'=>$score];$this->marketingModel->storeFinalMarketingContent(['source_id'=>null,'title'=>"Keyword: $keyword",'summary'=>$summary,'keywords'=>$keyword,'score'=>$score,'created_at'=>date('Y-m-d H:i:s')]);}}}catch(\Throwable $e){log_message('error',"âŒ Failed keyword scrape for {$keyword}: ".$e->getMessage());}}return $this->respond(['status'=>'complete','processed'=>$results]);}public function processMarketingTempEmails($limit=5,$mode='daily',$id=null){try{log_message('debug',"ðŸ§  Running unified email processor with mode={$mode}, limit={$limit}, id={$id}");if($id){$record=$this->marketingModel->getEmailRecordById($id);if(!$record||empty($record['content'])){return $this->failNotFound("No valid temp email record found for ID {$id}");}$cleanText=strip_tags($record['content']);$summary=$this->getMyMIMarketing()->summarizeText($cleanText);$keywords=$this->getMyMIMarketing()->extractKeywords($cleanText);if(empty($summary)||empty($keywords)){return $this->fail("Failed to generate summary or keywords for record ID {$id}");}$testPosts=['discord'=>"ðŸ’¬ *{$record['title']}*: {$summary} #".implode(' #',$keywords),'linkedin'=>"ðŸ“¢ {$record['title']} â€” {$summary}",'email'=>"Subject: {$record['title']}\n\n{$summary}",'x'=>substr($summary,0,250).'...'];$generated=['summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts];$this->marketingModel->insertFinalScraper($record,$generated);$this->marketingModel->markTempScraperProcessed($id);return $this->respond(['status'=>'success','message'=>"âœ… Test record stored for ID {$id}",'summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts]);}$records=($mode==='backfill')?$this->marketingModel->getOlderUnprocessedEmails($limit):$this->marketingModel->getValidUnprocessedEmails($limit);$results=[];foreach($records as $record){$recordId=$record['id']?? 0;if(empty($record['title'])){$record['title']="Fallback Title - ID {$recordId}";}try{$insert=$this->getMyMIMarketing()->generateContentAndInsert($record);if($insert){$this->marketingModel->markTempScraperProcessed($recordId);log_message('info',"âœ… Inserted record ID {$recordId}");$results[]=$insert['title'];}else{log_message('warning',"âš ï¸ Skipped ID {$recordId} â€” No summary generated.");}}catch(\Throwable $e){log_message('error',"âŒ Exception on ID {$recordId}: ".$e->getMessage());}}return $this->respond(['status'=>'success','mode'=>$mode,'inserted'=>$results]);}catch(\Throwable $e){return $this->failServerError("ðŸ”¥ Unified content processor failed: ".$e->getMessage());}}public function rankBufferPostsDaily(){$marketingModel=new MarketingModel();$marketing=new MyMIMarketing();$threshold=getenv('MARKETING_TFIDF_THRESHOLD')?:7.5;$pendingPosts=$marketingModel->getPendingBufferItems();foreach($pendingPosts as $post){$scoreData=$marketing->getTopKeywordScores(['summary'=>$post['summary'],]);$update=['score'=>$scoreData['score']?? 0,'tag_score'=>$scoreData['tag_score']?? 0,'tfidf_score'=>$scoreData['tfidf_score']?? 0,'auto_suggest'=>($scoreData['tfidf_score']?? 0)>=$threshold?1:0,];$marketingModel->updateBufferItem($post['id'],$update);}return $this->respond(['status'=>'success','message'=>'Buffer ranks updated.']);}public function rejectBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Record not found.");$this->marketingModel->updateBufferItem($id,['status'=>'rejected']);return $this->respond(['status'=>'success','message'=>'Content rejected.']);}public function runBackfillForTempEmails(){try{log_message('info','[ðŸ”„ Backfill] Starting backfill for unprocessed temp emails...');$unprocessedRecords=$this->marketingModel->where('status',null)->orWhere('status','')->findAll(25);if(empty($unprocessedRecords)){return $this->respond(['status'=>'complete','message'=>'No unprocessed records found.']);}$processedTitles=[];foreach($unprocessedRecords as $record){try{$result=$this->MyMIMarketing->generateContentAndInsert($record);if($result){$this->marketingModel->markTempScraperProcessed($record['id']);$processedTitles[]=$result['title'];}}catch(\Throwable $e){log_message('error','[âŒ Backfill Error] ID '.$record['id'].' â€” '.$e->getMessage());}}return $this->respond(['status'=>'success','processed'=>$processedTitles]);}catch(\Throwable $e){return $this->failServerError('[ðŸ”¥ Backfill Failure] '.$e->getMessage());}}public function testGenerateFromTempEmail($id){try{helper('text');$record=$this->marketingModel->getEmailRecordById($id);if(!$record||empty($record['content'])){return $this->failNotFound("No valid temp email record found for ID {$id}");}log_message('info',"ðŸ§ª Starting test content generation for temp record ID: {$id}");$cleanText=strip_tags($record['content']);$summary=$this->getMyMIMarketing()->summarizeText($cleanText);$summary=quoted_printable_decode($summary);$summary=mb_convert_encoding($summary,'UTF-8','UTF-8');$keywords=$this->getMyMIMarketing()->extractKeywords($cleanText);if(empty($summary)||empty($keywords)){return $this->fail("Failed to generate summary or keywords for record ID {$id}");}$decodedTitleRaw=$record['title']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$decodedTitle);$testPosts=['discord'=>"ðŸ’¬ *{$cleanTitle}*: {$summary} #".implode(' #',$keywords),'linkedin'=>"ðŸ“¢ {$cleanTitle} â€” {$summary}",'email'=>"Subject: {$cleanTitle}\n\n{$summary}",'x'=>substr($summary,0,250).'...',];$generated=['summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts];$this->marketingModel->insertFinalScraper($record,$generated);$this->marketingModel->markTempScraperProcessed($id);log_message('info',"âœ… Test record stored in bf_marketing_scraper for temp ID {$id}");return $this->respond(['status'=>'success','message'=>"Content generated and stored successfully.",'summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts]);}catch(\Throwable $e){log_message('critical',"âŒ testGenerateFromTempEmail({$id}) failed: ".$e->getMessage());return $this->failServerError("An error occurred: ".$e->getMessage());}}public function testTfIdfEdgeCases(){$cases=['Empty String'=>'','Whitespace Only'=>'     ','Single Word'=>'Bitcoin','HTML Only'=>'<div><p></p></div>','Malformed UTF-8'=>"\xB1\x31",'Link-Only Spam'=>'http://marketwatch.com https://example.com','Token Noise'=>str_repeat('$$$!!!@@@###',10),];$results=[];foreach($cases as $label=>$input){try{log_message('info',"ðŸ§ª Running TF-IDF Test Case: $label");$cleanInput=is_string($input)?strip_tags(trim($input)):'';if(strlen($cleanInput)<10||substr_count($cleanInput,' ')<2){log_message('debug',"âš ï¸ Skipping test: $label â€” input too short or lacks structure.");$results[$label]='[Skipped â€” Too short or unstructured]';continue;}$summary=$this->MyMIMarketing->summarizeText($cleanInput);log_message('debug',"Result - Summary: $summary");$results[$label]=$summary;}catch(\Throwable $e){log_message('error',"âŒ $label threw error: ".$e->getMessage());$results[$label]='[Error: '.$e->getMessage().']';}}return $this->renderTheme('App\Modules\Management\Views\Marketing\debugTfIdfResults',['results'=>$results,]);}public function triggerPostAutogenOnEmpty(){try{$existingPosts=$this->marketingModel->where('DATE(scraped_at)',date('Y-m-d'))->countAllResults();if($existingPosts===0){log_message('debug','[ðŸª„ AutoGen Trigger] No posts found for today. Running fallback generatorâ€¦');$this->marketingService->generatePostsFromTodaysSummaries();return $this->respond(['status'=>'success','message'=>'No posts found. Generated fresh content.']);}else{return $this->respond(['status'=>'success','message'=>'Posts already exist for today. No action taken.']);}}catch(\Throwable $e){log_message('error','[âŒ AutoGen Trigger Error] '.$e->getMessage());return $this->respond(['status'=>'error','message'=>'Failed to trigger autogen.','error'=>$e->getMessage()]);}}public function updateBufferScheduleInterval($id){$data=$this->request->getJSON(true);$interval=(int)($data['interval']?? 0);$updated=$this->marketingModel->updateBufferItem($id,['schedule_interval'=>$interval,'scheduled_at'=>null ]);if($updated){return $this->respond(['status'=>'success']);}else{return $this->fail('Failed to update interval.');}}public function updatePlatformToggle($id){$data=$this->request->getJSON(true);$platform=$data['platform'];$enabled=$data['enabled'];$record=$this->marketingModel->find($id);if(!$record){return $this->failNotFound("Record not found.");}$platforms=json_decode($record['platforms']?? '{}',true);$platforms[$platform]=$enabled;$this->marketingModel->update($id,['platforms'=>json_encode($platforms)]);return $this->respond(['status'=>'success']);}} ?><?php namespace App\Libraries;use App\Config\{SiteSettings,SocialMedia};use App\Libraries\{BaseLoader,MyMIInvestments};use App\Libraries\Traits\TextProcessor;use App\Models\{AnalyticalModel,MarketingModel};use App\Services\{EmailService,MarketingService,SolanaService};use CodeIgniter\HTTP\RequestInterface;use CodeIgniter\Session\Session;use Myth\Auth\Authorization\GroupModel;use Exception;use HTMLPurifier;use HTMLPurifier_Config;use Phpml\FeatureExtraction\TokenCountVectorizer;use Phpml\Tokenization\WhitespaceTokenizer;use Phpml\FeatureExtraction\TfIdfTransformer;use NlpTools\Tokenizers\WhitespaceTokenizer as NlpWhitespaceTokenizer;use NlpTools\Similarity\CosineSimilarity;use Facebook\Facebook;use Abraham\TwitterOAuth\TwitterOAuth;use Happyr\LinkedIn\LinkedIn;use Discord\Discord;use Discord\Parts\Channel\Message;use GuzzleHttp\Client;use Scrapemax\ScrapemaxClient;use Pscrape\Pscrape\Scrape as PscrapeScraper;use Symfony\Component\DomCrawler\Crawler;use Google\Cloud\TextToSpeech\V1\TextToSpeechClient;use Google\Cloud\TextToSpeech\V1\SynthesisInput;use Google\Cloud\TextToSpeech\V1\VoiceSelectionParams;use Google\Cloud\TextToSpeech\V1\AudioConfig;use Google\Cloud\TextToSpeech\V1\AudioEncoding;class MyMIMarketing{use BaseLoader;use TextProcessor;protected $auth;protected $cuID;protected $data;protected $debug;protected $logger;protected $request;protected $session;protected $uri;protected $APIs;protected $emailService;protected $solanaService;protected $siteSettings;protected $marketingModel;protected $analyticalModel;protected $socialMedia;protected $facebook;protected $twitter;protected $linkedin;protected $discord;protected $scrapemax;protected $pscrape;public function __construct(){$this->auth=service('authentication');$this->logger=service('logger');$this->request=service('request');$this->session=service('session');$this->uri=$this->request->getUri();$this->APIs=config('APIs');$this->socialMedia=config('SocialMedia');$this->siteSettings=config('SiteSettings');$this->debug=$this->siteSettings->debug;$this->socialMedia=config('SocialMedia');$this->marketingModel=new MarketingModel();$this->analyticalModel=new AnalyticalModel();$this->emailService=service('email');$this->solanaService=new SolanaService();$this->scrapemax=new ScrapemaxClient('https://api.scrapemax.com',$this->APIs->scrapemax_api_key);$this->pscrape=new PscrapeScraper();}public function marketing(){$department=$this->department();$links=$this->social_media();return['links'=>$links,'department'=>$department];}public function distributeTradeAlert($alert,$action='BUY'){$message=$this->generateTradeAlertMessage($alert,$action);$this->postToDiscord($message);$this->postToTwitter($message);$this->postToFacebook($message);$this->postToLinkedIn($message);}public function generateRandomMarketingContent(array $tradeAlert):array{$intros=["ðŸš¨ Breaking Market Update!","ðŸ“¢ Urgent Trade Alert!","ðŸ”¥ High-Momentum Stock Pick!","ðŸš€ Skyrocketing Stocks!","ðŸ’° Smart Money Moves!","âš¡ Quick Market Insight!","ðŸ“ˆ Bullish Breakout Alert!","ðŸ“Š Technical Setup Unfolding!","ðŸ§ Deep Market Analysis!","ðŸ’¡ Pro-Level Trading Insight!"];$emoticons=['ðŸš€','ðŸ”¥','ðŸ’°','ðŸ“ˆ','ðŸ“Š','âš¡','âœ…','ðŸ¤–','ðŸŽ¯','ðŸ”'];$outros=["ðŸ“Š Stay ahead of the markets!","â³ Don't miss this setup!","ðŸ’° Trade smart & maximize gains!","ðŸš€ Follow for more trade alerts!","ðŸ“ˆ Watch this ticker closely!","ðŸ”¥ This could be the next big mover!","ðŸ’¡ Insights that matter. Stay tuned!","ðŸ’Ž Precision trading at its best!","âš¡ More insights coming soon!","ðŸ“¢ Tap in for more premium setups!"];$intro=$intros[array_rand($intros)];$outro=$outros[array_rand($outros)];$emote1=$emoticons[array_rand($emoticons)];$emote2=$emoticons[array_rand($emoticons)];$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$tradeDesc=trim($tradeAlert['trade_description']?? '');$news=trim($tradeAlert['financial_news']?? '');$details=trim($tradeAlert['details']?? '');$price=number_format($tradeAlert['price']?? 0,2);$link=trim($tradeAlert['tv_chart']?? $tradeAlert['tv_chart_link']?? '');$chartText=(!empty($link))?"ðŸ“‰ Chart: [View Here]({$link})\n":'';$fixedLength=strlen($intro)+strlen($outro)+strlen($emote1)+strlen($emote2)+strlen($chartText)+12;$maxMessageLength=2000-$fixedLength;$coreMessage="Trade Alert for **{$ticker}** ({$company}):\n"."Price: \${$price}\n"."Signal: {$tradeDesc}\n"."News: {$news}\n"."Details: {$details}\n".$chartText;if(strlen($coreMessage)>$maxMessageLength){$coreMessage=substr($coreMessage,0,$maxMessageLength-3)."...";}$finalMessage="{$emote1} {$intro}\n{$coreMessage}\n{$outro} {$emote2}";return['twitter'=>substr($finalMessage,0,280),'facebook'=>substr($finalMessage,0,2000),'linkedin'=>substr($finalMessage,0,2000),'discord'=>substr($finalMessage,0,2000)];}public function generateEmailContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$news=$tradeAlert['financial_news']?? '';$details=$tradeAlert['details']?? '';$content="Email Alert for {$ticker} ({$company}):\n"."Current Price: \${$price}\n"."Trade Signal: {$tradeDesc}\n"."Latest News: {$news}\n"."Analysis Details: {$details}\n"."For more information, visit our website.";return $content;}public function generateBlogContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$news=$tradeAlert['financial_news']?? '';$details=$tradeAlert['details']?? '';$content="Blog Post: In-depth Market Analysis on {$ticker} ({$company})\n\n"."Current Price: \${$price}\n\n"."Trade Analysis: {$tradeDesc}\n\n"."Financial News: {$news}\n\n"."Detailed Analysis: {$details}\n\n"."Stay tuned for more insights!";return $content;}public function generateVoiceoverScriptContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$script="Voiceover Script:\n"."Welcome to today's market update. Our focus is on {$ticker} from {$company}.\n"."The current trading price is \${$price}.\n"."Trade insight: {$tradeDesc}.\n"."Thank you for watching. Stay tuned for more updates.";return $script;}public function generateTradeAlertEmailContent(array $tradeAlert):string{$defaultTemplate=<<<S
app/Modules/chatgpt.txt:44:S;}public function formatSocialPost(string $headline,string $summary,string $platform='generic'):string{$hashtags='#MyMIWallet #InvestSmarter #FinancialFreedom';switch($platform){case 'facebook':case 'linkedin':return"{$headline}\n\n{$summary}\n\nStart your journey: https://www.mymiwallet.com\n\n{$hashtags}";case 'twitter':case 'x':$shortSummary=substr($summary,0,180);return"{$headline} â€” {$shortSummary}...\nhttps://www.mymiwallet.com\n{$hashtags}";default:return"{$headline}\n\n{$summary}\nhttps://www.mymiwallet.com";}}public function formatDiscordPost(string $headline,string $summary):string{return"**{$headline}**\n\n{$summary}\n\nðŸ‘‰ <https://www.mymiwallet.com>";}private function normalizeUtf8($text){return mb_convert_encoding($text,'UTF-8',mb_detect_encoding($text,'UTF-8, ISO-8859-1',true));}private function notifyAdminOnError($subject,$message){$this->emailService->setFrom('no-reply@mymiwallet.com','MyMI Wallet');$this->emailService->setTo('team@mymiwallet.com');$this->emailService->setSubject($subject);$this->emailService->setMessage($message);if(!$this->emailService->send()){$this->logger->error('Failed to send error notification email: '.print_r($this->emailService->printDebugger(),true));}}public function notifyModerators(array $post){$platforms=json_decode($post['platforms']?? '{}',true);$used=implode(', ',array_keys(array_filter($platforms)));$subject="ðŸ“¢ Buffer Post Promoted: {$post['keyword']}";$message="âœ… Post ID: {$post['id']}\n\n"."Summary: ".wordwrap($post['summary'],80)."\n\n"."Promoted Platforms: {$used}\n\n".site_url('Marketing/PreviewGeneratedPost/'.$post['id']);$email=\Config\Services::email();$email->setTo('moderators@mymiwallet.com');$email->setSubject($subject);$email->setMessage($message);$email->send();log_message('info',"ðŸ“¬ Sent moderator alert for Buffer ID {$post['id']}");}public function reprocessIncompleteEmails(){$incompleteRecords=$this->marketingModel->getEmailsMissingTitleOrUrl(20);log_message('debug','ðŸ“‹ MyMIMarketing L986 - Incomplete records fetched: '.count($incompleteRecords));foreach($incompleteRecords as $record){try{$emailId=$record['message_id']?? null;$content=$record['content']?? '';$title=$record['title']?? '';$url=$record['url']?? '';if(!$emailId)continue;$email=$this->fetchEmailByMessageId($emailId);if($email){$content=$email['body']?? $content;$title=$email['subject']?? $title;$url=$email['link']?? $url;}$title=$title?:'Untitled Email - '.date('Y-m-d H:i');$url=$url?:'https://mymiwallet.com/news/fallback';$this->marketingModel->updateEmailFields($record['id'],$title,$url,$content);}catch(\Throwable $e){log_message('error','âŒ Error backfilling email ID '.$record['id'].': '.$e->getMessage());}}}private function retry($function,$attempts=3,$delay=2000){$attempt=0;while($attempt<$attempts){try{return $function();}catch(Exception $e){$attempt++;if($attempt>=$attempts){throw $e;}sleep($delay/1000);}}}private function sanitizeContent($content){$content=preg_replace('#<script(.*?)>(.*?)</script>#is','',$content);$content=preg_replace('#<noscript(.*?)>(.*?)</noscript>#is','',$content);$content=strip_tags($content)?? '';$content=preg_replace('/\.\s*/','. ',$content);return $content;}public function sanitizeRawEmailContent(string $rawContent):string{log_message('debug','ðŸ§ª MyMIMarketing L1140 - Raw Email Before Cleaning: {raw}',['raw'=>$rawContent]);$clean=preg_replace("/=\r\n|\=\n/",'',$rawContent);$clean=quoted_printable_decode($clean);$clean=html_entity_decode($clean,ENT_QUOTES|ENT_HTML5,'UTF-8');$clean=strip_tags($clean);$clean=preg_replace('/\s+/',' ',$clean);$clean=mb_convert_encoding($clean,'UTF-8','UTF-8');log_message('debug','âœ… MyMIMarketing L1159 - Cleaned Email Output: {clean}',['clean'=>$clean]);return trim($clean);}private function sanitizeText(string $text):string{return strip_tags(html_entity_decode($text));}public function saveTradingViewChart($chartUrl,$ticker){$saveDir=FCPATH.'assets/images/Alerts/Charts/';if(!is_dir($saveDir)){mkdir($saveDir,0777,true);}$timestamp=time();$filename="{$ticker}_chart_{$timestamp}.jpg";$savePath=$saveDir.$filename;$ch=curl_init($chartUrl);$fp=fopen($savePath,'wb');curl_setopt($ch,CURLOPT_FILE,$fp);curl_setopt($ch,CURLOPT_HEADER,0);curl_exec($ch);curl_close($ch);fclose($fp);if(file_exists($savePath)){return $filename;}else{return null;}}public function scoreKeywordRelevance(string $keyword,string $summary):int{$keyword=strtolower($keyword);$summaryText=strtolower(strip_tags($summary));$totalWords=str_word_count($summaryText);if($totalWords===0)return 0;$matches=substr_count($summaryText,$keyword);$score=min(100,round(($matches/$totalWords)*500));return $score;}public function scrapeTokenContent($tokenInfo){$scrapedData=[];foreach($tokenInfo as $token){if(!empty($token['website'])){log_message('debug','MyMIMarketing L101 - $token[website]: '.$token['website']);$websiteData=$this->scrapeWebsite($token['website']);log_message('debug','MyMIMarketing L103 - $websiteData: '.print_r($websiteData,true));$this->storeTemporaryData($websiteData);$scrapedData[]=$websiteData;}if(!empty($token['facebook'])){log_message('debug','MyMIMarketing L109 - $token[facebook]: '.$token['facebook']);$facebookData=$this->scrapeFacebook($token['facebook']);log_message('debug','MyMIMarketing L111 - $facebookData: '.print_r($facebookData,true));$this->storeTemporaryData($facebookData);$scrapedData[]=$facebookData;}if(!empty($token['twitter'])){log_message('debug','MyMIMarketing L117 - $token[twitter]: '.$token['twitter']);$twitterData=$this->scrapeTwitter($token['twitter']);log_message('debug','MyMIMarketing L119 - $twitterData: '.print_r($twitterData,true));$this->storeTemporaryData($twitterData);$scrapedData[]=$twitterData;}log_message('debug','MyMIMarketing L117 - $token[symbol] $token[name]: '.$token['symbol'].' '.$token['coin_name']);$googleData=$this->scrapeGoogleSearch($token['symbol'].' '.$token['coin_name']);$this->storeTemporaryData($googleData);$scrapedData[]=$googleData;}return $scrapedData;}public function scrapeAndGenerateContent($accountid,$category,$platform=null){$generatedData=[];if($category==='Solana'){$this->solanaModel=new SolanaModel();$tokenInfo=$this->solanaModel->getTokenInfoByID($accountid);}else{$tokenInfo=[];}if(!empty($tokenInfo)){$scrapedData=[];try{log_message('debug','Attempting to scrape token content.');$scrapedData=$this->scrapeTokenContent($tokenInfo);log_message('debug','Scraped Data: '.print_r($scrapedData,true));}catch(\GuzzleHttp\Exception\ClientException $e){if($e->getResponse()->getStatusCode()==403){log_message('critical','403 Forbidden encountered while scraping website: '.$e->getMessage());}else{log_message('critical','ClientException: '.$e->getMessage());}}catch(\Exception $e){log_message('critical','An error occurred while scraping token content: '.$e->getMessage());}try{if(!empty($scrapedData)){log_message('debug','Attempting to generate content from scraped data.');$generatedData=$this->generateContentFromScrapedData($scrapedData,$platform);log_message('debug','Generated Data: '.print_r($generatedData,true));}else{log_message('debug','Scraped data is empty.');}}catch(\Exception $e){log_message('critical','An error occurred while generating content: '.$e->getMessage());}}else{log_message('debug','Token information is empty.');}return $generatedData;}private function scrapeWebsite($url){try{$client=new Client();$response=$client->get($url);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$crawler=new \Symfony\Component\DomCrawler\Crawler($html);return['title'=>$crawler->filter('title')->text(),'content'=>$this->sanitizeContent($crawler->filter('body')->html()),];}}catch(RequestException $e){$this->logger->error('Error scraping website: '.$e->getMessage());}return[];}private function scrapeFacebook($url){return $this->scrapeWithRetries('facebook',$url,function($content){return['title'=>$content['page_title']?? 'No title','content'=>$this->sanitizeContent($content['posts']?? 'No posts'),];});}private function scrapeTwitter($url){return $this->scrapeWithRetries('twitter',$url,function($content){return['title'=>$content['profile']?? 'No title','content'=>$this->sanitizeContent($content['tweets']?? 'No tweets'),];});}private function scrapeWithRetries($type,$url,$transform,$retries=3){$backoff=1;for($i=0;$i<$retries;$i++){try{$response=$this->scrapemax->scrape(['target_url'=>$url,'type'=>'data','js_enabled'=>1,'base64_encoded'=>0]);$content=json_decode($response->getBody()->getContents(),true);if(empty($content)){throw new \Exception("No content returned");}return $transform($content);}catch(ServerException $e){if($i<$retries-1){sleep($backoff);$backoff*=2;continue;}$this->logger->error("Error scraping $type: ".$e->getMessage());}catch(RequestException $e){$this->logger->error("Error scraping $type: ".$e->getMessage());break;}catch(\Exception $e){$this->logger->error("General error scraping $type: ".$e->getMessage());break;}}return['title'=>'No title','content'=>'No content'];}private function scrapeGoogleSearch($query){try{$results=$this->pscrape->rollingCurl('rollingCurl');$results->request('https://www.google.com/search?q='.urlencode($query));$content='';$resultsData=$results->execute();if(!is_array($resultsData)){throw new \Exception("Google search did not return an array");}foreach($resultsData as $result){$content.=$result['title'].' '.$result['link'].' ';}return['title'=>'Google Search Results for '.$query,'content'=>$this->sanitizeContent($content),];}catch(\Exception $e){$this->logger->error('Error scraping Google Search: '.$e->getMessage());}return[];}public function sendZapierTradeAlert($tradeAlert){$zapierWebhookUrl="YOUR_ZAPIER_WEBHOOK_URL";$payload=json_encode(['ticker'=>$tradeAlert['ticker'],'price'=>$tradeAlert['price'],'sentiment'=>$tradeAlert['market_sentiment'],'chart_link'=>$tradeAlert['link'],'created_on'=>$tradeAlert['created_on']]);$ch=curl_init($zapierWebhookUrl);curl_setopt($ch,CURLOPT_HTTPHEADER,['Content-Type: application/json']);curl_setopt($ch,CURLOPT_POST,1);curl_setopt($ch,CURLOPT_POSTFIELDS,$payload);curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);$response=curl_exec($ch);curl_close($ch);return $response;}public function standaloneScrapeWebsite($url){try{$client=new Client();$response=$client->get($url);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$crawler=new Crawler($html);$content=$crawler->filter('body')->each(function($node){return $node->text();});$content=array_filter($content,function($text){return!str_contains($text,'footer')&&!str_contains($text,'head');});$data=['url'=>$url,'content'=>implode(' ',$content),'scraped_at'=>date('Y-m-d H:i:s')];$this->saveTemporaryScrapedData($data);return $data;}else{log_message('error','Failed to scrape website. HTTP status code: '.$response->getStatusCode());}}catch(RequestException $e){log_message('error','RequestException while scraping website: '.$e->getMessage());}catch(\Throwable $th){log_message('error','Throwable error while scraping website: '.$th->getMessage());}return false;}public function saveTemporaryScrapedData($data){$marketingModel=new \App\Models\MarketingModel();return $this->marketingModel->insertTemporaryData($data);}private function storeTemporaryData($data){if(!empty($data)){$this->marketingModel->insertTemporaryData($data);}else{$this->logger->warning('Attempted to store empty data.');}}private function selectSummarySentences($sentences,$scores,$topN=5){arsort($scores,SORT_NUMERIC);$topSentenceIndexes=array_keys(array_slice($scores,0,$topN,true));$summary=array_intersect_key($sentences,array_flip($topSentenceIndexes));usort($summary,function($a,$b)use($sentences){return array_search($a,$sentences)-array_search($b,$sentences);});return $summary;}private function splitIntoSentences($content){$content=preg_replace('/\s+/',' ',trim($content));$sentences=preg_split('/(?<=[.!?])\s+/',$content,-1,PREG_SPLIT_NO_EMPTY);return array_filter($sentences,function($sentence){return strlen(trim($sentence))>0;});}public function summarize($text,$method='textrank',$charLimit=500){$text=$this->cleanText($text);if($method==='tfidf'){return $this->summarizeText($text);}else{return $this->summarizeContent($text,$charLimit);}}public function summarizeContent($content,$charLimit=500){if(empty(trim($content))){$this->logger->error('$content is Empty for summarizeContent() function');return[];}$sentences=$this->splitIntoSentences($content);if(empty($sentences)){log_message('warning','âš ï¸ MyMIMarketing L1306 - summarizeContent(): No valid sentences found in content.');return null;}if(empty($sentences)){$this->logger->error('No sentences found for summarization');return[];}$tokens=$this->tokenizeWithNlpTools($content);$features=$this->extractFeaturesWithPhpMl($content);$wordFrequencies=$this->calculateWordFrequencies($content,$this->getStopWords());$similarityMatrix=$this->buildSimilarityMatrix($sentences,$wordFrequencies);$scores=$this->pageRank($similarityMatrix);$summary=$this->buildSummaryToCharLimit($sentences,$scores,$charLimit);$finalSummary=$this->convertUrlsToLinks($summary);return!empty($finalSummary)?['sentences'=>$sentences,'tokens'=>$tokens,'features'=>$features,'wordFrequencies'=>$wordFrequencies,'similarityMatrix'=>$similarityMatrix,'scores'=>$scores,'summary'=>$finalSummary,]:$summary;}public function summarizeContentFromHtml(string $html,$recordId=null):array{$html=quoted_printable_decode($html);$html=html_entity_decode($html,ENT_QUOTES|ENT_HTML5,'UTF-8');$html=preg_replace('/=\r?\n/','',$html);$plainText=strip_tags(html_entity_decode($html));$cleaned=$this->sanitizeRawEmailContent($plainText);if(strlen($cleaned)<300||substr_count($cleaned,' ')<20){$logSuffix=$recordId?" (ID: $recordId)":'';log_message('info',"[MyMIMarketing] summarizeContentFromHtml(): Skipping â€” content too short or lacks structure{$logSuffix}");return['summary'=>'','keywords'=>[]];}$cleaned=preg_replace('/\s{2,}/',' ',$cleaned);$summaryData=$this->summarizeContent($cleaned);if(!is_array($summaryData)||empty($summaryData['summary'])){return['summary'=>'','keywords'=>[]];}$keywords=$this->marketingModel->extractKeywords($cleaned);return['summary'=>$summaryData['summary'],'keywords'=>$keywords ??[],'featureScore'=>$summaryData['featureScore']?? null,'keywordScore'=>$summaryData['keywordScore']?? null,'pageRankScore'=>$summaryData['pageRankScore']?? null,'semanticDiversityScore'=>$summaryData['semanticDiversityScore']?? null,];}public function summarizeContentTextRank($content){$sentences=$this->splitIntoSentences($content);$similarityMatrix=$this->buildSimilarityMatrix($sentences);$scores=$this->pageRank($similarityMatrix);return $this->extractTopSentences($sentences,$scores);}public function summarizeText($text,$maxSentences=5){if(!is_string($text)||empty(trim($text))){log_message('error','summarizeText(): Empty or invalid input text provided.');return 'Summary not available.';}$sentences=$this->splitIntoSentences($text);if(empty($sentences)||count($sentences)<2){log_message('warning','summarizeText(): Not enough content to summarize.');return implode(' ',$sentences);}$vectorizer=new TokenCountVectorizer(new WhitespaceTokenizer());$vectorizer->fit($sentences);$vectorizer->transform($sentences);$tfidf=new TfIdfTransformer();try{$tfidf->fit($sentences);$tfidf->transform($sentences);}catch(\Throwable $e){log_message('error','summarizeText(): TF-IDF transform failed â€” '.$e->getMessage());return 'Summary unavailable due to processing error.';}$scores=[];foreach($sentences as $i=>$vector){$score=0;foreach($vector as $value){$score+=(float)$value;}$scores[$i]=$score;}arsort($scores);$topIndexes=array_slice(array_keys($scores),0,$maxSentences);sort($topIndexes);$originalSentences=$this->splitIntoSentences($text);$summary=implode(' ',array_map(fn($i)=>$originalSentences[$i],$topIndexes));return $summary;}private function tokenizeSmart($text,$method='nlp'){return $method==='nlp'?$this->tokenizeWithNlpTools($text):$this->tokenizeText($text);}private function tokenizeText($text){$text=strtolower(strip_tags($text));return preg_split('/\W+/',$text,-1,PREG_SPLIT_NO_EMPTY);}public function tokenizeWithNlpTools($content){$tokenizer=new NlpWhitespaceTokenizer();$tokens=$tokenizer->tokenize($content);$this->logger->debug('Tokens: '.print_r($tokens,true));return $tokens;}public function insertFinalScraper($record,$summary){$model=new MarketingModel();if(!isset($record['id'])||!$summary){log_message('error','âŒ Missing record ID or summary when calling insertFinalScraper()');return false;}$existing=$model->where('source_id',$record['id'])->first();if($existing){log_message('info',"âš ï¸ Final scrape already exists for source_id: {$record['id']}");return false;}$cleanSummary=mb_convert_encoding($summary['summary'],'UTF-8','UTF-8');$cleanTitle=isset($record['title'])?$record['title']:word_limiter($cleanSummary,12);$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$cleanTitle);$data=['source_id'=>$record['id'],'title'=>trim($cleanTitle),'summary'=>trim($cleanSummary),'keywords'=>isset($summary['keywords'])?implode(',',$summary['keywords']):'','date_created'=>date('Y-m-d H:i:s'),];$result=$model->insert($data);if($result){log_message('info',"âœ… Final scraped content inserted for source_id: {$record['id']}");}else{log_message('error',"âŒ Failed to insert final scrape for source_id: {$record['id']}");}return $result;}private function cleanText($text){$text=$this->decodeSpecialCharacters($text);$text=$this->sanitizeRawEmailContent($text);return $this->normalizeUtf8(strip_tags($text));}private function combineScores($featureScore,$keywordScore,$pageRankScore,$semanticDiversityScore){$featureScore=is_numeric($featureScore)?(float)$featureScore:0.0;$keywordScore=is_numeric($keywordScore)?(float)$keywordScore:0.0;$pageRankScore=is_numeric($pageRankScore)?(float)$pageRankScore:0.0;$semanticDiversityScore=is_numeric($semanticDiversityScore)?(float)$semanticDiversityScore:0.0;$combinedScore=0.4*$featureScore+0.2*$keywordScore+0.3*$pageRankScore+0.1*$semanticDiversityScore;$this->logger->debug('âœ… Combined Score for sentence: '.$combinedScore);return $combinedScore;}private function buildSimilarityMatrix($sentences,$wordFrequencies){$matrix=[];$sentenceLength=count($sentences);for($i=0;$i<$sentenceLength;$i++){for($j=0;$j<$sentenceLength;$j++){if($i!=$j){$matrix[$i][$j]=$this->calculateSimilarity($sentences[$i],$sentences[$j],$wordFrequencies);}}}return $matrix;}private function calculateSimilarity($sentence1,$sentence2,$wordFrequencies){$sentence1=is_string($sentence1)?strtolower($sentence1):'';$sentence2=is_string($sentence2)?strtolower($sentence2):'';$words1=array_unique(str_word_count($sentence1,1));$words2=array_unique(str_word_count($sentence2,1));$commonWords=array_intersect($words1,$words2);$score=0;foreach($commonWords as $word){$score+=(float)($wordFrequencies[$word]?? 0);}$logWordCount1=count($words1)>0?log(count($words1)):0;$logWordCount2=count($words2)>0?log(count($words2)):0;if($logWordCount1+$logWordCount2==0){return 0;}return $score/($logWordCount1+$logWordCount2);}private function calculateWordFrequencies($content,$stopWords){$frequencies=[];$words=preg_split('/\s+/',strtolower($content));foreach($words as $word){if(!in_array($word,$stopWords)&&strlen($word)>1){$frequencies[$word]=($frequencies[$word]?? 0)+1;}}arsort($frequencies);return $frequencies;}public function decodeMimeHeaderSafe($string){try{return mb_decode_mimeheader($string);}catch(\Throwable $e){log_message('error','decodeMimeHeaderSafe() failed: '.$e->getMessage());return $string;}}private function decodeSpecialCharacters($text){return html_entity_decode($text,ENT_QUOTES|ENT_HTML5,'UTF-8');}public function getScrapesByKeyword($keyword){return $this->marketingModel->getScrapesByKeyword($keyword);}private function getStopWords(){return["a","the","and","of","in","to","is","you","that","it","he","was","for","on","are","as","with","his","they","I","at","be","this","have","from","or","one","had","by","word","but","not","what","all","were","we","when","your","can","said","there","use","an","each","which","she","do","how","their","if","will","up","other","about","out","many","then","them","these","so","some","her","would","make","like","him","into","time","has","look","two","more","write","go","see","number","no","way","could","people","my","than","first","water","been","call","who","oil","its","now","find","long","down","day","did","get","come","made","may","part"];}public function getTopKeywordScores($content,$max=10){if(!is_string($content)){log_message('error','MyMIMarketing L1706 - getTopKeywordScores(): Content must be a string');return[];}$content=$this->normalizeUtf8($content);$sentences=$this->splitIntoSentences($content);if(empty($sentences)){log_message('error','MyMIMarketing L1713 - getTopKeywordScores(): No valid sentences to process');return[];}$tfIdf=new TfIdfTransformer();$tokenized=array_values(array_filter(array_map(function($sentence){$cleaned=strtolower($this->normalizeUtf8(trim($sentence)));$tokens=array_filter(explode(' ',$cleaned),fn($w)=>strlen($w)>1);return count($tokens)>0?$tokens:null;},$sentences)));if(empty($tokenized)||!isset($tokenized[0])||!is_array($tokenized[0])||empty($tokenized[0])){log_message('error','âŒ MyMIMarketing L1725 - Tokenized input invalid for TF-IDF. Tokenized: '.json_encode($tokenized));return[];}try{$tfIdf->fit($tokenized);log_message('debug','ðŸ“Š MyMIMarketing L1731 - TF-IDF Document Preview: '.json_encode(array_slice($tokenized,0,1)));$tfIdf->transform($tokenized);}catch(\Throwable $e){log_message('error','âŒ MyMIMarketing L1734 - TF-IDF error: '.$e->getMessage());return[];}$scores=[];foreach($tokenized as $docIndex=>$tokens){foreach($tokens as $token){if(!is_string($token))continue;if(!isset($scores[$token])){$scores[$token]=0.0;}$scores[$token]+=1.0;}}if(empty($scores)){log_message('error','âŒ MyMIMarketing L1752 - No TF-IDF scores generated');return[];}arsort($scores);return array_keys(array_slice($scores,0,$max,true));}private function isSemanticallyDifferent($sentence1,$sentence2,$tokens){$tokens1=array_intersect($tokens,str_word_count(strtolower($sentence1),1));$tokens2=array_intersect($tokens,str_word_count(strtolower($sentence2),1));$overlap=count(array_intersect($tokens1,$tokens2));$threshold=2;return $overlap<$threshold;}private function pageRank($matrix,$dampingFactor=0.85,$maxIterations=100,$tolerance=1e-6){$numSentences=count($matrix);if($numSentences==0){return[];}$pagerank=array_fill(0,$numSentences,1/$numSentences);$tempRank=array_fill(0,$numSentences,0);for($iter=0;$iter<$maxIterations;$iter++){for($i=0;$i<$numSentences;$i++){$tempRank[$i]=(1-$dampingFactor)/$numSentences;for($j=0;$j<$numSentences;$j++){if($i!=$j&&isset($matrix[$j][$i])){$matrixRowSum=array_sum($matrix[$j]);if($matrixRowSum!=0){$tempRank[$i]+=$dampingFactor*($matrix[$j][$i]*$pagerank[$j]/$matrixRowSum);}}}}$diff=0;for($i=0;$i<$numSentences;$i++){$diff+=abs($tempRank[$i]-$pagerank[$i]);}if($diff<$tolerance){break;}$pagerank=$tempRank;}return $pagerank;}private function extractTopSentences($sentences,$scores,$topN=5){asort($scores,SORT_NUMERIC);$topSentenceIndexes=array_keys(array_slice($scores,-$topN,$topN,true));$summary=[];foreach($topSentenceIndexes as $index){$summary[]=trim($sentences[$index]);}return $summary;}public function enqueueEmailJob($emailData){$data=['type'=>'email_processing','data'=>json_encode($emailData)];$this->marketingModel->insertJobQueue($data);}private function stripHtmlTags($htmlContent){return strip_tags($htmlContent);}public function social_media(){return['discord'=>$this->socialMedia->discord,'facebook_page'=>$this->socialMedia->facebook_page,'facebook_group'=>$this->socialMedia->facebook_group,'linkedin'=>$this->socialMedia->linkedin,'twitter'=>$this->socialMedia->twitter,'youtube'=>$this->socialMedia->youtube,];}public function department(){$activeCampaigns=$this->marketingModel->getActiveCampaigns();$totalActiveCampaigns=$activeCampaigns['num_rows'];$activePriorityCampaigns=$this->marketingModel->getActivePriorityCampaigns();$totalActivePriorityCampaigns=$activePriorityCampaigns['num_rows'];return['getActiveCampaigns'=>$activeCampaigns['result'],'totalActiveCampaigns'=>$totalActiveCampaigns,'getActivePriorityCampaigns'=>$activePriorityCampaigns['result'],'totalActivePriorityCampaigns'=>$totalActivePriorityCampaigns,];}public function seoCheck(){$uri_string=$this->request->getUri()->getPath();$query=$this->marketingModel->where('url',$uri_string)->first();if(!$query){$data=['url'=>$uri_string,'title'=>str_replace(['_','/'],[' ',' - '],$uri_string),'description'=>"Experience the future of personal finance with MyMI Wallet. We provide advanced budgeting and investment portfolio management solutions, empowering individuals to better manage their finances. Streamline your financial journey with our intuitive online fintech application and service.",'image'=>base_url('/assets/images/Company/MyMI-Wallet-White.png'),];$this->marketingModel->insert($data);$insert_id=$this->marketingModel->getInsertID();$task_info=['task'=>'Page SEO Edit','title'=>str_replace(['_','/'],[' ',' - '],$uri_string),'seo_id'=>$insert_id,'url'=>$uri_string,];$this->assignMarketingTask($task_info);}}public function assignMarketingTask($task_info){$data=['status'=>'Pending','group'=>'Marketing','task'=>$task_info['task'],'title'=>$task_info['title'],'description'=>'Complete SEO for '.$task_info['url'],'url'=>site_url('/Management/Marketing/Page-SEO/'.$task_info['seo_id']),];$this->marketingModel->insertManagementTask($data);}public function autoDistributeHighRelevanceSummaries($minScore=75){$posts=$this->marketingModel->getRecentPosts(10);foreach($posts as $post){if(($post['score']?? 0)>=$minScore){$message="**{$post['title']}**\n\n".word_limiter(strip_tags($post['summary']),60);$this->sendToDiscordNotification($message);}}}public function autoSendToZapier($minScore=75){$posts=$this->marketingModel->getRecentPosts(10);foreach($posts as $post){if(($post['score']?? 0)>=$minScore){$this->sendToZapier('facebook',$post['summary']);}}}public function getPageHeaders(){$getPageSEO=$this->marketingModel->getMarketingPageSeo();$pageSEOData=[];foreach($getPageSEO as $pageSEO){$pageSEOData[]=['page_id'=>$pageSEO['id'],'page_name'=>$pageSEO['page_name'],'page_title'=>$pageSEO['page_title'],'page_url'=>$pageSEO['page_url'],'page_sitemap_url'=>$pageSEO['page_sitemap_url'],'page_internal_url'=>$pageSEO['page_internal_url'],'page_controller'=>$pageSEO['page_controller'],'page_controller_url'=>$pageSEO['page_controller_url'],'page_controller_directory'=>$pageSEO['page_controller_directory'],'page_file_directory'=>$pageSEO['page_file_directory'],'page_image'=>$pageSEO['page_image'],'page_description'=>$pageSEO['page_description'],'page_address'=>$pageSEO['page_address'],'page_city'=>$pageSEO['page_city'],'page_state'=>$pageSEO['page_state'],'page_country'=>$pageSEO['page_country'],'page_zipcode'=>$pageSEO['page_zipcode'],'page_facebook'=>$pageSEO['page_facebook'],'linked'=>$pageSEO['linked'],'functionality'=>$pageSEO['functionality'],'design'=>$pageSEO['design'],'seo'=>$pageSEO['seo'],'ext_links'=>$pageSEO['ext_links'],'grammar'=>$pageSEO['grammar'],'d_optimize'=>$pageSEO['d_optimize'],'load_perf'=>$pageSEO['load_perf'],'additional_notes'=>$pageSEO['additional_notes'],];}return $pageSEOData;}public function getPageHeadersByName($pageName){$getPageSEO=$this->marketingModel->getMarketingPageSeoByName($pageName);$pageSEOData=[];foreach($getPageSEO as $pageSEO){$pageSEOData[]=['page_id'=>$pageSEO['id'],'page_name'=>$pageSEO['page_name'],'page_title'=>$pageSEO['page_title'],'page_url'=>$pageSEO['page_url'],'page_sitemap_url'=>$pageSEO['page_sitemap_url'],'page_internal_url'=>$pageSEO['page_internal_url'],'page_controller'=>$pageSEO['page_controller'],'page_controller_url'=>$pageSEO['page_controller_url'],'page_controller_directory'=>$pageSEO['page_controller_directory'],'page_file_directory'=>$pageSEO['page_file_directory'],'page_image'=>$pageSEO['page_image'],'page_description'=>$pageSEO['page_description'],'page_address'=>$pageSEO['page_address'],'page_city'=>$pageSEO['page_city'],'page_state'=>$pageSEO['page_state'],'page_country'=>$pageSEO['page_country'],'page_zipcode'=>$pageSEO['page_zipcode'],'page_facebook'=>$pageSEO['page_facebook'],'linked'=>$pageSEO['linked'],'functionality'=>$pageSEO['functionality'],'design'=>$pageSEO['design'],'seo'=>$pageSEO['seo'],'ext_links'=>$pageSEO['ext_links'],'grammar'=>$pageSEO['grammar'],'d_optimize'=>$pageSEO['d_optimize'],'load_perf'=>$pageSEO['load_perf'],'additional_notes'=>$pageSEO['additional_notes'],];}return $pageSEOData;}public function postToDiscord($message){$discordWebhookUrl=getenv('DISCORD_WEBHOOK_URL');if(strlen($message)>2000){$message=substr($message,0,1997)."...";}$payload=json_encode(["content"=>$message]);$ch=curl_init($discordWebhookUrl);curl_setopt($ch,CURLOPT_HTTPHEADER,['Content-Type: application/json']);curl_setopt($ch,CURLOPT_POST,1);curl_setopt($ch,CURLOPT_POSTFIELDS,$payload);curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);$response=curl_exec($ch);curl_close($ch);return $response;}public function postToFacebookPage($pageId,$message){try{$response=$this->facebook->post("/{$pageId}/feed",['message'=>$message,],$this->facebook->getAccessToken());return $response->getGraphNode();}catch(Facebook\Exceptions\FacebookResponseException $e){log_message('error','Graph returned an error: '.$e->getMessage());return false;}catch(Facebook\Exceptions\FacebookSDKException $e){log_message('error','Facebook SDK returned an error: '.$e->getMessage());return false;}}public function postToFacebookGroup($groupId,$message){try{$response=$this->facebook->post("/{$groupId}/feed",['message'=>$message,],$this->facebook->getAccessToken());return $response->getGraphNode();}catch(Facebook\Exceptions\FacebookResponseException $e){log_message('error','Graph returned an error: '.$e->getMessage());return false;}catch(Facebook\Exceptions\FacebookSDKException $e){log_message('error','Facebook SDK returned an error: '.$e->getMessage());return false;}}public function sendNotification($type,$viewPath,$data,$targetGroup=null,$socialMedia=[]){$userModel=new UserModel();if($targetGroup){$users=$userModel->where('group',$targetGroup)->findAll();}else{$users=$userModel->findAll();}$viewContent=view($viewPath,$data);$notoCount=0;$emailNotoCount=0;if(in_array('in-app',$type)){foreach($users as $user){$this->sendInAppNotification($user,$viewContent);$notoCount++;}}if(in_array('email',$type)){foreach($users as $user){$this->sendEmailNotification($user,$viewContent);$emailNotoCount++;}}foreach($socialMedia as $platform){switch($platform){case 'facebook':$this->postToFacebook($data['message']);break;case 'twitter':$this->postToTwitter($data['message']);break;case 'linkedin':$this->postToLinkedIn($data['message']);break;case 'discord':$this->postToDiscord($data['message']);break;}}$notificationData=['active'=>1,'message'=>$viewContent,'created_at'=>date('Y-m-d H:i:s'),'created_by'=>session('user_id'),'noto_count'=>$notoCount,'email_noto_count'=>$emailNotoCount,];$this->marketingModel->storeNotification($notificationData);}private function sendInAppNotification($user,$content){$db=\Config\Database::connect();$db->table('user_notifications')->insert(['user_id'=>$user->id,'content'=>$content,'created_at'=>date('Y-m-d H:i:s')]);}private function sendEmailNotification($user,$content){$email=\Config\Services::email();$email->setTo($user->email);$email->setSubject('Notification');$email->setMessage($content);$email->send();}public function postToSocialMedia($content){try{$this->postToFacebook($content);$this->postToTwitter($content);$this->postToLinkedIn($content);}catch(\Throwable $e){$this->logger->error('âŒ postToSocialMedia() failed: '.$e->getMessage());}}private function postToFacebook($message){try{$response=$this->facebook->post('/me/feed',['message'=>$message],$this->socialMedia->facebook_access_token);return $response->getGraphNode();}catch(Facebook\Exceptions\FacebookResponseException $e){$this->logger->error('Facebook Graph returned an error: '.$e->getMessage());return false;}catch(Facebook\Exceptions\FacebookSDKException $e){$this->logger->error('Facebook SDK returned an error: '.$e->getMessage());return false;}}public function fetchTweets($query,$count=100){try{$tweets=$this->twitter->get('search/tweets',['q'=>$query,'count'=>$count]);if($this->twitter->getLastHttpCode()===200){$processedTweets=[];foreach($tweets->statuses as $tweet){$processedTweets[]=['tweet_id'=>$tweet->id_str,'content'=>$tweet->text,'author'=>$tweet->user->screen_name,'created_at'=>$tweet->created_at,'url'=>"https://twitter.com/{$tweet->user->screen_name}/status/{$tweet->id_str}"];}foreach($processedTweets as $tweetData){$this->marketingModel->storeScrapedContent(['title'=>$tweetData['content'],'url'=>$tweetData['url'],'content'=>$tweetData['content'],'keywords'=>json_encode([$tweetData['author']]),'scraped_at'=>date('Y-m-d H:i:s')]);}return $processedTweets;}else{throw new \Exception('Failed to fetch tweets: '.$this->twitter->getLastBody());}}catch(\Throwable $th){log_message('error','Error fetching tweets: '.$th->getMessage());return[];}}public function generateContentFromTweets($tweets){$summary=$this->summarizeText(implode(' ',array_column($tweets,'content')));$keywords=$this->extractKeywords($summary);return['summary'=>$summary,'keywords'=>$keywords,'platform_content'=>$this->generatePlatformContent($summary,$keywords)];}public function generateFromTempScraper($limit=5){$records=$this->marketingModel->getLatestTempRecords($limit);if(empty($records)){log_message('info','No temp scraper records found to process.');return;}foreach($records as $record){try{log_message('debug','ðŸ§ª Processing record ID '.$record['id']);$summary=$this->generateContentFromRaw($record);if($summary){$this->marketingModel->markTempScraperProcessed($record['id']);log_message('info','âœ… Processed and stored content for record ID '.$record['id']);}else{log_message('warning','âš ï¸ Summary was null/empty for record ID '.$record['id']);}}catch(\Throwable $e){log_message('error','âŒ Error generating content for record ID '.$record['id'].': '.$e->getMessage());}}}public function postToTwitter($content){try{$response=$this->twitter->post('statuses/update',['status'=>$content]);if($this->twitter->getLastHttpCode()===200){log_message('info','Successfully posted to Twitter: '.$content);return $response;}else{throw new \Exception('Failed to post to Twitter: '.json_encode($response));}}catch(\Throwable $th){log_message('error','Error posting to Twitter: '.$th->getMessage());return false;}}private function postToLinkedIn($message){try{$response=$this->linkedin->post('/people/~/shares',['comment'=>$message,'visibility'=>['code'=>'anyone']],$this->socialMedia->linkedin_access_token);return $response;}catch(Exception $e){$this->logger->error('LinkedIn API returned an error: '.$e->getMessage());return false;}}private function postToBlog($content){$client=new Client(['base_uri'=>$this->siteSettings->wordpress_site_url,]);try{$response=$client->post('/wp-json/wp/v2/posts',['auth'=>[$this->siteSettings->wordpress_username,$this->siteSettings->wordpress_password],'json'=>['title'=>substr($content,0,50),'content'=>$content,'status'=>'publish',],]);if($response->getStatusCode()==201){$this->logger->info('Posted to blog: '.$content);return json_decode($response->getBody(),true);}else{$this->logger->error('Failed to post to blog: '.$response->getBody());return false;}}catch(RequestException $e){$this->logger->error('Blog post request error: '.$e->getMessage());return false;}}public function distributeContentToSocialMedia($content){$twitterPost="ï¿½ **Stock Market Highlights** ï¿½\n";$facebookPost="ï¿½ **Market Movers Update** ï¿½\n";$linkedinPost="ï¿½ **Today's Market Summary** ï¿½\n";$discordPost="ï¿½ **TRADE ALERTS UPDATE!** ï¿½\n";foreach($content['expandedContent']as $post){$twitterPost.=$post."\n";$facebookPost.=$post."\n";$linkedinPost.=$post."\n";$discordPost.=$post."\n";}$this->postToTwitter($twitterPost);$this->postToFacebook($facebookPost);$this->postToLinkedIn($linkedinPost);$this->postToDiscord($discordPost);return['twitter'=>$twitterPost,'facebook'=>$facebookPost,'linkedin'=>$linkedinPost,'discord'=>$discordPost];}public function generateAndPostContent(){$emailSummaries=$this->marketingModel->getEmailSummariesForReview();foreach($emailSummaries as $summary){log_message('info','Generating content for email summary: '.$summary['email_subject']);$content=$this->generateMarketingContent($summary['summary']);log_message('debug','Generated content: '.print_r($content,true));$this->postToSocialMedia($content);$this->postToBlog($content);$this->marketingModel->updateEmailStatus($summary['email_identifier'],'Posted');log_message('info','Updated email status to Posted for: '.$summary['email_subject']);}}public function generateMarketingContent():void{$topStories=$this->marketingModel->getTopStories(10);$count=0;foreach($topStories as $story){if(empty(trim($story['title']?? ''))){log_message('debug','â­ Skipped record ID '.$story['id'].' - no title provided.');continue;}if($count>=5){break;}$headline=$story['title'];$url=$story['source_url']?? '#';$summary=$this->generateSummary($story);$hashtags=$this->extractHashtags($story['title'].' '.$story['email_body']);$platformPosts=['discord'=>"**{$headline}**\n{$summary}\nðŸ”— {$url}\n{$hashtags}",'twitter'=>"{$headline} {$url} {$hashtags}",'linkedin'=>"{$headline}\n{$summary}\nRead more: {$url} {$hashtags}",'facebook'=>"{$headline}\n{$summary}\n{$url} {$hashtags}",'email'=>['subject'=>$headline,'body'=>"{$summary}\n\nRead More: {$url}\n{$hashtags}",],];$this->marketingModel->storeGeneratedContent($story['id'],$platformPosts);$count++;}}private function logScrapeError($url,$error){log_message('error',"Scraping failed for URL: $url, Error: $error");}public function generateContentFromData($title,$content,$tags){$summary=$this->summarizeContent($content);return $title." - ".$summary." Tags: ".implode(', ',$tags);}public function generateContentFromScrapedData($scrapedData,$platform=null){if(empty($scrapedData)||!is_array($scrapedData)){log_message('error','âŒ generateContentFromScrapedData() called with empty or invalid $scrapedData');return[];}$cleanedSummaries=[];foreach($scrapedData as $record){$rawContent=$record['content']?? '';$cleaned=$this->sanitizeRawEmailContent($rawContent);if(strlen($cleaned)<300||substr_count($cleaned,' ')<20){log_message('warning','[MyMIMarketing] Skipped record due to short or unstructured content (Title: '.($record['title']?? 'Untitled').')');continue;}try{$summaryData=$this->summarizeContent($cleaned);if(!is_array($summaryData)||empty($summaryData['summary'])){log_message('warning','âš ï¸ generateContentFromScrapedData(): Summary was null/empty for record title: '.($record['title']?? 'Untitled'));continue;}$headline=$this->generateHeadline($summaryData['summary']);$platformPosts=$this->generatePlatformContent($summaryData['summary'],$summaryData['tokens']??[]);$payload=['title'=>$record['title']?? $headline,'source'=>$record['url']?? 'unknown','summary'=>$summaryData['summary'],'keywords'=>$summaryData['tokens']??[],'headline'=>$headline,'platform_content'=>$platformPosts,'platform'=>$platform,'created_on'=>date("Y-m-d H:i:s"),];$this->marketingModel->storeGeneratedContent($record['id']?? null,$platformPosts);$cleanedSummaries[]=$payload;}catch(\Throwable $e){log_message('error','âŒ Exception in generateContentFromScrapedData(): '.$e->getMessage());}}return $cleanedSummaries;}public function generateContentFromLargeText($content,$tags){if(empty($content)){log_message('error','Content is empty in generateContentFromLargeText.');return['summary'=>'','keywords'=>[],'platforms_content'=>[],];}$tokenizer=new WhitespaceTokenizer();$samples=[$tokenizer->tokenize($content)];log_message('debug','Tokenized samples: '.print_r($samples,true));if(empty($samples)||!isset($samples[0])||!is_array($samples[0])||empty($samples[0])){log_message('error','ðŸš« Empty or malformed document array before TF-IDF.');return['summary'=>'','keywords'=>[],'platforms_content'=>[],];}try{$tfidf=new TfIdfTransformer();$tfidf->fit($samples);$tfidf->transform($samples);log_message('debug','TfIdf transformation successful.');}catch(\Exception $e){log_message('error','TfIdfTransformer failed: '.$e->getMessage());return['summary'=>'','keywords'=>[],'platforms_content'=>[],];}$summary=$this->summarizeText($content);$keywords=$this->extractKeywords($content);$platforms_content=$this->generatePlatformContent($summary,$keywords);return['summary'=>$summary,'keywords'=>$keywords,'platforms_content'=>$platforms_content,];}public function generateCanvaVideo(){$scriptResponse=$this->generateVoiceoverScript();if(!$scriptResponse['status']==='success'){return $this->respond(['status'=>'error','message'=>'Voiceover script not found'],404);}$scriptText=$scriptResponse['script'];$canvaApiUrl="https://api.canva.com/v1/projects";$headers=['Authorization: Bearer YOUR_CANVA_API_KEY','Content-Type: application/json'];$payload=['title'=>'MyMI Trade Alerts Video','template'=>'YOUR_CANVA_TEMPLATE_ID','elements'=>['text'=>$scriptText,'voiceover'=>base_url('uploads/voiceover.mp3')]];$ch=curl_init($canvaApiUrl);curl_setopt($ch,CURLOPT_HTTPHEADER,$headers);curl_setopt($ch,CURLOPT_POST,true);curl_setopt($ch,CURLOPT_POSTFIELDS,json_encode($payload));curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);$response=curl_exec($ch);curl_close($ch);return $this->respond(['status'=>'success','message'=>'Video generated','video_url'=>json_decode($response)->video_url]);}public function generateEnhancedContent($voiceScript){$summary=$this->summarizeContent($voiceScript);$checkedContent=$this->spellCheckAndRefine($summary);$expandedContent=$this->contentGenerator($checkedContent);return['summary'=>$summary,'checkedContent'=>$checkedContent,'expandedContent'=>$expandedContent];}private function generatePrimaryContent($scrapedData){$content="";foreach($scrapedData as $data){$content.="Source: {$data['source']}\n";$content.="Title: {$data['title']}\n";$content.="Content: ".substr($data['content'],0,200)."...\n";$content.="Link: ".($data['url']?? 'N/A')."\n\n";}return $content;}public function generatePlatformContent($summary,$keywords,$mediaAssets=[]){$facebookContent="Facebook Post: ".$summary."\n\n"."Related: #".implode(' #',$keywords);$twitterContent="Twitter: ".substr($summary,0,280)."\n\n#".implode(' #',$keywords);$stocktwitsContent="StockTwits: ".substr($summary,0,250)."\n\n".implode(' ',$keywords);$discordContent="Discord: ".$summary."\n\nJoin the discussion! #".implode(' #',$keywords);$blogContent="Blog Post\n\n".$summary."\n\nKeywords: ".implode(', ',$keywords);$emailContent="Email Notification: ".$summary."\n\nRead more on our blog.";$browserNotificationContent="New Update: ".substr($summary,0,100)."... Click to learn more.";$tiktokScript=$this->generateTikTokScript($summary,$keywords,$mediaAssets);$youtubeScript=$this->generateYouTubeScript($summary,$keywords,$mediaAssets);return['Facebook'=>$facebookContent,'Twitter'=>$twitterContent,'StockTwits'=>$stocktwitsContent,'Discord'=>$discordContent,'Blog'=>$blogContent,'Email'=>$emailContent,'BrowserNotification'=>$browserNotificationContent,'TikTok'=>$tiktokScript,'YouTube'=>$youtubeScript];}public function generateSocialPost(array $summary):array{$text=$summary['summary']?? '';$keywords=$summary['keywords']??[];$hashtags=implode(' ',array_map(function($word){return '#'.ucfirst(trim($word));},array_slice($keywords,0,5)));return['twitter'=>substr("{$text} {$hashtags}",0,280),'facebook'=>"{$text}\n\n{$hashtags}",'linkedin'=>"{$text}\n\n#StayInformed {$hashtags}",'discord'=>"**News Summary:**\n{$text}\n\n{$hashtags}",];}private function generateSocialMediaContent($scrapedData){$facebookContent="Facebook: ";$twitterContent="Twitter: ";$linkedinContent="LinkedIn: ";foreach($scrapedData as $data){$facebookContent.=$data['title']." ".($data['url']?? '')."\n";$twitterContent.=$data['title']." ".($data['url']?? '')."\n";$linkedinContent.=$data['title']." ".($data['url']?? '')."\n";}return['Facebook'=>$facebookContent,'Twitter'=>$twitterContent,'LinkedIn'=>$linkedinContent,];}protected function generateSummary(array $story):string{return substr(strip_tags($story['email_body']?? ''),0,250).'...';}public function generateTikTokScript($summary,$keywords,$mediaAssets=[]){$hook="Did you know?";$cta="Follow us for more updates!";$mediaInclusion=!empty($mediaAssets)?"Include these images/videos: ".implode(", ",$mediaAssets):"";return"TikTok Video Script:\n1. Hook: \"{$hook}\"\n2. Summary: {$summary}\n3. Media: {$mediaInclusion}\n4. CTA: {$cta}";}public function generateYouTubeScript($summary,$keywords,$mediaAssets=[]){$hook="Breaking news in the world of finance...";$cta="Like, subscribe, and share for more updates!";$mediaInclusion=!empty($mediaAssets)?"Include these images/videos: ".implode(", ",$mediaAssets):"";return"YouTube Video Script:\n1. Hook: \"{$hook}\"\n2. Detailed Summary: {$summary}\n3. Media: {$mediaInclusion}\n4. CTA: {$cta}";}public function generateVoiceoverAudio($text){$client=new TextToSpeechClient();$input=new SynthesisInput();$input->setText($text);$voice=new VoiceSelectionParams();$voice->setLanguageCode('en-US');$voice->setSsmlGender('MALE');$audioConfig=new AudioConfig();$audioConfig->setAudioEncoding(AudioEncoding::MP3);$response=$client->synthesizeSpeech($input,$voice,$audioConfig);$audioContent=$response->getAudioContent();$filePath=WRITEPATH.'uploads/voiceover.mp3';file_put_contents($filePath,$audioContent);return base_url('uploads/voiceover.mp3');}public function generateVoiceoverScript(){$tradeAlerts=$this->alertsModel->getFilteredTradeAlerts(['start'=>date('Y-m-d 00:00:00'),'end'=>date('Y-m-d 23:59:59')])->get()->getResultArray();if(empty($tradeAlerts)){return $this->respond(['status'=>'error','message'=>'No trade alerts found for today.'],404);}$script="**Voiceover Script: MyMI Trade Alerts - Top Stock Movers**\n\n[INTRO]\n";$script.="Welcome to todayâ€™s MyMI Trade Alerts! Weâ€™re breaking down the hottest stocks in the market based on momentum, volume, and breakout potential. Letâ€™s jump right in!\n\n";foreach($tradeAlerts as $alert){$script.="**[{$alert['ticker']} - {$alert['company']}]**\n";$script.="**Price:** \${$alert['price']}  |  **% Change:** {$alert['change']}%  |  **Volume:** {$alert['volume']}M\n";$script.="ï¿½ 52-Week High: \${$alert['high']}  |  ï¿½ 52-Week Low: \${$alert['low']}\n";$script.="Market Cap: {$alert['market_cap']}\n\n";}$script.="[OUTRO]\nThatâ€™s it for todayâ€™s MyMI Trade Alerts! Donâ€™t forget to like, subscribe, and stay tuned for more market insights. Drop your thoughts in the commentsâ€”whatâ€™s your top stock pick today? See you in the next update!\n";return $this->respond(['status'=>'success','script'=>$script]);}public function generateStockInformation($cuID){$MyMIInvestments=new MyMIInvestments();$investmentData=$MyMIInvestments->getInvestmentDashboard($cuID);$symbols=$this->getSymbolsByAssetType($investmentData['getSymbols']);$forecastData=[];$riskData=[];foreach($symbols as $type=>$symbolList){switch($type){case 'stocks':$forecastData['stocks']=$MyMIInvestments->performARIMAForecast($symbolList);$riskData['stocks']=$MyMIInvestments->generateRiskManagementTools($cuID,'stocks');break;case 'etfs':$forecastData['etfs']=$MyMIInvestments->performARIMAForecast($symbolList);$riskData['etfs']=$MyMIInvestments->generateRiskManagementTools($cuID,'etfs');break;case 'crypto':$forecastData['crypto']=$MyMIInvestments->performARIMAForecast($symbolList);$riskData['crypto']=$MyMIInvestments->generateRiskManagementTools($cuID,'crypto');break;}}$content=$this->generateContent($forecastData,$riskData);return $content;}private function getSymbolsByAssetType($symbols){$result=['stocks'=>[],'etfs'=>[],'crypto'=>[]];foreach($symbols as $symbol){if(preg_match('/^[A-Z]{1,5}$/',$symbol)){$result['stocks'][]=$symbol;}elseif(preg_match('/^[A-Z]{1,5}$/',$symbol)){$result['etfs'][]=$symbol;}else{$result['crypto'][]=$symbol;}}return $result;}private function generateContent($forecastData,$riskData){$content="";if(!empty($forecastData['stocks'])){$content.="### Stock Investment Forecast\n";foreach($forecastData['stocks']as $symbol=>$forecast){$content.="- **{$symbol}**: ".json_encode($forecast)."\n";}}if(!empty($forecastData['etfs'])){$content.="### ETF Investment Forecast\n";foreach($forecastData['etfs']as $symbol=>$forecast){$content.="- **{$symbol}**: ".json_encode($forecast)."\n";}}if(!empty($forecastData['crypto'])){$content.="### Crypto Investment Forecast\n";foreach($forecastData['crypto']as $symbol=>$forecast){$content.="- **{$symbol}**: ".json_encode($forecast)."\n";}}$content.="\n### Risk Management Insights\n";foreach($riskData as $type=>$riskMetrics){$content.="#### ".ucfirst($type)." Risks\n";foreach($riskMetrics as $riskMetric=>$details){$content.="- **{$riskMetric}**: ".json_encode($details)."\n";}}return $content;}public function getRecentPosts($limit=5){return $this->marketingModel->getRecentPosts($limit);}public function pullFinancialNews():void{$response=$this->client->get('https://www.marketaux.com/api/v1/news/all',['query'=>['api_token'=>getenv('marketaux.apiKey'),'language'=>'en','country'=>'us','published_after'=>date('Y-m-d\TH:i:s\Z',strtotime('-1 hour')),'limit'=>50,],]);$data=json_decode($response->getBody(),true);if(isset($data['data'])){foreach($data['data']as $story){$this->marketingModel->saveNews($story);}}}public function rankBufferCandidates(){$buffer=$this->marketingModel->fetchBufferPostsForScoring();foreach($buffer as $post){$keywords=$this->extractKeywords($post['summary']);$score=array_sum(array_column($keywords,'score'));$tagScore=min($score/10,10);$this->marketingModel->updateBufferItem($post['id'],['tag_score'=>$tagScore]);}}public function rankNewsArticles():void{$unrankedNews=$this->marketingModel->getUnrankedNews();foreach($unrankedNews as $news){$content=strtolower(($news['title']?? '').' '.($news['email_subject']?? '').' '.($news['email_body']?? ''));$words=str_word_count(strip_tags($content),1);$wordFreq=array_count_values($words);$filtered=array_filter($wordFreq,fn($freq,$word)=>strlen($word)>3&&$freq>1,ARRAY_FILTER_USE_BOTH);arsort($filtered);$score=array_sum(array_values($filtered));$topKeywords=array_slice(array_keys($filtered),0,5);$this->marketingModel->updateRankedNews($news['id'],$score,implode(',',$topKeywords));}}public function summarizeMultipleArticles(array $articles):string{$allContent='';foreach($articles as $article){$content=$article['content']?? '';$allContent.=strip_tags($content).' ';}if(empty(trim($allContent))){log_message('error','summarizeMultipleArticles() received empty content.');return 'No content available to summarize.';}$summaryData=$this->summarizeContent($allContent);return is_array($summaryData)&&isset($summaryData['summary'])?$summaryData['summary']:substr($allContent,0,300).'...';}} ?><?php namespace App\Models;use CodeIgniter\Model;use Phpml\FeatureExtraction\TfIdfTransformer;use Phpml\Tokenization\WhitespaceTokenizer;class MarketingModel extends Model{protected $table='bf_marketing_scraper';protected $primaryKey='id';protected $useAutoIncrement=true;protected $returnType='object';protected $useSoftDeletes=false;protected $allowedFields=['title','description','created_on','modified_on','status','type','day','time','activity','link','url','summary','content','email_identifier','email_date','email_sender','email_subject','email_body','email_attachments','keywords','scraped_at','links','images','videos','metadata','structured_data','sched_id','escalated','audience_type','stage','name','assigned_on','assigned_to','completed_on','scheduled_at','primary_content','secondary_content','html_content','voice_script','shared','shared_users','blog','in_app','email','discord','facebook','linkedin','telegram','twitter','website','promotional_links','facebook_message','linkedin_message','discord_message','stocktwits_message','tiktok_message','youtube_message','email_message','additional_info','image_paths'];protected $useTimestamps=true;protected $createdField='created_on';protected $updatedField='modified_on';public function addMarketingCampaign($campaignData){log_message('debug','MarketingModel L206 - $marketingData: '.(print_r($campaignData,true)));$dbData=['beta'=>$campaignData['beta'],'config_mode'=>$campaignData['config_mode'],'form_mode'=>$campaignData['form_mode'],'escalated'=>$campaignData['escalated'],'created_by'=>$campaignData['user_id'],'user_id'=>$campaignData['user_id'],'user_email'=>$campaignData['user_email'],'username'=>$campaignData['username'],'assigned_to'=>$campaignData['assigned_to'],'assigned_on'=>$campaignData['date'].' - '.$campaignData['time'],'name'=>$campaignData['campaign_name'],'promotional_links'=>$campaignData['promotionalLinks'],'overall_campaign_description'=>$campaignData['overall_campaign_description'],'voice_script'=>$campaignData['voice_script'],'facebook_message'=>$campaignData['facebookMessage'],'linkedin_message'=>$campaignData['linkedinMessage'],'discord_message'=>$campaignData['discordMessage'],'stocktwits_message'=>$campaignData['stocktwitsMessage'],'tiktok_message'=>$campaignData['tiktokMessage'],'youtube_message'=>$campaignData['youtubeMessage'],'email_message'=>$campaignData['emailMessage'],'additional_info'=>$campaignData['additionalInfo'],'hashtags'=>$campaignData['hashtags'],];log_message('debug','MarketingModel L206 - $marketingData: '.(print_r($dbData,true)));if($this->db->table('bf_marketing_campaigns')->insert($dbData)){log_message('info','Campaign created successfully.');return $this->getInsertID();}else{log_message('error','DB Insert Error: '.json_encode($this->errors()));return false;}}public function addMarketingSchedule($data){$data['zapier_webhook_url']=$data['zapier_webhook_url']?? null;$data['post_status']='pending';$this->db->table('bf_marketing_schedule')->insert($data);return $this->db->insertID();}public function addSubscriber($subscriberData){if($this->db->table('bf_users_subscribers')->insert($subscriberData)){log_message('info','Subscriber added successfully.');return true;}else{log_message('error','DB Insert Error: '.json_encode($this->errors()));return false;}}public function cleanHtmlEmailContent($raw):string{$raw=is_string($raw)?$raw:'';$decoded=quoted_printable_decode($raw);$decoded=is_string($decoded)?$decoded:'';$text=strip_tags($decoded);$text=preg_replace('/\s+/',' ',str_replace(["\r","\n","\t",'&nbsp;'],' ',$text));return trim(substr($text,0,5000));}public function copyMarketingCampaign($marketingData){unset($marketingData['id']);if($this->insert($marketingData)){log_message('info','Campaign copied successfully.');return $this->getInsertID();}else{log_message('error','DB Insert Error: '.json_encode($this->errors()));return false;}}public function countBlogs(){return $this->db->table('bf_marketing_blog_posts')->countAllResults();}public function countNewlyInsertedToday():int{return $this->where('DATE(scraped_at)',date('Y-m-d'))->countAllResults();}public function createSlug($title){$slug=url_title($title,'-',true);$existing=$this->db->table('bf_marketing_blog_posts')->where('slug',$slug)->countAllResults();return $existing?$slug.'-'.uniqid():$slug;}public function deleteMarketingCampaign($id){if($this->delete($id)){log_message('info','Campaign deleted successfully.');return true;}else{log_message('error','DB Delete Error: '.json_encode($this->errors()));return false;}}public function deleteSchedule($id){return $this->db->table('bf_marketing_schedule')->where('id',$id)->delete();}public function editMarketingCampaign($marketingData){if($this->update($marketingData['id'],$marketingData)){log_message('info','Campaign updated successfully.');return true;}else{log_message('error','DB Update Error: '.json_encode($this->errors()));return false;}}public function extractKeywords($text){if(empty($text)||strlen(trim($text))<50){return[];}$tokenizer=new WhitespaceTokenizer();$tokens=array_filter($tokenizer->tokenize($text));if(empty($tokens)){return[];}$documents=[$tokens];$tfidf=new TfIdfTransformer();try{$tfidf->transform($documents);}catch(\Exception $e){log_message('error','TfIdfTransformer failed: '.$e->getMessage());return[];}$keywordScores=[];foreach($documents[0]as $word=>$score){$keywordScores[$word]=$score;}arsort($keywordScores);return array_slice(array_keys($keywordScores),0,10);}public function fetchBufferPaginated($page=1,$limit=20){$offset=($page-1)*$limit;$builder=$this->db->table('bf_marketing_buffer')->where('status !=','promoted')->orderBy('tag_score','DESC')->limit($limit,$offset);$results=$builder->get()->getResultArray();$total=$this->db->table('bf_marketing_buffer')->where('status !=','promoted')->countAllResults();return['data'=>$results,'pagination'=>['page'=>$page,'pages'=>ceil($total/$limit),]];}public function fetchBufferPaginatedWithFilters(array $params=[]){$page=$params['page']?? 1;$limit=$params['limit']?? 20;$offset=($page-1)*$limit;$keyword=$params['keyword']?? null;$category=$params['category']?? null;$minTagScore=$params['min_tag_score']?? 0;$onlySuggested=$params['only_suggested']?? false;$builder=$this->db->table('bf_marketing_buffer')->where('status !=','promoted');if(!empty($keyword)){$builder->like('keyword',$keyword);}if(!empty($category)){$builder->where('category',$category);}if(!empty($minTagScore)){$builder->where('tag_score >=',$minTagScore);}if($onlySuggested){$builder->where('auto_suggest',1);}$totalQuery=clone $builder;$total=$totalQuery->countAllResults(false);$results=$builder->orderBy('tag_score','DESC')->limit($limit,$offset)->get()->getResultArray();return['data'=>$results,'pagination'=>['page'=>$page,'limit'=>$limit,'pages'=>ceil($total/$limit),'total'=>$total,],];}public function fetchBufferPostsForReview($limit=25){return $this->db->table('bf_marketing_buffer')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getBufferItem($id){return $this->db->table('bf_marketing_buffer')->where('id',$id)->get()->getRowArray();}public function getPendingAutoSuggested($limit=5){return $this->db->table('bf_marketing_buffer')->where('status','pending')->where('auto_suggest',1)->orderBy('tfidf_score','DESC')->limit($limit)->get()->getResultArray();}public function getPendingScheduledPosts($currentTimestamp){return $this->db->table('bf_marketing_schedule')->where('post_time <=',$currentTimestamp)->where('post_status','pending')->get()->getResult();}public function getPendingScraperSummaries($limit=10){return $this->db->table('bf_marketing_scraper')->where('status',null)->orWhere('status','')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getProcessedEmails($date=null){$builder=$this->select('email_identifier');if($date){$builder->where('DATE(email_date)',$date);}$results=$builder->get()->getResultArray();$identifiers=[];foreach($results as $row){if(!empty($row->email_identifier)){$identifiers[]=$row->email_identifier;}}return $identifiers;}public function findBufferItem($id){return $this->db->table('bf_marketing_buffer')->where('id',$id)->get()->getRowArray();}public function findFinalizedById($id){return $this->db->table('bf_marketing_scraper')->where('id',$id)->get()->getRowArray();}public function getActiveCampaigns(){$builder=$this->db->table('bf_marketing_campaigns');$num_rows=$builder->where('status',1)->countAllResults(false);$result=$builder->where('status',1)->get()->getResultArray();return['result'=>$result,'num_rows'=>$num_rows];}public function getActiveIdeas(){return $this->db->table('bf_marketing_ideas')->where('status !=','approved')->get()->getResultArray();}public function getActivePriorityCampaigns(){$builder=$this->db->table('bf_marketing_campaigns');$num_rows=$builder->where('status',1)->where('escalated',1)->countAllResults(false);$result=$builder->where('status',1)->where('escalated',1)->get()->getResultArray();return['result'=>$result,'num_rows'=>$num_rows];}public function getApprovedBufferWithoutSchedule(){return $this->db->table('bf_marketing_buffer')->where('status','approved')->where('scheduled_at IS NULL',null,false)->where('schedule_interval >',0)->orderBy('tag_score','DESC')->limit(10)->get()->getResultArray();}public function getApprovedLogos(){return $this->db->table('bf_company_logos')->get()->getResultArray();}public function getBlogPostBySlug($slug){return $this->db->table('bf_marketing_blog_posts')->where('slug',$slug)->get()->getRow();}public function getBlogPostDetails($id){return $this->find($id);}public function getBlogPosts(){return $this->where('type','Email/Newsletters')->limit(50)->get()->getResultArray();}public function getBlogs(){return $this->db->table('bf_marketing_blog_posts')->orderBy('created_on','DESC')->get()->getResult();}public function getBufferItems($limit=50){return $this->builder()->where('status','pending')->orderBy('score','DESC')->limit($limit)->get()->getResultArray();}public function getCampaignById($campaign_id){return $this->db->table('bf_marketing_campaigns')->where('id',$campaign_id)->get()->getResultArray();}public function getCampaignsBySchedId($accountid){return $this->db->table('bf_marketing_campaigns')->where('sched_id',$accountid)->get()->getResultArray();}public function getDailyLogsByDate($date){return $this->db->table('bf_marketing_scraper')->where('DATE(created_on)',$date)->get()->getResult();}public function getEmailRecordById($id){return $this->db->table('bf_marketing_temp_scraper')->where('id',$id)->get()->getRowArray();}public function getEmailByMessageId($messageId){return $this->db->table('bf_marketing_temp_scraper')->where('email_identifier',$messageId)->get()->getRowArray();}public function getEmailContentsForNewsletter(){return $this->where('include_newsletter',false)->limit(50)->get()->getResultArray();}public function getEmailsMissingTitleOrUrl($limit=20){return $this->db->table('bf_marketing_temp_scraper')->where('(title IS NULL OR title = "" OR url IS NULL OR url = "")',null,false)->orderBy('date_scraped','DESC')->limit($limit)->get()->getResultArray();}public function getEmailSummariesForReview(){return $this->where('status','In Review')->limit(50)->get()->getResultArray();}public function getExchangeTokenById($id){return $this->db->table('bf_exchanges_assets')->where('id',$id)->get()->getRowArray();}public function getExistingLogoBySymbol($symbol){return $this->db->table('bf_company_logos')->where('symbol',$symbol)->get()->getRow();}public function getFeatures(){return $this->db->table('bf_users_memberships')->where('active',1)->orderBy('feature_level','ASC')->orderBy('feature_name','ASC')->get()->getResultArray();}public function getGeneratedContent($postId){return $this->db->table('bf_marketing_campaigns')->where('sched_id',$postId)->get()->getRowArray();}public function getGeneratedPostsBySourceId($id){$row=$this->db->table('bf_marketing_scraper')->where('source_id',$id)->get()->getRowArray();if(!$row||empty($row['platforms']))return[];$decoded=json_decode($row['platforms'],true);if(!is_array($decoded))return[];return $decoded;}public function getLatestGeneratedSummaries($limit=25){return $this->db->table('bf_marketing_scraper')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getLatestNewsletterDraft(){return $this->db->table('bf_marketing_newsletters')->orderBy('created_at','DESC')->first();}public function getLatestTempRecords($limit=5){return $this->db->table('bf_marketing_temp_scraper')->where('status','In Review')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getLatestUnprocessedEmails($limit=10){return $this->db->table('bf_marketing_temp_scraper')->where('status','In Review')->orderBy('scraped_at','DESC')->limit($limit)->get()->getResultArray();}public function getMarketingBuffer($status='Pending'){return $this->builder()->where('status',$status)->orderBy('created_at','DESC')->get()->getResultArray();}public function getMarketingPageSeoByName($pageTitle){return $this->where('page_name',$pageTitle)->get()->getResultArray();}public function getMarketingTeam(){$result=$this->db->table('bf_management_positions')->where('department','Marketing')->get()->getResultArray();return $result;}public function getNewsArticles(){$result=$this->select('articles_json')->first();return json_decode($result->articles_json ?? '[]',true);}public function getNewEmails(){return $this->db->table('bf_marketing_raw_emails')->where('status','unprocessed')->get()->getResultArray();}public function getNewsPosts(){return $this->where('type','news_post')->limit(50)->get()->getResultArray();}public function getNextScheduledPost(){return $this->db->table('bf_marketing_buffer')->where('status','approved')->where('tag_score >=',7.0)->orderBy('tag_score','DESC')->limit(1)->get()->getRowArray();}public function getRecentPosts($limit=5){$results=$this->asObject()->select("id, title, category, created_at, blog_content")->orderBy('created_at','DESC')->limit($limit)->findAll();log_message('info','MarketingModel L437 - $result Array: '.(print_r($results,true)));foreach($results as $r){$r->short_description=substr(strip_tags($r->blog_content ?? 0),0,150);}return $results;}public function getRecentScrapes(){return $this->db->table('bf_marketing_temp_scraper')->orderBy('scraped_at','DESC')->limit(5)->get()->getResult();}public function getRecentSummaries($limit=5){return $this->db->table('bf_marketing_scraper')->select('id, title, summary, keywords, scraped_at')->where("CHAR_LENGTH(summary) >=",100)->where("summary LIKE",'% % % % % % % % % %')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getRecentUnprocessedTempEmails($limit=5){return $this->db->table('bf_marketing_temp_scraper')->where('status','In Review')->orderBy('id','DESC')->limit($limit)->get()->getResultArray();}public function getScheduledBufferPosts($timestamp){return $this->db->table('bf_marketing_buffer')->where('status','approved')->where('scheduled_at <=',$timestamp)->orderBy('scheduled_at','ASC')->limit(3)->get()->getResultArray();}public function getScheduledCampaigns(){return $this->db->table('bf_marketing_newsletters')->where('status','scheduled')->where('scheduled_date <=',date('Y-m-d H:i:s'))->get()->getResultArray();}public function getScheduleByDay($day){return $this->db->table('bf_marketing_calendar')->where('day',ucfirst($day))->get()->getResultArray();}public function getScheduleById($id){return $this->db->table('bf_marketing_schedule')->where('id',$id)->get()->getRow();}public function getScrapesByDate($date){return $this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',$date)->orderBy('scraped_at','DESC');if($limit){$builder->limit($limit);}return $builder->get()->getResultArray();}public function getScrapesByKeyword($keyword){return $this->db->table('bf_marketing_scraper')->like('summary',$keyword)->orLike('keywords',$keyword)->orderBy('created_on','DESC')->limit(10)->get()->getResultArray();}public function getTodaysNewsContent($limit=10){$builder=$this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',date('Y-m-d'))->where('type !=','todays_story')->orderBy('scraped_at','DESC')->limit($limit);$query=$builder->get();$results=$query->getResultArray();if(empty($results)){log_message('info','No scraped content found for today.');}return $results;}public function getTodaysScrapedContent(){return $this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',date('Y-m-d'))->orderBy('feature_score','DESC')->get()->getResultArray();}public function getTodaysStory(){return $this->db->table('bf_marketing_temp_scraper')->where('type','todays_story')->where('DATE(scraped_at)',date('Y-m-d'))->orderBy('scraped_at','DESC')->get()->getRowArray();}public function getTopBufferPosts($limit=5,$minTagScore=7.5){return $this->builder('bf_marketing_buffer')->where('status','approved')->where('tag_score >=',$minTagScore)->orderBy('tag_score','DESC')->limit($limit)->get()->getResultArray();}public function getTopStories($limit=10){return $this->db->table('bf_marketing_scraper')->where('status','pending')->where('title IS NOT NULL')->where('title !=','')->orderBy('feature_score','DESC')->limit($limit)->get()->getResultArray();}public function getTopTempRecords($limit=5){return $this->db->table('bf_marketing_temp_scraper')->where('title IS NOT NULL')->orderBy('created_at','desc')->limit($limit)->get()->getResultArray();}public function getUpcomingSchedule(){return $this->db->table('bf_marketing_schedule')->select('id, post_date, completed, GROUP_CONCAT(DISTINCT platform ORDER BY platform ASC SEPARATOR ", ") as platforms, MIN(content_subject) as subjects, MIN(content_description) as descriptions')->where('post_date >=',date('Y-m-d'))->groupBy('post_date')->orderBy('post_date','ASC')->get()->getResultArray();}public function getUpcomingEarnings(){$builder=$this->db->where('bf_investment_calendar')->where('date >=',date('Y-m-d'))->where('event_type','Earnings')->orderBy('date','ASC')->get()->getResultArray();log_message('debug','MarketingModel L211 - getUpcomingEvents $builder Array: '.(print_r($builder,true)));return $builder;}public function getValidUnprocessedEmails($limit=10){$builder=$this->db->table('bf_marketing_temp_scraper');$builder->where('processed',0);$builder->limit($limit*2);$query=$builder->get();$results=$query->getResultArray();$valid=[];foreach($results as $row){$id=$row['id'];if(empty($row['title'])){log_message('debug',"ðŸª“ Skipping record ID {$id} â€” Missing title.");continue;}if(empty($row['content'])||strlen(strip_tags($row['content']))<100){log_message('debug',"ðŸª“ Skipping record ID {$id} â€” Content empty or too short.");continue;}$textContent=strip_tags($row['content']);$htmlRatio=strlen($textContent)/strlen($row['content']?? '');if($htmlRatio<0.3){log_message('debug',"ðŸª“ Skipping record ID {$id} â€” HTML-dominant content ({$htmlRatio}).");continue;}$valid[]=$row;if(count($valid)>=$limit){break;}}return $valid;}public function getValidUnprocessedEmailsFromToday($limit=10){return $this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',date('Y-m-d'))->where('content IS NOT NULL',null,false)->where('title IS NOT NULL',null,false)->where('CHAR_LENGTH(content) >',250)->orderBy('id','DESC')->limit($limit)->get()->getResultArray();}public function incrementRetryCount($id){return $this->db->table('bf_marketing_schedule')->where('id',$id)->set('retry_count','retry_count + 1',false)->update(['last_attempt_at'=>date('Y-m-d H:i:s')]);}public function insertBufferItem(array $summary){$MyMIMarketing=new \App\Libraries\MyMIMarketing();$scoreData=$MyMIMarketing->getTopKeywordScores($summary['summary']);$threshold=getenv('MARKETING_TFIDF_THRESHOLD')?:7.5;$bufferRecord=['keyword'=>$scoreData['top_keyword']?? 'general','summary'=>$summary['summary'],'score'=>$scoreData['score']?? 0,'tag_score'=>$scoreData['tag_score']?? 0,'category'=>$scoreData['category']?? 'Uncategorized','status'=>'pending','tfidf_score'=>$scoreData['tfidf_score']?? 0,'auto_suggest'=>($scoreData['tfidf_score']?? 0)>=$threshold?1:0,'platforms'=>json_encode(['discord'=>true,'linkedin'=>true,'x'=>false,'email'=>false,]),'created_at'=>date('Y-m-d H:i:s'),];return $this->insert($bufferRecord);}public function insertFinalScraper(array $record,array $summary){$data=['source_id'=>$record['id'],'title'=>$record['title']?? '(No Title)','summary'=>$summary['summary']?? '','keywords'=>json_encode($summary['keywords']??[]),'platforms'=>json_encode($summary['posts']??[]),'status'=>'ready','created_on'=>date('Y-m-d H:i:s'),];return $this->db->table('bf_marketing_scraper')->insert($data);}public function insertNewsContent(array $newsItem,string $ticker){$data=['title'=>$newsItem['title']?? '','summary'=>$newsItem['summary']?? '','content'=>$newsItem['content']?? '','type'=>'financial_news','status'=>'Published','created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),'scraped_at'=>date('Y-m-d H:i:s'),'keywords'=>json_encode($newsItem['keywords']??[]),'links'=>json_encode($newsItem['links']??[]),'audience_type'=>'investor','activity'=>$ticker,];return $this->db->table('bf_marketing_scraper')->insert($data);}public function insertTempScraper($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function idleFetchEmails(){$config=config('NewsEmailServer');$connectionString="{$config->host}:{$config->port}/imap/{$config->encryption}";$inbox=@imap_open($connectionString,$config->username,$config->password);if(!$inbox){log_message('error','Cannot connect to email server: '.imap_last_error());return;}try{while(true){if(function_exists('imap_idle')){$status=imap_idle($inbox);}else{log_message('warning','ðŸ“­ imap_idle not supported on this server. Falling back to polling.');sleep(30);continue;}$status=imap_idle($inbox);if($status){$emails=imap_search($inbox,'ALL');if($emails){foreach($emails as $email_number){$overview=imap_fetch_overview($inbox,$email_number,0)[0];$sender=$overview->from;$subject=$overview->subject;$body=imap_fetchbody($inbox,$email_number,1);$data=['status'=>'In Review','type'=>'Email/Newsletters','email_identifier'=>md5($subject.$sender.$overview->date),'email_date'=>date('Y-m-d H:i:s',strtotime($overview->date)),'email_sender'=>$sender,'email_subject'=>$subject,'email_body'=>$body,'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];if($this->isEmailProcessed($data['email_identifier'])){log_message('debug','Email already processed: '.$data['email_identifier']);}else{$this->storeEmailContent($data);}}}else{log_message('debug','No new emails found or imap_search returned false');}}sleep(30);}}catch(\Exception $e){log_message('error','An exception occurred during email fetching: '.$e->getMessage());}finally{imap_close($inbox);}}public function isEmailProcessed($emailIdentifier){return $this->where('email_identifier',$emailIdentifier)->countAllResults()>0;}private function mapToContextualHashtags($keywords){return array_map(fn($keyword)=>'#'.preg_replace('/\s+/','',ucfirst($keyword)),$keywords);}public function markEmailsAsProcessed($ids=[]){if(!empty($ids)){return $this->db->table('bf_marketing_temp_scraper')->whereIn('id',$ids)->update(['status'=>'Processed']);}return false;}public function markTempRecordAsProcessed($id){return $this->db->table('bf_marketing_temp_scraper')->where('id',$id)->update(['status'=>'Processed','updated_at'=>date('Y-m-d H:i:s')]);}public function markTempScraperProcessed($id){$this->db->table('bf_marketing_temp_scraper')->where('id',$id)->update(['status'=>'Processed']);}public function processText($emailBody){$summary=$this->summarizeText($emailBody);$keywords=$this->extractKeywords($emailBody);$hashtags=$this->mapToContextualHashtags($keywords);if(empty($summary)||empty($hashtags)){log_message('error','Text processing failed');return false;}return $summary.' '.implode(' ',$hashtags);}public function saveApprovedLogo($symbol,$imageUrl){$symbol=strtoupper(trim($symbol));$data=['symbol'=>$symbol,'image_url'=>$imageUrl,'approved_at'=>date('Y-m-d H:i:s'),'updated_at'=>date('Y-m-d H:i:s'),];try{$existingLogo=$this->db->table('bf_company_logos')->where('symbol',$symbol)->get()->getRow();if($existingLogo){if($existingLogo->image_url!==$imageUrl){$this->db->table('bf_company_logos')->where('symbol',$symbol)->update($data);log_message('info',"Logo for symbol {$symbol} updated in bf_company_logos.");}else{log_message('info',"Logo for symbol {$symbol} already exists and is up to date.");}}else{$this->db->table('bf_company_logos')->insert($data);log_message('info',"Logo for symbol {$symbol} added to bf_company_logos.");}}catch(\Exception $e){log_message('error',"Failed to save or update logo for symbol {$symbol}: ".$e->getMessage());}}public function saveDailyLog($data){return $this->db->table('bf_marketing_scraper')->insert($data);}public function saveLogo($data){$symbol=strtoupper(trim($data['symbol']));$existing=$this->db->table('bf_company_logos')->where('symbol',$symbol)->get()->getRow();$data['symbol']=$symbol;$data['updated_at']=date('Y-m-d H:i:s');if($existing){$this->db->table('bf_company_logos')->where('symbol',$symbol)->update($data);log_message('info',"Logo for symbol {$symbol} updated in bf_company_logos.");}else{$data['created_at']=date('Y-m-d H:i:s');$this->db->table('bf_company_logos')->insert($data);log_message('info',"Logo for symbol {$symbol} added to bf_company_logos.");}}public function scheduleNewsletterCampaign($data){return $this->db->table('bf_marketing_newsletters')->insert($data);}public function storeContentAnalytics(array $data){return $this->db->table('bf_marketing_analysis')->insert($data);}public function storeEmail($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function storeEmailContent($data){return $this->insert($data);}public function storeFinalMarketingContent($data){return $this->db->table('bf_marketing_scraper')->insert($data);}public function storeTodaysStory($title,$content){$data=['title'=>$title,'content'=>$content,'links'=>json_encode([]),'url'=>'','type'=>'todays_story','scraped_at'=>date('Y-m-d H:i:s'),'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function submitCampaignContent($data){if(isset($data['promotional_links'])&&is_array($data['promotional_links'])){$data['promotional_links']=json_encode($data['promotional_links']);}$data['status']=$data['status']?? 1;$data['stage']=$data['stage']?? 'draft';$data['created_on']=date('Y-m-d H:i:s');return $this->save($data);}public function storeNewsletterDraft($data){return $this->db->table('bf_marketing_newsletters')->insert($data);}public function storeNotification($data){return $this->db->table('bf_users_promotional_messages')->insert($data);}public function storeScrapedContent($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function storeTempScrapedData($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function summarizeText($text){if(empty($text)){return '';}$sentences=explode('.',$text);if(count($sentences)<=1){return substr($text,0,200);}$tokenizer=new WhitespaceTokenizer();$documents=array_map([$tokenizer,'tokenize'],$sentences);$documents=array_filter($documents);if(empty($documents)){return '';}$tfidf=new TfIdfTransformer();try{$tfidf->transform($documents);}catch(\Exception $e){log_message('error','TfIdfTransformer failed: '.$e->getMessage());return '';}$sentenceScores=[];foreach($documents as $index=>$document){$sentenceScores[$index]=array_sum($document);}arsort($sentenceScores);$numSentences=min(5,count($sentenceScores));$summarySentences=array_slice(array_keys($sentenceScores),0,$numSentences);return implode('. ',array_intersect_key($sentences,array_flip($summarySentences)));}public function updateBufferItem($id,$data){return $this->db->table('bf_marketing_buffer')->where('id',$id)->update($data);}public function updateBufferStatus($id,$status){return $this->db->table('bf_marketing_buffer')->where('id',$id)->update(['status'=>$status]);}public function updateCampaignStatus($id,$status){return $this->db->table('bf_marketing_newsletters')->where('id',$id)->update(['status'=>$status]);}public function updateEmailFields($id,$title,$url,$content=null){$data=['title'=>$title,'url'=>$url];if(!empty($content)){$data['content']=$content;}return $this->db->table('bf_marketing_temp_scraper')->where('id',$id)->update($data);}public function updateExchangeToken($id,$data){return $this->update($id,$data);}public function updateNotification($data){return $this->db->table('bf_users_promotional_messages')->update($data);}public function updateSchedule($id,$data){return $this->db->table('bf_marketing_schedule')->where('id',$id)->update($data);}public function updatePostStatus($id,$status){return $this->db->table('bf_marketing_schedule')->where('id',$id)->update(['post_status'=>$status,'last_attempt_at'=>date('Y-m-d H:i:s')]);}} ?><?php namespace App\Services;use App\Libraries\{BaseLoader,MyMIMarketing};use App\Models\{MarketingModel};use GuzzleHttp\Client;class MarketingService{use BaseLoader;protected $MyMIMarketing;protected $marketingModel;protected $httpClient;public function __construct(){$this->MyMIMarketing=new MyMIMarketing();$this->marketingModel=new MarketingModel();$this->httpClient=new Client(['timeout'=>5,'stream'=>true,'http_errors'=>false,'headers'=>['User-Agent'=>'MyMI Content Bot','Accept-Encoding'=>'gzip, deflate, br',]]);}public function distributeContent($platform,$message){switch($platform){case 'discord':return $this->sendToDiscordWebhook($message);case 'facebook':return $this->sendToZapier('facebook',$message);case 'linkedin':return $this->sendToZapier('linkedin',$message);default:return false;}}public function extractTopKeywords($summary){return $this->getMyMIMarketing()->extractKeywords($summary['summary']);}public function fetchUnprocessedEmailSummaries(){return $this->getMyMIMarketing()->getEmailSummariesForReview();}public function getEmailRecordById($id){return $this->marketingModel->getEmailRecordById($id);}public function getFeatures(){$getFeatures=$this->getMyMIMarketing()->getFeatures();return $getFeatures;}public function gatherKeywordBasedContent($keywords){$allContent=[];foreach($keywords as $keyword){$secData=$this->getMyMIMarketing()->scrapeGoogleSearch("SEC filings {$keyword}");$alphaVantageData=$this->getMyMIMarketing()->scrapeGoogleSearch("AlphaVantage {$keyword}");$googleData=$this->getMyMIMarketing()->scrapeGoogleSearch($keyword,$this->httpClient);$internalData=$this->getMyMIMarketing()->getScrapesByKeyword($keyword);$allContent[]=array_merge([$secData],[$alphaVantageData],[$googleData],$internalData);}return $allContent;}public function generateContentFromPost($title,$content,$tags){$summaryData=$this->getMyMIMarketing()->summarizeContent($content);if(empty($summaryData)||empty($summaryData['summary'])){log_message('error','generateContentFromPost() failed to generate summary.');return null;}return $this->getMyMIMarketing()->generatePlatformContent($summaryData['summary'],$tags);}public function generateFinalContentFromTemp(){$records=$this->marketingModel->getTopTempRecords(5);foreach($records as $record){if(empty($record['title'])||empty($record['content']))continue;$summary=$this->summarizeContent($record['content']);$socialMediaPost=$this->generateSocialPost($summary);$final=['title'=>$record['title'],'content'=>$summary,'post_text'=>$socialMediaPost,'source'=>'email','created_at'=>date('Y-m-d H:i:s'),];$this->marketingModel->insertFinalScraper($final);}}public function generatePlatformPosts($content){$summaryText=implode(" ",array_column($content,'content'));return $this->getMyMIMarketing()->generateContentFromLargeText($summaryText,[]);}public function getManagementTeam(){$getManagementTeam=$this->getMyMIMarketing()->getManagementTeam();return $getManagementTeam;}public function getMarketingData($accountid,$category,$platform){$data=[];if($category&&$accountid){$scrapedData=$this->getMyMIMarketing()->scrapeTokenContentByAccountId($accountid);if($scrapedData){$data['generatedData']=$this->getMyMIMarketing()->generateContentFromScrapedData($scrapedData,$platform);}else{$data['generatedData']=[];}}return $data;}public function getPromotionalBanners($userId){return $this->getMyMIMarketing()->fetchPromotionalBanners($userId);}public function getRecentGeneratedContent($limit=10){return $this->db->table('bf_marketing_scraper')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function regeneratePostsFromEmailId($id){$record=$this->getEmailRecordById($id);if(!$record||empty($record['content'])){log_message('error',"âŒ Email record not found or empty for ID: $id");return null;}$processed=$this->getMyMIMarketing()->generateContentFromRaw($record);if($processed){$this->marketingModel->insertFinalScraper($record,$processed);$this->marketingModel->markEmailsAsProcessed([$id]);return $processed;}return null;}public function sanitizeAndSummarize($content){$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($content);return $this->getMyMIMarketing()->summarizeContent($cleanedBody);}public function storeGeneratedPostsForDashboard($posts){$this->getMyMIMarketing()->storeGeneratedContent(['primary_content'=>$posts['summary'],'social_media_content'=>json_encode($posts['platforms_content']),'status'=>'Generated','created_on'=>date('Y-m-d H:i:s'),]);}protected function sendToDiscordWebhook($message){$webhook=getenv('DISCORD_WEBHOOK_URL');if(!$webhook)return false;$client=\Config\Services::curlrequest();$payload=['content'=>$message];$response=$client->post($webhook,['json'=>$payload]);return $response->getStatusCode()===204;}protected function sendToZapier($platform,$message){$zapierHooks=['facebook'=>getenv('ZAPIER_FACEBOOK_WEBHOOK'),'linkedin'=>getenv('ZAPIER_LINKEDIN_WEBHOOK'),];$hook=$zapierHooks[$platform]?? null;if(!$hook)return false;$client=\Config\Services::curlrequest();$payload=['message'=>$message,'platform'=>$platform];$response=$client->post($hook,['json'=>$payload]);return $response->getStatusCode()===200;}public function storeScrapedContent($content){foreach($content as $data){$this->getMyMIMarketing()->storeTempScrapedData(['title'=>$data['title'],'content'=>$data['content'],'scraped_at'=>date('Y-m-d H:i:s'),'type'=>'keyword_summary',]);}}} ?><?php namespace App\Modules\APIs\Controllers;use CodeIgniter\Controller;use App\Modules\APIs\Controllers\MarketingController;use App\Libraries\{BaseLoader,MyMIAlerts,MyMIMarketing};use App\Models\{AlertsModel,ExchangeModel,MarketingModel,ReferralModel,SupportModel,UserModel};use App\Services\{MarketingService};use CodeIgniter\API\ResponseTrait;class ManagementController extends UserController{use BaseLoader;use ResponseTrait;protected $alertManager;protected $MyMIMarketing;protected $marketingService;protected $alertsModel;protected $exchangeModel;protected $marketingModel;protected $userModel;protected $referralModel;protected $supportModel;public function __construct(){$this->alertManager=new MyMIAlerts();$this->MyMIMarketing=new MyMIMarketing();$this->alertsModel=new AlertsModel();$this->exchangeModel=new ExchangeModel();$this->marketingModel=new MarketingModel();$this->marketingService=new MarketingService();$this->referralModel=new ReferralModel();$this->supportModel=new SupportModel();$this->userModel=new UserModel();}public function runCRONTasks(){log_message('info','ðŸ› ï¸ ManagementController::runCRONTasks() initiated.');$marketingController=new MarketingController();log_message('info','ðŸ“Œ Step 1: cronFetchAndGenerateNews()');try{$marketingController->cronFetchAndGenerateNews();}catch(\Throwable $e){log_message('error','âŒ cronFetchAndGenerateNews failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 3: generateDailyContentDigest()');try{$todayNews=$this->marketingModel->getTodaysScrapedContent();if(!empty($todayNews)){$marketingController->generateDailyContentDigest();}else{log_message('info','ðŸ›‘ Skipping summary generation â€” no scraped news available today.');}}catch(\Throwable $e){log_message('error','âŒ generateDailyContentDigest() failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 4: cronFetchInbox()');try{$marketingController->cronFetchInbox();}catch(\Throwable $e){log_message('error','âŒ cronFetchInbox() failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 5: cronAnalyzeContent()');try{$marketingController->cronAnalyzeContent();}catch(\Throwable $e){log_message('error','âŒ cronAnalyzeContent() failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 6: reprocessIncompleteEmails()');try{$marketingController->runBackfillForTempEmails();}catch(\Throwable $e){log_message('error','âŒ reprocessIncompleteEmails() failed: '.$e->getMessage());}log_message('info','âœ… ManagementController::runCRONTasks() completed.');}public function ajaxGetActiveUsers(){log_message('debug','ðŸ“¥ ajaxGetActiveUsers() called.');$request=service('request');$post=$request->getPost();log_message('debug','ðŸ“¦ Incoming POST: '.print_r($post,true));$start=$post['start']?? 0;$length=$post['length']?? 10;$search=$post['search']['value']?? '';$records=$this->userModel->getUsersByStatus(1,$search);$totalRecords=count($records);$records=array_slice($records,$start,$length);$data=[];foreach($records as $user){try{$actionView=view('ManagementModule\Views\Users\partials\action_buttons',['user'=>$user]);}catch(\Throwable $e){log_message('error','âŒ Error rendering action_buttons view for user ID '.$user['id'].': '.$e->getMessage());$actionView='<span class="text-danger">View Error</span>';}$data[]=['id'=>'<a href="'.site_url('Management/Users/Profile/'.$user['username']).'">'.$user['id'].'</a>','type'=>$user['type'],'name'=>$user['first_name'].' '.$user['last_name'].' '.$user['name_suffix'],'email'=>'<a href="mailto:'.$user['email'].'">'.$user['email'].'</a>','location'=>$user['city'].', '.$user['state'],'referral_code'=>$user['referral_code'],'actions'=>$actionView,];}return $this->response->setJSON(['draw'=>intval($post['draw']?? 1),'recordsTotal'=>$totalRecords,'recordsFiltered'=>$totalRecords,'data'=>$data,]);}public function ajaxGetInactiveUsers(){log_message('debug','ðŸ“¥ ajaxGetInactiveUsers() called.');$request=service('request');$post=$request->getPost();log_message('debug','ðŸ“¦ Incoming POST: '.print_r($post,true));$start=$post['start']?? 0;$length=$post['length']?? 10;$search=$post['search']['value']?? '';$records=$this->userModel->getUsersByStatus(0,$search);$totalRecords=count($records);$records=array_slice($records,$start,$length);$data=[];foreach($records as $user){try{$actionView=view('ManagementModule\Views\Users\partials\action_buttons',['user'=>$user]);}catch(\Throwable $e){log_message('error','âŒ Error rendering action_buttons view for user ID '.$user['id'].': '.$e->getMessage());$actionView='<span class="text-danger">View Error</span>';}$data[]=['id'=>'<a href="'.site_url('Management/Users/Profile/'.$user['username']).'">'.$user['id'].'</a>','type'=>$user['type'],'name'=>$user['first_name'].' '.$user['last_name'].' '.$user['name_suffix'],'email'=>'<a href="mailto:'.$user['email'].'">'.$user['email'].'</a>','location'=>$user['city'].', '.$user['state'],'referral_code'=>$user['referral_code'],'actions'=>$actionView,];}return $this->response->setJSON(['draw'=>intval($post['draw']?? 1),'recordsTotal'=>$totalRecords,'recordsFiltered'=>$totalRecords,'data'=>$data,]);}protected function arrayToXml(array $data,\SimpleXMLElement $xml){foreach($data as $key=>$value){is_array($value)?$this->arrayToXml($value,$xml->addChild($key)):$xml->addChild($key,htmlspecialchars($value));}return $xml;}public function checkForSpamUsers(){try{$MyMIUser=new \App\Libraries\MyMIUser();$spamAccounts=$MyMIUser->findPotentialSpamUsers();return $this->response->setJSON(['status'=>'success','message'=>count($spamAccounts).' spam accounts detected.','data'=>$spamAccounts]);}catch(\Throwable $e){log_message('error','âŒ Error checking spam users: '.$e->getMessage());return $this->failServerError('Failed to check for spam accounts.');}}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);log_message('debug','âœ… Content digest completed.');}public function cronFetchAndGenerateNews(){try{$this->getMyMIMarketing()->cronFetchAndGenerateNews();return $this->response->setJSON(['status'=>'success','message'=>'MarketAux news pulled, ranked, and content generated.']);}catch(\Throwable $e){return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();log_message('debug','âœ… Inbox scrape completed.');}public function cronFetchMarketingEmails(){log_message('info','CRON: Starting Marketing Email Fetch');$service=new MarketingService();$emailsFetched=$service->fetchAndStoreMarketingEmails();log_message('info','CRON: Fetched '.$emailsFetched.' marketing emails');return $this->respond(['status'=>'success','fetched'=>$emailsFetched]);}public function cronFetchAndStoreEmails(){try{$this->logMessage('ðŸ“¥ [CRON] Started cronFetchAndStoreEmails');$marketingService=$this->getMarketingService();$fetched=$marketingService->scrapeInboxAndStore();$this->logMessage("ðŸ“© [CRON] Fetched and stored {$fetched} emails into bf_marketing_temp_scraper");return $this->respond(['status'=>'success','stored'=>$fetched]);}catch(\Throwable $e){log_message('error','[CRON] Error in cronFetchAndStoreEmails: '.$e->getMessage());return $this->failServerError('Failed to fetch emails');}}public function distributeTodaysNewsContent(){$generated=$this->generateTodaysNewsSummary();$result=$this->getMyMIMarketing()->sendToZapier($generated['content']);return $this->response->setJSON(['status'=>'success','message'=>'Content distributed via Zapier.','zapier_result'=>$result]);}public function exportPostJson($id){$post=$this->marketingModel->getGeneratedPostById($id);if(!$post||empty($post['posts'])){return $this->failNotFound('Post not found.');}$posts=json_decode($post['posts'],true);$export=['title'=>$post['title'],'summary'=>$post['summary'],'cta'=>'Check it out at https://mymiwallet.com','keywords'=>explode(',',$post['keywords']?? ''),'platform_captions'=>$posts,];return $this->response->setHeader('Content-Type','application/json')->setHeader('Content-Disposition','attachment; filename="canva_post_'.$id.'.json"')->setJSON($export);}public function fetchAlphaVantageNewsForTradeAlerts(){$alerts=$this->alertsModel->getTradeAlertsWithCreatedFlag();log_message('info','ðŸ“ˆ Processing '.count($alerts).' trade alerts.');foreach($alerts as $alert){try{log_message('info','ðŸ” Fetching AlphaVantage news for: '.$alert['ticker']);$newsItems=$this->alertManager->fetchAlphaVantageNews($alert['ticker']);log_message('info','ðŸ“° '.count($newsItems).' news items fetched for '.$alert['ticker']);foreach($newsItems as $news){$this->marketingModel->insertNewsContent($news,$alert['ticker']);}}catch(\Throwable $e){log_message('error','âŒ AlphaVantage fetch failed for '.$alert['ticker'].': '.$e->getMessage());}}return $this->response->setJSON(['status'=>'success','message'=>'Financial news processed for alerts.']);}public function fetchEmailsToTempScraper(){try{log_message('info','ðŸ“¥ Starting email scrape to bf_marketing_temp_scraper...');$this->getMyMIMarketing()->fetchAndStoreEmails('news');log_message('info','ðŸ“¬ Number of emails fetched: '.count($emails));return $this->response->setJSON(['status'=>'success','message'=>'Emails stored successfully.']);}catch(\Throwable $e){log_message('error','âŒ fetchEmailsToTempScraper error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function fetchNewsEmails(){log_message('info','ðŸ“¥ fetchNewsEmails - Started.');try{$this->getMyMIMarketing()->fetchAndStoreEmails('news');return $this->response->setJSON(['status'=>'success','message'=>'News emails fetched successfully.']);}catch(\Exception $e){log_message('error','âŒ fetchNewsEmails - Error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function forceFetchEmails(){try{$result=$this->alertManager->fetchAndStoreEmails();return $this->response->setJSON(['status'=>'success','message'=>'Emails fetched and processed successfully.']);}catch(\Exception $e){return $this->response->setJSON(['status'=>'error','message'=>'Error fetching emails: '.$e->getMessage()],500);}}public function generateContentDigestFromStored(){log_message('info','Marketing: Starting summary generation from stored marketing emails.');$model=new MarketingModel();$records=$model->getRecentUnprocessedTempEmails(5);$results=[];foreach($records as $record){if(empty($record['title'])||empty($record['content'])){log_message('debug','Skipped record due to missing title/content ID: '.$record['id']);continue;}try{$summary=$this->getMarketingService()->generateContentFromRaw($record['title'],$record['content']);$model->storeFinalMarketingContent(['source_id'=>$record['id'],'title'=>$record['title'],'summary'=>$summary,'created_at'=>date('Y-m-d H:i:s')]);$model->markTempRecordAsProcessed($record['id']);$results[]=$record['title'];}catch(\Throwable $e){log_message('error','Failed to process record ID '.$record['id'].': '.$e->getMessage());}}return $this->respond(['status'=>'complete','processed_titles'=>$results]);}public function generateContentFromScraper(){log_message('debug','ðŸ” API::MarketingController::generateContentFromScraper called');try{$limit=$this->request->getGet('limit')?? 5;$records=[];$allRecords=$this->marketingModel->getValidUnprocessedEmails($limit);if(!is_array($allRecords)){log_message('error','âŒ $allRecords is not an array or null. Cannot proceed.');return $this->respond(['status'=>'error','message'=>'Failed to fetch records.']);}foreach($allRecords as $record){$titleOk=!empty($record['title']);$contentOk=strlen(strip_tags($record['content']?? ''))>1000;if($titleOk&&$contentOk){$records[]=$record;if(count($records)>=$limit)break;}else{log_message('debug',"âš ï¸ Skipping invalid record ID {$record['id']} during prefilter (Title or content missing/too short).");$this->marketingModel->markEmailsAsProcessed([$record['id']]);}}if(empty($records)){return $this->respond(['status'=>'no_data','message'=>'No unprocessed records found.']);}$processedSummaries=[];foreach($records as $record){$content=$record['content']?? '';$title=$record['title']?? '';$recordId=$record['id']?? 0;if(empty(trim($content))||strlen($content)<1000){log_message('debug',"â­ï¸ Skipping record ID {$recordId} - content too short or empty.");continue;}if(empty(trim($title))){log_message('debug',"â­ï¸ Skipping record ID {$recordId} - missing title.");continue;}if(stripos($content,'<html')!==false&&substr_count($content,'<')>50){log_message('debug',"â­ï¸ Skipping record ID {$recordId} - content likely raw HTML.");continue;}try{$processed=$this->getMarketingService()->generateContentFromRaw($record);if(!is_array($processed)){log_message('debug',"âš ï¸ Skipped record ID {$recordId} - generateContentFromRaw() returned invalid structure.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$this->marketingModel->markEmailsAsProcessed([$recordId]);$processedSummaries[]=['id'=>$recordId,'title'=>$processed['headline']?? $title,'summary'=>$processed['summary']?? '','keywords'=>$processed['keywords']??[],];}catch(\Throwable $e){log_message('error',"âŒ Failed to process record ID {$recordId}: {$e->getMessage()}");}}return $this->respond(['status'=>'success','message'=>count($processedSummaries).' records processed successfully.','data'=>$processedSummaries]);}catch(\Throwable $e){log_message('error','âŒ API::generateContentFromScraper error - '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function generateDailyContentDigest(){log_message('debug','ðŸ§  Start Memory Usage: '.memory_get_usage(true));@ini_set('memory_limit','768M');$limit=5;$summary=[];try{$records=$this->marketingModel->getValidUnprocessedEmails($limit);if(!is_array($records)||empty($records)){log_message('info','ðŸš« No valid records returned from getValidUnprocessedEmails().');return $this->response->setJSON(['status'=>'no_data','message'=>'No valid records to process.']);}foreach($records as $record){$recordId=$record['id']?? 0;$title=$record['title']?? '';$content=$record['content']?? '';$contentSize=strlen(strip_tags($content));if(empty(trim($title))||$contentSize<1000){log_message('debug',"âš ï¸ Skipping record ID {$recordId} â€” title missing or content too short ({$contentSize} chars).");$this->marketingModel->markEmailsAsProcessed([$recordId]);continue;}if(stripos($content,'<html')!==false&&substr_count($content,'<')>50){log_message('debug',"â­ï¸ Skipping record ID {$recordId} â€” likely raw HTML content.");$this->marketingModel->markEmailsAsProcessed([$recordId]);continue;}try{gc_collect_cycles();$processed=$this->getMarketingService()->generateContentFromRaw($record);if(!is_array($processed)){log_message('warning',"âš ï¸ Skipped record ID {$recordId} â€” generateContentFromRaw() returned invalid result.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$this->marketingModel->markEmailsAsProcessed([$recordId]);$summary[]=['title'=>$processed['headline']?? 'Untitled','summary'=>$processed['summary']?? '','subtopics'=>$processed['subtopics']??[],'platform_posts'=>$processed['posts']??[],];}catch(\Throwable $e){log_message('error',"âŒ Error processing record ID {$recordId}: {$e->getMessage()}");}}log_message('debug','ðŸ Peak Memory Usage: '.memory_get_peak_usage(true));return $this->response->setJSON(['status'=>'success','digest'=>$summary]);}catch(\Throwable $e){log_message('error','âŒ generateDailyContentDigest fatal error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function generateRankedMarketingContent(){$this->getMyMIMarketing()->generateRankedMarketingContent();return $this->response->setJSON(['status'=>'success','message'=>'Ranked content generated.']);}public function getBalanceSheet($symbol,$apikey){$url="https://www.alphavantage.co/query?function=BALANCE_SHEET&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getCashFlowStatement($symbol,$apikey){$url="https://www.alphavantage.co/query?function=CASH_FLOW&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getCompanyOverview($symbol,$apikey){$url="https://www.alphavantage.co/query?function=OVERVIEW&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getEarningsCalendar($apikey,$horizon='3month'){$url="https://www.alphavantage.co/query?function=EARNINGS_CALENDAR&horizon=".$horizon."&apikey=".$apikey;$csv=file_get_contents($url);$lines=explode("\n",trim($csv));$data=array_map('str_getcsv',$lines);return $data;}public function getFixedWindowAnalytics($symbols,$rangeStart,$rangeEnd,$calculations,$apikey){$url="https://alphavantageapi.co/timeseries/analytics?SYMBOLS=".urlencode($symbols);$url.="&RANGE=".$rangeStart."&RANGE=".$rangeEnd;$url.="&INTERVAL=DAILY&OHLC=close";$url.="&CALCULATIONS=".urlencode($calculations)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getIncomeStatement($symbol,$apikey){$url="https://www.alphavantage.co/query?function=INCOME_STATEMENT&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getInsiderTransactions($symbol,$apikey){$url="https://www.alphavantage.co/query?function=INSIDER_TRANSACTIONS&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getNewsSentiment($apikey,$tickers='',$topics='',$time_from='',$time_to='',$sort='LATEST',$limit=50){$url="https://www.alphavantage.co/query?function=NEWS_SENTIMENT";$url.="&tickers=".urlencode($tickers);$url.="&topics=".urlencode($topics);if($time_from)$url.="&time_from=".$time_from;if($time_to)$url.="&time_to=".$time_to;$url.="&sort=".$sort."&limit=".$limit."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getSlidingWindowAnalytics($symbols,$range,$windowSize,$calculations,$apikey){$url="https://alphavantageapi.co/timeseries/running_analytics?SYMBOLS=".urlencode($symbols);$url.="&RANGE=".$range."&INTERVAL=DAILY&OHLC=close";$url.="&WINDOW_SIZE=".$windowSize;$url.="&CALCULATIONS=".urlencode($calculations)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function generatePostsFromSummary($summaryId=null){try{$summary=$this->marketingModel->find($summaryId);if(!$summary){return $this->failNotFound('Summary not found.');}$decodedTitleRaw=$summary['title']?? '';$decodedSummaryRaw=$summary['summary']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$decodedSummary=quoted_printable_decode($decodedSummaryRaw);$cleanedSummary=html_entity_decode(strip_tags($decodedSummary));$keywords=$this->MyMIMarketing->extractKeywords($cleanedSummary);$posts=$this->MyMIMarketing->generateSocialPosts($cleanedSummary,$keywords);$this->marketingModel->update($summaryId,['keywords'=>json_encode($keywords),'posts'=>json_encode($posts),]);return $this->respond(['status'=>'success','message'=>'Content generated and stored successfully.','original'=>$summary,'cleaned'=>['title'=>$decodedTitle,'summary'=>$cleanedSummary,'keywords'=>$keywords,'posts'=>$posts,],]);}catch(\Throwable $e){log_message('error','âŒ generatePostsFromSummary() failed: '.$e->getMessage());return $this->failServerError('Error generating posts.');}}public function testTfIdfPipeline(){$samples=['Short unstructured','This is a valid test document with enough content and structure to process correctly.','     ','<html><body>Broken HTML without substance</body></html>','Here is another test input to validate TF-IDF scoring logic.',];foreach($samples as $i=>$text){$summary=$this->MyMIMarketing->summarizeText($text);$keywords=$this->MyMIMarketing->extractKeywords($text);$scorePreview=$this->MyMIMarketing->getTopKeywordScores($text,5);log_message('debug',"ðŸ§ª Test #{$i} | Summary: {$summary}");log_message('debug',"ðŸ§ª Test #{$i} | Keywords: ".implode(',',$keywords));log_message('debug',"ðŸ“Š Test #{$i} | TF-IDF Scores: ".print_r($scorePreview,true));}return $this->respond(['status'=>'ok','message'=>'TF-IDF test pipeline ran successfully.']);}public function generateTodaysNewsSummary(){$todayNews=$this->marketingModel->getTodaysNewsContent();$summary=$this->getMyMIMarketing()->summarizeMultipleArticles($todayNews);$content=$this->getMyMIMarketing()->generateMarketingContent($summary);return $this->response->setJSON(['status'=>'success','summary'=>$summary,'content'=>$content]);}public function generateTodaysStory(){ini_set('memory_limit','1024M');try{log_message('info','ðŸ” Starting email scrape for news@mymiwallet.com...');$this->getMyMIMarketing()->fetchAndStoreEmails('news');$today=date('Y-m-d');$scrapes=$this->marketingModel->getScrapesByDate($today,10);if(empty($scrapes)){log_message('info','No scraped emails found for today.');return $this->response->setJSON(['status'=>'error','message'=>'No emails found for today.'],404);}$summaries=[];foreach(array_chunk($scrapes,10)as $scrapeChunk){foreach($scrapeChunk as $scrape){$content=$scrape['email_body']?? $scrape['content']?? '';log_message('info','Content size: '.strlen($content));$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($content);$summary=$this->getMyMIMarketing()->summarizeContent($cleanedBody);log_message('debug','Memory after summary: '.memory_get_usage(true));if(is_array($summary)){$summary=$summary['summary']?? implode('. ',array_map('strval',$summary));}$summaries[]=$summary;}}$combinedSummary=implode("\n\n",$summaries);if(strlen($combinedSummary)>500000){log_message('warning','Combined summary too long. Truncating...');$combinedSummary=substr($combinedSummary,0,500000);}$todayTitle="Today's Top Stories - ".date('F j, Y');$data=['title'=>$todayTitle,'content'=>$combinedSummary,'links'=>json_encode([]),'url'=>'','type'=>'todays_story','scraped_at'=>date('Y-m-d H:i:s'),'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeTempScrapedData($data);log_message('info','âœ… Todayâ€™s story generated and stored.');return $this->response->setJSON(['status'=>'success','message'=>'Todayâ€™s story generated and stored successfully!','title'=>$todayTitle,'summary'=>$combinedSummary]);}catch(\Throwable $e){log_message('error','âŒ generateTodaysStory error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function generateVoiceScriptManually(){try{log_message('info','ðŸŽ¤ generateVoiceScriptManually() triggered.');$script=$this->getMyMIMarketing()->generateVoiceoverScript();return $this->response->setJSON(['status'=>'success','script'=>$script]);}catch(\Throwable $e){log_message('error','âŒ Error in generateVoiceScriptManually: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()]);}}public function getAlerts(){log_message('debug','ðŸ” getAlerts called');try{$alerts=$this->alertsModel->getAllTradeAlerts();log_message('debug','âœ… getAlerts retrieved '.count($alerts).' alerts.');return $this->response->setJSON($alerts);}catch(\Throwable $e){log_message('error','âŒ getAlerts error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getAssets(){log_message('debug','ðŸ“Š getAssets called');try{$assets=$this->exchangeModel->getManagementAssets();log_message('debug','âœ… getAssets retrieved '.count($assets).' assets.');return $this->response->setJSON($assets);}catch(\Throwable $e){log_message('error','âŒ getAssets error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getNews(){log_message('debug','ðŸ“° getNews called');try{$news=$this->marketingModel->getNewsAlerts();log_message('debug','âœ… getNews retrieved '.count($news).' news records.');return $this->response->setJSON($news);}catch(\Throwable $e){log_message('error','âŒ getNews error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getReferrals(){log_message('debug','ðŸ” getReferrals called');try{$referrals=$this->referralModel->getAllReferrals();log_message('debug','âœ… getReferrals retrieved '.count($referrals).' referrals.');return $this->response->setJSON($referrals);}catch(\Throwable $e){log_message('error','âŒ getReferrals error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getSupport(){log_message('debug','ðŸ§¾ getSupport called');try{$support=$this->supportModel->getManagementSupport();log_message('debug','âœ… getSupport retrieved '.count($support).' support records.');return $this->response->setJSON($support);}catch(\Throwable $e){log_message('error','âŒ getSupport error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getTopMovers($apikey){$url="https://www.alphavantage.co/query?function=TOP_GAINERS_LOSERS&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getUpcomingIPOs($apikey){$url="https://www.alphavantage.co/query?function=IPO_CALENDAR&apikey=".$apikey;$csv=file_get_contents($url);$lines=explode("\n",trim($csv));$data=array_map('str_getcsv',$lines);return $data;}public function getUsers(){log_message('debug','ðŸ” getUsers called');}public function massResendActivationEmails(){$users=$this->userModel->getPendingActivationUsers();$activator=service('activator');$emailer=\Config\Services::email();$successCount=0;$failureCount=0;foreach($users as $user){$sent=$activator->send($user);if($sent){$successCount++;log_message('info',"Activation email sent to: {$user->email}");}else{$failureCount++;log_message('error',"Failed to send activation email to: {$user->email}");}}$summary="{$successCount} emails sent successfully, {$failureCount} failed.";return redirect()->to('/Management/Users')->with('message',$summary);}public function processAllTradeAlerts(){try{log_message('info','âš¡ Management API - processAllTradeAlerts triggered.');$this->alertManager->fetchAndStoreAlertsEmails();$this->alertManager->processTradeAlertsInBatches(50);$this->alertManager->updateAlerts();return $this->response->setJSON(['status'=>'success','message'=>'All trade alerts processed successfully.']);}catch(\Exception $e){log_message('error','âŒ Management API - Error processing trade alerts: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function processAndGenerateMarketingContent(){$emails=$this->getMarketingService()->fetchUnprocessedEmailSummaries();if(!empty($emails)&&is_array($emails)){foreach($emails as $email){$cleanContent=$this->getMarketingService()->sanitizeAndSummarize($email['email_body']);$keywords=$this->getMyMIMarketing()->extractTopKeywords($cleanContent);$externalContent=$this->getMarketingService()->gatherKeywordBasedContent($keywords);$this->getMarketingService()->storeScrapedContent($externalContent);$generatedPosts=$this->getMarketingService()->generatePlatformPosts($externalContent);$this->getMarketingService()->storeGeneratedPostsForDashboard($generatedPosts);}}return redirect()->to('/Management/Marketing')->with('message','Content generation completed.');}public function processTempEmailsToScraper(){try{log_message('info','âš™ï¸ Starting content generation from bf_marketing_temp_scraper...');$tempEmails=$this->marketingModel->getRecentScrapes();foreach($tempEmails as $email){$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($email->email_body);$summary=$this->getMyMIMarketing()->summarizeContent($cleanedBody);$keywords=$this->marketingModel->extractKeywords($email->email_body);$hashtags=$this->marketingModel->mapToContextualHashtags($keywords);$data=['title'=>$email->email_subject ?? 'Generated Content','summary'=>is_array($summary)?implode("\n",$summary):$summary,'content'=>$email->email_body,'tags'=>implode(',',$keywords),'type'=>'Email/Newsletters','status'=>'pending','created_on'=>date('Y-m-d H:i:s'),'author_information'=>$email->email_sender,];$this->marketingModel->saveDailyLog($data);}log_message('info','âœ… Finished processing and saving to bf_marketing_scraper.');return $this->response->setJSON(['status'=>'success','message'=>'Content generated and saved to bf_marketing_scraper.',]);}catch(\Throwable $e){log_message('error','âŒ processTempEmailsToScraper error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function reprocessIncompleteEmails(){try{$this->getMyMIMarketing()->reprocessIncompleteEmails();return $this->response->setJSON(['status'=>'success','message'=>'Backfilled incomplete emails.']);}catch(\Throwable $e){log_message('error','âŒ reprocessIncompleteEmails error: '.$e->getMessage());return $this->failServerError('Failed to reprocess incomplete emails.');}}public function runCronManually(){$this->runCRONTasks();return $this->response->setJSON(['status'=>'success','message'=>'Manual CRON execution complete.']);}public function runDailyAlphaVantageDataPipeline(){$symbols=$this->alertsModel->getTopWatchlistSymbols();$apikey=getenv('ALPHA_VANTAGE_KEY');foreach($symbols as $symbol){$this->fetchAlphaVantageNewsForTradeAlerts($symbol['symbol'],$apikey);$this->getCompanyOverview($symbol['symbol'],$apikey);$this->getIncomeStatement($symbol['symbol'],$apikey);}return $this->response->setJSON(['status'=>'success','message'=>'Daily Alpha Vantage data pipeline completed.']);}public function sendToZapierManually(){$summary=$this->generateTodaysNewsSummary();$result=$this->getMyMIMarketing()->sendToZapier($summary['content']);return $this->response->setJSON(['status'=>'success','message'=>'Sent manually to Zapier.','result'=>$result]);}public function scrapeAndGenerateTodaysStoryFromInbox(){try{log_message('info','ðŸ“¥ Starting inbox scrape for news@mymiwallet.com...');$this->getMyMIMarketing()->fetchAndStoreEmails('news');$today=date('Y-m-d');$scrapes=$this->marketingModel->getScrapesByDate($today);if(empty($scrapes)){log_message('info','ðŸ“­ No emails found for today.');return $this->response->setJSON(['status'=>'error','message'=>'No emails found for today.'],404);}$summaries=[];foreach($scrapes as $scrape){$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($scrape['content']);$summary=$this->getMyMIMarketing()->summarizeContent($cleanedBody);if(is_array($summary)){$summary=$summary['summary']?? implode('. ',array_map('strval',$summary));}$summaries[]=$summary;}$combinedSummary=implode("\n\n",$summaries);if(strlen($combinedSummary)>500000){log_message('warning','Combined summary too long. Truncating...');$combinedSummary=substr($combinedSummary,0,500000);}$todayTitle="Today's News Highlights - ".date('F j, Y');$data=['title'=>$todayTitle,'content'=>$combinedSummary,'links'=>json_encode([]),'url'=>'','type'=>'todays_story','scraped_at'=>date('Y-m-d H:i:s'),'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeTempScrapedData($data);log_message('info','âœ… Todayâ€™s story generated and stored.');return $this->response->setJSON(['status'=>'success','message'=>'Todayâ€™s story generated and stored successfully!','title'=>$todayTitle,'summary'=>$combinedSummary]);}catch(\Throwable $e){log_message('error','âŒ scrapeAndGenerateTodaysStoryFromInbox error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function sharePost($id,$platform){try{$post=$this->marketingModel->getGeneratedPostById($id);if(!$post||empty($post['posts'])){return $this->failNotFound('Post not found or invalid.');}$posts=json_decode($post['posts'],true);$message=$posts[$platform]?? null;if(!$message){return $this->failValidationError("No formatted message found for platform: $platform");}$success=$this->getMarketingService()->distributeContent($platform,$message);if($success){return $this->respond(['status'=>'success','message'=>'Post shared.']);}else{return $this->failServerError('Failed to dispatch post.');}}catch(\Throwable $e){log_message('error',"[PostShare] Error: ".$e->getMessage());return $this->failServerError('An unexpected error occurred.');}}public function sendAllDiscordAlerts(){$alerts=$this->alertsModel->getAlertsWithNewTVChart();if(empty($alerts)){return $this->response->setJSON(['status'=>'error','message'=>'No new alerts to send.'],404);}foreach($alerts as $alert){$this->alertManager->sendDiscordNotification($alert);}return $this->response->setJSON(['status'=>'success','message'=>'All Discord notifications sent.']);}public function updateMarketDataForAlerts(){try{$this->alertManager->updateAlerts();return $this->response->setJSON(['status'=>'success','message'=>'Trade alerts updated with market data.']);}catch(\Exception $e){return $this->response->setJSON(['status'=>'error','message'=>'Failed to update market data: '.$e->getMessage()],500);}}} ?><?php $managementActionItems=$siteSettings->managementActionItems;$department=$uri->getSegment(2);$viewFileData=['managementActionItems'=>$managementActionItems,'targetUsers'=>$targetUsers ?? 0,'totalActiveUsers'=>$totalActiveUsers ?? 0,'totalActivePartners'=>$totalActivePartners ?? 0,'totalActiveCampaigns'=>$totalActiveCampaigns ??[],'getTasksByDepartment'=>$getTasksByDepartment ??[],'totalDepartmentTasks'=>$totalDepartmentTasks ??[],'totalPageSEOTasks'=>$totalPageSEOTasks ??[],'totalTransFees'=>$totalTransFees ?? 0,'totalLastTransFees'=>$totalLastTransFees ?? 0,'usersPercentage'=>$usersPercentage ?? 0,'getActiveCampaigns'=>$getActiveCampaigns ??[],'totalApprovedAssets'=>$totalApprovedAssets ?? 0,'totalPendingAssets'=>$totalPendingAssets ?? 0,'userGoals'=>$userGoals ??[],'newsUpdates'=>$newsUpdates ??[],'getBlogPosts'=>$getBlogPosts ??[],'recentMarketingPosts'=>$recentMarketingPosts ??[],'todaysStory'=>$todaysStory ??[],]; ?><div class="nk-block"><div class="row gy-gs"><div class="col-lg-12"><div class="nk-block-head-xs"><div class="nk-block-head-content"><h1 class="title nk-block-title">MyMI Management -<?=esc($department)?></h1><a href="<?=site_url('/Management')?>">â† Back to Management Dashboard</a></div></div></div><div class="col-12 col-xxl-4"><?=view('ManagementModule\Views\Marketing\index\action_center_new',$viewFileData)?></div><div class="col-12 col-xxl-8"><?=view('ManagementModule\Views\Marketing\index\most_recent_content',$viewFileData)?></div><div class="col-12"><?php  ?></div><div class="col-12"><?php  ?></div><div class="col-12 col-xxl-6"><?=view('ManagementModule\Views\Marketing\resources\controlPanelBlock',$viewFileData)?><?php  ?></div><div class="col-12 col-xxl-6"><?=view('ManagementModule\Views\Marketing\resources\ctaRecommenderModule',$viewFileData)?></div><div class="col-12 col-xxl-12 px-2"><div class="generated-summaries"id="generatedSummariesBlock"><?=view('ManagementModule\Views\Marketing\resources\generatedSummaries',$viewFileData)?></div></div><div class="col-12 mt-3 col-xxl-12"><div class="card card-bordered"><div class="card-inner"><h5 class="title">ðŸ“° Recent Marketing Posts</h5><?php $validPosts=array_filter($recentMarketingPosts,fn($p)=>!empty($p->title));if(!empty($validPosts)): ?><ul class="list-group"><?php foreach($validPosts as $post): ?><li class="d-flex justify-content-between align-items-start flex-column list-group-item"><div class="w-100"><strong><?=esc($post->title?:'(Untitled Post)')?></strong><br><small class="text-muted"><?=date('M d, Y h:i A',strtotime($post->created_at))?></small><br><?php if(!empty($post->short_description)): ?><small class="text-secondary"><?=esc($post->short_description)?>...</small><?php else: ?><small class="text-secondary">No description available.</small><?php endif; ?></div><div class="mt-2"><button class="btn btn-primary btn-sm"onclick='dynamicModalLoader("Marketing","PreviewGeneratedPost","<?=$post->id?>")'>Preview</button></div></li><?php endforeach; ?></ul><?php else: ?><p>No posts with valid titles available yet. Click 'Generate' to create one!</p><?php endif; ?></div></div></div><div class="col-12 mt-3 col-xxl-4"><?=view('ManagementModule\Views\Marketing\index\exchange_action_center',$viewFileData)?></div><div class="col-12 mt-3 col-xxl-8"><?=view('ManagementModule\Views\Marketing\index\target_users',$viewFileData)?></div></div></div><script <?= $nonce['script'] ?? '' ?>></script><div class="nk-block"><div class="nk-block-head"><div class="d-flex justify-content-between align-items-center nk-block-head-content"><h4 class="nk-block-title">ðŸ“¢ Generated Marketing Summaries</h4><div><div class="d-flex justify-content-end mt-3"><label class="form-check form-switch ml-2"><input class="btn btn-lg form-check-input"id="liveModeToggle"type="checkbox"> <span class="form-check-label">Live Mode</span></label></div></div></div><p class="text-soft">This section shows finalized summaries ready for distribution across platforms.</p></div><div class="row"id="generatedSummariesBlock"><?php if(!empty($todaysStory)): ?><?php foreach($todaysStory as $summary): ?><div class="mb-4 col-lg-4 col-md-6"><div class="card h-100 shadow-sm"><div class="d-flex flex-column card-body"><h6 class="title mb-1"><?=esc($summary['title'])?></h6><p class="small mb-2 text-soft"><?=date('F j, Y g:i A',strtotime($summary['created_at']))?></p><div class="small mb-2"><?=esc($summary['summary'])?></div><?php if(!empty($summary['keywords'])): ?><div class="small mb-2 text-muted"><strong>#Tags:</strong><?php foreach(explode(',',$summary['keywords'])as $tag): ?><span class="badge bg-light me-1 text-dark">#<?=trim($tag)?></span><?php endforeach; ?></div><?php endif; ?><?php if(!empty($summary['cta'])): ?><div class="small mb-2 text-primary"><strong>ðŸ“£ CTA:</strong><?=esc($summary['cta'])?></div><?php endif; ?><a href="javascript:void(0);"class="btn btn-primary btn-sm mt-auto"onclick='dynamicModalLoader("/API/Management/PreviewGeneratedPost/<?=$summary['id']?>")'>ðŸ” Preview Post</a></div></div></div><?php endforeach; ?><?php else: ?><div class="col-12"><div class="alert alert-warning">âš ï¸ No summaries available. Click "Generate Todayâ€™s Content" to begin.</div></div><?php endif; ?></div></div><script <?= $nonce['script'] ?? '' ?>>const liveToggle = document.getElementById('liveModeToggle');
app/Modules/chatgpt.txt:75:            const response = await fetch("<?=site_url('API/Marketing/generateDailyContentDigest')?>");
app/Modules/chatgpt.txt:100:                const response = await fetch("<?=site_url('API/Marketing/generateContentFromScraper')?>");
app/Modules/chatgpt.txt:125:            const response = await fetch("<?=site_url('API/Marketing/massResendActivationEmails')?>", {
app/Modules/chatgpt.txt:155:            const response = await fetch("<?=site_url('Management/reprocessIncompleteEmails')?>");
app/Modules/chatgpt.txt:169:            const response = await fetch(`<?=site_url('API/Management/approveBufferItem/')?>${id}`, {
app/Modules/chatgpt.txt:184:        window.open("<?=site_url('API/Management/exportBufferPosts')?>", '_blank');
app/Modules/chatgpt.txt:192:            const res = await fetch("<?=site_url('API/Marketing/previewPendingSummaries')?>");
app/Modules/chatgpt.txt:204:            const response = await fetch(`<?=site_url('API/Management/rejectBufferItem/')?>${id}`, {
app/Modules/Support/Views/_partials/_feedback.php:1:<form action="<?= site_url('Support/Feedback') ?>" method="post">
app/Modules/Support/Views/index.php:5:    <li><a href="<?= site_url('Support/Article/' . $slug) ?>"><?= esc($article['title']) ?></a></li>
app/Modules/Notifications/Controllers/PushController.php:62:        $url   = (string) ($this->request->getPost('url') ?? site_url('/'));
app/Modules/User/Views/Alerts/resources/overview_chart.php:73:                    <a href="<?php echo site_url('Budget/Income'); ?>">
app/Modules/User/Views/Alerts/resources/overview_chart.php:85:                    <a href="<?php echo site_url('Budget/Expenses'); ?>">
app/Modules/User/Views/Alerts/resources/overview_chart.php:124:                    <a href="<?php echo site_url('Budget/Income'); ?>">
app/Modules/User/Views/Alerts/resources/overview_chart.php:136:                    <a href="<?php echo site_url('Budget/Expenses'); ?>">
app/Modules/User/Views/Alerts/resources/advisorMedia.php:20:        <a href="<?= site_url('API/Management/generateAdvisorVoiceover/' . $advisorMedia['user_id']) ?>"
app/Modules/User/Views/Alerts/resources/control_center.php:27:                        Receives Rewards for completing your <a href="<?php echo site_url('MyMI-Gold/Goals/Daily'); ?>">Daily Goals for MyMIGold</a>! 
app/Modules/User/Views/Alerts/resources/control_center.php:30:                <a href="<?php echo site_url('MyMI-Gold/Goals/Daily'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Alerts/resources/control_center.php:41:                        <a href="<?php echo site_url('Budget/Income'); ?>">Income Accounts</a> 
app/Modules/User/Views/Alerts/resources/control_center.php:46:                <a href="<?php echo site_url('Budget/Income'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Alerts/resources/control_center.php:57:                        <a href="<?php echo site_url('Budget/Expenses'); ?>">Expense Accounts</a> 
app/Modules/User/Views/Alerts/resources/control_center.php:62:                <a href="<?php echo site_url('Budget/Expenses'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Alerts/resources/control_center.php:73:                        <a href="<?php echo site_url('Wallets/Checking'); ?>">Checking Accounts</a> 
app/Modules/User/Views/Alerts/resources/control_center.php:77:                <a href="<?php echo site_url('/Wallets/Checking'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Alerts/resources/control_center.php:88:                        <a href="<?php echo site_url('/Wallets/Credit'); ?>">Credit</a> 
app/Modules/User/Views/Alerts/resources/control_center.php:92:                <a href="<?php echo site_url('/Wallets/Credit'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Alerts/resources/control_center.php:102:                        <a href="<?php echo site_url('/Wallets/Debt'); ?>">Debt</a> 
app/Modules/User/Views/Alerts/resources/control_center.php:106:                <a href="<?php echo site_url('/Wallets/Debt'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Alerts/resources/control_center.php:119:                        <a href="<?php echo site_url('/Wallets/Investments'); ?>">Investments</a> 
app/Modules/User/Views/Alerts/resources/control_center.php:126:                <a href="<?php echo site_url('/Wallets/Investments'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Alerts/resources/control_center.php:136:                        <a href="<?= site_url('/Memberships/Customize') ?>">Account Membership &amp; Services</a> 
app/Modules/User/Views/Alerts/resources/control_center.php:139:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Alerts/resources/control_center.php:157:                        <a href="<?php //echo site_url('/Budget/Income/Accounts'); ?>">Investments / Assets</a> 
app/Modules/User/Views/Alerts/resources/control_center.php:160:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Alerts/resources/control_center.php:165:                <a href="<?php //echo site_url('/Budget/Add/Expense'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Alerts/resources/control_center.php:174:                    <p>View, manage and analyze your <a href="<?php //echo site_url('Budget/Forecast'); ?>"><strong><?php //echo $totalTransactions; ?> Financial Forecast &amp; 5-Year Projections</strong></a>.</p>
app/Modules/User/Views/Alerts/resources/control_center.php:176:                <a href="<?php //echo site_url('Exchanges'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Alerts/index.php:30:                        <a href="<?= site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>
app/Modules/User/Views/Alerts/index.php:399:                url: '<?= site_url("API/Alerts/getFilteredAlerts"); ?>',
app/Modules/User/Views/Alerts/index.php:420:                url: '<?= site_url("API/Alerts/getFilteredAlerts"); ?>',
app/Modules/User/Views/Alerts/index.php:542:            url: '<?= site_url("API/Alerts/processTradeBatch"); ?>',
app/Modules/User/Views/Alerts/index.php:581:                url: '<?= site_url("API/Alerts/getLatestPrices"); ?>',
app/Modules/User/Views/Alerts/index.php:624:            url: '<?= site_url("API/Alerts/createTradeAlert"); ?>',
app/Modules/User/Views/Alerts/index.php:647:            url: '<?= site_url("API/Alerts/createTradeAlert"); ?>',
app/Modules/User/Views/Alerts/index.php:667:                url: '<?= site_url("API/Alerts/hideTradeAlert"); ?>',
app/Modules/User/Views/Wallets/types/wallets_block.php:341:    const base = "<?=site_url()?>"
app/Modules/User/Views/Wallets/types/wallets_block.php:471:            <div>Your session expired. Please <a class="ms-1" href="<?=esc(site_url('login'))?>">sign in</a> to view wallets.</div>
app/Modules/User/Views/Wallets/types/wallets_block copy.php:257:  function siteUrl(path){ return "<?= site_url() ?>".replace(/\/+$/,'') + '/' + String(path).replace(/^\/+/,''); }
app/Modules/User/Views/Wallets/Purchase/paypal_fields.php:219://             fetch('<?= site_url("/Wallets/MyMIGPayPalCallback") ?>', {
app/Modules/User/Views/Wallets/Purchase/paypal_fields.php:224://                 window.location.href = '<?= site_url("/Wallets/Purchase/MyMIGold/Complete") ?>';
app/Modules/User/Views/Wallets/Purchase/paypal_subscription.php:15:        window.location.href = '<?= site_url("/path/to/success") ?>';
app/Modules/User/Views/Wallets/Purchase/Memberships.php:43:                                    <a href="<?php echo site_url('Wallets/Purchase/Memberships/Customize'); ?>" class="btn btn-primary">Customize Your Plan</a>
app/Modules/User/Views/Wallets/Purchase/Memberships.php:70:                                    <a href="<?php echo site_url('Wallets/Purchase/Memberships/Starter'); ?>" class="btn btn-primary">Select Plan</a>
app/Modules/User/Views/Wallets/Purchase/Memberships.php:100:                                    <a href="<?php echo site_url('Wallets/Purchase/Memberships/Basic'); ?>" class="btn btn-primary">Select Plan</a>
app/Modules/User/Views/Wallets/Purchase/Memberships.php:130:                                    <a href="<?php echo site_url('Wallets/Purchase/Memberships/Pro'); ?>" class="btn btn-primary">Select Plan</a>
app/Modules/User/Views/Wallets/Purchase/Memberships.php:170:                                    <a href="<?php echo site_url('Wallets/Purchase/Memberships/Premium'); ?>" class="btn btn-primary">Select Plan</a>
app/Modules/User/Views/Wallets/Purchase/Memberships.php:222:                                    <td><a href="<?php echo site_url('Wallets/Purchase/Memberships/Starter'); ?>" class="btn btn-primary">Select Plan</a></td>
app/Modules/User/Views/Wallets/Purchase/Memberships.php:223:                                    <td><a href="<?php echo site_url('Wallets/Purchase/Memberships/Basic'); ?>" class="btn btn-primary">Select Plan</a></td>
app/Modules/User/Views/Wallets/Purchase/Memberships.php:224:                                    <td><a href="<?php echo site_url('Wallets/Purchase/Memberships/Pro'); ?>" class="btn btn-primary">Select Plan</a></td>
app/Modules/User/Views/Wallets/Purchase/Memberships.php:225:                                    <td><a href="<?php echo site_url('Wallets/Purchase/Memberships/Premium'); ?>" class="btn btn-primary">Select Plan</a></td>
app/Modules/User/Views/Wallets/Purchase/Memberships/Advertisements/CustomizeYourMembership.php:4:    <a href="' . site_url('Memberships/Customize') . '">
app/Modules/User/Views/Wallets/Purchase/Memberships/Advertisements/CustomizeYourMembership.php:13:            <a href="' . site_url('Wallets/Purchase/Memberships/Customize') . '">
app/Modules/User/Views/Wallets/Purchase/Memberships/Advertisements/CustomizeYourMembership.php:19:        <a href="' . site_url('Wallets/Purchase/Memberships/Customize') . '">
app/Modules/User/Views/Wallets/Purchase/Memberships/Customize.php:176:                fetch('<?=site_url("/Memberships/PurchaseCallback")?>', {
app/Modules/User/Views/Wallets/Purchase/Memberships/Customize.php:182:                        window.location.href = '<?=site_url("/Memberships/PurchaseComplete")?>';
app/Modules/User/Views/Wallets/Purchase/Memberships/Starter.php:106:                <span><a href="<?php echo site_url('Wallets/Purchase/Memberships'); ?>" class="btn btn-primary"><em class="icon ni ni-arrow-left"></em> Back to Memberships</a></span>
app/Modules/User/Views/Wallets/Purchase/Memberships/Starter.php:107:                <span><a href="<?php echo site_url('Dashboard'); ?>" class="btn btn-success">Continue Free <em class="icon ni ni-arrow-right"></em></a></span>
app/Modules/User/Views/Wallets/Purchase/Memberships/Features.php:59:                                <a class="btn btn-success" href="<?php echo site_url($feature_link); ?>">Start Now!</a>
app/Modules/User/Views/Wallets/Purchase/Memberships/Features.php:73:                    <!-- <span><a class="btn btn-primary" href="<?php echo site_url('Wallets/Purchase/Memberships'); ?>"><em class="icon ni ni-arrow-left"></em> Back to Memberships</a></span>  -->
app/Modules/User/Views/Wallets/Purchase/Memberships/Features.php:75:                    <!-- <span><a class="btn btn-success" href="<?php echo site_url('Dashboard'); ?>">Subscribe: <?= $featureCost; ?> <em class="icon ni ni-arrow-right"></em></a></span> -->
app/Modules/User/Views/Wallets/Purchase/Memberships/Basic.php:123:                <span><a href="<?php echo site_url('Wallets/Purchase/Memberships'); ?>" class="btn btn-primary"><em class="icon ni ni-arrow-left"></em> Back to Memberships</a></span>
app/Modules/User/Views/Wallets/Purchase/Memberships/Basic.php:124:                <span><a href="<?php echo site_url('Dashboard'); ?>" class="btn btn-success">Continue Free <em class="icon ni ni-arrow-right"></em></a></span>
app/Modules/User/Views/Wallets/Purchase/Memberships/Premium.php:106:                <span><a href="<?php echo site_url('Wallets/Purchase/Memberships'); ?>" class="btn btn-primary"><em class="icon ni ni-arrow-left"></em> Back to Memberships</a></span>
app/Modules/User/Views/Wallets/Purchase/Memberships/Premium.php:107:                <span><a href="<?php echo site_url('Dashboard'); ?>" class="btn btn-success">Continue Free <em class="icon ni ni-arrow-right"></em></a></span>
app/Modules/User/Views/Wallets/Purchase/Memberships/Promotions.php:43:                                    <a href="<?php echo site_url('Wallets/Purchase/Memberships/Customize'); ?>" class="btn btn-primary">Customize Your Plan</a>
app/Modules/User/Views/Wallets/Purchase/Memberships/Promotions.php:71:                                    <a href="<?php echo site_url('Wallets/Purchase/Memberships/Starter'); ?>" class="btn btn-primary">Select Plan</a>
app/Modules/User/Views/Wallets/Purchase/Memberships/Promotions.php:102:                                    <a href="<?php echo site_url('Wallets/Purchase/Memberships/Basic'); ?>" class="btn btn-primary">Select Plan</a>
app/Modules/User/Views/Wallets/Purchase/Memberships/Promotions.php:133:                                    <a href="<?php echo site_url('Wallets/Purchase/Memberships/Pro'); ?>" class="btn btn-primary">Select Plan</a>
app/Modules/User/Views/Wallets/Purchase/Memberships/Promotions.php:174:                                    <a href="<?php echo site_url('Wallets/Purchase/Memberships/Premium'); ?>" class="btn btn-primary">Select Plan</a>
app/Modules/User/Views/Wallets/Purchase/Memberships/Promotions.php:226:                                    <td><a href="<?php echo site_url('Wallets/Purchase/Memberships/Starter'); ?>" class="btn btn-primary">Select Plan</a></td>
app/Modules/User/Views/Wallets/Purchase/Memberships/Promotions.php:227:                                    <td><a href="<?php echo site_url('Wallets/Purchase/Memberships/Basic'); ?>" class="btn btn-primary">Select Plan</a></td>
app/Modules/User/Views/Wallets/Purchase/Memberships/Promotions.php:228:                                    <td><a href="<?php echo site_url('Wallets/Purchase/Memberships/Pro'); ?>" class="btn btn-primary">Select Plan</a></td>
app/Modules/User/Views/Wallets/Purchase/Memberships/Promotions.php:229:                                    <td><a href="<?php echo site_url('Wallets/Purchase/Memberships/Premium'); ?>" class="btn btn-primary">Select Plan</a></td>
app/Modules/User/Views/Wallets/Purchase/Memberships/Pro.php:105:                <span><a href="<?php echo site_url('Wallets/Purchase/Memberships'); ?>" class="btn btn-primary"><em class="icon ni ni-arrow-left"></em> Back to Memberships</a></span>
app/Modules/User/Views/Wallets/Purchase/Memberships/Pro.php:106:                <span><a href="<?php echo site_url('Dashboard'); ?>" class="btn btn-success">Continue Free <em class="icon ni ni-arrow-right"></em></a></span>
app/Modules/User/Views/Wallets/Purchase/user_fields.php:202:            fetch('<?=site_url("/Wallets/MyMIGPayPalCallback")?>', {
app/Modules/User/Views/Wallets/Purchase/user_fields.php:207:                window.location.href = '<?=site_url("/Wallets/Purchase/MyMIGold/Complete")?>';
app/Modules/User/Views/Wallets/Generate_Wallet.php:81:            const result = await fetch("<?= site_url('User/Wallets/Wallet_Generator'); ?>", {
app/Modules/User/Views/Wallets/Complete_Purchase/paypal_checkout.php:34:        $url        = site_url('MyMI-Gold/Purchase-Complete/' . $orderID);
app/Modules/User/Views/Wallets/Complete_Purchase/Desktop.php:25:										<li class="breadcrumb-item"><a href="<?php echo site_url('/Dashboard'); ?>">Dashboard</a></li>
app/Modules/User/Views/Wallets/Complete_Purchase/Mobile.php:26:										<li class="breadcrumb-item"><a href="<?php echo site_url('/Invest'); ?>">Invest</a></li>
app/Modules/User/Views/Wallets/Add_Account/crypto_fields.php:1317:    <a href="<?= site_url('/Wallets') ?>" class="btn btn-secondary">Cancel</a>
app/Modules/User/Views/Wallets/Add_Account/investment_fields.php:1323:    <a href="<?= site_url('/Wallets') ?>" class="btn btn-secondary">Cancel</a>
app/Modules/User/Views/Wallets/Add_Account/credit_fields.php:110:    <a href="<?= site_url('/Wallets') ?>" class="btn btn-secondary">Cancel</a>
app/Modules/User/Views/Wallets/MyMI_Wallet/header.php:6:					<a class="back-to" href="<?php echo site_url('/Wallets'); ?>"><em class="icon ni ni-arrow-left"></em><span>My Wallets</span></a>
app/Modules/User/Views/Wallets/MyMI_Wallet/header.php:51:					<a href="<?php //echo site_url('/Edit-Wallet/' . $walletID);?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-setting"></em></a><span class="btn-extext">Settings</span>
app/Modules/User/Views/Wallets/MyMI_Wallet/header.php:67:					<a href="<?php echo site_url('/MyMI-Wallet'); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-plus"></em></a><span class="btn-extext">Purchase</span>
app/Modules/User/Views/Wallets/Add.php:39:    $redirectURL            = site_url('/Wallets');
app/Modules/User/Views/Wallets/Add.php:61:    $redirectURL            = site_url('/Wallets');
app/Modules/User/Views/Wallets/Add.php:81:    $redirectURL            = site_url('/Wallets');
app/Modules/User/Views/Wallets/Add.php:101:    $redirectURL            = site_url('/Wallets');
app/Modules/User/Views/Wallets/Add.php:121:    $redirectURL            = site_url('/Wallets');
app/Modules/User/Views/Wallets/Add.php:173:    <form class="form-horizontal" id="add_user_wallet" action="<?= site_url('Wallets/Add'); ?>" method="POST">
app/Modules/User/Views/Wallets/Add.php:202:                const response = await fetch("<?= site_url('Wallets/accountManager'); ?>", {
app/Modules/User/Views/Wallets/Add.php:217:                window.location.href = "<?= site_url('/Wallets'); ?>";
app/Modules/User/Views/Wallets/index-orig/financial_wallets/Wallet_Listing.php:7:				<a class="nk-wgw-name" href="' . site_url('/Bank-Account/Details/' . $accountID) . '">
app/Modules/User/Views/Wallets/index-orig/financial_wallets/Wallet_Listing.php:22:						<!-- <a href="' . site_url('Wallets/Add-Deposit/' . $accountID) . '"><i class="icon icon-arrow-up"></i> <span>Track Deposit</span></a> -->
app/Modules/User/Views/Wallets/index-orig/financial_wallets/Wallet_Listing.php:23:						<a href="' . site_url('/Bank-Account/Details/' . $accountID) . '"><i class="icon ni ni-list-index"></i> <span>View Details</span></a>
app/Modules/User/Views/Wallets/index-orig/financial_wallets/Wallet_Listing.php:26:                        <a href="' . site_url('/Bank-Account/Edit/' . $accountID) . '"><i class="icon ni ni-pen2"></i> <span>Edit</span></a>
app/Modules/User/Views/Wallets/index-orig/financial_wallets/Wallet_Listing.php:28:						<!-- <a href="' . site_url('Wallets/Add-Withdraw/' . $accountID) . '"><i class="icon icon-arrow-up"></i> <span>Track Withdraw</span></a> -->
app/Modules/User/Views/Wallets/index-orig/financial_wallets/Wallet_Listing.php:36:						<li><a href="' . site_url('/Bank-Account/Details/' . $accountID) . '">Details</a></li>   
app/Modules/User/Views/Wallets/index-orig/financial_wallets/MyMIWallet.php:7:				<a class="nk-wgw-name" href="' . site_url('/MyMI-Wallet') . '">
app/Modules/User/Views/Wallets/index-orig/financial_wallets/MyMIWallet.php:32:						<li><a href="' . site_url('/MyMI-Wallet') . '">Details</a></li>   
app/Modules/User/Views/Wallets/index-orig/crypto_wallets.php:14:						<a class="nk-wgw-name" href="' . site_url('/MyMI-Coin') . '">
app/Modules/User/Views/Wallets/index-orig/crypto_wallets.php:39:								<li><a href="' . site_url('/MyMI-Wallet') . '">Details</a></li>   
app/Modules/User/Views/Wallets/index-orig/crypto_wallets.php:54:						<a class="nk-wgw-name" href="' . site_url('/MyMI-Coin') . '">
app/Modules/User/Views/Wallets/index-orig/crypto_wallets.php:79:								<li><a href="' . site_url('/MyMI-Wallet') . '">Details</a></li>   
app/Modules/User/Views/Wallets/index-orig/fiat_wallets/Wallet_Listing.php:7:				<a class="nk-wgw-name" href="' . site_url('/Bank-Account/Details/' . $accountID) . '">
app/Modules/User/Views/Wallets/index-orig/fiat_wallets/Wallet_Listing.php:22:						<!-- <a href="' . site_url('Wallets/Add-Deposit/' . $accountID) . '"><i class="icon icon-arrow-up"></i> <span>Track Deposit</span></a> -->
app/Modules/User/Views/Wallets/index-orig/fiat_wallets/Wallet_Listing.php:23:						<a href="' . site_url('/Bank-Account/Details/' . $accountID) . '"><i class="icon icon-arrow-up"></i> <span>View Details</span></a>
app/Modules/User/Views/Wallets/index-orig/fiat_wallets/Wallet_Listing.php:27:						<!-- <a href="' . site_url('Wallets/Add-Withdraw/' . $accountID) . '"><i class="icon icon-arrow-up"></i> <span>Track Withdraw</span></a> -->
app/Modules/User/Views/Wallets/index-orig/fiat_wallets/Wallet_Listing.php:35:						<li><a href="' . site_url('/Bank-Account/Details/' . $accountID) . '">Details</a></li>   
app/Modules/User/Views/Wallets/index-orig/fiat_wallets/MyMIWallet.php:7:				<a class="nk-wgw-name" href="' . site_url('/MyMI-Wallet') . '">
app/Modules/User/Views/Wallets/index-orig/fiat_wallets/MyMIWallet.php:32:						<li><a href="' . site_url('/MyMI-Wallet') . '">Details</a></li>   
app/Modules/User/Views/Wallets/index-orig/crypto_wallets/Wallet_Listing.php:7:				<a class="nk-wgw-name" href="' . site_url('/Wallet-Details/' . $walletID) . '">
app/Modules/User/Views/Wallets/index-orig/crypto_wallets/Wallet_Listing.php:21:						<a href="' . site_url('/Add-Wallet-Deposit/' . $walletInfo['id']) . '"><i class="icon icon-arrow-up"></i> <span>Track Deposit</span></a>
app/Modules/User/Views/Wallets/index-orig/crypto_wallets/Wallet_Listing.php:24:						<a href="' . site_url('/Add-Wallet-Withdraw/' . $walletInfo['id']) . '"><em class="icon icon-arrow-down"></em><span>Track Withdraw</span></a>
app/Modules/User/Views/Wallets/index-orig/crypto_wallets/Wallet_Listing.php:32:						<li><a href="' . site_url('/Wallet-Details/' . $walletID) . '">Details</a></li>   
app/Modules/User/Views/Wallets/index-orig/crypto_wallets/Wallet_Listing.php:33:						<li><a href="' . site_url('/Edit-Wallet/' . $walletID) . '">Edit</a></li>
app/Modules/User/Views/Wallets/index-orig/crypto_wallets/MyMIGold.php:7:				<a class="nk-wgw-name" href="' . site_url('/MyMI-Wallet') . '">
app/Modules/User/Views/Wallets/index-orig/crypto_wallets/MyMIGold.php:32:						<li><a href="' . site_url('/MyMI-Wallet') . '">Details</a></li>   
app/Modules/User/Views/Wallets/Link_Account/Import-Trades.php:70:            const result = await fetch("<?= site_url('User/Wallets/Wallet_Manager'); ?>", {
app/Modules/User/Views/Wallets/Link_Account/Import-Trades.php:79:		    location.href = <?php echo '\'' . site_url('/Wallets/Link-Account/Confirm') . '\'';?>;
app/Modules/User/Views/Wallets/Link_Account/Confirm.php:172:                                                    <a class="btn btn-primary btn-sm text-white" href="' . site_url('Wallets/Link-Account/Details/' . $institute_id) . '">Manage</a>
app/Modules/User/Views/Wallets/Link_Account/Success.php:26:    'success_link'                              => site_url('/Wallets'),
app/Modules/User/Views/Wallets/Link_Account/Success.php:44:                        <a class="btn btn-primary btn-sm" href="' . site_url('Wallets') . '">My Wallets</a>
app/Modules/User/Views/Wallets/Link_Account/Success.php:64:                            <a class="btn btn-primary btn-md mt-3" href="' . site_url('Assets') . '">Visit</a>
app/Modules/User/Views/Wallets/Link_Account/Success.php:82:                            <a class="btn btn-primary btn-md mt-3" href="' . site_url('Exchange') . '">Visit</a>
app/Modules/User/Views/Wallets/Link_Account/Success.php:99:                            <a class="btn btn-primary btn-md mt-3" href="' . site_url('Asset-Creator') . '">Create Assets</a>
app/Modules/User/Views/Wallets/Link_Account/Success.php:117:                            <a class="btn btn-primary btn-md mt-3" href="' . site_url('/Exchange') . '">Visit Exchange</a>
app/Modules/User/Views/Wallets/Link_Account/Success.php:134:                            <a class="btn btn-primary btn-md mt-3" href="' . site_url('/Trade-Tracker') . '">Track Trades</a>
app/Modules/User/Views/Wallets/MyMI_Wallet.php:111:								<a href="<?php echo site_url('/Trade-Tracker/Search'); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-plus"></em></a><span class="btn-extext">Add Trade</span>
app/Modules/User/Views/Wallets/MyMI_Wallet.php:197:                                                    //~ <a class="mr-2" href="' . site_url($stockURL) . '" data-bs-toggle="tooltip" data-placement="bottom" title="View Chart Log"><i class="icon-chart"></i></a>
app/Modules/User/Views/Wallets/MyMI_Wallet.php:198:                                                    //~ <a class="mr-2" href="' . site_url('Trade-Tracker/Log/' . $symbol . '/' . $trade_id) . '" data-bs-toggle="tooltip" data-placement="bottom" title="View Trade Log"><i class="icon-notebook"></i></a>
app/Modules/User/Views/Wallets/MyMI_Wallet.php:200:                                                    //~ <a class="mr-2" href="' . site_url('Trade-Tracker/Update/' . $symbol . '/' . $trade_id) . '" data-bs-toggle="tooltip" data-placement="bottom" title="Update Trade Log"><i class="icon-note"></i></a>
app/Modules/User/Views/Wallets/MyMI_Wallet.php:202:                                                    //~ <a class="mr-2 text-danger" href="' . site_url('Trade-Tracker/Sell/' . $symbol . '/' . $trade_id) . '" data-bs-toggle="tooltip" data-placement="bottom" title="Record Position Sell"><i class="icon ni ni-tranx" style="font-size:1rem !important;"></i></a>
app/Modules/User/Views/Wallets/MyMI_Wallet.php:203:                                                    //~ <a class="mr-2 text-danger" href="' . site_url('Trade-Tracker/Close/' . $symbol . '/' . $trade_id) . '" data-bs-toggle="tooltip" data-placement="bottom" title="Close Trade Log"><i class="icon ni ni-wallet-out" style="font-size:1rem !important;"></i></a>
app/Modules/User/Views/Wallets/MyMI_Wallet.php:208:                                                    //~ <a class="mr-2" href="' . site_url($stockURL) . '" data-bs-toggle="tooltip" data-placement="bottom" title="View Chart Log"><i class="icon-chart"></i></a>
app/Modules/User/Views/Wallets/MyMI_Wallet.php:210:                                                    //~ <a class="mr-2" href="' . site_url('Trade-Tracker/Log/' . $symbol . '/' . $trade_id) . '" data-bs-toggle="tooltip" data-placement="bottom" title="View Trade Log"><i class="icon-notebook"></i></a>
app/Modules/User/Views/Wallets/MyMI_Wallet.php:241:								<a href="<?php echo site_url('/Trade-Tracker/Search'); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-plus"></em></a><span class="btn-extext">Add Trade</span>
app/Modules/User/Views/Wallets/MyMI_Wallet.php:315:                                                //~ <a class="mr-2" href="' . site_url($stockURL) . '" data-bs-toggle="tooltip" data-placement="bottom" title="View Chart Log"><i class="icon-chart"></i></a>
app/Modules/User/Views/Wallets/MyMI_Wallet.php:316:                                                //~ <a class="mr-2" href="' . site_url('Trade-Tracker/Log/' . $symbol . '/' . $trade_id) . '" data-bs-toggle="tooltip" data-placement="bottom" title="View Trade Log"><i class="icon-notebook"></i></a>
app/Modules/User/Views/Wallets/MyMI_Wallet.php:350:                //~ <a type="button" class="btn btn-primary" href="' . site_url('Trade-Tracker/Delete/' . $trade_id . '/' . $redirect_url) . '">Yes</a>
app/Modules/User/Views/Wallets/Coin_Swap.php:126:            fetch('<?=site_url("/Wallets/MyMIGPayPalCallback")?>', {
app/Modules/User/Views/Wallets/Coin_Swap.php:131:                window.location.href = '<?=site_url("/Wallets/Purchase/MyMIGold/Complete")?>';
app/Modules/User/Views/Wallets/Edit_Account.php:29:    $redirectURL                        = site_url('/Wallets');
app/Modules/User/Views/Wallets/Edit_Account.php:34:        // $redirectURL        = site_url('/Wallets');
app/Modules/User/Views/Wallets/Edit_Account.php:39:        // $redirectURL        = site_url('/Wallets');
app/Modules/User/Views/Wallets/Edit_Account.php:44:        // $redirectURL        = site_url('/Wallets');
app/Modules/User/Views/Wallets/Edit_Account.php:50:        // $redirectURL        = site_url('/Wallets');
app/Modules/User/Views/Wallets/Edit_Account.php:55:        // $redirectURL        = site_url('/Wallets');
app/Modules/User/Views/Wallets/Edit_Account.php:60:        // $redirectURL        = site_url('/Wallets');
app/Modules/User/Views/Wallets/Edit_Account.php:65:        // $redirectURL        = site_url('/Wallets');
app/Modules/User/Views/Wallets/Edit_Account.php:95:    $redirectURL                        = site_url('/Wallets');
app/Modules/User/Views/Wallets/Edit_Account.php:143:	<a type="button" class="close" href="<?php echo site_url('/Wallets'); ?>">
app/Modules/User/Views/Wallets/Edit_Account.php:216:            const result = await fetch("<?= site_url('User/Wallets/Wallet_Manager'); ?>", {
app/Modules/User/Views/Wallets/Add_Withdraw_Fetch.php:69:            const result = await fetch("<?= site_url('User/Wallets/Wallet_Transaction'); ?>", {
app/Modules/User/Views/Wallets/Add_Deposit_Fetch.php:71:            const result = await fetch("<?= site_url('User/Wallets/Wallet_Transaction'); ?>", {
app/Modules/User/Views/Wallets/Purchase_Complete/Desktop.php:25:										<li class="breadcrumb-item"><a href="<?php echo site_url('/Dashboard'); ?>">Dashboard</a></li>
app/Modules/User/Views/Wallets/Purchase_Complete/Mobile.php:25:										<li class="breadcrumb-item"><a href="<?php echo site_url('/Invest'); ?>">Invest</a></li>
app/Modules/User/Views/Wallets/Complete_Purchase.php:133:                                    <a class="btn btn-primary btn-sm" href="<?php echo site_url('/Support'); ?>">Contact Support</a>
app/Modules/User/Views/Wallets/Link_Account (Original)/Import-Trades.php:70:            const result = await fetch("<?= site_url('User/Wallets/Wallet_Manager'); ?>", {
app/Modules/User/Views/Wallets/Link_Account (Original)/Import-Trades.php:79:		    location.href = <?php echo '\'' . site_url('/Wallets/Link-Account/Confirm') . '\'';?>;
app/Modules/User/Views/Wallets/Link_Account (Original)/Confirm.php:69:                                            <a class="btn btn-primary btn-block" href="' . site_url('Wallets/Link-Account/Upload-Trades/' . $walletInfo['id']) . '">Approve</a>
app/Modules/User/Views/Wallets/Link_Account (Original)/Confirm.php:72:                                            <a class="btn btn-danger btn-block" href="' . site_url('Wallets/Link-Account/Delete/' . $walletInfo['id']) . '">Deny</a>
app/Modules/User/Views/Wallets/Link_Account (Original)/Confirm.php:79:                                            <a class="btn btn-primary btn-block" href="' . site_url('Wallets/Link-Account/Edit/' . $walletInfo['id']) . '">Edit</a>
app/Modules/User/Views/Wallets/Link_Account (Original)/Confirm.php:87:                                            <a class="btn btn-outline-danger btn-block statusRed" href="' . site_url('Wallets/Link-Account/Delete/' . $walletInfo['id']) . '">Remove</a>
app/Modules/User/Views/Wallets/Link_Account (Original)/Success.php:59:    'success_link'                              => site_url('/Wallets'),
app/Modules/User/Views/Wallets/Link_Account (Original)/Success.php:77:                        <a class="btn btn-primary btn-sm" href="' . site_url('Wallets') . '">My Wallets</a>
app/Modules/User/Views/Wallets/Link_Account (Original)/Success.php:97:                            <a class="btn btn-primary btn-md mt-3" href="' . site_url('Assets') . '">Visit</a>
app/Modules/User/Views/Wallets/Link_Account (Original)/Success.php:115:                            <a class="btn btn-primary btn-md mt-3" href="' . site_url('Exchange') . '">Visit</a>
app/Modules/User/Views/Wallets/Link_Account (Original)/Success.php:132:                            <a class="btn btn-primary btn-md mt-3" href="' . site_url('Asset-Creator') . '">Create Assets</a>
app/Modules/User/Views/Wallets/Link_Account (Original)/Success.php:150:                            <a class="btn btn-primary btn-md mt-3" href="' . site_url('/Exchange') . '">Visit Exchange</a>
app/Modules/User/Views/Wallets/Link_Account (Original)/Success.php:167:                            <a class="btn btn-primary btn-md mt-3" href="' . site_url('/Trade-Tracker') . '">Track Trades</a>
app/Modules/User/Views/Wallets/index.php:25:  ['label'=>'Checking',   'cat'=>'financial',  'href'=>site_url('Wallets/Checking')],
app/Modules/User/Views/Wallets/index.php:26:  ['label'=>'Credit',     'cat'=>'credit',     'href'=>site_url('Wallets/Credit')],
app/Modules/User/Views/Wallets/index.php:27:  ['label'=>'Crypto',     'cat'=>'crypto',     'href'=>site_url('Wallets/Crypto')],
app/Modules/User/Views/Wallets/index.php:28:  ['label'=>'Debt',       'cat'=>'debt',       'href'=>site_url('Wallets/Debt')],
app/Modules/User/Views/Wallets/index.php:29:  ['label'=>'Investments','cat'=>'investment', 'href'=>site_url('Wallets/Investments')],
app/Modules/User/Views/Wallets/Purchase_Gold.php:81:            const result = await fetch("<?= site_url('User/Wallets/Purchase_Coins_Transaction'); ?>", {
app/Modules/User/Views/Wallets/Purchase_Gold.php:90:		    location.href = <?php echo '\'' . site_url('/MyMI-Gold/Complete-Purchase') . '\'';?>;
app/Modules/User/Views/Wallets/orig_Wallet_Selection.php:110:            const result = await fetch("<?= site_url('User/Wallets/Wallet_Manager'); ?>", {
app/Modules/User/Views/Wallets/orig_Wallet_Selection.php:121:			// 	url: <?php //echo '\'' . site_url('Add-Wallet/Fiat') . '\'';?>,
app/Modules/User/Views/Wallets/Generate_Wallet/user_fields.php:66:			url: <?php echo '\'' . site_url('Wallets/Address-Generator') . '\''; ?>,
app/Modules/User/Views/Wallets/Generate_Wallet/user_fields.php:80:        // console.log(<?php echo '\'' . site_url('Wallets/Address-Generator') . '\''; ?>);
app/Modules/User/Views/Wallets/Add/form.php:57:            const result = await fetch("<?= site_url('User/Wallets/Wallet_Manager'); ?>", {
app/Modules/User/Views/Wallets/Add/form.php:66:		    location.href = <?php echo '\'' . site_url('/Wallets/Link-Account/Confirm') . '\'';?>;
app/Modules/User/Views/Wallets/Purchase_Complete.php:96:                                        <a class="btn btn-primary btn-sm" href="<?php echo site_url('/Support'); ?>">Contact Support</a>
app/Modules/User/Views/Wallets/Purchase_Complete.php:137:            url: <?php echo '\'' . site_url($redirect_url) . '\''; ?>,
app/Modules/User/Views/Wallets/Add_Fiat_Wallet.php:78:                const result = await fetch("<?= site_url('User/Wallets/Wallet_Manager'); ?>", {			
app/Modules/User/Views/Wallets/Add_Fiat_Wallet.php:86:                const result = await fetch("<?= site_url('User/Wallets/Purchase_Coins_Transaction'); ?>", {			
app/Modules/User/Views/Wallets/Add_Fiat_Wallet.php:95:		    location.href = <?php echo '\'' . site_url('Wallets/Link-Account/Confirm') . '\'';?>;
app/Modules/User/Views/Wallets/Add_Fiat_Wallet.php:123://             const result = await fetch("<?php //site_url('User/Wallets/Wallet_Manager');?>", {
app/Modules/User/Views/Wallets/Add_Fiat_Wallet.php:135:// 			// 	url: <?php //echo '\'' . site_url('Add-Wallet/Fiat') . '\'';?>,
app/Modules/User/Views/Wallets/Add_Account.php:48:    $redirectURL                    = site_url('/Wallets');
app/Modules/User/Views/Wallets/Add_Account.php:52:        // $redirectURL        = site_url('/Wallets');
app/Modules/User/Views/Wallets/Add_Account.php:57:        // $redirectURL        = site_url('/Wallets');
app/Modules/User/Views/Wallets/Add_Account.php:62:        // $redirectURL        = site_url('/Wallets');
app/Modules/User/Views/Wallets/Add_Account.php:67:        // $redirectURL        = site_url('/Wallets');
app/Modules/User/Views/Wallets/Add_Account.php:72:        // $redirectURL        = site_url('/Wallets');
app/Modules/User/Views/Wallets/Add_Account.php:76:        // $redirectURL        = site_url('/Wallets');
app/Modules/User/Views/Wallets/Add_Account.php:83:    $redirectURL                    = site_url('/Wallets');
app/Modules/User/Views/Wallets/Add_Account.php:215:            const result = await fetch("<?= site_url('User/Wallets/Wallet_Manager'); ?>", {
app/Modules/User/Views/Wallets/Details.orig.php:98:									<a href="<?php echo site_url('/Exchange/Market/' . $wallet_market_pair . '/' . $wallet_market); ?>" class="btn btn-primary"><span>Trade <?= $wallet_market; ?></span> <em class="icon icon-arrow-right"></em></a>
app/Modules/User/Views/Wallets/Details.orig.php:134:											<a href="<?php echo site_url('/Edit-Wallet/' . $walletID); ?>">Edit Wallet</a>
app/Modules/User/Views/Wallets/Details.orig.php:156:								<a href="<?php echo site_url('/Add-Wallet-Deposit/' . $walletID); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-plus"></em></a><span class="btn-extext">Deposit Funds</span>
app/Modules/User/Views/Wallets/Details.orig.php:159:								<a href="<?php echo site_url('/Add-Wallet-Withdraw/' . $walletID); ?>" class="btn btn-icon btn-xl btn-primary"><em class="icon ni ni-arrow-to-right"></em></a><span class="btn-extext">Withdraw Funds</span>
app/Modules/User/Views/Wallets/Details.orig.php:371:																	<td class="text-center"><a href="' . site_url($stockURL) . '">' . $stock . '</a></td>
app/Modules/User/Views/Wallets/Details.orig.php:378:																		<a class="mr-2" href="' . site_url('Trade-Tracker/Log/' . $stock . '/' . $tradeID) . '" data-bs-toggle="tooltip" data-placement="bottom" title="View Trade Log"><i class="icon-notebook"></i></a>
app/Modules/User/Views/Wallets/Details.orig.php:380:																		<a class="mr-2" href="' . site_url('Trade-Tracker/Update/' . $stock . '/' . $tradeID) . '" data-bs-toggle="tooltip" data-placement="bottom" title="Update Trade Log"><i class="icon-note"></i></a>
app/Modules/User/Views/Wallets/Details.orig.php:382:																		<a class="mr-2 text-danger" href="' . site_url('Trade-Tracker/Close/' . $stock . '/' . $tradeID) . '" data-bs-toggle="tooltip" data-placement="bottom" title="Close Trade Log"><i class="icon ni ni-wallet-out" style="font-size:1rem !important;"></i></a>
app/Modules/User/Views/Wallets/Details.orig.php:526:																	<td class="text-center"><a href="' . site_url($stockURL) . '">' . $stock . '</a></td>
app/Modules/User/Views/Wallets/Details.orig.php:533:																		<a class="mr-2" href="' . site_url('Trade-Tracker/Log/' . $stock . '/' . $tradeID) . '" data-bs-toggle="tooltip" data-placement="bottom" title="View Trade Log"><i class="icon-notebook"></i></a>
app/Modules/User/Views/Wallets/Details.orig.php:535:																		<a class="mr-2" href="' . site_url('Trade-Tracker/Update/' . $stock . '/' . $tradeID) . '" data-bs-toggle="tooltip" data-placement="bottom" title="Update Trade Log"><i class="icon-note"></i></a>
app/Modules/User/Views/Wallets/Details.orig.php:537:																		<a class="mr-2 text-danger" href="' . site_url('Trade-Tracker/Close/' . $stock . '/' . $tradeID) . '" data-bs-toggle="tooltip" data-placement="bottom" title="Close Trade Log"><i class="icon ni ni-wallet-out" style="font-size:1rem !important;"></i></a>
app/Modules/User/Views/Wallets/Details.orig.php:579:				<a type="button" class="btn btn-primary" href="' . site_url('Trade-Tracker/Delete/' . $trade_id . '/' . $redirect_url) . '">Yes</a>
app/Modules/User/Views/Wallets/Details.orig.php:671:				<a type="button" class="btn btn-success" href="' . site_url('Delete-Wallet/' . $walletID) . '">Yes</a>
app/Modules/User/Views/Wallets/Wallet_Selection.php:31:// $accountWallet                          = site_url('Wallets/Accounting/Add/Account');
app/Modules/User/Views/Wallets/Wallet_Selection.php:32:$bankingWallet                          = site_url('Wallets/Banking/Add/Account');
app/Modules/User/Views/Wallets/Wallet_Selection.php:33:// $ecommerceWallet                        = site_url('Wallets/eCommerce/Add/Account');
app/Modules/User/Views/Wallets/Wallet_Selection.php:34:$investmentWallet                       = site_url('Wallets/Investment/Add/Account');
app/Modules/User/Views/Wallets/Details/bank_accounts.php:50:								<a href="<?php echo site_url('/Add-Wallet-Deposit/' . $accountID); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-plus"></em></a><span class="btn-extext">Deposit Funds</span>
app/Modules/User/Views/Wallets/Details/bank_accounts.php:53:								<a href="<?php echo site_url('/Add-Wallet-Deposit/' . $accountID); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-plus"></em></a><span class="btn-extext">Transfer Funds</span>
app/Modules/User/Views/Wallets/Details/bank_accounts.php:56:								<a href="<?php echo site_url('/Add-Wallet-Withdraw/' . $accountID); ?>" class="btn btn-icon btn-xl btn-primary"><em class="icon ni ni-arrow-to-right"></em></a><span class="btn-extext">Withdraw Funds</span>
app/Modules/User/Views/Wallets/Details/bank_accounts.php:190:                    <a type="button" class="btn btn-success" href="' . site_url('Delete-Wallet/' . $accountID) . '">Yes</a>
app/Modules/User/Views/Wallets/Details/bank_accounts.php:215:// 				<a type="button" class="btn btn-primary" href="' . site_url('Trade-Tracker/Delete/' . $trade_id . '/' . $redirect_url) . '">Yes</a>
app/Modules/User/Views/Wallets/Details/bank_accounts.php:307:// 				<a type="button" class="btn btn-success" href="' . site_url('Delete-Wallet/' . $accountID) . '">Yes</a>
app/Modules/User/Views/Wallets/Details/wallets.php:25:									<a href="<?php echo site_url('/Exchange/Market/' . $walletMarketPair . '/' . $walletMarket); ?>" class="btn btn-primary"><span>Trade <?= $walletMarket; ?></span> <em class="icon icon-arrow-right"></em></a>
app/Modules/User/Views/Wallets/Details/wallets.php:64:                                                    <a href="' . site_url('/Wallet/Edit/' . $walletID) . '">Edit</a>
app/Modules/User/Views/Wallets/Details/wallets.php:95:								<a href="<?php echo site_url('/Wallets/Track-Deposit/' . $walletID); ?>" class="btn btn-icon btn-lg btn-dark"><em class="icon ni ni-plus"></em></a><span class="btn-extext">Deposit</span>
app/Modules/User/Views/Wallets/Details/wallets.php:98:								<a href="<?php echo site_url('/Wallets/Track-Withdraw/' . $walletID); ?>" class="btn btn-icon btn-lg btn-primary"><em class="icon ni ni-arrow-to-right"></em></a><span class="btn-extext">Withdraw</span>
app/Modules/User/Views/Wallets/Details/wallets.php:282:                                                        <a class="mr-2" href="' . site_url('Trade-Tracker/Log/' . $symbol . '/' . $tradeID) . '" data-bs-toggle="tooltip" data-placement="bottom" title="View Trade Log"><i class="icon-notebook"></i></a>
app/Modules/User/Views/Wallets/Details/wallets.php:284:                                                        <a class="mr-2" href="' . site_url('Trade-Tracker/Update/' . $symbol . '/' . $tradeID) . '" data-bs-toggle="tooltip" data-placement="bottom" title="Update Trade Log"><i class="icon-note"></i></a>
app/Modules/User/Views/Wallets/Details/wallets.php:286:                                                        <a class="mr-2 text-danger" href="' . site_url('Trade-Tracker/Close/' . $symbol . '/' . $tradeID) . '" data-bs-toggle="tooltip" data-placement="bottom" title="Close Trade Log"><i class="icon ni ni-wallet-out" style="font-size:1rem !important;"></i></a>
app/Modules/User/Views/Wallets/Details/Balance.php:26:                                    <a href="<?php echo site_url('/Edit-Wallet/' . $walletID); ?>">Edit Wallet</a>
app/Modules/User/Views/Wallets/Details/Balance.php:48:                        <a href="<?php echo site_url('/Add-Wallet-Deposit/' . $walletID); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-plus"></em></a><span class="btn-extext">Deposit Funds</span>
app/Modules/User/Views/Wallets/Details/Balance.php:51:                        <a href="<?php echo site_url('/Add-Wallet-Withdraw/' . $walletID); ?>" class="btn btn-icon btn-xl btn-primary"><em class="icon ni ni-arrow-to-right"></em></a><span class="btn-extext">Withdraw Funds</span>
app/Modules/User/Views/Wallets/Details/credit_accounts.php:55:                                <a href="<?php echo site_url('/Add-Credit-Payment/' . $accountID); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-cc-alt2"></em></a><span class="btn-extext">Make Payment</span>
app/Modules/User/Views/Wallets/Details/credit_accounts.php:58:                                <a href="<?php echo site_url('/Credit-Card-Statement/' . $accountID); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-books"></em></a><span class="btn-extext">View Statement</span>
app/Modules/User/Views/Wallets/Details/credit_accounts.php:61:                                <a href="<?php echo site_url('/Report-Lost-Card/' . $accountID); ?>" class="btn btn-icon btn-xl btn-primary"><em class="icon ni ni-alert-circle"></em></a><span class="btn-extext">Report Lost/Stolen Card</span>
app/Modules/User/Views/Wallets/Details/credit_accounts.php:82:                                        <a href="<?php echo site_url('/Credit-Transaction-History/' . $accountID); ?>" class="link">View All</a>
app/Modules/User/Views/Wallets/Details/Title.php:26:                            <a href="<?php //echo site_url('/Exchange/Market/' . $wallet_market_pair . '/' . $wallet_market); ?>" class="btn btn-primary"><span>Trade <?= $wallet_market; ?></span> <em class="icon icon-arrow-right"></em></a>
app/Modules/User/Views/Wallets/Details/investment_accounts.php:52:                                <a href="<?php echo site_url('/Add-Investment/' . $accountID); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-plus"></em></a><span class="btn-extext">Add Investment</span>
app/Modules/User/Views/Wallets/Details/investment_accounts.php:55:                                <a href="<?php echo site_url('/Investment-History/' . $accountID); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-repeat"></em></a><span class="btn-extext">Investment History</span>
app/Modules/User/Views/Wallets/Details/investment_accounts.php:58:                                <a href="<?php echo site_url('/Sell-Investment/' . $accountID); ?>" class="btn btn-icon btn-xl btn-primary"><em class="icon ni ni-arrow-to-right"></em></a><span class="btn-extext">Sell Investment</span>
app/Modules/User/Views/Wallets/Details/debt_accounts.php:52:                                <a href="<?php echo site_url('/Make-Debt-Payment/' . $accountID); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-wallet-out"></em></a><span class="btn-extext">Make Payment</span>
app/Modules/User/Views/Wallets/Details/debt_accounts.php:55:                                <a href="<?php echo site_url('/Debt-Payment-History/' . $accountID); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-repeat"></em></a><span class="btn-extext">Payment History</span>
app/Modules/User/Views/Wallets/Details/debt_accounts.php:58:                                <a href="<?php echo site_url('/Negotiate-Debt/' . $accountID); ?>" class="btn btn-icon btn-xl btn-primary"><em class="icon ni ni-talk"></em></a><span class="btn-extext">Negotiate Debt</span>
app/Modules/User/Views/Wallets/index copy.php:174:    'redirect_uri'              => site_url('/Content-Creator'),
app/Modules/User/Views/Wallets/index copy.php:324:                const response = await fetch("<?php echo site_url('Accounts/get_transactions'); ?>");
app/Modules/User/Views/Wallets/index copy.php:335:                const response = await fetch("<?php echo site_url('Accounts/createLinkToken'); ?>");
app/Modules/User/Views/Wallets/index copy.php:359:                            const response = await fetch("<?php echo site_url('Accounts/exchangeToken'); ?>", {
app/Modules/User/Views/Wallets/Edit_Account/ecommerce_fields.php:2179:				<a class="btn btn-secondary btn-block" href="<?php echo site_url('/Wallets'); ?>">Cancel</a>
app/Modules/User/Views/Wallets/Edit_Account/accounting_fields.php:2152:				<a class="btn btn-secondary btn-block" href="<?php echo site_url('/Wallets'); ?>">Cancel</a>
app/Modules/User/Views/Wallets/Edit_Account/banking_fields.php:74:    <a href="<?= site_url('/Wallets') ?>" class="btn btn-secondary">Cancel</a>
app/Modules/User/Views/Wallets/Edit_Account/transaction_history.php:37:                                        $accountPaidStatus          = '<a href="' . site_url('Budget/Status/Paid/' . $transaction['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Wallets/Edit_Account/transaction_history.php:39:                                        $accountPaidStatus          = '<a class="statusGreen" href="' . site_url('Budget/Status/Unpaid/' . $transaction['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Wallets/Edit_Account/transaction_history.php:57:                                            <a href="' . site_url('Budget/Edit/' . $transaction['id']) . '"><i class="icon  myfs-md ni ni-edit"></i></a>
app/Modules/User/Views/Wallets/Edit_Account/transaction_history.php:58:                                            <a class="text-red" href="' . site_url('Budget/Delete-Account/' . $transaction['id']) . '"><i class="icon myfs-md ni ni-cross-circle"></i></a>
app/Modules/User/Views/Wallets/Edit_Account/transaction_history.php:84:                <a class="btn btn-primary btn-sm" href="<?php echo site_url('/Support'); ?>"><i class="icon ni ni-envelope"></i>Contact Support</a>
app/Modules/User/Views/Wallets/Edit_Account/investment_fields.php:73:                <a class="btn btn-secondary btn-block" href="<?= site_url('/wallets') ?>">Cancel</a>
app/Modules/User/Views/Wallets/Edit_Account/debt_fields.php:90:    <a href="<?= site_url('/Wallets') ?>" class="btn btn-secondary">Cancel</a>
app/Modules/User/Views/Wallets/Edit_Account/credit_fields.php:86:    <a href="<?= site_url('/Wallets') ?>" class="btn btn-secondary">Cancel</a>
app/Modules/User/Views/Wallets/index/financial_wallets/Wallet_Listing.php:8:				<a class="nk-wgw-name" href="' . site_url('Wallets/Banking/Details/' . $accountID) . '">
app/Modules/User/Views/Wallets/index/financial_wallets/Wallet_Listing.php:22:						<a href="' . site_url('Wallets/Banking/Details/' . $accountID) . '"><i class="icon ni ni-list-index mr-1"></i> <span>Details</span></a>
app/Modules/User/Views/Wallets/index/financial_wallets/Wallet_Listing.php:38:						<li><a href="' . site_url('Wallets/Banking/Details/' . $accountID) . '">Details</a></li>   
app/Modules/User/Views/Wallets/index/financial_wallets/Wallet_Listing.php:39:						<li><a href="' . site_url('/Wallets/Banking/Edit/Account/' . $accountID) . '">Edit</a></li>
app/Modules/User/Views/Wallets/index/financial_wallets/MyMIWallet.php:7:				<a class="nk-wgw-name" href="' . site_url('/MyMI-Wallet') . '">
app/Modules/User/Views/Wallets/index/financial_wallets/MyMIWallet.php:32:						<li><a href="' . site_url('/MyMI-Wallet') . '">Details</a></li>   
app/Modules/User/Views/Wallets/index/debt_wallets.php:5:            <a href="<?php echo site_url('/Wallets/Debt'); ?>"><small>View All</small></a>
app/Modules/User/Views/Wallets/index/crypto_wallets.php:5:            <a href="<?php echo site_url('/Wallets/Crypto'); ?>"><small>View All</small></a>
app/Modules/User/Views/Wallets/index/investment_wallets/Wallet_Listing.php:7:				<a class="nk-wgw-name" href="' . site_url('Wallets/Investment/Details/' . $accountID) . '">
app/Modules/User/Views/Wallets/index/investment_wallets/Wallet_Listing.php:21:						<a href="' . site_url('Wallets/Investment/Details/' . $accountID) . '">
app/Modules/User/Views/Wallets/index/investment_wallets/Wallet_Listing.php:50:                            <a href="' . site_url('Wallets/Investment/Details/' . $accountID) . '">Details</a>
app/Modules/User/Views/Wallets/index/investment_wallets/Wallet_Listing.php:53:                            <a href="' . site_url('/Wallets/Investment/Edit/Account/' . $accountID) . '">Edit</a>
app/Modules/User/Views/Wallets/index/investment_wallets/MyMIWallet.php:7:				<a class="nk-wgw-name" href="' . site_url('/MyMI-Wallet') . '">
app/Modules/User/Views/Wallets/index/investment_wallets/MyMIWallet.php:34:						<li><a href="' . site_url('/MyMI-Wallet') . '">Details</a></li>   
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:52:                    <a class="badge badge-xs badge-dim rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a><br>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:64:                <td><a class="badge badge-sm badge-dim rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a></td>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:71:                    <a class="badge badge-sm badge-dim rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:90:                <td><a class="badge badge-xs badge-dim rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:101:                <td><a class="badge badge-sm badge-dim rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:108:                    <a class="badge badge-sm badge-dim rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:133:        //         <td><a class="badge badge-xs badge-dim rounded-pill bg-success text-white px-4" href="' . site_url('/Wallets') . '">Investments</a></td>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:144:        //         <td><a class="badge badge-sm badge-dim rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Investments</a></td>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:150:        //         <a class="badge badge-sm badge-dim rounded-pill bg-success text-white" href="' . site_url('Wallets') . '">Add</a>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:151:        //         <a class="badge badge-sm badge-dim rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:167:                $accountPaidStatus          = '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:170:                $accountPaidStatus          = '<a class="statusGreen" href="' . site_url('Budget/Status/Unpaid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:189:                    <td><a href="' . site_url('Budget/Details/' . $account['id']) . '">' . $accountNameDisplay . '</a></td>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:199:                    <td><a href="' . site_url('Budget/Details/' . $account['id']) . '">' . $account['name'] . '</a></td>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:207:                                    //         <a href="' . site_url('Wallets/' . $account['account_type'] . '/Details/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:211:                                            <a href="' . site_url('Wallets/' . $account['account_type'] . '/Details/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:228:                                            //     <li><a href="' . site_url('Wallets/Attach-Account/' . $account['account_type'] . '/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a></li>    
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:232:                                            <li><a href="' . site_url('Wallets/Attach-Account/' . $account['account_type'] . '/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a></li>    
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:245:                                            //     <li><a href="' . site_url('Wallets/Attach-Account/' . $account['account_type'] . '/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a></li>    
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:249:                                                <li><a href="' . site_url('Wallets/Attach-Account/' . $account['account_type'] . '/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a></li>    
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:254:                                        <li><a href="' . site_url('Wallets') . '"><span><em class="icon icon-xs ni ni-plus"></em> Create Wallet</span></a></li>    
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:265:                        <a href="' . site_url('Budget/Edit/' . $account['id']) . '"><i class="icon  myfs-md ni ni-edit"></i></a>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:266:                        <a href="' . site_url('Budget/Copy/' . $account['id']) . '"><i class="icon  myfs-md ni ni-copy"></i></a>
app/Modules/User/Views/Wallets/index/debt_summary/active_table.php:267:                        <a class="text-red" href="' . site_url('Budget/Delete-Account/' . $account['id']) . '"><i class="icon myfs-md ni ni-trash"></i></a>
app/Modules/User/Views/Wallets/index/investment_wallets.php:4:        <a href="<?php echo site_url('/Wallets/Investments'); ?>"><small>View All</small></a>
app/Modules/User/Views/Wallets/index/header.php:29:                    echo '<a class="btn btn-primary text-white" href="' . site_url('/Wallets') . '">View All Wallets</a>';
app/Modules/User/Views/Wallets/index/debt_wallets/Wallet_Listing.php:7:				<a class="nk-wgw-name" href="' . site_url('Wallets/Debt/Details/' . $accountID) . '">
app/Modules/User/Views/Wallets/index/debt_wallets/Wallet_Listing.php:21:						<a href="' . site_url('Wallets/Debt/Details/' . $accountID) . '"><i class="icon ni ni-list-index mr-1"></i> <span>Details</span></a>
app/Modules/User/Views/Wallets/index/debt_wallets/Wallet_Listing.php:39:                    <a class="dropdown-item" href="' . site_url('/Budget/Details/' . $accountID) . '">Details</a>
app/Modules/User/Views/Wallets/index/debt_wallets/Wallet_Listing.php:40:                    <a class="dropdown-item" href="' . site_url('/Budget/Edit/' . $accountID) . '">Edit</a>
app/Modules/User/Views/Wallets/index/debt_wallets/Wallet_Listing.php:41:                    <a class="dropdown-item" href="' . site_url('/Budget/Delete-Account/' . $accountID) . '">Delete</a>
app/Modules/User/Views/Wallets/index/debt_wallets/MyMIWallet.php:7:				<a class="nk-wgw-name" href="' . site_url('/MyMI-Wallet') . '">
app/Modules/User/Views/Wallets/index/debt_wallets/MyMIWallet.php:32:						<li><a href="' . site_url('/MyMI-Wallet') . '">Details</a></li>   
app/Modules/User/Views/Wallets/index/fiat_wallets/Wallet_Listing.php:8:				<a class="nk-wgw-name" href="' . site_url('Wallets/Banking/Details/' . $walletID) . '">
app/Modules/User/Views/Wallets/index/fiat_wallets/Wallet_Listing.php:22:						<a href="' . site_url('/Wallets/Banking/Details/' . $walletID) . '">
app/Modules/User/Views/Wallets/index/fiat_wallets/Wallet_Listing.php:27:                        <a href="' . site_url('Wallets/Banking/Edit/Account/' . $walletID) . '">
app/Modules/User/Views/Wallets/index/fiat_wallets/Wallet_Listing.php:51:                            <a href="' . site_url('/Wallets/Banking/Details/' . $walletID) . '">Details</a>
app/Modules/User/Views/Wallets/index/fiat_wallets/Wallet_Listing.php:54:                            <a href="' . site_url('/Wallets/Banking/Edit/Account/' . $walletID) . '">Edit</a>
app/Modules/User/Views/Wallets/index/fiat_wallets/MyMIWallet.php:7:				<a class="nk-wgw-name" href="' . site_url('/MyMI-Wallet') . '">
app/Modules/User/Views/Wallets/index/fiat_wallets/MyMIWallet.php:21:                        <a href="' . site_url('/MyMI-Wallet') . '"><em class="icon ni ni-menu"></em><span>Details</span></a>
app/Modules/User/Views/Wallets/index/fiat_wallets/MyMIWallet.php:35:						<li><a href="' . site_url('/MyMI-Wallet') . '">Details</a></li>   
app/Modules/User/Views/Wallets/index/fiat_wallets/Wallet_Listing-02242024.php:7:				<a class="nk-wgw-name" href="' . site_url('Wallets/Investment/Details/' . $walletID) . '">
app/Modules/User/Views/Wallets/index/fiat_wallets/Wallet_Listing-02242024.php:21:						<a href="' . site_url('/Wallets/Investment/Details' . $accountID) . '"><i class="icon ni ni-list-index"></i> <span>Details</span></a>
app/Modules/User/Views/Wallets/index/fiat_wallets/Wallet_Listing-02242024.php:24:                        <a href="' . site_url('Wallets/Investment/Edit/Account/' . $accountID) . '"><i class="icon ni ni-pen2"></i> <span>Edit</span></a>
app/Modules/User/Views/Wallets/index/fiat_wallets/Wallet_Listing-02242024.php:35:						<li><a href="' . site_url('/Wallets/Investment/Details' . $walletID) . '">Details</a></li>   
app/Modules/User/Views/Wallets/index/fiat_wallets/Wallet_Listing-02242024.php:36:						<li><a href="' . site_url('/Wallets/Investment/Edit/Account/' . $walletID) . '">Edit</a></li>
app/Modules/User/Views/Wallets/index/financial_wallets.php:5:            <a href="<?php echo site_url('/Wallets/Banking'); ?>"><small>View All</small></a>
app/Modules/User/Views/Wallets/index/crypto_wallets/Wallet_Listing.php:8:				<a class="nk-wgw-name" href="' . site_url('Wallets/Crypto/Details/' . $accountID) . '">
app/Modules/User/Views/Wallets/index/crypto_wallets/Wallet_Listing.php:22:						<a href="' . site_url('Wallets/Investment/Details/' . $accountID) . '"><i class="icon ni ni-list-index"></i> <span>Details</span></a>
app/Modules/User/Views/Wallets/index/crypto_wallets/Wallet_Listing.php:25:                        <a href="' . site_url('Wallets/Investment/Edit/Account/' . $accountID) . '"><i class="icon ni ni-pen2"></i> <span>Edit</span></a>
app/Modules/User/Views/Wallets/index/crypto_wallets/Wallet_Listing.php:38:						<li><a href="' . site_url('/Wallets/Investment/Details/' . $accountID) . '">Details</a></li>   
app/Modules/User/Views/Wallets/index/crypto_wallets/Wallet_Listing.php:39:						<li><a href="' . site_url('/Wallets/Investment/Edit/Account/' . $accountID) . '">Edit</a></li>
app/Modules/User/Views/Wallets/index/crypto_wallets/MyMIGold.php:7:				<a class="nk-wgw-name" href="' . site_url('/MyMI-Wallet') . '">
app/Modules/User/Views/Wallets/index/crypto_wallets/MyMIGold.php:22:						<a href="' . site_url('Wallets/Crypto/Details/' . $accountID) . '"><i class="icon ni ni-list-index mr-1"></i> <span>Details</span></a>
app/Modules/User/Views/Wallets/index/crypto_wallets/MyMIGold.php:38:                        <li><a href="' . site_url('Wallets/Crypto/Details/' . $accountID) . '">Details</a></li>   
app/Modules/User/Views/Wallets/index/crypto_wallets/MyMIGold.php:39:                        <li><a href="' . site_url('/Wallets/Crypto/Edit/Account/' . $walletID) . '">Edit</a></li>
app/Modules/User/Views/Wallets/index/credit_wallets/Wallet_Listing.php:8:                <a class="nk-wgw-name" href="' . site_url('Wallets/Credit/Details/' . $accountID) . '">
app/Modules/User/Views/Wallets/index/credit_wallets/Wallet_Listing.php:31:                        <a href="' . site_url('Wallets/Credit/Details/' . $accountID) . '">
app/Modules/User/Views/Wallets/index/credit_wallets/Wallet_Listing.php:60:                            <a href="' . site_url('Wallets/Credit/Details/' . $accountID) . '">Details</a>
app/Modules/User/Views/Wallets/index/credit_wallets/MyMIWallet.php:7:				<a class="nk-wgw-name" href="' . site_url('/MyMI-Wallet') . '">
app/Modules/User/Views/Wallets/index/credit_wallets/MyMIWallet.php:32:						<li><a href="' . site_url('/MyMI-Wallet') . '">Details</a></li>   
app/Modules/User/Views/Wallets/index/credit_wallets.php:8:            <a href="<?= site_url('/Wallets/Credit'); ?>"><small>View All</small></a>
app/Modules/User/Views/Wallets/Edit.php:33:$redirectURL   = $redirectURL   ?? site_url('/Wallets');
app/Modules/User/Views/Wallets/Edit.php:176:$formAction = $formAction ?? site_url("Wallets/Edit/{$finalFieldData['accountType']}/{$finalFieldData['accountID']}");
app/Modules/User/Views/Wallets/MyMI_Gold/order_form.php:71:            const result = await fetch("<?= site_url('User/Wallets/Purchase_Coins_Transaction'); ?>", {
app/Modules/User/Views/Wallets/MyMI_Gold/order_form.php:80:		    location.href = <?php echo '\'' . site_url('/MyMI-Gold/Complete-Purchase') . '\'';?>;
app/Modules/User/Views/Support/Communication_Manager.php:10:    //     header('Location: ' . site_url('/Customer-Support'));
app/Modules/User/Views/Support/Feedback.php:68:            const result = await fetch("<?= site_url('User/Support/Communication_Manager'); ?>", {
app/Modules/User/Views/Support/Feedback.php:77:		    location.href = <?php echo '\'' . site_url('/Wallets/Link-Account/Confirm') . '\'';?>;
app/Modules/User/Views/Support/Request.php:71:            const response = await fetch("<?php echo site_url('Support/Manager'); ?>", {
app/Modules/User/Views/Support/Request.php:85:                    location.href = "<?php echo site_url('/Support'); ?>";
app/Modules/User/Views/Institutes/index.php:36:                                        <a href="<?= site_url('/Institutes/view/' . $institute['id']) ?>">View</a> |
app/Modules/User/Views/Institutes/index.php:37:                                        <a href="<?= site_url('/Institutes/edit/' . $institute['id']) ?>">Edit</a> |
app/Modules/User/Views/Institutes/index.php:38:                                        <a href="<?= site_url('/Institutes/delete/' . $institute['id']) ?>" onclick='return confirm("Are you sure?")'>Delete</a>
app/Modules/User/Views/Projects/management/project_control.php:8:        <form action="<?= site_url('Management/Projects/UpdateStatus/' . $project['id']); ?>" method="post">
app/Modules/User/Views/Projects/Add.php:13:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/Add.php:16:        $accountTypeAltURl                  =  site_url('/Budget/Add/Income');
app/Modules/User/Views/Projects/Add.php:19:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/Add.php:27:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/Add.php:30:        $accountTypeAltURl                  =  site_url('/Budget/Add/Income');
app/Modules/User/Views/Projects/Add.php:33:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/Add.php:125:                                <a href="<?= site_url('Projects/List'); ?>" class="btn btn-white btn-dim btn-outline-primary">
app/Modules/User/Views/Projects/Add.php:223:                url: '<?= site_url('Projects/Add'); ?>', // Controller method to handle the form submission
app/Modules/User/Views/Projects/view.php:32:                        <a href="<?= site_url('/Projects'); ?>"><em class="icon ni ni-arrow-left"></em> View All Projects</a>
app/Modules/User/Views/Projects/forms/project_sell.php:13:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_sell.php:16:        $accountTypeAltURl                  =  site_url('/Budget/Add/Income');
app/Modules/User/Views/Projects/forms/project_sell.php:19:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_sell.php:27:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_sell.php:30:        $accountTypeAltURl                  =  site_url('/Budget/Add/Income');
app/Modules/User/Views/Projects/forms/project_sell.php:33:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_sell.php:123:                                    <a href="<?= site_url('Projects/List'); ?>" class="btn btn-white btn-dim btn-outline-primary">
app/Modules/User/Views/Projects/forms/project_sell.php:217:                url: '<?= site_url('User/Projects/SubmitSell'); ?>', // SubmitSell controller method
app/Modules/User/Views/Projects/forms/project_commit.php:13:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_commit.php:16:        $accountTypeAltURl                  =  site_url('/Budget/Add/Income');
app/Modules/User/Views/Projects/forms/project_commit.php:19:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_commit.php:27:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_commit.php:30:        $accountTypeAltURl                  =  site_url('/Budget/Add/Income');
app/Modules/User/Views/Projects/forms/project_commit.php:33:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_commit.php:121:                                    <a href="<?= site_url('Projects/List'); ?>" class="btn btn-white btn-dim btn-outline-primary">
app/Modules/User/Views/Projects/forms/project_commit.php:209:                url: '<?= site_url('User/Projects/SubmitCommit'); ?>', // SubmitCommit controller method
app/Modules/User/Views/Projects/forms/project_invest.php:13:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_invest.php:16:        $accountTypeAltURl                  =  site_url('/Budget/Add/Income');
app/Modules/User/Views/Projects/forms/project_invest.php:19:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_invest.php:27:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_invest.php:30:        $accountTypeAltURl                  =  site_url('/Budget/Add/Income');
app/Modules/User/Views/Projects/forms/project_invest.php:33:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_invest.php:123:                                    <a href="<?= site_url('Projects/List'); ?>" class="btn btn-white btn-dim btn-outline-primary">
app/Modules/User/Views/Projects/forms/project_invest.php:214:                url: '<?= site_url('User/Projects/SubmitInvest'); ?>', // SubmitInvest controller method
app/Modules/User/Views/Projects/forms/project_discuss.php:13:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_discuss.php:16:        $accountTypeAltURl                  =  site_url('/Budget/Add/Income');
app/Modules/User/Views/Projects/forms/project_discuss.php:19:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_discuss.php:27:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_discuss.php:30:        $accountTypeAltURl                  =  site_url('/Budget/Add/Income');
app/Modules/User/Views/Projects/forms/project_discuss.php:33:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Projects/forms/project_discuss.php:123:                                    <a href="<?= site_url('Projects/List'); ?>" class="btn btn-white btn-dim btn-outline-primary">
app/Modules/User/Views/Projects/forms/project_discuss.php:214:                url: '<?= site_url('User/Projects/AddComment'); ?>', // AddComment controller method
app/Modules/User/Views/Projects/holdings.php:168:                  <td><a href="<?= site_url('Projects/view/'.$pid) ?>"><?= esc($pname) ?></a></td>
app/Modules/User/Views/Projects/holdings.php:303:    <form method="post" action="<?= site_url('Projects/reportRevenue') ?>" id="formReportRevenue">
app/Modules/User/Views/Projects/holdings.php:348:        document.getElementById('formCommit').setAttribute('action', '<?= site_url('Projects/commitInvestment') ?>' + '/' + pid);
app/Modules/User/Views/Projects/holdings.php:355:        document.getElementById('formInvest').setAttribute('action', '<?= site_url('User/Projects/SubmitInvest') ?>' + '/' + pid);
app/Modules/User/Views/Projects/holdings.php:362:        document.getElementById('formSell').setAttribute('action', '<?= site_url('User/Projects/SubmitSell') ?>' + '/' + pid);
app/Modules/User/Views/Projects/index/top_projects.php:41:                            <a href="<?= site_url('Projects/View/' . $project['id']); ?>" class="btn btn-primary mt-2">View Details</a>
app/Modules/User/Views/Projects/index/most_recent_content.php:101:        fetch('<?php echo site_url('Management/Marketing/getRecentScrapes'); ?>')
app/Modules/User/Views/Projects/index/project_dashboard.php:121:                            <a href="<?= site_url('Projects/View/' . $otherProject['id']) ?>"><strong><?= esc($otherProject['name']); ?></strong></a><br>
app/Modules/User/Views/Projects/index/action_center.php:15:                <p>Add New <a href="<?php echo site_url('/Management/Marketing/Campaigns'); ?>"><strong>Marketing Campaigns</strong></a> to share with the team.</p>
app/Modules/User/Views/Projects/index/action_center.php:17:            <a href="<?php echo site_url('/Marketing/Campaigns/Add'); ?>" class="btn btn-primary btn-md">
app/Modules/User/Views/Projects/index/action_center.php:28:                <p>Have new <a href="<?php echo site_url('/Management/Marketing/Ideas'); ?>"><strong>Marketing Ideas</strong></a>? Share them with the team here.</p>
app/Modules/User/Views/Projects/index/action_center.php:30:            <a href="<?php echo site_url('/Management/Marketing/Ideas'); ?>" class="btn btn-warning btn-md">
app/Modules/User/Views/Projects/index/action_center.php:41:                <p>View <a href="<?php echo site_url('/Management/Marketing/Ideas'); ?>"><strong>Weekly Marketing Reports</strong></a> to view Analytics and more.</p>
app/Modules/User/Views/Projects/index/action_center.php:43:            <a href="<?php echo site_url('/Marketing/Reports'); ?>" class="btn btn-info btn-md">
app/Modules/User/Views/Projects/index/action_center.php:54:                <p>Additional <a href="<?php echo site_url('/Management/Marketing/Tools'); ?>"><strong>Marketing Tools</strong></a> to generate even more content.</p>
app/Modules/User/Views/Projects/index/action_center.php:56:            <a href="<?php echo site_url('/Management/Marketing/Tools'); ?>" class="btn btn-success btn-md">
app/Modules/User/Views/Projects/index/exchange_action_center.php:17:                    View The <a href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities'); ?>"><strong><?php  ?>Exchange Communities</strong></a> 
app/Modules/User/Views/Projects/index/exchange_action_center.php:27:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Discord'); ?>">Discord</a></li>
app/Modules/User/Views/Projects/index/exchange_action_center.php:28:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Facebook'); ?>">Facebook</a></li>
app/Modules/User/Views/Projects/index/exchange_action_center.php:29:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Twitter'); ?>">X (Twitter)</a></li>
app/Modules/User/Views/Projects/index/exchange_action_center.php:30:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Website'); ?>">Website</a></li>
app/Modules/User/Views/Projects/index/exchange_action_center.php:42:                    View the <a href="<?php echo site_url('Management/Marketing/Exchanges/Top-Performers'); ?>"><strong><?php  ?>Top Performing Currencies</strong></a> 
app/Modules/User/Views/Projects/index/modals.php:28:  //         data-href="<?= site_url('Management/CreatePost') ?>">
app/Modules/User/Views/Projects/index/action_center_new.php:16:                <p><a href="<?php echo site_url('/Marketing/Campaigns/Add'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/User/Views/Projects/index/action_center_new.php:18:            <a href="<?php echo site_url('/Management/Marketing/Campaigns/Add'); ?>" class="btn btn-primary btn-md">
app/Modules/User/Views/Projects/index/action_center_new.php:30:                <p><a href="<?php echo site_url('/Management/Marketing/fetchEmails'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/User/Views/Projects/index/action_center_new.php:32:            <a href="<?php echo site_url('/Management/Marketing/fetchEmails'); ?>" class="btn btn-primary btn-md">
app/Modules/User/Views/Projects/index/action_center_new.php:44:                <p><a href="<?php echo site_url('Management/Marketing/generateNewsletter'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/User/Views/Projects/index/action_center_new.php:46:            <a href="<?php echo site_url('/Management/Marketing/generateNewsletter'); ?>" class="btn btn-primary btn-md">
app/Modules/User/Views/Projects/index/action_center_new.php:58:                <p><a href="<?php echo site_url('Management/Marketing/scheduleNewsletters'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/User/Views/Projects/index/action_center_new.php:60:            <a href="<?php echo site_url('/Management/Marketing/scheduleNewsletters'); ?>" class="btn btn-primary btn-md">
app/Modules/User/Views/Projects/index/action_center_new.php:72:                <p><a href="<?php echo site_url('/Management/Marketing/Tools'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/User/Views/Projects/index/action_center_new.php:74:            <a href="<?php echo site_url('/Management/Marketing/Tools'); ?>" class="btn btn-primary btn-md">
app/Modules/User/Views/Projects/index/action_center_new.php:85:                <p><a href="<?php echo site_url('/Management/Marketing/Campaigns/Add'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/User/Views/Projects/index/action_center_new.php:87:            <a href="<?php echo site_url('/Management/Marketing/Campaigns/Add'); ?>" class="btn btn-primary btn-md">
app/Modules/User/Views/Projects/index/action_center_new.php:98:                <p><a href="<?php echo site_url('/Marketing/SEO/Tasks'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/User/Views/Projects/index/action_center_new.php:100:            <a href="<?php echo site_url('/Marketing/SEO/Tasks'); ?>" class="btn btn-warning btn-md">
app/Modules/User/Views/Projects/index/action_center_new.php:111:                <p><a href="<?php echo site_url('/Marketing/Reports'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/User/Views/Projects/index/action_center_new.php:113:            <a href="<?php echo site_url('/Marketing/Reports'); ?>" class="btn btn-info btn-md">
app/Modules/User/Views/Projects/index/action_center_new.php:124:                <p><a href="<?php echo site_url('/Marketing/Reports'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/User/Views/Projects/index/action_center_new.php:126:            <a href="<?php echo site_url('/Marketing/Tools'); ?>" class="btn btn-success btn-md">
app/Modules/User/Views/Projects/index/project_creation.php:4:        <form action="<?= site_url('Projects/Create'); ?>" method="post">
app/Modules/User/Views/Projects/index/project_list.php:21:                <a class="btn btn-primary full-width" href="<?= site_url('/Management/Projects') ?>">
app/Modules/User/Views/Projects/index/project_list.php:59:                    <!-- <a href="<?= site_url('Projects/Export'); ?>" class="btn btn-sm btn-secondary">Export Projects</a>
app/Modules/User/Views/Projects/index/project_list.php:60:                    <a href="<?= site_url('Projects/Report'); ?>" class="btn btn-sm btn-warning">Generate Report</a> -->
app/Modules/User/Views/Projects/index/project_list.php:81:                            <td><a href="<?= site_url('Projects/View/' . $project['id']); ?>"><?= esc($project['name']); ?></a></td>
app/Modules/User/Views/Projects/index/project_list.php:97:                                <a href="<?= site_url('Projects/View/' . $project['id']); ?>" class="btn btn-sm btn-primary mx-5"><em class="icon ni ni-eye"></em></a>
app/Modules/User/Views/Projects/index/project_list.php:98:                                <!-- <a href="<?= site_url('Projects/Edit/' . $project['id']); ?>" class="btn btn-sm btn-secondary mx-5"><em class="icon ni ni-pen"></em></a>
app/Modules/User/Views/Projects/index/project_list.php:99:                                <a href="<?= site_url('Projects/Delete/' . $project['id']); ?>" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this project?');"><em class="icon ni ni-cross"></em></a> -->
app/Modules/User/Views/Projects/index/investment_commitment.php:9:        <form action="<?= site_url('Projects/Commit'); ?>" method="post">
app/Modules/User/Views/Projects/index/project_details.php:57:            <a href="<?= site_url('User/Projects/Invest/' . $project['id']); ?>" class="btn btn-success me-2">Invest</a>
app/Modules/User/Views/Projects/index/project_details.php:58:            <a href="<?= site_url('User/Projects/Sell/' . $project['id']); ?>" class="btn btn-danger me-2">Sell</a>
app/Modules/User/Views/Projects/index/project_details.php:59:            <a href="<?= site_url('User/Projects/Discuss/' . $project['id']); ?>" class="btn btn-primary">Join Discussion</a>
app/Modules/User/Views/Projects/index/project_overview.php:14:                <tr><th>Submitted By</th><td><strong><a href="<?= site_url('/Profile/' . $owner['cuUsername']) ?>"><?= esc($owner['cuUsername']); ?></a></strong></td></tr>
app/Modules/User/Views/Projects/index/project_overview.php:54:            <a href="<?= site_url('Management/Projects/Approve/' . $project['id']); ?>" class="btn btn-success me-2" onclick="return confirm('Approve this project?');">Approve</a>
app/Modules/User/Views/Projects/index/project_overview.php:55:            <a href="<?= site_url('Management/Projects/Reject/' . $project['id']); ?>" class="btn btn-danger me-2" onclick="return confirm('Reject this project?');">Reject</a>
app/Modules/User/Views/Projects/index/project_overview.php:56:            <a href="<?= site_url('Management/Projects/Edit/' . $project['id']); ?>" class="btn btn-secondary me-2">Edit</a>
app/Modules/User/Views/Projects/index/project_overview.php:57:            <a href="<?= site_url('Management/Projects/Message/' . $project['id']); ?>" class="btn btn-primary">Request More Information</a>
app/Modules/User/Views/Referral_Program/Apply.php:21:                        <a href="<?php echo site_url('/Dashboard'); ?>">Return to Dashboard</a>							
app/Modules/User/Views/Referral_Program/Apply.php:94:            const result = await fetch("<?= site_url('User/Referral_Program/Application_Manager'); ?>", {
app/Modules/User/Views/Referral_Program/Apply.php:103:		    location.href = <?php echo '\'' . site_url('Referral-Program/Application/Success') . '\'';?>;
app/Modules/User/Views/Referral_Program/Marketing_Affiliate_Program_Agreement.php:17:                        <a href="<?php echo site_url('/Referral-Program/Apply'); ?>">Return to Referral Program</a>							
app/Modules/User/Views/Referral_Program/Marketing_Affiliate_Program_Agreement.php:85:                            â€œProgram Policies Pageâ€ means the landing page: <a href="<?php echo site_url('/Referral-Program/Apply' . $cuID); ?>"><span><?php echo site_url('/Referral-Program/Apply' . $cuID); ?></span></a> where we will provide all the up-to-date guidelines and policies for the Affiliate Program.
app/Modules/User/Views/Referral_Program/Marketing_Affiliate_Program_Agreement.php:91:                            â€œSubscription Serviceâ€ means our web-based sales software that is subscribed to, developed, operated, and maintained by us, accessible via <a href="<?php echo site_url('/'); ?>"><span><?php echo site_url('/'); ?></span></a> or another designated URL, and add-on products to our sales software. 
app/Modules/User/Views/Referral_Program/Create.php:77:        fetch('<?=site_url("/Referrals/sendReferralEmail")?>', {
app/Modules/User/Views/Referral_Program/Create.php:98:                window.location.href = "<?=site_url('/My-Referrals')?>"; // Redirect after success
app/Modules/User/Views/Referral_Program/Create.php:110:    const referralLink = "<?=site_url('/Referral/Register/' . $cuID)?>"; // Assuming you have a referral link URL
app/Modules/User/Views/Referral_Program/My_Referrals/control_center.php:30:                <a href="<?php echo site_url('Referrals/Create'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-plus"></em></a>
app/Modules/User/Views/Referral_Program/My_Referrals/control_center.php:51:                    <p>Manage your <a href="<?php echo site_url('Referral/Active'); ?>">Active Referrals</a> to view detailed information.</p>
app/Modules/User/Views/Referral_Program/My_Referrals/control_center.php:53:                <a href="<?php echo site_url('Referral/Active'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Referral_Program/My_Referrals/control_center.php:61:                    <p>Manage your <a href="<?php echo site_url('Referral/Pending'); ?>">Pending Referrals</a> to view detailed information.</p>
app/Modules/User/Views/Referral_Program/My_Referrals/control_center.php:63:                <a href="<?php echo site_url('Referral/Pending'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Referral_Program/My_Referrals/control_center.php:73:                <a href="<?php echo site_url('Referral/Reports'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Referral_Program/Users.php:105:											<a style="color: green;" href="' . site_url('Referral-Program/Activate-Affiliate/' . $userInfo['id']) . '"><i class="icon-check"></i></a>
app/Modules/User/Views/Referral_Program/Users.php:109:											<a style="color: blue;" href="' . site_url('Referral-Program/New-Affiliate-Information/' . $userInfo['id']) . '"><i class="icon-note"></i></a>
app/Modules/User/Views/Referral_Program/Users.php:268:					<a type="button" class="btn btn-success" href="' . site_url('Referral-Program/Activate-Affiliate/' . $userInfo['id']) . '">Approve</a>
app/Modules/User/Views/Referral_Program/My_Referrals.php:34:                        <a href="<?php echo site_url('/Referral-Program/Apply'); ?>">Return to Referral Program</a>							
app/Modules/User/Views/Referral_Program/index.php:88:                                <a href="<?php echo site_url('Referral/Active'); ?>">
app/Modules/User/Views/Referral_Program/index.php:98:                                <a href="<?php echo site_url('Referral/Pending'); ?>">
app/Modules/User/Views/Referral_Program/index.php:108:                                <a href="<?php echo site_url('Referral/Reports'); ?>">
app/Modules/User/Views/Referral_Program/index.php:118:                                <a href="<?php echo site_url('Referral/Create'); ?>">
app/Modules/User/Views/Referral_Program/Apply/Referral_Policy.php:31:        <p>We will be providing our Affiliate Members with the opportunity to collect <a href="<?php echo site_url('Knowledge-Base/Assets#what-are-digital-assets'); ?>">MyMI Coins</a> in return for referring new members to the Millennial Investments Community. So let's get into the details of how this works by continuing to read the information provided below!</p>
app/Modules/User/Views/Referral_Program/Apply/Referral_Policy.php:33:        <p><strong class="text-bold">Account:</strong> You can log into your membership account at anytime and track your clicks and referrals at <a href="<?php echo site_url('My-Referrals'); ?>"><?php echo site_url('My-Referrals'); ?></a> or simply clicking <a href="<?php echo site_url('My-Referrals'); ?>">here</a>.</p>
app/Modules/User/Views/Referral_Program/Apply/Referral_Policy_Additional.php:13:$MyMICoinLink                   = '<a href="' . site_url('Exchange/Market/USD/MyMI') . '">MyMI</a>';
app/Modules/User/Views/Referral_Program/Apply/Referral_Policy_Additional.php:94:        <p>There are a number of other limitations that may result in commissions not being paid - we encourage you to read the <a href="<?php echo site_url('Referral-Program/Marketing-Affiliate-Program-Agreement'); ?>">Marketing Affiliate Program Agreement</a> for more information on this.<br><a href="<?php echo site_url('Referral-Program/Marketing-Affiliate-Program-Agreement'); ?>">View our Marketing Affiliate Program Agreement</a></p>        
app/Modules/User/Views/Budget_Orig/index.php:480:                                        <a class="btn btn-success btn-sm text-white" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/User/Views/Budget_Orig/index.php:481:                                        <a class="btn btn-danger btn-sm text-white" href="' . site_url('/Budget/Add/Expense') . '"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/User/Views/Budget_Orig/index.php:483:                                        <a class="btn btn-outline-secondary btn-sm" href="' . site_url('/Budget/History') . '"><i class="icon ni ni-history"></i> History</a>
app/Modules/User/Views/Budget_Orig/index.php:490:                                                            <a class="" href="' . site_url('/Budget/Add/Income') . '">On</a>
app/Modules/User/Views/Budget_Orig/index.php:493:                                                            <a class="" href="' . site_url('/Budget/Add/Income') . '">Off</a>
app/Modules/User/Views/Budget_Orig/index.php:497:                                                            <a class="" href="' . site_url('/Budget/Add/Income') . '">On</a>
app/Modules/User/Views/Budget_Orig/index.php:500:                                                            <a class="" href="' . site_url('/Budget/Add/Income') . '">Off</a>
app/Modules/User/Views/Budget_Orig/index.php:507:                                                Include Credit Accounts: <a class="" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-toggle-off"></i></a>
app/Modules/User/Views/Budget_Orig/index.php:510:                                                Include Investment Accounts: <a class="" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-toggle-off"></i></a>
app/Modules/User/Views/Budget_Orig/index.php:517:                                        Include Credit Accounts: <a class="" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-toggle-off"></i></a>
app/Modules/User/Views/Budget_Orig/index.php:518:                                        Include Investment Accounts: <a class="" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-toggle-off"></i></a>
app/Modules/User/Views/Budget_Orig/index.php:559:                                        <a class="btn btn-success btn-xs text-white" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/User/Views/Budget_Orig/index.php:560:                                        <a class="btn btn-danger btn-xs text-white" href="' . site_url('/Budget/Add/Expense') . '"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/User/Views/Budget_Orig/index/overview_chart.php:70:                    <a href="<?php echo site_url('Budget/Income'); ?>">
app/Modules/User/Views/Budget_Orig/index/overview_chart.php:82:                    <a href="<?php echo site_url('Budget/Expenses'); ?>">
app/Modules/User/Views/Budget_Orig/index/overview_chart.php:121:                    <a href="<?php echo site_url('Budget/Income'); ?>">
app/Modules/User/Views/Budget_Orig/index/overview_chart.php:133:                    <a href="<?php echo site_url('Budget/Expenses'); ?>">
app/Modules/User/Views/Budget_Orig/index/control_center.php:28:                        <a href="<?php echo site_url('Budget/Income'); ?>">Income Accounts</a> 
app/Modules/User/Views/Budget_Orig/index/control_center.php:32:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Budget_Orig/index/control_center.php:37:                <a href="<?php echo site_url('Budget/Income'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget_Orig/index/control_center.php:48:                        <a href="<?php echo site_url('Budget/Expenses'); ?>">Expense Accounts</a> 
app/Modules/User/Views/Budget_Orig/index/control_center.php:52:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Budget_Orig/index/control_center.php:57:                <a href="<?php echo site_url('Budget/Expenses'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget_Orig/index/control_center.php:68:                        <a href="<?php echo site_url('Wallets/Checking'); ?>">Checking Accounts</a> 
app/Modules/User/Views/Budget_Orig/index/control_center.php:71:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Budget_Orig/index/control_center.php:76:                <a href="<?php echo site_url('/Wallets/Checking'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget_Orig/index/control_center.php:86:                        <a href="<?php echo site_url('/Wallets/Credit'); ?>">Credit</a> 
app/Modules/User/Views/Budget_Orig/index/control_center.php:89:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Budget_Orig/index/control_center.php:94:                <a href="<?php echo site_url('/Wallets/Credit'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget_Orig/index/control_center.php:104:                        <a href="<?php echo site_url('/Wallets/Debt'); ?>">Debt</a> 
app/Modules/User/Views/Budget_Orig/index/control_center.php:107:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Budget_Orig/index/control_center.php:112:                <a href="<?php echo site_url('/Wallets/Debt'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget_Orig/index/control_center.php:123:                        <!-- <a href="<?php echo site_url('/Wallets/Investments'); ?>">Investments</a>  -->
app/Modules/User/Views/Budget_Orig/index/control_center.php:126:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Budget_Orig/index/control_center.php:145:                        <!-- <a href="<?php //echo site_url('/Wallets/Retirement'); ?>">Retirement</a>  -->
app/Modules/User/Views/Budget_Orig/index/control_center.php:148:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Budget_Orig/index/control_center.php:173:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Budget_Orig/index/control_center.php:192:                        <a href="<?php //echo site_url('/Budget/Income/Accounts'); ?>">Investments / Assets</a> 
app/Modules/User/Views/Budget_Orig/index/control_center.php:195:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Budget_Orig/index/control_center.php:200:                <a href="<?php //echo site_url('/Budget/Add/Expense'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget_Orig/index/control_center.php:209:                    <p>View, manage and analyze your <a href="<?php //echo site_url('Budget/Forecast'); ?>"><strong><?php //echo $totalTransactions; ?> Financial Forecast &amp; 5-Year Projections</strong></a>.</p>
app/Modules/User/Views/Budget_Orig/index/control_center.php:211:                <a href="<?php //echo site_url('Exchanges'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Search/index.php:11:                    href="<?= site_url('Investments/Symbol/' . urlencode($row['symbol'] ?? '')) ?>"
app/Modules/User/Views/Auctions/index.php:41:                                    <a href="<?= site_url('Auctions/Item/' . $lot['item_id']) ?>" class="btn btn-primary w-100">View &amp; Bid</a>
app/Modules/User/Views/Auctions/item.php:69:            <form id="bid-form" class="mb-3" action="<?= site_url('Auctions/Bid/' . $lotId) ?>" method="post">
app/Modules/User/Views/Auctions/item.php:143:    const pollUrl = '<?= site_url('Auctions/Poll/' . $lotId) ?>';
app/Modules/User/Views/Auctions/item.php:253:                const response = await fetch('<?= site_url('API/Auctions/topup') ?>', {
app/Modules/User/Views/Subscribe/header_subscribe.php:68:            const result = await fetch("<?= site_url('Blog/Email/Subscription/Account-Manager'); ?>", {            
app/Modules/User/Views/Budget/History.php:177:                                        <a class="btn btn-success btn-sm text-white" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/User/Views/Budget/History.php:178:                                        <a class="btn btn-danger btn-sm text-white" href="' . site_url('/Budget/Add/Expense') . '"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/User/Views/Budget/History.php:179:                                        <a class="btn btn-outline-secondary btn-sm" href="' . site_url('/Budget') . '"><i class="icon ni ni-history"></i> Current</a>
app/Modules/User/Views/Budget/History.php:217:                                            <a class="btn btn-success btn-xs text-white" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/User/Views/Budget/History.php:218:                                            <a class="btn btn-danger btn-xs text-white" href="' . site_url('/Budget/Add/Expense') . '"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/User/Views/Budget/Search.php:179:                                        <a class="btn btn-success btn-sm text-white" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/User/Views/Budget/Search.php:180:                                        <a class="btn btn-danger btn-sm text-white" href="' . site_url('/Budget/Add/Expense') . '"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/User/Views/Budget/Search.php:181:                                        <a class="btn btn-outline-secondary btn-sm" href="' . site_url('/Budget/History') . '"><i class="icon ni ni-history"></i> History</a>
app/Modules/User/Views/Budget/Search.php:219:                                        <a class="btn btn-success btn-xs text-white" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/User/Views/Budget/Search.php:220:                                        <a class="btn btn-danger btn-xs text-white" href="' . site_url('/Budget/Add/Expense') . '"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/User/Views/Budget/this_month.php:15:            <a class="btn btn-secondary" href="<?= site_url('Budget'); ?>">Back to Budget</a>
app/Modules/User/Views/Budget/this_month.php:16:            <a class="btn btn-primary" href="<?= site_url('Budget/This-Month'); ?>">All</a>
app/Modules/User/Views/Budget/this_month.php:17:            <a class="btn btn-outline-success" href="<?= site_url('Budget/This-Month/Income'); ?>">Income</a>
app/Modules/User/Views/Budget/this_month.php:18:            <a class="btn btn-outline-danger" href="<?= site_url('Budget/This-Month/Expense'); ?>">Expenses</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.orig.php:307:                                <!-- <a class="btn btn-success text-white" href="<?php //echo site_url('/Budget/Approve-Recurring-Schedule/' . $accountID); ?>">Approve</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.orig.php:308:                                <a class="btn btn-danger text-white" href="<?php //echo site_url('/Budget/Cancel-Account/' . $accountID); ?>">Cancel</a> -->
app/Modules/User/Views/Budget/Recurring_Account_Schedule.orig.php:341:                                    <td><a class="btn btn-success text-white" href="<?php echo site_url('Budget/Edit/' . $accountID); ?>">Edit</a></td>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.orig.php:360:                                <a class="btn btn-success text-white" href="<?php echo site_url('/Budget/Approve-Recurring-Schedule/' . $accountID); ?>">Approve</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.orig.php:361:                                <a class="btn btn-danger text-white" href="<?php echo site_url('/Budget/Cancel-Account/' . $accountID); ?>">Cancel</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.orig.php:366:                                            <li><a href="<?php //echo site_url('/Budget/Edit/' . $accountID); ?>"><em class="icon ni ni-setting"></em><span>Account Settings</span></a></li>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.orig.php:401:                                            <a class="data-more" href="' . site_url('Budget/Recurring-Account/Edit/' . $accountID . $account['recurring_account_order']) . '" onClick="email_Switch(this)"><em class="icon ni ni-pen2"></em></a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.orig.php:478:                                                    <a class="data-more" href="' . site_url('Budget/Recurring-Account/Edit/' . $accountID . $account['recurring_account_order']) . '" onClick="email_Switch(this)"><em class="icon ni ni-pen2"></em></a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.orig.php:520:                                            <li><a href="<?php //echo site_url('/Budget/Edit/' . $accountID); ?>"><em class="icon ni ni-setting"></em><span>Account Settings</span></a></li>
app/Modules/User/Views/Budget/Recurring_Account_Schedule-12232023.php:342:                                <!-- <a class="btn btn-success text-white" href="<?php //echo site_url('/Budget/Approve-Recurring-Schedule/' . $accountID); ?>">Approve</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule-12232023.php:343:                                <a class="btn btn-danger text-white" href="<?php //echo site_url('/Budget/Cancel-Account/' . $accountID); ?>">Cancel</a> -->
app/Modules/User/Views/Budget/Recurring_Account_Schedule-12232023.php:376:                                    <td><a class="btn btn-success text-white" href="<?php echo site_url('Budget/Edit/' . $accountID); ?>">Edit</a></td>
app/Modules/User/Views/Budget/Recurring_Account_Schedule-12232023.php:395:                                <a class="btn btn-success text-white" href="<?php echo site_url('/Budget/Approve-Recurring-Schedule/' . $accountID); ?>">Approve</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule-12232023.php:396:                                <a class="btn btn-danger text-white" href="<?php echo site_url('/Budget/Cancel-Account/' . $accountID); ?>">Cancel</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule-12232023.php:401:                                            <li><a href="<?php //echo site_url('/Budget/Edit/' . $accountID); ?>"><em class="icon ni ni-setting"></em><span>Account Settings</span></a></li>
app/Modules/User/Views/Budget/Recurring_Account_Schedule-12232023.php:439:                                            <a class="data-more" href="' . site_url('Budget/Recurring-Account/Edit/' . $accountID . $account['recurring_account_order']) . '" onClick="email_Switch(this)"><em class="icon ni ni-pen2"></em></a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule-12232023.php:497:                                                    <a class="data-more" href="' . site_url('Budget/Recurring-Account/Edit/' . $accountID . $account['recurring_account_order']) . '" onClick="email_Switch(this)"><em class="icon ni ni-pen2"></em></a>
app/Modules/User/Views/Budget/monthly_overview.php:22:            <a class="btn btn-secondary" href="<?= site_url('Budget'); ?>">Back to Budget</a>
app/Modules/User/Views/Budget/monthly_overview.php:23:            <a class="<?= $allBtnClass ?>" href="<?= site_url($routeBase); ?>">All</a>
app/Modules/User/Views/Budget/monthly_overview.php:24:            <a class="<?= $incomeBtnClass ?>" href="<?= site_url($routeBase . '/Income'); ?>">Income</a>
app/Modules/User/Views/Budget/monthly_overview.php:25:            <a class="<?= $expenseBtnClass ?>" href="<?= site_url($routeBase . '/Expense'); ?>">Expenses</a>
app/Modules/User/Views/Budget/Add.php:14:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Budget/Add.php:17:        $accountTypeAltURl                  =  site_url('/Budget/Add/Income');
app/Modules/User/Views/Budget/Add.php:20:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Budget/Add.php:28:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Budget/Add.php:31:        $accountTypeAltURl                  =  site_url('/Budget/Add/Income');
app/Modules/User/Views/Budget/Add.php:34:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Budget/Add.php:86:    <form class="form-horizontal" id="add_user_budgeting_account" action="<?= site_url('Wallets/Add'); ?>" method="POST">
app/Modules/User/Views/Budget/Add.php:299:            redirectURL = '<?php echo site_url('/Budget/Recurring-Account/Schedule'); ?>';
app/Modules/User/Views/Budget/Add.php:302:            redirectURL = '<?php echo site_url('/Budget'); ?>';
app/Modules/User/Views/Budget/Add.php:334:                const response = await fetch("<?php echo site_url('Budget/Account-Manager'); ?>", {
app/Modules/User/Views/Budget/Add.php:350:                        location.href = `<?php echo site_url('/Budget/Recurring-Account/Schedule/'); ?>${accountID}`;
app/Modules/User/Views/Budget/Add.php:352:                        location.href = `<?php echo site_url('/Budget'); ?>`;
app/Modules/User/Views/Budget/index.orig.php:480:                                        <a class="btn btn-success btn-sm text-white" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/User/Views/Budget/index.orig.php:481:                                        <a class="btn btn-danger btn-sm text-white" href="' . site_url('/Budget/Add/Expense') . '"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/User/Views/Budget/index.orig.php:483:                                        <a class="btn btn-outline-secondary btn-sm" href="' . site_url('/Budget/History') . '"><i class="icon ni ni-history"></i> History</a>
app/Modules/User/Views/Budget/index.orig.php:490:                                                            <a class="" href="' . site_url('/Budget/Add/Income') . '">On</a>
app/Modules/User/Views/Budget/index.orig.php:493:                                                            <a class="" href="' . site_url('/Budget/Add/Income') . '">Off</a>
app/Modules/User/Views/Budget/index.orig.php:497:                                                            <a class="" href="' . site_url('/Budget/Add/Income') . '">On</a>
app/Modules/User/Views/Budget/index.orig.php:500:                                                            <a class="" href="' . site_url('/Budget/Add/Income') . '">Off</a>
app/Modules/User/Views/Budget/index.orig.php:507:                                                Include Credit Accounts: <a class="" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-toggle-off"></i></a>
app/Modules/User/Views/Budget/index.orig.php:510:                                                Include Investment Accounts: <a class="" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-toggle-off"></i></a>
app/Modules/User/Views/Budget/index.orig.php:517:                                        Include Credit Accounts: <a class="" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-toggle-off"></i></a>
app/Modules/User/Views/Budget/index.orig.php:518:                                        Include Investment Accounts: <a class="" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-toggle-off"></i></a>
app/Modules/User/Views/Budget/index.orig.php:559:                                        <a class="btn btn-success btn-xs text-white" href="' . site_url('/Budget/Add/Income') . '"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/User/Views/Budget/index.orig.php:560:                                        <a class="btn btn-danger btn-xs text-white" href="' . site_url('/Budget/Add/Expense') . '"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/User/Views/Budget/Account_Manager-12232023.php:171:                        'redirectURL' => isset($redirectURL) ? $redirectURL : site_url('/Budget'),
app/Modules/User/Views/Budget/Account_Manager-12232023.php:183:                        'redirectURL' => site_url('/Budget'),
app/Modules/User/Views/Budget/Account_Manager-12232023.php:212:            //             $redirectURL = site_url('Budget/Recurring-Schedule/' . $accountID); 
app/Modules/User/Views/Budget/Account_Manager-12232023.php:232:            //                     'redirectURL'           => site_url('/Budget'),
app/Modules/User/Views/Budget/Account_Manager-12232023.php:245:            //                 'redirectURL'           => site_url('/Budget'),
app/Modules/User/Views/Budget/Account_Manager-12232023.php:267:                $redirectURL = site_url('Budget/Recurring-Schedule/' . $accountID); 
app/Modules/User/Views/Budget/Account_Manager-12232023.php:287:                        'redirectURL'           => site_url('/Budget'),
app/Modules/User/Views/Budget/index.09122025.php:244:                            $accountPaidStatus = $account['paid'] ? '' : '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon ni ni-check-thick"></i></a>';
app/Modules/User/Views/Budget/index.09122025.php:250:                                <td><a href="<?= site_url('Budget/Details/' . $account['id']) ?>"><?= $account['name'] ?></a></td>
app/Modules/User/Views/Budget/index.09122025.php:256:                                    <a href="<?= site_url('Budget/Edit/' . $account['id']) ?>"><i class="icon ni ni-edit"></i></a>
app/Modules/User/Views/Budget/index.09122025.php:257:                                    <a href="<?= site_url('Budget/Copy/' . $account['id']) ?>"><i class="icon ni ni-copy"></i></a>
app/Modules/User/Views/Budget/index.09122025.php:258:                                    <a href="<?= site_url('Budget/Delete-Account/' . $account['id']) ?>" class="text-red"><i class="icon ni ni-trash"></i></a>
app/Modules/User/Views/Budget/index.09122025.php:274:                window.location.href = `<?=site_url('Budget/Search/')?>${encodeURIComponent(val)}`;
app/Modules/User/Views/Budget/Financial_Forecast.php:60:                                <p><a href="<?php echo site_url('/Budget/Add/Income'); ?>"><strong>Manage Income Accounts</strong></a> to manage your Monthly Income Accounts.</p>
app/Modules/User/Views/Budget/Financial_Forecast.php:62:                            <a href="<?php echo site_url('/Budget/Income'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/Financial_Forecast.php:70:                                <p><a href="<?php echo site_url('/Budget/Add/Expense'); ?>"><strong>Manage Expense Accounts</strong></a> to manage your Monthly Expense Accounts.</p>
app/Modules/User/Views/Budget/Financial_Forecast.php:72:                            <a href="<?php echo site_url('/Budget/Income/Settings'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/Financial_Forecast.php:80:                                <p>View and Manage your <a href="<?php echo site_url('Management/Assets/Transactions'); ?>"><strong><?php //echo $totalTransactions; ?> Potential Investments</strong></a>.</p>
app/Modules/User/Views/Budget/Financial_Forecast.php:82:                            <a href="<?php echo site_url('Management/Assets/Transactions'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/Financial_Forecast.php:90:                                <p>View and Manage your <a href="<?php echo site_url('Management/Assets/Transactions'); ?>"><strong><?php //echo $totalTransactions; ?>Active Support Requests</strong></a>.</p>
app/Modules/User/Views/Budget/Financial_Forecast.php:92:                            <a href="<?php echo site_url('Management/Assets/Transactions'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/Financial_Forecast.php:129:                                        <a href="<?php echo site_url('Budget/Income'); ?>">
app/Modules/User/Views/Budget/Financial_Forecast.php:138:                                        <a href="<?php echo site_url('Budget/Expenses'); ?>">
app/Modules/User/Views/Budget/Copy.php:54:$accountTypeAltURl                      = site_url('/Budget/Add/' . $accountType);
app/Modules/User/Views/Budget/Copy.php:174:            redirectURL = '<?php echo site_url('/Budget/Recurring-Account/Schedule'); ?>';
app/Modules/User/Views/Budget/Copy.php:177:            redirectURL = '<?php echo site_url('/Budget'); ?>';
app/Modules/User/Views/Budget/Copy.php:206:                const response = await fetch("<?php echo site_url('Budget/Account-Manager'); ?>", {
app/Modules/User/Views/Budget/Copy.php:222:                        location.href = `<?php echo site_url('/Budget/Recurring-Account/Schedule/'); ?>${accountID}`;
app/Modules/User/Views/Budget/Copy.php:224:                        location.href = `<?php echo site_url('/Budget'); ?>`;
app/Modules/User/Views/Budget/Copy.php:239:        // const redirectURL                   = <?php //echo '\'' . site_url('/Budget/Recurring-Account/Schedule') . '\'';?>;
app/Modules/User/Views/Budget/Copy.php:242:        // const redirectURL                   = <?php //echo '\'' . site_url('/Budget') . '\'';?>;
app/Modules/User/Views/Budget/Copy.php:245:    const redirectURL                       = <?php echo '\'' . site_url('/Budget') . '\'';?>;
app/Modules/User/Views/Budget/Copy.php:268:            const result = await fetch("<?= site_url('User/Budget/Account_Manager'); ?>", {
app/Modules/User/Views/Budget/Copy.php:283:                    location.href = <?php echo '\'' . site_url('/Budget/Recurring-Account/Schedule/' . $accountID) . '\'';?>;
app/Modules/User/Views/Budget/Copy.php:285:                    location.href = <?php echo '\'' . site_url('/Budget') . '\'';?>;
app/Modules/User/Views/Budget/Copy.php:288:                location.href = <?php echo '\'' . site_url('/Budget') . '\'';?>;
app/Modules/User/Views/Budget/Account_Overview/action_center.php:26:                    <p><a href="<?php echo site_url('/Budget/Add/' . $accountType); ?>"><strong>Create <?php echo $accountType; ?> Record</strong></a> to include in your Monthly <?php echo $accountType; ?> Accounts.</p>
app/Modules/User/Views/Budget/Account_Overview/action_center.php:28:                <a href="<?php echo site_url('/Budget/Add/' . $accountType); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/Account_Overview/action_center.php:36:                    <p><a href="<?php echo site_url('/Budget/History/' . $accountType); ?>"><strong>Manage <?= $accountType; ?> Accounts</strong></a> in your Monthly Budget.</p>
app/Modules/User/Views/Budget/Account_Overview/action_center.php:38:                <a href="<?php echo site_url('/Budget/History/' . $accountType); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/Account_Overview/action_center.php:46:                    <p>View and Manage your <a href="<?php echo site_url('Budget/Settings/' . $budgetType); ?>"><strong><?= $accountType; ?> Settings</strong></a>.</p>
app/Modules/User/Views/Budget/Account_Overview/action_center.php:48:                <a href="<?php echo site_url('Budget/Settings/' . $budgetType); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/Account_Overview/action_center.php:56:                    <p>View and Manage your <a href="<?php echo site_url('Support/Budget'); ?>"><strong><?php //echo $totalTransactions; ?>Active Support Requests</strong></a>.</p>
app/Modules/User/Views/Budget/Account_Overview/action_center.php:58:                <a href="<?php echo site_url('Support/Budget'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/Account_Overview/monthly_overview.php:99:                            <a href="<?php echo site_url('/Budget'); ?>">
app/Modules/User/Views/Budget/Account_Overview/monthly_overview.php:108:                            <a href="<?php echo site_url('Budget/' . $budgetType); ?>">
app/Modules/User/Views/Budget/Account_Overview/monthly_overview.php:117:                            <a href="<?php echo site_url('/Budget/' . $oppBudgetType); ?>">
app/Modules/User/Views/Budget/Account_Overview/monthly_overview.php:126:                            <a href="<?php echo site_url('/Budget'); ?>">
app/Modules/User/Views/Budget/Add-New.php:15:    $accountTypeAltURl = site_url('/Budget/Add/Expense');
app/Modules/User/Views/Budget/Add-New.php:18:    $accountTypeAltURl = site_url('/Budget/Add/Income');
app/Modules/User/Views/Budget/Add-New.php:134:            // redirectURL = '<?php echo site_url('/Budget/Recurring-Account/Schedule'); ?>';
app/Modules/User/Views/Budget/Add-New.php:137:            // redirectURL = '<?php echo site_url('/Budget'); ?>';
app/Modules/User/Views/Budget/Add-New.php:152:                const response = await fetch("<?php echo site_url('User/Budget/Account_Manager'); ?>", {
app/Modules/User/Views/Budget/Add-New.php:173:                        const redirectURL = recurringAccount === "Yes" ? "<?php echo site_url('/Budget/Recurring-Account/Schedule/'); ?>${accountID}" : "<?php echo site_url('/Budget/Recurring-Account/Schedule'); ?>";
app/Modules/User/Views/Budget/Add-New.php:176:                        redirectURL = '<?php echo site_url('/Budget'); ?>';
app/Modules/User/Views/Budget/Forecast.php:203:                                <p><a href="<?php echo site_url('/Budget/Add/Income'); ?>"><strong>Manage Income Accounts</strong></a> to manage your Monthly Income Accounts.</p>
app/Modules/User/Views/Budget/Forecast.php:205:                            <a href="<?php echo site_url('/Budget/Income'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/Forecast.php:213:                                <p><a href="<?php echo site_url('/Budget/Add/Expense'); ?>"><strong>Manage Expense Accounts</strong></a> to manage your Monthly Expense Accounts.</p>
app/Modules/User/Views/Budget/Forecast.php:215:                            <a href="<?php echo site_url('/Budget/Income/Settings'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/Forecast.php:223:                                <p>View and Manage your <a href="<?php echo site_url('Management/Assets/Transactions'); ?>"><strong><?php //echo $totalTransactions; ?> Potential Investments</strong></a>.</p>
app/Modules/User/Views/Budget/Forecast.php:225:                            <a href="<?php echo site_url('Management/Assets/Transactions'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/Forecast.php:233:                                <p>View and Manage your <a href="<?php echo site_url('Management/Assets/Transactions'); ?>"><strong><?php //echo $totalTransactions; ?>Active Support Requests</strong></a>.</p>
app/Modules/User/Views/Budget/Forecast.php:235:                            <a href="<?php echo site_url('Management/Assets/Transactions'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/Forecast.php:272:                                        <a href="<?php echo site_url('Budget/Income'); ?>">
app/Modules/User/Views/Budget/Forecast.php:281:                                        <a href="<?php echo site_url('Budget/Expenses'); ?>">
app/Modules/User/Views/Budget/index.php:244:                                : '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon ni ni-check-thick"></i></a>';
app/Modules/User/Views/Budget/index.php:250:                                <td><a href="<?= site_url('Budget/Details/' . $account['id']) ?>"><?= esc($account['name'] ?? '') ?></a></td>
app/Modules/User/Views/Budget/index.php:256:                                    <a href="<?= site_url('Budget/Edit/' . $account['id']) ?>"><i class="icon ni ni-edit"></i></a>
app/Modules/User/Views/Budget/index.php:257:                                    <a href="<?= site_url('Budget/Copy/' . $account['id']) ?>"><i class="icon ni ni-copy"></i></a>
app/Modules/User/Views/Budget/index.php:258:                                    <a href="<?= site_url('Budget/Delete-Account/' . $account['id']) ?>" class="text-red"><i class="icon ni ni-trash"></i></a>
app/Modules/User/Views/Budget/index.php:275:        window.location.href = "<?= site_url('Budget/Search/') ?>" + encodeURIComponent(val);
app/Modules/User/Views/Budget/index.php:312:            <a class="btn btn-primary" href="<?= site_url('Budget/This-Month'); ?>">This Month (All)</a>
app/Modules/User/Views/Budget/index.php:313:            <a class="btn btn-outline-success" href="<?= site_url('Budget/This-Month/Income'); ?>">Income</a>
app/Modules/User/Views/Budget/index.php:314:            <a class="btn btn-outline-danger" href="<?= site_url('Budget/This-Month/Expense'); ?>">Expenses</a>
app/Modules/User/Views/Budget/index.php:317:            <a class="btn btn-outline-primary" href="<?= site_url('Budget/Last-Month'); ?>">Last Month (All)</a>
app/Modules/User/Views/Budget/index.php:318:            <a class="btn btn-outline-success" href="<?= site_url('Budget/Last-Month/Income'); ?>">Income</a>
app/Modules/User/Views/Budget/index.php:319:            <a class="btn btn-outline-danger" href="<?= site_url('Budget/Last-Month/Expense'); ?>">Expenses</a>
app/Modules/User/Views/Budget/index.php:322:            <a class="btn btn-outline-primary" href="<?= site_url('Budget/Next-Month'); ?>">Next Month (All)</a>
app/Modules/User/Views/Budget/index.php:323:            <a class="btn btn-outline-success" href="<?= site_url('Budget/Next-Month/Income'); ?>">Income</a>
app/Modules/User/Views/Budget/index.php:324:            <a class="btn btn-outline-danger" href="<?= site_url('Budget/Next-Month/Expense'); ?>">Expenses</a>
app/Modules/User/Views/Budget/index.php:381:                <a href="<?= site_url('Budget/Add/Income'); ?>" class="btn btn-success mb-2">Add Income</a>
app/Modules/User/Views/Budget/index.php:382:                <a href="<?= site_url('Budget/Add/Expense'); ?>" class="btn btn-danger mb-2">Add Expense</a>
app/Modules/User/Views/Budget/index.php:383:                <a href="<?= site_url('Budget/Add/Debt'); ?>" class="btn btn-warning mb-2">Add Debt</a>
app/Modules/User/Views/Budget/index.php:384:                <a href="<?= site_url('Budget/Add/Investment'); ?>" class="btn btn-info mb-2">Add Investment</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.working.php:272:                                            <li><a href="<?php echo site_url('/Budget/Edit/' . $accountID); ?>"><em class="icon ni ni-setting"></em><span>Account Settings</span></a></li>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.working.php:326:                                            <li><a href="<?php echo site_url('/Budget/Edit/' . $accountID); ?>"><em class="icon ni ni-setting"></em><span>Account Settings</span></a></li>
app/Modules/User/Views/Budget/Recurring_Account/Schedule.php:101:                                        <td><a class="btn text-white btn-success" href="<?= site_url('Budget/Edit/' . $accountID); ?>">Edit</a></td>
app/Modules/User/Views/Budget/Recurring_Account/Schedule.php:121:                                    <a class="btn btn-danger text-white" href="<?= site_url('/Budget/Cancel-Account/' . $accountID); ?>">Cancel</a>
app/Modules/User/Views/Budget/Recurring_Account/Schedule.php:167:                                            <td class='text-center'><a class='data-more' href='" . site_url('Budget/Recurring-Account/Edit/' . ($accountID + $id)) . "'><em class='icon ni ni-pen2'></em></a></td>
app/Modules/User/Views/Budget/Recurring_Account/Schedule.php:240:                const response = await fetch("<?= site_url('/Budget/Approve-Recurring-Schedule/' . $accountID); ?>", {
app/Modules/User/Views/Budget/Recurring_Account/Schedule.php:254:                    window.location.href = "<?= site_url('/Budget'); ?>";
app/Modules/User/Views/Budget/Recurring_Account/Schedule-12282024.php:107:                                        <td><a class="btn text-white btn-success" href="<?= site_url('Budget/Edit/'.$accountID); ?>">Edit</a></td>
app/Modules/User/Views/Budget/Recurring_Account/Schedule-12282024.php:127:                                    <a class="btn btn-danger text-white" href="<?= site_url('/Budget/Cancel-Account/' . $accountID); ?>">Cancel</a>
app/Modules/User/Views/Budget/Recurring_Account/Schedule-12282024.php:160:                                            <td class="text-center"><a class="data-more" href="' . site_url('Budget/Recurring-Account/Edit/' . ($accountID + $id)) . '" onClick="email_Switch(this)"><em class="icon ni ni-pen2"></em></a></td>
app/Modules/User/Views/Budget/Recurring_Account/Schedule-12282024.php:196:                const response = await fetch("<?= site_url('/Budget/Approve-Recurring-Schedule/' . $accountID); ?>", {
app/Modules/User/Views/Budget/Recurring_Account/Schedule-12282024.php:206:                    window.location.href = "<?= site_url('/Budget'); ?>";
app/Modules/User/Views/Budget/Settings.php:12:                    <form id="budget-settings-form" action="<?= site_url('budget/settings/save') ?>" method="post">
app/Modules/User/Views/Budget/Settings.php:104:                                <a class="btn btn-secondary btn-block" href="<?= site_url('/Budget/' . $budgetType) ?>">Cancel</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.php:142:                                <!-- <a class="btn btn-success text-white" href="<?php //echo site_url('/Budget/Approve-Recurring-Schedule/' . $accountID); ?>">Approve</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.php:143:                                <a class="btn btn-danger text-white" href="<?php //echo site_url('/Budget/Cancel-Account/' . $accountID); ?>">Cancel</a> -->
app/Modules/User/Views/Budget/Recurring_Account_Schedule.php:176:                                    <td><a class="btn btn-success text-white" href="<?php echo site_url('Budget/Edit/' . $accountID); ?>">Edit</a></td>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.php:195:                                <a class="btn btn-success text-white" href="<?php echo site_url('/Budget/Approve-Recurring-Schedule/' . $accountID); ?>">Approve</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.php:196:                                <a class="btn btn-danger text-white" href="<?php echo site_url('/Budget/Cancel-Account/' . $accountID); ?>">Cancel</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.php:201:                                            <li><a href="<?php //echo site_url('/Budget/Edit/' . $accountID); ?>"><em class="icon ni ni-setting"></em><span>Account Settings</span></a></li>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.php:239:                                            <a class="data-more" href="' . site_url('Budget/Recurring-Account/Edit/' . $accountID . $account['recurring_account_order']) . '" onClick="email_Switch(this)"><em class="icon ni ni-pen2"></em></a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.php:297:                                                    <a class="data-more" href="' . site_url('Budget/Recurring-Account/Edit/' . $accountID . $account['recurring_account_order']) . '" onClick="email_Switch(this)"><em class="icon ni ni-pen2"></em></a>
app/Modules/User/Views/Budget/Details/bank_accounts.php:50:								<a href="<?php echo site_url('/Add-Wallet-Deposit/' . $accountID); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-plus"></em></a><span class="btn-extext">Deposit Funds</span>
app/Modules/User/Views/Budget/Details/bank_accounts.php:53:								<a href="<?php echo site_url('/Add-Wallet-Deposit/' . $accountID); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-plus"></em></a><span class="btn-extext">Transfer Funds</span>
app/Modules/User/Views/Budget/Details/bank_accounts.php:56:								<a href="<?php echo site_url('/Add-Wallet-Withdraw/' . $accountID); ?>" class="btn btn-icon btn-xl btn-primary"><em class="icon ni ni-arrow-to-right"></em></a><span class="btn-extext">Withdraw Funds</span>
app/Modules/User/Views/Budget/Details/bank_accounts.php:190:                    <a type="button" class="btn btn-success" href="' . site_url('Delete-Wallet/' . $accountID) . '">Yes</a>
app/Modules/User/Views/Budget/Details/bank_accounts.php:215:// 				<a type="button" class="btn btn-primary" href="' . site_url('Trade-Tracker/Delete/' . $trade_id . '/' . $redirect_url) . '">Yes</a>
app/Modules/User/Views/Budget/Details/bank_accounts.php:307:// 				<a type="button" class="btn btn-success" href="' . site_url('Delete-Wallet/' . $accountID) . '">Yes</a>
app/Modules/User/Views/Budget/Details/accounts.php:44:								<a href="<?php echo site_url('/Budget/Add/' . $recordType); ?>" class="btn btn-icon btn-lg btn-success"><em class="icon ni ni-plus"></em></a><span class="btn-extext">Add</span>
app/Modules/User/Views/Budget/Details/accounts.php:47:								<a href="<?php echo site_url('/Budget/Delete-Account/' . $recordID); ?>" class="btn btn-icon btn-lg btn-danger"><em class="icon ni ni-cross"></em></a><span class="btn-extext">Delete</span>
app/Modules/User/Views/Budget/Details/accounts.php:63:                                <!-- <a class="btn btn-success text-white" href="<?php //echo site_url('/Budget/Approve-Recurring-Schedule/' . $recordID); ?>">Approve</a>
app/Modules/User/Views/Budget/Details/accounts.php:64:                                <a class="btn btn-danger text-white" href="<?php //echo site_url('/Budget/Cancel-Account/' . $recordID); ?>">Cancel</a> -->
app/Modules/User/Views/Budget/Details/accounts.php:97:                                    <td><a class="btn btn-success text-white" href="<?php echo site_url('Budget/Edit/' . $recordID); ?>">Edit</a></td>
app/Modules/User/Views/Budget/Details/accounts.php:212:                                                $accountPaidStatus = '<a href="' . site_url('Budget/Status/Paid/' . $relatedRecords['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Budget/Details/accounts.php:215:                                                $accountPaidStatus = '<a class="statusGreen" href="' . site_url('Budget/Status/Unpaid/' . $relatedRecords['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Budget/Details/accounts.php:232:                                                <td><a href="' . site_url('Budget/Details/' . $relatedRecords['id']) . '">' . $relatedRecords['name'] . '</a></td>
app/Modules/User/Views/Budget/Details/accounts.php:238:                                                    <a href="' . site_url('Budget/Edit/' . $relatedRecords['id']) . '"><i class="icon  myfs-md ni ni-edit"></i></a>
app/Modules/User/Views/Budget/Details/accounts.php:239:                                                    <a href="' . site_url('Budget/Copy/' . $relatedRecords['id']) . '"><i class="icon  myfs-md ni ni-copy"></i></a>
app/Modules/User/Views/Budget/Details/accounts.php:240:                                                    <a class="text-red" href="' . site_url('Budget/Delete-Account/' . $relatedRecords['id']) . '"><i class="icon myfs-md ni ni-trash"></i></a>
app/Modules/User/Views/Budget/Details/Balance.php:26:                                    <a href="<?php echo site_url('/Edit-Wallet/' . $walletID); ?>">Edit Wallet</a>
app/Modules/User/Views/Budget/Details/Balance.php:48:                        <a href="<?php echo site_url('/Add-Wallet-Deposit/' . $walletID); ?>" class="btn btn-icon btn-xl btn-dark"><em class="icon ni ni-plus"></em></a><span class="btn-extext">Deposit Funds</span>
app/Modules/User/Views/Budget/Details/Balance.php:51:                        <a href="<?php echo site_url('/Add-Wallet-Withdraw/' . $walletID); ?>" class="btn btn-icon btn-xl btn-primary"><em class="icon ni ni-arrow-to-right"></em></a><span class="btn-extext">Withdraw Funds</span>
app/Modules/User/Views/Budget/Details/Title.php:26:                            <a href="<?php //echo site_url('/Exchange/Market/' . $wallet_market_pair . '/' . $wallet_market); ?>" class="btn btn-primary"><span>Trade <?= $wallet_market; ?></span> <em class="icon icon-arrow-right"></em></a>
app/Modules/User/Views/Budget/index copy.php:83:                                <p>Add <a href="<?php echo site_url('/Budget/Add/Income'); ?>"><strong>Income Accounts</strong></a> to update your Monthly Income Accounts.</p>
app/Modules/User/Views/Budget/index copy.php:85:                            <a href="<?php echo site_url('/Budget/Add/Income'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/index copy.php:93:                                <p>Add <a href="<?php echo site_url('/Budget/Add/Expense'); ?>"><strong>Expense Accounts</strong></a> to update your Monthly Expense Budget.</p>
app/Modules/User/Views/Budget/index copy.php:95:                            <a href="<?php echo site_url('/Budget/Add/Expense'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/index copy.php:103:                                <p>View, manage and analyze your <a href="<?php echo site_url('Budget/Forecast'); ?>"><strong><?php //echo $totalTransactions; ?> Financial Forecast &amp; 5-Year Projections</strong></a>.</p>
app/Modules/User/Views/Budget/index copy.php:105:                            <a href="<?php echo site_url('Exchanges'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/index copy.php:113:                                <p>View and manage your <a href="<?php echo site_url('Support/My-Requests'); ?>"><strong><?php //echo $totalTransactions; ?>Active Support Requests</strong></a> for additional assistance.</p>
app/Modules/User/Views/Budget/index copy.php:115:                            <a href="<?php echo site_url('Support/My-Requests'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/index copy.php:152:                                        <a href="<?php echo site_url('Budget/Income'); ?>">
app/Modules/User/Views/Budget/index copy.php:161:                                        <a href="<?php echo site_url('Budget/Expenses'); ?>">
app/Modules/User/Views/Budget/index copy.php:210:                                        <a class="btn btn-success text-white" href="<?php echo site_url('/Budget/Add/Income'); ?>"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/User/Views/Budget/index copy.php:211:                                        <a class="btn btn-danger text-white" href="<?php echo site_url('/Budget/Add/Expense'); ?>"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/User/Views/Budget/index copy.php:245:                                                $accountPaidStatus          = '<a href="' . site_url('Budget/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Budget/index copy.php:261:                                                    <a href="' . site_url('Budget/Edit/' . $account['id']) . '"><i class="icon  myfs-md ni ni-edit"></i></a>
app/Modules/User/Views/Budget/index copy.php:262:                                                    <a class="text-red" href="' . site_url('Budget/Delete-Account/' . $account['id']) . '"><i class="icon myfs-md ni ni-cross-circle"></i></a>
app/Modules/User/Views/Budget/index/historical_table.php:64:                    <td><a href='" . site_url('Budget/Details/' . htmlspecialchars($account['id'] ?? '')) . "'>" . htmlspecialchars($accountName) . "</a></td>
app/Modules/User/Views/Budget/index/historical_table.php:70:                        <a href='" . site_url('Budget/Edit/' . htmlspecialchars($account['id'] ?? '')) . "'><i class='icon myfs-md ni ni-edit'></i></a>
app/Modules/User/Views/Budget/index/historical_table.php:71:                        <a href='" . site_url('Budget/Copy/' . htmlspecialchars($account['id'] ?? '')) . "'><i class='icon myfs-md ni ni-copy'></i></a>
app/Modules/User/Views/Budget/index/historical_table.php:72:                        <a class='text-red' href='" . site_url('Budget/Delete-Account/' . htmlspecialchars($account['id'] ?? '')) . "'><i class='icon myfs-md ni ni-trash'></i></a>
app/Modules/User/Views/Budget/index/mobile_table.11152024.php:74:                                            <td><a class="badge badge-sm rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank</a></td>
app/Modules/User/Views/Budget/index/mobile_table.11152024.php:88:                                            <td><a class="badge badge-sm rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit</a></td>
app/Modules/User/Views/Budget/index/mobile_table.11152024.php:103:                                            $accountPaidStatus = $account['paid'] ? '' : '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Budget/index/mobile_table.11152024.php:109:                                                <td><a href="<?= site_url('Budget/Details/' . $account['id']); ?>"><?= $account['name']; ?></a></td>
app/Modules/User/Views/Budget/index/overview_chart.php:95:                    <a href="<?= site_url('Budget/Income'); ?>">
app/Modules/User/Views/Budget/index/overview_chart.php:109:                    <a href="<?= site_url('Budget/Expenses'); ?>">
app/Modules/User/Views/Budget/index/overview_chart.php:151:                    <a href="<?= site_url('Budget/Income'); ?>">
app/Modules/User/Views/Budget/index/overview_chart.php:165:                    <a href="<?= site_url('Budget/Expenses'); ?>">
app/Modules/User/Views/Budget/index/browser_table.php:59:      <a class="btn btn-success btn-sm text-white me-md-2" href="<?= site_url('Budget/Add/Income'); ?>">+ Add Income</a>
app/Modules/User/Views/Budget/index/browser_table.php:60:      <a class="btn btn-danger btn-sm text-white me-md-2" href="<?= site_url('Budget/Add/Expense'); ?>">+ Add Expense</a>
app/Modules/User/Views/Budget/index/browser_table.php:61:      <a class="btn btn-secondary btn-sm" href="<?= site_url('Budget/History'); ?>">View History</a>
app/Modules/User/Views/Budget/index/browser_table.php:96:              <a class="badge badge-sm bg-primary text-white" href="<?= site_url('Wallets'); ?>" title="Manage Wallets">
app/Modules/User/Views/Budget/index/browser_table.php:118:              <a class="badge badge-sm bg-primary text-white" href="<?= site_url('Wallets'); ?>" title="Manage Wallets">
app/Modules/User/Views/Budget/index/browser_table.php:145:                  '<a href="' . site_url('Budget/Status/Paid/' . $accountIdUrl) . '" class="js-mark-paid" title="Mark Paid"><i class="icon myfs-md ni ni-check-thick"></i></a>';          ?>
app/Modules/User/Views/Budget/index/browser_table.php:156:              <a href="<?= site_url('Budget/Details/' . $accountIdUrl); ?>">
app/Modules/User/Views/Budget/index/browser_table.php:165:              <a href="<?= site_url('Budget/Edit/' . $accountIdUrl); ?>" class="js-action" title="Edit"><i class="icon myfs-md ni ni-edit"></i></a>
app/Modules/User/Views/Budget/index/browser_table.php:166:              <a href="<?= site_url('Budget/Copy/' . $accountIdUrl); ?>" class="js-action" title="Copy"><i class="icon myfs-md ni ni-copy"></i></a>
app/Modules/User/Views/Budget/index/browser_table.php:167:              <a class="text-red js-action" href="<?= site_url('Budget/Delete-Account/' . $accountIdUrl); ?>" title="Delete"><i class="icon myfs-md ni ni-trash">
app/Modules/User/Views/Budget/index/active_table.php:113:    <a class="btn btn-success btn-sm text-white me-md-2" href="<?= site_url('Budget/Add/Income'); ?>">+ Add Income</a>
app/Modules/User/Views/Budget/index/active_table.php:114:    <a class="btn btn-danger btn-sm text-white me-md-2" href="<?= site_url('Budget/Add/Expense'); ?>">+ Add Expense</a>
app/Modules/User/Views/Budget/index/active_table.php:115:    <a class="btn btn-secondary btn-sm" href="<?= site_url('Budget/History'); ?>">View History</a>
app/Modules/User/Views/Budget/index/active_table.php:151:        <td><a class="badge badge-sm rounded-pill bg-primary text-white px-4" href="<?= site_url('/Wallets'); ?>">Bank Accounts</a></td>
app/Modules/User/Views/Budget/index/active_table.php:164:            <a class="badge badge-sm rounded-pill bg-primary text-white" href="<?= site_url('Wallets'); ?>"><i class="icon ni ni-edit"></i></a>
app/Modules/User/Views/Budget/index/active_table.php:173:        <td><a class="badge badge-sm rounded-pill bg-warning text-white px-4" href="<?= site_url('/Wallets'); ?>">Credit Accounts</a></td>
app/Modules/User/Views/Budget/index/active_table.php:186:            <a class="badge badge-sm rounded-pill bg-primary text-white" href="<?= site_url('Wallets'); ?>"><i class="icon ni ni-edit"></i></a>
app/Modules/User/Views/Budget/index/active_table.php:207:          <td><a href="<?= site_url('Budget/Details/' . $accountIdUrl); ?>"><?= esc($name); ?></a></td>
app/Modules/User/Views/Budget/index/active_table.php:217:                <a href="<?= site_url('Budget/Status/Paid/' . $accountIdUrl); ?>" title="Mark Paid"><i class="icon myfs-md ni ni-check-thick"></i></a>
app/Modules/User/Views/Budget/index/active_table.php:219:              <a href="<?= site_url('Budget/Edit/' . $accountIdUrl); ?>"><i class="icon ni ni-edit"></i></a>
app/Modules/User/Views/Budget/index/active_table.php:220:              <a href="<?= site_url('Budget/Copy/' . $accountIdUrl); ?>"><i class="icon ni ni-copy"></i></a>
app/Modules/User/Views/Budget/index/active_table.php:221:              <a class="text-red" href="<?= site_url('Budget/Delete-Account/' . $accountIdUrl); ?>"><i class="icon ni ni-trash"></i></a>
app/Modules/User/Views/Budget/index/mobile_table.php:90:              <a class="btn btn-outline-secondary btn-xs" href="<?= site_url('Budget/History'); ?>">
app/Modules/User/Views/Budget/index/mobile_table.php:217:          actions += '<a href="<?= site_url('Budget/Status/Paid/'); ?>'+id+'" class="btn btn-success btn-xs text-white me-1"><i class="ni ni-check-thick"></i> Paid</a>';
app/Modules/User/Views/Budget/index/mobile_table.php:219:        actions += '<a href="<?= site_url('Budget/Edit/'); ?>'+id+'" class="btn btn-primary btn-xs me-1"><i class="ni ni-edit"></i> Edit</a>';
app/Modules/User/Views/Budget/index/mobile_table.php:220:        actions += '<a href="<?= site_url('Budget/Copy/'); ?>'+id+'" class="btn btn-secondary btn-xs me-1"><i class="ni ni-copy"></i> Copy</a>';
app/Modules/User/Views/Budget/index/mobile_table.php:221:        actions += '<a href="<?= site_url('Budget/Delete-Account/'); ?>'+id+'" class="btn btn-danger btn-xs text-white"><i class="ni ni-trash"></i> Delete</a>';
app/Modules/User/Views/Budget/index/mobile_table.php:224:        actions += '<a href="<?= site_url('Wallets'); ?>" class="btn btn-primary btn-xs"><i class="ni ni-edit"></i> Manage</a>';
app/Modules/User/Views/Budget/index/browser_table.09122024.php:59:              <a class="badge badge-sm bg-primary text-white" href="<?= site_url('Wallets'); ?>">
app/Modules/User/Views/Budget/index/browser_table.09122024.php:75:              <a class="badge badge-sm bg-primary text-white" href="<?= site_url('Wallets'); ?>">
app/Modules/User/Views/Budget/index/browser_table.09122024.php:97:                  : '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Budget/index/browser_table.09122024.php:103:              <a href="<?= site_url('Budget/Details/' . $account['id']); ?>">
app/Modules/User/Views/Budget/index/browser_table.09122024.php:112:              <a href="<?= site_url('Budget/Edit/' . $account['id']); ?>"><i class="icon myfs-md ni ni-edit"></i></a>
app/Modules/User/Views/Budget/index/browser_table.09122024.php:113:              <a href="<?= site_url('Budget/Copy/' . $account['id']); ?>"><i class="icon myfs-md ni ni-copy"></i></a>
app/Modules/User/Views/Budget/index/browser_table.09122024.php:114:              <a class="text-red" href="<?= site_url('Budget/Delete-Account/' . $account['id']); ?>"><i class="icon myfs-md ni ni-trash"></i></a>
app/Modules/User/Views/Budget/index/browser_table.11152024.php:16:                                <!-- <a class="btn btn-success btn-sm text-white me-2 mb-2" href="<?php echo site_url('Budget/Add/Income'); ?>"><i class="icon ni ni-plus"></i> Income</a> -->
app/Modules/User/Views/Budget/index/browser_table.11152024.php:18:                                <!-- <a class="btn btn-danger btn-sm text-white me-2 mb-2" href="<?php echo site_url('Budget/Add/Expense'); ?>"><i class="icon ni ni-plus"></i> Expense</a> -->
app/Modules/User/Views/Budget/index/browser_table.11152024.php:21:                                <a class="btn btn-outline-secondary btn-sm me-2 mb-2" href="<?php echo site_url('Budget/History'); ?>"><i class="icon ni ni-history"></i> History</a>
app/Modules/User/Views/Budget/index/browser_table.11152024.php:104:                                            <td><a class="badge badge-sm rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a></td>
app/Modules/User/Views/Budget/index/browser_table.11152024.php:111:                                                <a class="badge badge-sm rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '"><i class="icon ni ni-edit"></i></a>
app/Modules/User/Views/Budget/index/browser_table.11152024.php:127:                                                <td><a class="badge badge-sm rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Budget/index/browser_table.11152024.php:134:                                                    <a class="badge badge-sm rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '"><i class="icon ni ni-edit"></i></a>
app/Modules/User/Views/Budget/index/browser_table.11152024.php:152:                                                <td><a href="' . site_url('Budget/Details/' . $schedule['account_id']) . '">' . $schedule['bank_name'] . '</a></td>
app/Modules/User/Views/Budget/index/browser_table.11152024.php:172:                                            $accountPaidStatus = $account['paid'] ? '' : '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Budget/index/browser_table.11152024.php:179:                                                <td><a href="<?= site_url('Budget/Details/' . $account['id']); ?>"><?= $account['name']; ?></a></td>
app/Modules/User/Views/Budget/index/browser_table.11152024.php:185:                                                    <a href="' . site_url('Budget/Edit/' . $account['id']) . '"><i class="icon myfs-md ni ni-edit"></i></a>
app/Modules/User/Views/Budget/index/browser_table.11152024.php:186:                                                    <a href="' . site_url('Budget/Copy/' . $account['id']) . '"><i class="icon myfs-md ni ni-copy"></i></a>
app/Modules/User/Views/Budget/index/browser_table.11152024.php:187:                                                    <a class="text-red" href="' . site_url('Budget/Delete-Account/' . $account['id']) . '"><i class="icon myfs-md ni ni-trash"></i></a>
app/Modules/User/Views/Budget/index/active_table-09212025.php:74:                <td><a class="badge badge-sm rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a></td>
app/Modules/User/Views/Budget/index/active_table-09212025.php:81:                    <a class="badge badge-sm rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Budget/index/active_table-09212025.php:94:                <td><a class="badge badge-sm rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Budget/index/active_table-09212025.php:101:                    <a class="badge badge-sm rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Budget/index/active_table-09212025.php:115:                $accountPaidStatus = $account['paid'] ? '' : '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Budget/index/active_table-09212025.php:122:                    <td><a href="<?= site_url('Budget/Details/' . $account['id']); ?>"><?= $account['name']; ?></a></td>
app/Modules/User/Views/Budget/index/active_table-09212025.php:128:                        <a href="' . site_url('Budget/Edit/' . $account['id']) . '"><i class="icon ni ni-edit"></i></a>
app/Modules/User/Views/Budget/index/active_table-09212025.php:129:                        <a href="' . site_url('Budget/Copy/' . $account['id']) . '"><i class="icon ni ni-copy"></i></a>
app/Modules/User/Views/Budget/index/active_table-09212025.php:130:                        <a class="text-red" href="' . site_url('Budget/Delete-Account/' . $account['id']) . '"><i class="icon ni ni-trash"></i></a>
app/Modules/User/Views/Budget/index/historical_table.orig.php:51:        //             <a class="badge badge-xs badge-dim rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a><br>
app/Modules/User/Views/Budget/index/historical_table.orig.php:63:        //         <td><a class="badge badge-sm badge-dim rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a></td>
app/Modules/User/Views/Budget/index/historical_table.orig.php:70:        //             <a class="badge badge-sm badge-dim rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Budget/index/historical_table.orig.php:87:        //         <td><a class="badge badge-xs badge-dim rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Budget/index/historical_table.orig.php:98:        //         <td><a class="badge badge-sm badge-dim rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Budget/index/historical_table.orig.php:105:        //             <a class="badge badge-sm badge-dim rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Budget/index/historical_table.orig.php:120:                $accountPaidStatus          = '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Budget/index/historical_table.orig.php:123:                $accountPaidStatus          = '<a class="statusRed" href="' . site_url('Budget/Status/Unpaid/' . $account['id']) . '"><i class="icon myfs-md ni ni-na"></i></a>';
app/Modules/User/Views/Budget/index/historical_table.orig.php:143:                    <td><a href="' . site_url('Budget/Details/' . $account['id']) . '">' . $accountNameDisplay . '</a></td>
app/Modules/User/Views/Budget/index/historical_table.orig.php:153:                    <td><a href="' . site_url('Budget/Details/' . $account['id']) . '">' . $account['name'] . '</a></td>
app/Modules/User/Views/Budget/index/historical_table.orig.php:161:                        //                     <a href="' . site_url('Wallets/' . $account['account_type'] . '/Details/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a>
app/Modules/User/Views/Budget/index/historical_table.orig.php:178:                        //                         <li><a href="' . site_url('Wallets/Attach-Account/' . $account['account_type'] . '/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a></li>    
app/Modules/User/Views/Budget/index/historical_table.orig.php:192:                        //                         <li><a href="' . site_url('Wallets/Attach-Account/' . $account['account_type'] . '/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a></li>    
app/Modules/User/Views/Budget/index/historical_table.orig.php:198:                        //                 <li><a href="' . site_url('Wallets') . '"><span><em class="icon icon-xs ni ni-plus"></em> Create Wallet</span></a></li>    
app/Modules/User/Views/Budget/index/historical_table.orig.php:209:                        <a href="' . site_url('Budget/Edit/' . $account['id']) . '"><i class="icon  myfs-md ni ni-edit"></i></a>
app/Modules/User/Views/Budget/index/historical_table.orig.php:210:                        <a href="' . site_url('Budget/Copy/' . $account['id']) . '"><i class="icon  myfs-md ni ni-copy"></i></a>
app/Modules/User/Views/Budget/index/historical_table.orig.php:211:                        <a class="text-red" href="' . site_url('Budget/Delete-Account/' . $account['id']) . '"><i class="icon myfs-md ni ni-trash"></i></a>
app/Modules/User/Views/Budget/index/control_center.php:27:                        Receives Rewards for completing your <a href="<?php echo site_url('MyMI-Gold/Goals/Daily'); ?>">Daily Goals for MyMIGold</a>! 
app/Modules/User/Views/Budget/index/control_center.php:30:                <a href="<?php echo site_url('MyMI-Gold/Goals/Daily'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/index/control_center.php:41:                        <a href="<?php echo site_url('Budget/Income'); ?>">Income Accounts</a> 
app/Modules/User/Views/Budget/index/control_center.php:46:                <a href="<?php echo site_url('Budget/Income'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/index/control_center.php:57:                        <a href="<?php echo site_url('Budget/Expenses'); ?>">Expense Accounts</a> 
app/Modules/User/Views/Budget/index/control_center.php:62:                <a href="<?php echo site_url('Budget/Expenses'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/index/control_center.php:73:                        <a href="<?php echo site_url('Wallets/Checking'); ?>">Checking Accounts</a> 
app/Modules/User/Views/Budget/index/control_center.php:77:                <a href="<?php echo site_url('/Wallets/Checking'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/index/control_center.php:88:                        <a href="<?php echo site_url('/Wallets/Credit'); ?>">Credit</a> 
app/Modules/User/Views/Budget/index/control_center.php:92:                <a href="<?php echo site_url('/Wallets/Credit'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/index/control_center.php:102:                        <a href="<?php echo site_url('/Wallets/Debt'); ?>">Debt</a> 
app/Modules/User/Views/Budget/index/control_center.php:106:                <a href="<?php echo site_url('/Wallets/Debt'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/index/control_center.php:119:                        <a href="<?php echo site_url('/Wallets/Investments'); ?>">Investments</a> 
app/Modules/User/Views/Budget/index/control_center.php:126:                <a href="<?php echo site_url('/Wallets/Investments'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/index/control_center.php:136:                        <a href="<?= site_url('/Memberships/Customize') ?>">Account Membership &amp; Services</a> 
app/Modules/User/Views/Budget/index/control_center.php:139:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Budget/index/control_center.php:157:                        <a href="<?php //echo site_url('/Budget/Income/Accounts'); ?>">Investments / Assets</a> 
app/Modules/User/Views/Budget/index/control_center.php:160:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Budget/index/control_center.php:165:                <a href="<?php //echo site_url('/Budget/Add/Expense'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/index/control_center.php:174:                    <p>View, manage and analyze your <a href="<?php //echo site_url('Budget/Forecast'); ?>"><strong><?php //echo $totalTransactions; ?> Financial Forecast &amp; 5-Year Projections</strong></a>.</p>
app/Modules/User/Views/Budget/index/control_center.php:176:                <a href="<?php //echo site_url('Exchanges'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Budget/index/historical_table.11152024.php:51:        //             <a class="badge badge-xs badge-dim rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a><br>
app/Modules/User/Views/Budget/index/historical_table.11152024.php:63:        //         <td><a class="badge badge-sm badge-dim rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a></td>
app/Modules/User/Views/Budget/index/historical_table.11152024.php:70:        //             <a class="badge badge-sm badge-dim rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Budget/index/historical_table.11152024.php:87:        //         <td><a class="badge badge-xs badge-dim rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Budget/index/historical_table.11152024.php:98:        //         <td><a class="badge badge-sm badge-dim rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Budget/index/historical_table.11152024.php:105:        //             <a class="badge badge-sm badge-dim rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Budget/index/historical_table.11152024.php:120:                $accountPaidStatus          = '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Budget/index/historical_table.11152024.php:123:                $accountPaidStatus          = '<a class="statusRed" href="' . site_url('Budget/Status/Unpaid/' . $account['id']) . '"><i class="icon myfs-md ni ni-na"></i></a>';
app/Modules/User/Views/Budget/index/historical_table.11152024.php:143:                    <td><a href="' . site_url('Budget/Details/' . $account['id']) . '">' . $accountNameDisplay . '</a></td>
app/Modules/User/Views/Budget/index/historical_table.11152024.php:153:                    <td><a href="' . site_url('Budget/Details/' . $account['id']) . '">' . $account['name'] . '</a></td>
app/Modules/User/Views/Budget/index/historical_table.11152024.php:161:                        //                     <a href="' . site_url('Wallets/' . $account['account_type'] . '/Details/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a>
app/Modules/User/Views/Budget/index/historical_table.11152024.php:178:                        //                         <li><a href="' . site_url('Wallets/Attach-Account/' . $account['account_type'] . '/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a></li>    
app/Modules/User/Views/Budget/index/historical_table.11152024.php:192:                        //                         <li><a href="' . site_url('Wallets/Attach-Account/' . $account['account_type'] . '/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a></li>    
app/Modules/User/Views/Budget/index/historical_table.11152024.php:198:                        //                 <li><a href="' . site_url('Wallets') . '"><span><em class="icon icon-xs ni ni-plus"></em> Create Wallet</span></a></li>    
app/Modules/User/Views/Budget/index/historical_table.11152024.php:209:                        <a href="' . site_url('Budget/Edit/' . $account['id']) . '"><i class="icon  myfs-md ni ni-edit"></i></a>
app/Modules/User/Views/Budget/index/historical_table.11152024.php:210:                        <a href="' . site_url('Budget/Copy/' . $account['id']) . '"><i class="icon  myfs-md ni ni-copy"></i></a>
app/Modules/User/Views/Budget/index/historical_table.11152024.php:211:                        <a class="text-red" href="' . site_url('Budget/Delete-Account/' . $account['id']) . '"><i class="icon myfs-md ni ni-trash"></i></a>
app/Modules/User/Views/Budget/Edit.php:4:$defaultRedirect = site_url('/Budget');
app/Modules/User/Views/Budget/Edit.php:52:    $copyButtonURL                      = site_url('/Budget/Copy/' . $accountID);
app/Modules/User/Views/Budget/Edit.php:58:    $copyButtonURL                      = site_url('/Budget/Copy/' . $accountID);
app/Modules/User/Views/Budget/Edit.php:64:    $copyButtonURL                      = site_url('/Budget/Edit/' . $accountID);
app/Modules/User/Views/Budget/Edit.php:103:$accountTypeAltURl                          = site_url('/Budget/Add/' . $accountType);
app/Modules/User/Views/Budget/Edit.php:173:                            <li><a href="<?php echo site_url('/Budget'); ?>" class="btn btn-danger btn-dim btn-outline-primary"><em class="icon ni ni-cross"></em><span>Cancel</span></a></li>
app/Modules/User/Views/Budget/Edit.php:213:                                        <a href="<?php echo site_url('/Budget'); ?>" class="btn btn-danger btn-dim btn-outline-primary"><em class="icon ni ni-cross"></em><span>Cancel</span></a></li>
app/Modules/User/Views/Budget/Edit.php:234:let redirectURL = "<?= site_url('/Budget'); ?>";
app/Modules/User/Views/Budget/Edit.php:243:        // const redirectURL                   = <?php //echo '\'' . site_url('/Budget/Recurring-Account/Schedule') . '\'';?>;
app/Modules/User/Views/Budget/Edit.php:246:        // const redirectURL                   = <?php //echo '\'' . site_url('/Budget') . '\'';?>;
app/Modules/User/Views/Budget/Edit.php:249:    // const redirectURL                       = <?php //echo '\'' . site_url('/Budget') . '\'';?>;
app/Modules/User/Views/Budget/Edit.php:288:            const result = await fetch("<?php echo site_url('Budget/Account-Manager'); ?>", {
app/Modules/User/Views/Budget/Edit.php:302:            // location.href = <?php // echo '\'' . site_url('/Budget') . '\'';?>;
app/Modules/User/Views/Budget/Recurring_Account_Schedule.working102322.php:294:                                <a class="btn btn-success text-white" href="<?php echo site_url('/Budget/Approve-Recurring-Schedule/' . $accountID); ?>">Approve</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.working102322.php:295:                                <a class="btn btn-danger text-white" href="<?php echo site_url('/Budget/Cancel-Account/' . $accountID); ?>">Cancel</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.working102322.php:300:                                            <li><a href="<?php //echo site_url('/Budget/Edit/' . $accountID); ?>"><em class="icon ni ni-setting"></em><span>Account Settings</span></a></li>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.working102322.php:325:                                <a class="btn btn-success text-white" href="<?php echo site_url('/Budget/Approve-Recurring-Schedule/' . $accountID); ?>">Approve</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.working102322.php:326:                                <a class="btn btn-danger text-white" href="<?php echo site_url('/Budget/Cancel-Account/' . $accountID); ?>">Cancel</a>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.working102322.php:331:                                            <li><a href="<?php //echo site_url('/Budget/Edit/' . $accountID); ?>"><em class="icon ni ni-setting"></em><span>Account Settings</span></a></li>
app/Modules/User/Views/Budget/Recurring_Account_Schedule.working102322.php:456:                                            <li><a href="<?php //echo site_url('/Budget/Edit/' . $accountID); ?>"><em class="icon ni ni-setting"></em><span>Account Settings</span></a></li>
app/Modules/User/Views/Budget/Copy-12242023.php:54:$accountTypeAltURl                      = site_url('/Budget/Add/' . $accountType);
app/Modules/User/Views/Budget/Copy-12242023.php:172:        // const redirectURL                   = <?php //echo '\'' . site_url('/Budget/Recurring-Account/Schedule') . '\'';?>;
app/Modules/User/Views/Budget/Copy-12242023.php:175:        // const redirectURL                   = <?php //echo '\'' . site_url('/Budget') . '\'';?>;
app/Modules/User/Views/Budget/Copy-12242023.php:178:    const redirectURL                       = <?php echo '\'' . site_url('/Budget') . '\'';?>;
app/Modules/User/Views/Budget/Copy-12242023.php:201:            const result = await fetch("<?= site_url('User/Budget/Account_Manager'); ?>", {
app/Modules/User/Views/Budget/Copy-12242023.php:216:                    location.href = <?php echo '\'' . site_url('/Budget/Recurring-Account/Schedule/' . $accountID) . '\'';?>;
app/Modules/User/Views/Budget/Copy-12242023.php:218:                    location.href = <?php echo '\'' . site_url('/Budget') . '\'';?>;
app/Modules/User/Views/Budget/Copy-12242023.php:221:                location.href = <?php echo '\'' . site_url('/Budget') . '\'';?>;
app/Modules/User/Views/Advisors/index.php:38:                                        <a href="<?= site_url('/CertifiedAdvisor/view/'.$advisor['id']) ?>">View</a> |
app/Modules/User/Views/Advisors/index.php:39:                                        <a href="<?= site_url('/CertifiedAdvisor/edit/'.$advisor['id']) ?>">Edit</a> |
app/Modules/User/Views/Advisors/index.php:40:                                        <a href="<?= site_url('/CertifiedAdvisor/delete/'.$advisor['id']) ?>" onclick="return confirm('Are you sure?')">Delete</a>
app/Modules/User/Views/Predictions/view.php:16:    <a href="<?=site_url('Predictions/Markets')?>" class="btn btn-outline-secondary">Back</a>
app/Modules/User/Views/Predictions/view.php:98:    const rsp = await fetch('<?=site_url('API/Predictions/orders/place')?>', {
app/Modules/User/Views/Predictions/markets.php:50:            <a class="btn btn-primary" href="<?=site_url('Predictions/Market/'.$m['id'])?>">View</a>
app/Modules/User/Views/Knowledgebase/Technical_Support.php:78:                                                    <li><a href="<?php echo site_url('Investor-Profile'); ?>">Investor Profile</a></li>
app/Modules/User/Views/Knowledgebase/Technical_Support.php:119:                                                    <li class="list-group-item"><a href="<?php echo site_url('Support'); ?>">Customer Support</a></li>
app/Modules/User/Views/Knowledgebase/Technical_Support.php:160:                                                    <li><a href="<?php echo site_url('Investor-Profile'); ?>">Investor Profile</a></li>
app/Modules/User/Views/Knowledgebase/Investor_Profile.php:97:                                                    <li class="list-group-item"><a href="#<?php //echo site_url('Free/register'); ?>">List of Financial Brokerages</a></li>
app/Modules/User/Views/Knowledgebase/Integrating_Wallets.php:122:                                                    <li class="list-group-item"><a href="<?php // echo site_url('Support/Check-KYC-Verification'); ?>">Premium Brokerage Integration</a></li>
app/Modules/User/Views/Knowledgebase/Integrating_Wallets.php:149:                                                    <li class="list-group-item"><a href="<?php // echo site_url('Support/Check-KYC-Verification'); ?>">Premium Brokerage Integration</a></li>
app/Modules/User/Views/Knowledgebase/includes/Assets/asset_creator.php:20:                                        <li class="list-group-item"><a href="<?= site_url('Knowledgebase/Assets') ?>">What are Assets?</a></li>
app/Modules/User/Views/Knowledgebase/includes/Assets/mymi_exchange.php:167:                                    <li class="list-group-item"><a href="<?= site_url('Knowledgebase/MyMI-Partnerships') ?>">Partnership Accounts</a></li>
app/Modules/User/Views/Knowledgebase/includes/Assets/mymi_exchange.php:168:                                    <li class="list-group-item"><a href="<?= site_url('Knowledgebase/KYC-Verification') ?>">KYC Verification</a></li>
app/Modules/User/Views/Knowledgebase/includes/Assets/mymi_exchange.php:169:                                    <li class="list-group-item"><a href="#<?= site_url('Knowledgebase/KYC-Verification') ?>">Additional MyMI Exchange Requirements</a></li>
app/Modules/User/Views/Knowledgebase/includes/Assets/mymi_marketplace.php:217:                                    <li class="list-group-item"><a href="<?= site_url('Knowledgebase/MyMI-Partnerships') ?>">Partnership Accounts</a></li>
app/Modules/User/Views/Knowledgebase/includes/Assets/mymi_marketplace.php:218:                                    <li class="list-group-item"><a href="<?= site_url('Knowledgebase/KYC-Verification') ?>">KYC Verification</a></li>
app/Modules/User/Views/Knowledgebase/includes/Assets/mymi_marketplace.php:219:                                    <li class="list-group-item"><a href="#<?= site_url('Knowledgebase/KYC-Verification') ?>">Additional MyMI Exchange Requirements</a></li>
app/Modules/User/Views/Knowledgebase/includes/navigation.php:12:                                <a class="btn btn-primary btn-md" href="<?php echo site_url('Knowledgebase/Getting-Started'); ?>">Learn more</a>
app/Modules/User/Views/Knowledgebase/includes/navigation.php:30:                                <a class="btn btn-primary btn-md" href="<?php echo site_url('Announcements'); ?>">Learn more</a>
app/Modules/User/Views/Knowledgebase/includes/navigation.php:48:                                <a class="btn btn-primary btn-md" href="<?php echo site_url('Knowledgebase/Account-And-Billing'); ?>">Learn more</a>
app/Modules/User/Views/Knowledgebase/includes/Customer_Support/contact_support.php:18:                                If you need to reach out to <a href="<?= site_url('Support') ?>">Customer Support</a>, you can submit a ticket or reach out to us via Social Media via the links below:
app/Modules/User/Views/Knowledgebase/includes/Customer_Support/contact_support.php:22:                                    <a class="btn btn-outline-primary" href="<?= site_url('Support') ?>">
app/Modules/User/Views/Knowledgebase/includes/Referral_Program/getting_started.php:13:                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">Referral Program Application</a></li>
app/Modules/User/Views/Knowledgebase/includes/Referral_Program/getting_started.php:20:                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">MyMI Existing Membership</a></li>
app/Modules/User/Views/Knowledgebase/includes/Referral_Program/getting_started.php:21:                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">KYC Verification</a></li>
app/Modules/User/Views/Knowledgebase/includes/Referral_Program/getting_started.php:22:                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">Terms &amp; Agreements</a></li>
app/Modules/User/Views/Knowledgebase/includes/Referral_Program/more_details.php:13:                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/Types-Of-Accounts#partner-referrals'); ?>">MyMI Referral Program</a></li>
app/Modules/User/Views/Knowledgebase/includes/KYC_Verification/kyc_regulations.php:20:                                    <li class="list-group-item"><a href="<?php // echo site_url('Knowledgebase/KYC-Requirements'); ?>" target="_blank">Corporate Transparency Act (CTA)</a></li>
app/Modules/User/Views/Knowledgebase/includes/KYC_Verification/more_details.php:13:                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/KYC-Verification'); ?>">KYC Verification Process</a></li>
app/Modules/User/Views/Knowledgebase/includes/KYC_Verification/kyc_requirements.php:14:                                    <li class="list-group-item"><a href="<?php // echo site_url('Support/Check-KYC-Verification'); ?>">Check KYC Status</a></li>
app/Modules/User/Views/Knowledgebase/includes/KYC_Verification/kyc_requirements.php:37:                                    <li class="list-group-item"><a href="<?php // echo site_url('Knowledgebase/KYC-Requirements'); ?>">Registration Number/EIN</a></li>
app/Modules/User/Views/Knowledgebase/includes/KYC_Verification/kyc_requirements.php:38:                                    <li class="list-group-item"><a href="<?php // echo site_url('Knowledgebase/KYC-Requirements'); ?>">Company Name & Address Verification</a></li>
app/Modules/User/Views/Knowledgebase/includes/KYC_Verification/kyc_requirements.php:39:                                    <li class="list-group-item"><a href="<?php // echo site_url('Knowledgebase/KYC-Requirements'); ?>">Secretary of State Status</a></li>
app/Modules/User/Views/Knowledgebase/includes/KYC_Verification/kyc_requirements.php:40:                                    <li class="list-group-item"><a href="<?php // echo site_url('Knowledgebase/KYC-Requirements'); ?>">Key Management Personel Verification</a></li>
app/Modules/User/Views/Knowledgebase/includes/KYC_Verification/kyc_requirements.php:41:                                    <li class="list-group-item"><a href="<?php // echo site_url('Knowledgebase/KYC-Requirements'); ?>">Ownership Structure & Percentage of Ownership(s)</a></li>
app/Modules/User/Views/Knowledgebase/includes/KYC_Verification/kyc_requirements.php:42:                                    <li class="list-group-item"><a href="<?php // echo site_url('Knowledgebase/KYC-Requirements'); ?>">Ultimate Beneficial Owners (UBOs)</a></li>
app/Modules/User/Views/Knowledgebase/includes/KYC_Verification/kyc_requirements.php:65:                                    <li class="list-group-item"><a href="<?php // echo site_url('Knowledgebase/KYC-Requirements'); ?>">Account Reviews</a></li>
app/Modules/User/Views/Knowledgebase/includes/KYC_Verification/kyc_requirements.php:66:                                    <li class="list-group-item"><a href="<?php // echo site_url('Knowledgebase/KYC-Requirements'); ?>">Transactional Analysis/Auditing</a></li>
app/Modules/User/Views/Knowledgebase/includes/KYC_Verification/kyc_requirements.php:67:                                    <li class="list-group-item"><a href="<?php // echo site_url('Knowledgebase/KYC-Requirements'); ?>">KYC Status Reviews</a></li>
app/Modules/User/Views/Knowledgebase/includes/KYC_Verification/periodic_due_diligence.php:14:                                    <li class="list-group-item"><a href="<?php // echo site_url('Knowledgebase/KYC-Requirements'); ?>">Account Reviews</a></li>
app/Modules/User/Views/Knowledgebase/includes/KYC_Verification/periodic_due_diligence.php:15:                                    <li class="list-group-item"><a href="<?php // echo site_url('Knowledgebase/KYC-Requirements'); ?>">Transactional Analysis/Auditing</a></li>
app/Modules/User/Views/Knowledgebase/includes/KYC_Verification/periodic_due_diligence.php:16:                                    <li class="list-group-item"><a href="<?php // echo site_url('Knowledgebase/KYC-Requirements'); ?>">KYC Status Reviews</a></li>
app/Modules/User/Views/Knowledgebase/includes/Investor_Account/tools.php:14:                                    <li class="list-group-item"><a href="<?php echo site_url('Wallets'); ?>">MyMI Wallets</a></li>
app/Modules/User/Views/Knowledgebase/includes/Investor_Account/tools.php:15:                                    <li class="list-group-item"><a href="<?php echo site_url('Trade-Tracker'); ?>">Trade Tracker</a></li>
app/Modules/User/Views/Knowledgebase/includes/Partnerships/full_content.php:23:                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/MyMI-Partnerships'); ?>">MyMI Partnerships</a></li>
app/Modules/User/Views/Knowledgebase/includes/Partnerships/full_content.php:43:                                To get started, if you're new to MyMI Wallet, you simply complete a MyMI Partnership Application (by clicking <a href="<?php echo site_url('Partner/register'); ?>">here!</a>). 
app/Modules/User/Views/Knowledgebase/includes/Partnerships/full_content.php:44:                                If you're an existing member, you can simply upgrade your membership by visiting <a href="<?php echo site_url('/Subscriptions'); ?>">My Subscriptions</a> under <strong>My Account</strong>. 
app/Modules/User/Views/Knowledgebase/includes/Partnerships/full_content.php:50:                                    <li class="list-group-item"><a href="<?php echo site_url('Partner/register'); ?>">Partnership Registration</a></li>
app/Modules/User/Views/Knowledgebase/includes/Partnerships/full_content.php:51:                                    <li class="list-group-item"><a href="<?php echo site_url('Subscriptions'); ?>">Upgrade to Partner</a></li>
app/Modules/User/Views/Knowledgebase/includes/Partnerships/more_details.php:13:                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/Types-Of-Accounts'); ?>">Partnership Accounts</a></li>
app/Modules/User/Views/Knowledgebase/includes/Partnerships/more_details.php:14:                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/MyMI-Partnerships'); ?>">MyMI Partnerships</a></li>
app/Modules/User/Views/Knowledgebase/Account_Billing.php:62:                                    For the most part, you can easily edit your personal account information via your <a href="<?php echo site_url('Investor-Profile'); ?>">Investor Profile</a>. For any additional information that may be required such as <a href="#">KYC Verification Documentation</a>, Required Company Documentation for our Partner Program will be requested on a per-account basis. All requests for information will be provided with notification via email (<a href="mailto:support@mymiwallet.com">support@mymiwallet.com</a>) and completed within the MyMI Wallet Dashboard. Any documentation requested from any other communication could be potential for fraud and spam. Please disregard if this were ever to be the case.
app/Modules/User/Views/Knowledgebase/Account_Billing.php:179:                                    You can review your Payment History by visiting your <a href="<?php echo site_url('Investor-Profile'); ?>">Investor Profile</a> and selecting the <a href="<?php echo site_url('Investor-Profile'); ?>">Billing / Payment</a> tab to view and manage your billing and payment history.<br>
app/Modules/User/Views/Knowledgebase/Account_Billing.php:181:                                        <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/Types-Of-Accounts'); ?>">View Billing & Payment History</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:126:                                                    <li class="list-group-item"><a href="<?php echo site_url($free_registration); ?>">Register Account</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:133:                                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/Types-Of-Accounts'); ?>">Types of Accounts</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:154:                                                To gain access to your account and Investor Dashboard, visit <a href="<?php echo site_url('login'); ?>">https://www.mymiwallet.com/login</a>.<br> 
app/Modules/User/Views/Knowledgebase/Getting_Started.php:156:                                                    <li class="list-group-item"><a href="<?php echo site_url('login'); ?>">Login Now!</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:192:                                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/KYC-Verification'); ?>">KYC Process &amp; Requirements</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:193:                                                    <li class="list-group-item"><a href="<?php echo site_url('Support/Check-KYC-Verification'); ?>">Check KYC Status</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:216:                                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/Investor-Profile'); ?>">Updating Investor Profile</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:257:                                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/Integrating-Wallets#completing-kyc-verification'); ?>">What are MyMI Wallets?</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:263:                                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/Integrating-Wallets#individual-required-information'); ?>">How to Manually Track Trades</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:264:                                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/Integrating-Wallets#manually-integrated-wallets'); ?>">How to Integrate Brokerage Accounts</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:286:                                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">"What's With This Trade Tracker?"</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:328:                                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">How to customize the Trade Tracker</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:329:                                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">MyMI Trade Tracker - In-Depth Overview</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:360:                                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">Ways to Backtest Your Investments</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:361:                                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">Trend Analysis &amp; Forecasting Your Investments</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:362:                                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">Import/Exporting Real-Time & Historical Data</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:363:                                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">Share Trade Analysis</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:364:                                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">Get The CommunityInvolved</a></li>
app/Modules/User/Views/Knowledgebase/Getting_Started.php:365:                                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">MyMI Trade Tracker - In-Depth Overview</a></li>
app/Modules/User/Views/Knowledgebase/Types_Of_Accounts.php:119:                                                    <li class="list-group-item"><a href="#<?php echo site_url('Knowledgebase/Investor-Profile'); ?>">Updating Investor Profile</a></li>
app/Modules/User/Views/Knowledgebase/Types_Of_Accounts.php:162:                                                    <li class="list-group-item"><a href="<?php echo site_url('Partner/register'); ?>">Register A Partner Account</a></li>
app/Modules/User/Views/Knowledgebase/Types_Of_Accounts.php:163:                                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/KYC-Verification'); ?>">KYC Verifications & Policy</a></li>
app/Modules/User/Views/Knowledgebase/Types_Of_Accounts.php:164:                                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/Partner-Service-Agreement'); ?>">Partner Service Agreement <?php // Needs Page Built ?></a></li>
app/Modules/User/Views/Knowledgebase/Types_Of_Accounts.php:188:                                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/MyMI-Partnerships#periodic-due-diligence-reporting'); ?>">What are Partner Assets?</a></li>
app/Modules/User/Views/Knowledgebase/Types_Of_Accounts.php:189:                                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/MyMI-Partnerships#types-of-mymi-assets'); ?>">Partner Asset Creator</a></li>
app/Modules/User/Views/Knowledgebase/Types_Of_Accounts.php:196:                                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/MyMI-Partnerships#mymi-marketplace-requirements'); ?>">MyMI Exchange</a></li>
app/Modules/User/Views/Knowledgebase/Types_Of_Accounts.php:197:                                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/MyMI-Partnerships#mymi-exchange'); ?>">How To Request Coin Listing</a></li>
app/Modules/User/Views/Knowledgebase/Types_Of_Accounts.php:198:                                                    <li class="list-group-item"><a href="<?php echo site_url('Knowledgebase/MyMI-Partnerships#listing-assets-marketplace'); ?>">How Are Assets Valued?</a></li>
app/Modules/User/Views/Knowledgebase/Types_Of_Accounts.php:227:                                                    <li class="list-group-item"><a href="#<?php echo site_url('My-Referrals'); ?>">Partner Referral Portal</a></li>
app/Modules/User/Views/Knowledgebase/Types_Of_Accounts.php:228:                                                    <li class="list-group-item"><a href="#<?php echo site_url('My-Referrals/Reporting'); ?>">Reporting & Analytics</a></li>
app/Modules/User/Views/Knowledgebase/Types_Of_Accounts.php:229:                                                    <li class="list-group-item"><a href="#<?php echo site_url('My-Referrals/Distributions'); ?>">Revenue Distributions</a></li>
app/Modules/User/Views/Knowledgebase/Types_Of_Accounts.php:276:                                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">How Investor Referrals Work</a></li>
app/Modules/User/Views/Knowledgebase/Types_Of_Accounts.php:305:                                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">How Distributions Are Determined</a></li>
app/Modules/User/Views/Knowledgebase/Types_Of_Accounts.php:306:                                                    <li class="list-group-item"><a href="#<?php //echo site_url('login'); ?>">Schedule of Monthly Distributions</a></li>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Technical_Support.php:19:                            <a class="btn btn-outline-primary" href="<?php echo site_url('Knowledgebase/Technical-Support'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Technical_Support.php:27:                            <a class="btn btn-outline-primary" href="<?php echo site_url('Knowledgebase/Technical-Support#managing-account-security'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Technical_Support.php:35:                            <a class="btn btn-outline-primary" href="<?php echo site_url('Knowledgebase/Technical-Support#reporting-bugs'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Technical_Support.php:43:                            <a class="btn btn-outline-primary" href="<?php echo site_url('Knowledgebase/Technical-Support#managing-support-tickets'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Wallets/Edit_Account/banking_fields.php:25:                <a class="btn btn-primary btn-sm" href="<?php echo site_url('/Support'); ?>"><i class="icon ni ni-envelope"></i>Contact Support</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Assets.php:19:                            <a class="btn btn-outline-primary" href="<?php echo site_url('Knowledgebase/Assets#how-do-you-own-mymi-assets'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Assets.php:27:                            <a class="btn btn-outline-primary" href="<?php echo site_url('Knowledgebase/Assets#asset_creator'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Assets.php:35:                            <a class="btn btn-outline-primary" href="<?php echo site_url('Knowledgebase/Assets#mymi-marketplace-requirements'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Assets.php:43:                            <a class="btn btn-outline-primary" href="<?php echo site_url('Knowledgebase/Assets#exchanging-assets'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Account_Billing.php:24:                <a class="btn btn-outline-primary" href="<?php echo site_url('Knowledgebase/Account-And-Billing'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Account_Billing.php:32:                <a class="btn btn-outline-primary" href="<?php echo site_url('Knowledgebase/Account-And-Billing#how-is-mymi-gold-valued'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Account_Billing.php:40:                <a class="btn btn-outline-primary" href="<?php echo site_url('Knowledgebase/Account-And-Billing#how-is-mymi-gold-valued'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Account_Billing.php:48:                <a class="btn btn-outline-primary" href="<?php echo site_url('Knowledgebase/Account-And-Billing#asset-distribution'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Partners.php:19:                            <a class="btn btn-outline-primary" href="<?php echo site_url('/Knowledgebase/MyMI-Partnerships'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Partners.php:27:                            <a class="btn btn-outline-primary" href="<?php echo site_url('/Knowledgebase/MyMI-Partnerships#getting-starting-with-kyc-verification'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Partners.php:35:                            <a class="btn btn-outline-primary" href="<?php echo site_url('/Knowledgebase/MyMI-Partnerships#coin-redistribution'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Partners.php:43:                            <a class="btn btn-outline-primary" href="<?php echo site_url('/Knowledgebase/MyMI-Partnerships#exchanging-assets'); ?>" data-abc="true">Read More</a>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/MyMIGold/includes/production_tutorials.php:21:        <p class="mb-4">Once your order is completed, you will receive <strong class="text-primary"><?= $total; ?> MyMI Gold</strong> in your <a class="text-primary fw-bold" href="' . site_url('/MyMI-Wallet') . '">MyMI Wallet</a>. While in <strong class="text-primary">Beta</strong>, you will not be charged. For more information and assistance, click below:</p><br>
app/Modules/User/Views/Knowledgebase/Tutorials/Categories/Budget/Add.php:25:                <a class="btn btn-primary btn-sm" href="<?php echo site_url('/Support'); ?>"><i class="icon ni ni-envelope"></i>Contact Support</a>
app/Modules/User/Views/Investments/resources/watchlist.php:38:                        <form action="<?= site_url('add-to-watchlist') ?>" method="post">
app/Modules/User/Views/Investments/resources/watchlist.php:49:                        <form action="<?= site_url('remove-from-watchlist') ?>" method="post">
app/Modules/User/Views/Investments/resources/set_alerts.php:51:                                        <a href="<?= site_url('/investments/deleteAlert/' . $alert['id']) ?>" class="btn btn-sm btn-danger">Delete</a>
app/Modules/User/Views/Investments/resources/manage_trade.php:14:                            <a href="<?= site_url('/investments/addTrade') ?>" class="btn btn-primary">Add New Trade</a>
app/Modules/User/Views/Investments/resources/manage_trade.php:37:                                        <a href="<?= site_url('/investments/editTrade/' . $trade['id']) ?>" class="btn btn-sm btn-warning">Edit</a>
app/Modules/User/Views/Investments/resources/manage_trade.php:38:                                        <a href="<?= site_url('/investments/deleteTrade/' . $trade['id']) ?>" class="btn btn-sm btn-danger">Delete</a>
app/Modules/User/Views/Investments/Add.php:153:    const investmentsUrl = "<?php echo site_url('/Investments'); ?>";
app/Modules/User/Views/Investments/Add.php:158:            const baseUrl = "<?php echo site_url('/API/Investments/getSymbolsByTradeType'); ?>";
app/Modules/User/Views/Investments/Add.php:218:        let baseUrl = "<?php echo site_url('Investments/API/fetchRealTimeData/'); ?>";
app/Modules/User/Views/Investments/Add.php:266:        fetch('<?= site_url('/Investments/Account-Manager'); ?>', {
app/Modules/User/Views/Investments/tradeTracker.php:22:            <a class="btn btn-primary" href="<?= site_url('/Investments') ?>">
app/Modules/User/Views/Investments/tradeTracker.php:191:            url: "<?= site_url('Trade-Tracker/getTradeData') ?>",
app/Modules/User/Views/Investments/tradeTracker.php:310:            url: "<?= site_url('Trade-Tracker/saveTradeData') ?>",
app/Modules/User/Views/Investments/includes/header.php:20:                                                    <li><a href="<?php // echo site_url('Investments/Add/Bond'); ?>#" class="dynamicModalLoader" data-formtype="Investments" data-endpoint="addBondTrade"><span>Bond</span></a></li>
app/Modules/User/Views/Investments/includes/header.php:21:                                                    <li><a href="<?php // echo site_url('Investments/Add/Crypto'); ?>#" class="dynamicModalLoader" data-formtype="Investments" data-endpoint="addCryptoTrade"><span>Crypto</span></a></li>
app/Modules/User/Views/Investments/includes/header.php:22:                                                    <li><a href="<?php // echo site_url('Investments/Add/Options'); ?>#" class="dynamicModalLoader" data-formtype="Investments" data-endpoint="addOptionsTrade"><span>Options</span></a></li>
app/Modules/User/Views/Investments/includes/header.php:23:                                                    <li><a href="<?php // echo site_url('Investments/Add/Stock'); ?>#" class="dynamicModalLoader" data-formtype="Investments" data-endpoint="addStockTrade"><span>Stock</span></a></li>
app/Modules/User/Views/Investments/tradeTracker copy 2.php:12:<a class="btn btn-primary" href="<?= site_url('/Investments') ?>">
app/Modules/User/Views/Investments/tradeTracker copy 2.php:78:        fetch('<?= site_url('/Investments/saveTradeTracker') ?>', {
app/Modules/User/Views/Investments/services.php:1:<a class="btn btn-primary" href="<?= site_url('/Investments') ?>">
app/Modules/User/Views/Investments/services.php:32:                            <a href="<?= site_url('/Investments/Details/' . urlencode($service['name'])) ?>" class="btn btn-primary">
app/Modules/User/Views/Investments/tradeTracker-full-functionality.php:12:            <a class="btn btn-primary" href="<?= site_url('/Investments') ?>">
app/Modules/User/Views/Investments/tradeTracker-full-functionality.php:130:            url: "<?= site_url('Trade-Tracker/getTradeData') ?>",
app/Modules/User/Views/Investments/tradeTracker-full-functionality.php:274:                url: "<?= site_url('Trade-Tracker/getTradeData') ?>",
app/Modules/User/Views/Investments/tradeTracker-full-functionality.php:368:                url: "<?= site_url('Trade-Tracker/getTradeData') ?>",
app/Modules/User/Views/Investments/tradeTracker-full-functionality.php:453:            url: "<?= site_url('Trade-Tracker/saveTradeData') ?>",
app/Modules/User/Views/Investments/tradeTracker-full-functionality.php:512:            url: "<?= site_url('Trade-Tracker/saveTradeData') ?>",
app/Modules/User/Views/Investments/index.php:239:            const response = await fetch(<?= site_url('/API/getUserInvestmentData/' . $cuID)?>); // Replace with your API endpoint
app/Modules/User/Views/Investments/Add/user_fields-04042024.php:501:                fetch('<?= site_url("/add_new_wallet") ?>', {
app/Modules/User/Views/Investments/Add/user_fields-04042024.php:559:            const baseUrl = "<?php echo site_url('/Investments/API/getSymbolsByTradeType/'); ?>";
app/Modules/User/Views/Investments/Add/user_fields-04042024.php:590:            let baseUrl = "<?php echo site_url('Investments/API/fetchRealTimeData/'); ?>";
app/Modules/User/Views/Investments/Add/form.php:78:                const result = await fetch("<?php echo site_url('Investments/Account-Manager'); ?>", {
app/Modules/User/Views/Investments/Add/form.php:92:                window.location.href = document.referrer || "<?= site_url('/Investments'); ?>";
app/Modules/User/Views/Investments/Add/form.php:135:            const baseUrl = "<?php echo site_url('/Investments/API/getSymbolsByTradeType/'); ?>";
app/Modules/User/Views/Investments/Add/form.php:167:        //     let baseUrl = "<?php echo site_url('Investments/API/fetchRealTimeData/'); ?>";
app/Modules/User/Views/Investments/Add/form.php:183:                let baseUrl = "<?php echo site_url('Investments/API/fetchRealTimeData/'); ?>";
app/Modules/User/Views/Investments/Add/form.php:264:                fetch('<?= site_url("/add_new_wallet") ?>', {
app/Modules/User/Views/Investments/Add/user_fields-new.php:513:                fetch('<?= site_url("/add_new_wallet") ?>', {
app/Modules/User/Views/Investments/Add/user_fields-new.php:679:    //     fetch('<?=site_url("/Autosave")?>', {
app/Modules/User/Views/Investments/Add/user_fields-09162023.php:501:                fetch('<?= site_url("/add_new_wallet") ?>', {
app/Modules/User/Views/Investments/Add/user_fields-09162023.php:571:        let baseUrl = "<?php echo site_url('Investments/API/fetchRealTimeData/'); ?>";
app/Modules/User/Views/Investments/Add/user_fields-09162023.php:653:    //     fetch('<?=site_url("/Autosave")?>', {
app/Modules/User/Views/Investments/Add/watchlist_fields.php:110:    //                 const response = await fetch("<?= site_url('Investments/API/AddWatchlist') ?>", {
app/Modules/User/Views/Investments/Add/watchlist_fields.php:140:        fetch("<?= site_url('API/Investments/GetUserWatchlist/' . $cuID) ?>")
app/Modules/User/Views/Investments/Add/user_fields.php:325:        url: <?php echo site_url('/Investments/API/getSymbolsByTradeType/'); ?> + selectedType,
app/Modules/User/Views/Investments/Add/user_fields.php:545:        let baseUrl = "<?php echo site_url('Investments/API/fetchRealTimeData/'); ?>";
app/Modules/User/Views/Investments/Add/user_fields_orig.php:498:                fetch('<?= site_url("/add_new_wallet") ?>', {
app/Modules/User/Views/Investments/Add/user_fields_orig.php:556:            const baseUrl = "<?php echo site_url('/Investments/API/getSymbolsByTradeType/'); ?>";
app/Modules/User/Views/Investments/Add/user_fields_orig.php:595:            let baseUrl = "<?php echo site_url('Investments/API/fetchRealTimeData/'); ?>";
app/Modules/User/Views/Investments/tradeTracker-working-12082024.php:11:<a class="btn btn-primary" href="<?= site_url('/Investments') ?>">
app/Modules/User/Views/Investments/tradeTracker-working-12082024.php:79:            url: "<?= site_url('Trade-Tracker/getTradeData') ?>",
app/Modules/User/Views/Investments/tradeTracker-working-12082024.php:139:        fetch("<?= site_url('Trade-Tracker/saveTradeData') ?>", {
app/Modules/User/Views/Investments/Add-12012024.php:102:        const baseUrl = "<?php echo site_url('/API/Investments/getSymbolsByTradeType'); ?>";
app/Modules/User/Views/Investments/Add-12012024.php:134:        let baseUrl = "<?php echo site_url('Investments/API/fetchRealTimeData/'); ?>";
app/Modules/User/Views/Investments/retirement.php:1:<a class="btn btn-primary" href="<?= site_url('/Investments') ?>"><em class="icon ni ni-arrow-left"></em> Back to Investments</a>
app/Modules/User/Views/Investments/retirement.php:138:                        <a href="<?= site_url('/Retirement/UpdateProfile'); ?>" class="btn btn-primary">Update your Retirement Profile</a>
app/Modules/User/Views/Investments/retirement.php:152:                        <a href="<?= site_url('/Retirement/ReadMore'); ?>">Read more</a>
app/Modules/User/Views/Investments/retirement.php:166:        fetch('<?= site_url('/Investments/saveRetirementPlan') ?>', {
app/Modules/User/Views/Investments/index/Performance_Overview.php:96:                    <a href="<?php echo site_url('Budget/Income'); ?>">
app/Modules/User/Views/Investments/index/Performance_Overview.php:109:                    <a href="<?php echo site_url('Budget/Expenses'); ?>">
app/Modules/User/Views/Investments/index/historical_table.php:56:                    <a class="badge badge-xs badge-dim rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a><br>
app/Modules/User/Views/Investments/index/historical_table.php:68:                <td><a class="badge badge-sm badge-dim rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a></td>
app/Modules/User/Views/Investments/index/historical_table.php:75:                    <a class="badge badge-sm badge-dim rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Investments/index/historical_table.php:98:                <td><a class="badge badge-xs badge-dim rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Investments/index/historical_table.php:109:                <td><a class="badge badge-sm badge-dim rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Investments/index/historical_table.php:116:                    <a class="badge badge-sm badge-dim rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Investments/index/historical_table.php:132:                $accountPaidStatus          = '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Investments/index/historical_table.php:135:                $accountPaidStatus          = '<a class="statusRed" href="' . site_url('Budget/Status/Unpaid/' . $account['id']) . '"><i class="icon myfs-md ni ni-na"></i></a>';
app/Modules/User/Views/Investments/index/historical_table.php:162:                    <td><a href="' . site_url('Budget/Details/' . $account['id']) . '">' . $accountNameDisplay . '</a></td>
app/Modules/User/Views/Investments/index/historical_table.php:172:                    <td><a href="' . site_url('Budget/Details/' . $account['id']) . '">' . $account['name'] . '</a></td>
app/Modules/User/Views/Investments/index/historical_table.php:180:                                            <a href="' . site_url('Wallets/' . $account['account_type'] . '/Details/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a>
app/Modules/User/Views/Investments/index/historical_table.php:197:                                                <li><a href="' . site_url('Wallets/Attach-Account/' . $account['account_type'] . '/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a></li>    
app/Modules/User/Views/Investments/index/historical_table.php:211:                                                <li><a href="' . site_url('Wallets/Attach-Account/' . $account['account_type'] . '/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a></li>    
app/Modules/User/Views/Investments/index/historical_table.php:217:                                        <li><a href="' . site_url('Wallets') . '"><span><em class="icon icon-xs ni ni-plus"></em> Create Wallet</span></a></li>    
app/Modules/User/Views/Investments/index/historical_table.php:228:                        <a href="' . site_url('Budget/Edit/' . $account['id']) . '"><i class="icon  myfs-md ni ni-edit"></i></a>
app/Modules/User/Views/Investments/index/historical_table.php:229:                        <a href="' . site_url('Budget/Copy/' . $account['id']) . '"><i class="icon  myfs-md ni ni-copy"></i></a>
app/Modules/User/Views/Investments/index/historical_table.php:230:                        <a class="text-red" href="' . site_url('Budget/Delete-Account/' . $account['id']) . '"><i class="icon myfs-md ni ni-trash"></i></a>
app/Modules/User/Views/Investments/index/Insights-test.php:180:        let baseUrl = <?php echo '"' . site_url('API/Investments/GetUserWatchlist/') . '"'; ?>;
app/Modules/User/Views/Investments/index/Insights-test.php:210:        fetch('<?php echo site_url('/Investments/API/getSymbolsByTradeType/'); ?>')
app/Modules/User/Views/Investments/index/Insights-test.php:229:        fetch('<?php echo site_url('/Investments/API/getSymbolsByTradeType/'); ?>')
app/Modules/User/Views/Investments/index/Insights.php:169:        fetch(<?php echo '"' . site_url('API/Investments/GetUserWatchlist/') . '"'; ?>) // Update this URL to your method
app/Modules/User/Views/Investments/index/Insights.php:190:        let baseUrl = <?php echo '"' . site_url('API/Investments/GetUserWatchlist/') . '"'; ?>;
app/Modules/User/Views/Investments/index/Insights.php:224:        fetch('<?php echo site_url('/Investments/API/getSymbolsByTradeType/'); ?>')
app/Modules/User/Views/Investments/index/Insights.php:243:        fetch('<?php echo site_url('/Investments/API/getSymbolsByTradeType/'); ?>')
app/Modules/User/Views/Investments/index/overview_chart.php:70:                    <a href="<?php echo site_url('Budget/Income'); ?>">
app/Modules/User/Views/Investments/index/overview_chart.php:82:                    <a href="<?php echo site_url('Budget/Expenses'); ?>">
app/Modules/User/Views/Investments/index/active_table.php:57:                    <a class="badge badge-xs badge-dim rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a><br>
app/Modules/User/Views/Investments/index/active_table.php:69:                <td><a class="badge badge-sm badge-dim rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a></td>
app/Modules/User/Views/Investments/index/active_table.php:76:                    <a class="badge badge-sm badge-dim rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Investments/index/active_table.php:99:                <td><a class="badge badge-xs badge-dim rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Investments/index/active_table.php:110:                <td><a class="badge badge-sm badge-dim rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Investments/index/active_table.php:117:                    <a class="badge badge-sm badge-dim rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Investments/index/active_table.php:142:        //         <td><a class="badge badge-xs badge-dim rounded-pill bg-success text-white px-4" href="' . site_url('/Wallets') . '">Investments</a></td>
app/Modules/User/Views/Investments/index/active_table.php:153:        //         <td><a class="badge badge-sm badge-dim rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Investments</a></td>
app/Modules/User/Views/Investments/index/active_table.php:159:        //         <a class="badge badge-sm badge-dim rounded-pill bg-success text-white" href="' . site_url('Wallets') . '">Add</a>
app/Modules/User/Views/Investments/index/active_table.php:160:        //         <a class="badge badge-sm badge-dim rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Investments/index/active_table.php:177:                $accountPaidStatus          = '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Investments/index/active_table.php:180:                $accountPaidStatus          = '<a class="statusGreen" href="' . site_url('Budget/Status/Unpaid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Investments/index/active_table.php:207:                    <td><a href="' . site_url('Budget/Details/' . $account['id']) . '">' . $accountNameDisplay . '</a></td>
app/Modules/User/Views/Investments/index/active_table.php:217:                    <td><a href="' . site_url('Budget/Details/' . $account['id']) . '">' . $account['name'] . '</a></td>
app/Modules/User/Views/Investments/index/active_table.php:225:                                            <a href="' . site_url('Wallets/' . $account['account_type'] . '/Details/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a>
app/Modules/User/Views/Investments/index/active_table.php:242:                                                <li><a href="' . site_url('Wallets/Attach-Account/' . $account['account_type'] . '/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a></li>    
app/Modules/User/Views/Investments/index/active_table.php:256:                                                <li><a href="' . site_url('Wallets/Attach-Account/' . $account['account_type'] . '/' . $account['id']) . '/' . $userWallets['id'] . '"><span>' . $userWallets['nickname'] . '</span></a></li>    
app/Modules/User/Views/Investments/index/active_table.php:262:                                        <li><a href="' . site_url('Wallets') . '"><span><em class="icon icon-xs ni ni-plus"></em> Create Wallet</span></a></li>    
app/Modules/User/Views/Investments/index/active_table.php:273:                        <a href="' . site_url('Budget/Edit/' . $account['id']) . '"><i class="icon  myfs-md ni ni-edit"></i></a>
app/Modules/User/Views/Investments/index/active_table.php:274:                        <a href="' . site_url('Budget/Copy/' . $account['id']) . '"><i class="icon  myfs-md ni ni-copy"></i></a>
app/Modules/User/Views/Investments/index/active_table.php:275:                        <a class="text-red" href="' . site_url('Budget/Delete-Account/' . $account['id']) . '"><i class="icon myfs-md ni ni-trash"></i></a>
app/Modules/User/Views/Investments/index/Investment_Tools-sm.php:47:                    <a href="<?php echo site_url($tools['feature_link']); ?>" class="btn btn-icon btn-trigger me-n2">
app/Modules/User/Views/Investments/index/Action_Center.php:29:                <a href="<?php echo site_url('/Investments'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Investments/index/Action_Center.php:39:                <a href="<?php echo site_url('/Investments/Retirement'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Investments/index/Action_Center.php:49:                <a href="<?php echo site_url('/Memberships'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Investments/index/Action_Center.php:59:                <a href="<?php echo site_url('/Trade-Tracker'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Investments/index/Action_Center.php:69:                <a href="<?php echo site_url('/Wallets/Investments'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Investments/index/Action_Center.php:79:                <a href="<?php echo site_url('/Investments/Watchlist'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Investments/index/Economic_Data.php:178:            url: "<?php echo site_url('investments/fetchEconomicData'); ?>",
app/Modules/User/Views/Investments/index/Economic_Data.php:216:            url: "<?php echo site_url('investments/searchEconomicData'); ?>",
app/Modules/User/Views/Investments/index/Economic_Data.php:254:            url: "<?php echo site_url('Investments/likeEconomicData'); ?>",
app/Modules/User/Views/Investments/index/Recent_Trades.php:38:                <a class="btn btn-success btn-sm text-white" href="<?php echo site_url('Investments/Add'); ?>"><em class="icon ni ni-plus"></em><span>Add</span></a>
app/Modules/User/Views/Investments/index/Recent_Trades.php:45:                                <a class="" href="' . site_url('/Budget/Add/Income') . '">CryptoAssets</a>
app/Modules/User/Views/Investments/index/Recent_Trades.php:48:                                <a class="" href="' . site_url('/Budget/Add/Income') . '">CryptoCoins</a>
app/Modules/User/Views/Investments/index/Recent_Trades.php:52:                                <a class="" href="' . site_url('/Budget/Add/Income') . '">On</a>
app/Modules/User/Views/Investments/index/Recent_Trades.php:55:                                <a class="" href="' . site_url('/Budget/Add/Income') . '">Off</a>
app/Modules/User/Views/Investments/index/Recent_Trades.php:59:                                <a class="" href="' . site_url('/Budget/Add/Income') . '">On</a>
app/Modules/User/Views/Investments/index/Recent_Trades.php:62:                                <a class="" href="' . site_url('/Budget/Add/Income') . '">Off</a>
app/Modules/User/Views/Investments/index/Recent_Trades.php:143:                                    <td><a href="' . site_url('Investments/Record/') . $investRecord['id'] . '">' . $investRecord['id'] . '</a></td>
app/Modules/User/Views/Investments/index/Recent_Trades.php:146:                                    <td><a href="' . site_url($assetURL) . '">' . $investRecord['symbol'] . '</a></td>
app/Modules/User/Views/Investments/index/control_center.php:29:                        <a href="<?php echo site_url('Wallets/Checking'); ?>">Checking Accounts</a> 
app/Modules/User/Views/Investments/index/control_center.php:32:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Investments/index/control_center.php:37:                <a href="<?php echo site_url('/Wallets/Checking'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Investments/index/Investment_Tools.php:49:                        <a href="<?php echo site_url($tools['feature_link']); ?>" class="btn btn-icon btn-trigger me-n2">
app/Modules/User/Views/Investments/index/Performance_Overview-09282023.php:87:                    <a href="<?php echo site_url('Budget/Income'); ?>">
app/Modules/User/Views/Investments/index/Performance_Overview-09282023.php:99:                    <a href="<?php echo site_url('Budget/Expenses'); ?>">
app/Modules/User/Views/Investments/index/Performance_Overview-09282023.php:1215:    //     // let r = `<?php echo site_url('API/fetchRealTimeData/'); ?>${a}/${e}`;
app/Modules/User/Views/Dashboard/Goals/Monthly/browser_table.php:101:                                            <td><a class="badge badge-sm rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a></td>
app/Modules/User/Views/Dashboard/Goals/Monthly/browser_table.php:108:                                                <a class="badge badge-sm rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Dashboard/Goals/Monthly/browser_table.php:121:                                            <td><a class="badge badge-sm rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Dashboard/Goals/Monthly/browser_table.php:128:                                                <a class="badge badge-sm rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Dashboard/Goals/Monthly/browser_table.php:142:                                            $accountPaidStatus = $account['paid'] ? '' : '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Dashboard/Goals/Monthly/browser_table.php:149:                                                <td><a href="<?= site_url('Budget/Details/' . $account['id']); ?>"><?= $account['name']; ?></a></td>
app/Modules/User/Views/Dashboard/Goals/Monthly/browser_table.php:155:                                                    <a href="' . site_url('Budget/Edit/' . $account['id']) . '"><i class="icon ni ni-edit"></i></a>
app/Modules/User/Views/Dashboard/Goals/Monthly/browser_table.php:156:                                                    <a href="' . site_url('Budget/Copy/' . $account['id']) . '"><i class="icon ni ni-copy"></i></a>
app/Modules/User/Views/Dashboard/Goals/Monthly/browser_table.php:157:                                                    <a class="text-red" href="' . site_url('Budget/Delete-Account/' . $account['id']) . '"><i class="icon ni ni-trash"></i></a>
app/Modules/User/Views/Dashboard/Goals/Monthly/mobile_table.php:27:                        <a class="btn btn-success btn-xs text-white" href="<?php site_url('/Budget/Add/Income'); ?>"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/User/Views/Dashboard/Goals/Monthly/mobile_table.php:28:                        <a class="btn btn-danger btn-xs text-white" href="<?php site_url('/Budget/Add/Expense'); ?>'"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/User/Views/Dashboard/Goals/Monthly/mobile_table.php:74:                                            <td><a class="badge badge-sm rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank</a></td>
app/Modules/User/Views/Dashboard/Goals/Monthly/mobile_table.php:88:                                            <td><a class="badge badge-sm rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit</a></td>
app/Modules/User/Views/Dashboard/Goals/Monthly/mobile_table.php:103:                                            $accountPaidStatus = $account['paid'] ? '' : '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Dashboard/Goals/Monthly/mobile_table.php:109:                                                <td><a href="<?= site_url('Budget/Details/' . $account['id']); ?>"><?= $account['name']; ?></a></td>
app/Modules/User/Views/Dashboard/Goals/browser_table.php:101:                                            <td><a class="badge badge-sm rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a></td>
app/Modules/User/Views/Dashboard/Goals/browser_table.php:108:                                                <a class="badge badge-sm rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Dashboard/Goals/browser_table.php:121:                                            <td><a class="badge badge-sm rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Dashboard/Goals/browser_table.php:128:                                                <a class="badge badge-sm rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Dashboard/Goals/browser_table.php:142:                                            $accountPaidStatus = $account['paid'] ? '' : '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Dashboard/Goals/browser_table.php:149:                                                <td><a href="<?= site_url('Budget/Details/' . $account['id']); ?>"><?= $account['name']; ?></a></td>
app/Modules/User/Views/Dashboard/Goals/browser_table.php:155:                                                    <a href="' . site_url('Budget/Edit/' . $account['id']) . '"><i class="icon ni ni-edit"></i></a>
app/Modules/User/Views/Dashboard/Goals/browser_table.php:156:                                                    <a href="' . site_url('Budget/Copy/' . $account['id']) . '"><i class="icon ni ni-copy"></i></a>
app/Modules/User/Views/Dashboard/Goals/browser_table.php:157:                                                    <a class="text-red" href="' . site_url('Budget/Delete-Account/' . $account['id']) . '"><i class="icon ni ni-trash"></i></a>
app/Modules/User/Views/Dashboard/Goals/mobile_table.php:27:                        <a class="btn btn-success btn-xs text-white" href="<?php site_url('/Budget/Add/Income'); ?>"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/User/Views/Dashboard/Goals/mobile_table.php:28:                        <a class="btn btn-danger btn-xs text-white" href="<?php site_url('/Budget/Add/Expense'); ?>'"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/User/Views/Dashboard/Goals/mobile_table.php:74:                                            <td><a class="badge badge-sm rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank</a></td>
app/Modules/User/Views/Dashboard/Goals/mobile_table.php:88:                                            <td><a class="badge badge-sm rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit</a></td>
app/Modules/User/Views/Dashboard/Goals/mobile_table.php:103:                                            $accountPaidStatus = $account['paid'] ? '' : '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Dashboard/Goals/mobile_table.php:109:                                                <td><a href="<?= site_url('Budget/Details/' . $account['id']); ?>"><?= $account['name']; ?></a></td>
app/Modules/User/Views/Dashboard/Goals/All/browser_table.php:101:                                            <td><a class="badge badge-sm rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a></td>
app/Modules/User/Views/Dashboard/Goals/All/browser_table.php:108:                                                <a class="badge badge-sm rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Dashboard/Goals/All/browser_table.php:121:                                            <td><a class="badge badge-sm rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Dashboard/Goals/All/browser_table.php:128:                                                <a class="badge badge-sm rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Dashboard/Goals/All/browser_table.php:142:                                            $accountPaidStatus = $account['paid'] ? '' : '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Dashboard/Goals/All/browser_table.php:149:                                                <td><a href="<?= site_url('Budget/Details/' . $account['id']); ?>"><?= $account['name']; ?></a></td>
app/Modules/User/Views/Dashboard/Goals/All/browser_table.php:155:                                                    <a href="' . site_url('Budget/Edit/' . $account['id']) . '"><i class="icon ni ni-edit"></i></a>
app/Modules/User/Views/Dashboard/Goals/All/browser_table.php:156:                                                    <a href="' . site_url('Budget/Copy/' . $account['id']) . '"><i class="icon ni ni-copy"></i></a>
app/Modules/User/Views/Dashboard/Goals/All/browser_table.php:157:                                                    <a class="text-red" href="' . site_url('Budget/Delete-Account/' . $account['id']) . '"><i class="icon ni ni-trash"></i></a>
app/Modules/User/Views/Dashboard/Goals/All/mobile_table.php:27:                        <a class="btn btn-success btn-xs text-white" href="<?php site_url('/Budget/Add/Income'); ?>"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/User/Views/Dashboard/Goals/All/mobile_table.php:28:                        <a class="btn btn-danger btn-xs text-white" href="<?php site_url('/Budget/Add/Expense'); ?>'"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/User/Views/Dashboard/Goals/All/mobile_table.php:74:                                            <td><a class="badge badge-sm rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank</a></td>
app/Modules/User/Views/Dashboard/Goals/All/mobile_table.php:88:                                            <td><a class="badge badge-sm rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit</a></td>
app/Modules/User/Views/Dashboard/Goals/All/mobile_table.php:103:                                            $accountPaidStatus = $account['paid'] ? '' : '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Dashboard/Goals/All/mobile_table.php:109:                                                <td><a href="<?= site_url('Budget/Details/' . $account['id']); ?>"><?= $account['name']; ?></a></td>
app/Modules/User/Views/Dashboard/Goals/control_center.php:27:                        Receives Rewards for completing your <a href="<?php echo site_url('Daily-Goals'); ?>">Daily Goals for MyMIGold</a>! 
app/Modules/User/Views/Dashboard/Goals/control_center.php:30:                <a href="<?php echo site_url('Budget/Income'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Dashboard/Goals/control_center.php:41:                        <a href="<?php echo site_url('Budget/Income'); ?>">Income Accounts</a> 
app/Modules/User/Views/Dashboard/Goals/control_center.php:46:                <a href="<?php echo site_url('Budget/Income'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Dashboard/Goals/control_center.php:57:                        <a href="<?php echo site_url('Budget/Expenses'); ?>">Expense Accounts</a> 
app/Modules/User/Views/Dashboard/Goals/control_center.php:62:                <a href="<?php echo site_url('Budget/Expenses'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Dashboard/Goals/control_center.php:73:                        <a href="<?php echo site_url('Wallets/Checking'); ?>">Checking Accounts</a> 
app/Modules/User/Views/Dashboard/Goals/control_center.php:77:                <a href="<?php echo site_url('/Wallets/Checking'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Dashboard/Goals/control_center.php:87:                        <a href="<?php echo site_url('/Wallets/Credit'); ?>">Credit</a> 
app/Modules/User/Views/Dashboard/Goals/control_center.php:91:                <a href="<?php echo site_url('/Wallets/Credit'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Dashboard/Goals/control_center.php:101:                        <a href="<?php echo site_url('/Wallets/Debt'); ?>">Debt</a> 
app/Modules/User/Views/Dashboard/Goals/control_center.php:105:                <a href="<?php echo site_url('/Wallets/Debt'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Dashboard/Goals/control_center.php:116:                        <a href="<?php echo site_url('/Wallets/Investments'); ?>">Investments</a> 
app/Modules/User/Views/Dashboard/Goals/control_center.php:123:                <a href="<?php echo site_url('/Wallets/Investments'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Dashboard/Goals/control_center.php:137:                        <!-- <a href="<?php //echo site_url('/Wallets/Retirement'); ?>">Retirement</a>  -->
app/Modules/User/Views/Dashboard/Goals/control_center.php:140:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Dashboard/Goals/control_center.php:161:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Dashboard/Goals/control_center.php:181:                        <a href="<?php //echo site_url('/Budget/Income/Accounts'); ?>">Investments / Assets</a> 
app/Modules/User/Views/Dashboard/Goals/control_center.php:184:                            <a href="<?php //echo site_url('/Wallets/Checking'); ?>">Checking Accounts</a>  
app/Modules/User/Views/Dashboard/Goals/control_center.php:189:                <a href="<?php //echo site_url('/Budget/Add/Expense'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Dashboard/Goals/control_center.php:198:                    <p>View, manage and analyze your <a href="<?php //echo site_url('Budget/Forecast'); ?>"><strong><?php //echo $totalTransactions; ?> Financial Forecast &amp; 5-Year Projections</strong></a>.</p>
app/Modules/User/Views/Dashboard/Goals/control_center.php:200:                <a href="<?php //echo site_url('Exchanges'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/User/Views/Dashboard/Goals/Weekly/browser_table.php:101:                                            <td><a class="badge badge-sm rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank Accounts</a></td>
app/Modules/User/Views/Dashboard/Goals/Weekly/browser_table.php:108:                                                <a class="badge badge-sm rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Dashboard/Goals/Weekly/browser_table.php:121:                                            <td><a class="badge badge-sm rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit Accounts</a></td>
app/Modules/User/Views/Dashboard/Goals/Weekly/browser_table.php:128:                                                <a class="badge badge-sm rounded-pill bg-primary text-white" href="' . site_url('Wallets') . '">Manage</a>
app/Modules/User/Views/Dashboard/Goals/Weekly/browser_table.php:142:                                            $accountPaidStatus = $account['paid'] ? '' : '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Dashboard/Goals/Weekly/browser_table.php:149:                                                <td><a href="<?= site_url('Budget/Details/' . $account['id']); ?>"><?= $account['name']; ?></a></td>
app/Modules/User/Views/Dashboard/Goals/Weekly/browser_table.php:155:                                                    <a href="' . site_url('Budget/Edit/' . $account['id']) . '"><i class="icon ni ni-edit"></i></a>
app/Modules/User/Views/Dashboard/Goals/Weekly/browser_table.php:156:                                                    <a href="' . site_url('Budget/Copy/' . $account['id']) . '"><i class="icon ni ni-copy"></i></a>
app/Modules/User/Views/Dashboard/Goals/Weekly/browser_table.php:157:                                                    <a class="text-red" href="' . site_url('Budget/Delete-Account/' . $account['id']) . '"><i class="icon ni ni-trash"></i></a>
app/Modules/User/Views/Dashboard/Goals/Weekly/mobile_table.php:27:                        <a class="btn btn-success btn-xs text-white" href="<?php site_url('/Budget/Add/Income'); ?>"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/User/Views/Dashboard/Goals/Weekly/mobile_table.php:28:                        <a class="btn btn-danger btn-xs text-white" href="<?php site_url('/Budget/Add/Expense'); ?>'"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/User/Views/Dashboard/Goals/Weekly/mobile_table.php:74:                                            <td><a class="badge badge-sm rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank</a></td>
app/Modules/User/Views/Dashboard/Goals/Weekly/mobile_table.php:88:                                            <td><a class="badge badge-sm rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit</a></td>
app/Modules/User/Views/Dashboard/Goals/Weekly/mobile_table.php:103:                                            $accountPaidStatus = $account['paid'] ? '' : '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Dashboard/Goals/Weekly/mobile_table.php:109:                                                <td><a href="<?= site_url('Budget/Details/' . $account['id']); ?>"><?= $account['name']; ?></a></td>
app/Modules/User/Views/Dashboard/Goals/Daily/mobile_table.php:27:                        <a class="btn btn-success btn-xs text-white" href="<?php site_url('/Budget/Add/Income'); ?>"><i class="icon ni ni-plus"></i> Income</a>
app/Modules/User/Views/Dashboard/Goals/Daily/mobile_table.php:28:                        <a class="btn btn-danger btn-xs text-white" href="<?php site_url('/Budget/Add/Expense'); ?>'"><i class="icon ni ni-plus"></i> Expense</a>
app/Modules/User/Views/Dashboard/Goals/Daily/mobile_table.php:74:                                            <td><a class="badge badge-sm rounded-pill bg-primary text-white px-4" href="' . site_url('/Wallets') . '">Bank</a></td>
app/Modules/User/Views/Dashboard/Goals/Daily/mobile_table.php:88:                                            <td><a class="badge badge-sm rounded-pill bg-warning text-white px-4" href="' . site_url('/Wallets') . '">Credit</a></td>
app/Modules/User/Views/Dashboard/Goals/Daily/mobile_table.php:103:                                            $accountPaidStatus = $account['paid'] ? '' : '<a href="' . site_url('Budget/Status/Paid/' . $account['id']) . '"><i class="icon myfs-md ni ni-check-thick"></i></a>';
app/Modules/User/Views/Dashboard/Goals/Daily/mobile_table.php:109:                                                <td><a href="<?= site_url('Budget/Details/' . $account['id']); ?>"><?= $account['name']; ?></a></td>
app/Modules/User/Views/Dashboard/Profile.php:67:                                <a class="btn btn-primary btn-xs" href="' . site_url('My-Referrals') . '"><em class="icon ni ni-plus"></em><span>Share A Trade?</span></a>
app/Modules/User/Views/Dashboard/Profile.php:83:                                <a class="btn btn-success btn-xs" href="' . site_url('My-Referrals') . '"><em class="icon ni ni-plus"></em><span>Invite Friends!</span></a>
app/Modules/User/Views/Dashboard/Defaults/security.php:20:                        <a href="<?php echo site_url('/Support'); ?>" class="btn btn-danger">
app/Modules/User/Views/Dashboard/Defaults/security.php:23:                        <a href="<?php echo site_url('/Dashboard'); ?>" class="btn btn-outline-secondary">
app/Modules/User/Views/Dashboard/Account/ConnectedAccounts copy.php:151:    var oauthUrl = '<?= site_url('Account/Connect/DoorDash'); ?>';
app/Modules/User/Views/Dashboard/Account/ConnectedAccounts.php:68:    var oauthUrl = '<?= site_url('Account/Connect/DoorDash'); ?>';
app/Modules/User/Views/Dashboard/Account/ControlCenter.php:29:                <div class="user-balance-sub"><a class="currency currency-usd" href="<?php echo site_url('/Wallets/Purchase/MyMIGold'); ?>">Purchase Now</a></div>
app/Modules/User/Views/Dashboard/Account/ControlCenter.php:34:                <li><a href="<?php echo site_url('/Account'); ?>"><em class="icon ni ni-user-fill-c"></em><span>Personal Infomation</span></a></li>
app/Modules/User/Views/Dashboard/Account/ControlCenter.php:35:                <li><a href="<?php echo site_url('/Account/Activity'); ?>"><em class="icon ni ni-activity-round-fill"></em><span>Account Activity</span></a></li>
app/Modules/User/Views/Dashboard/Account/ControlCenter.php:36:                <li><a href="<?php echo site_url('/Account/Connected-Accounts'); ?>"><em class="icon ni ni-activity-round-fill"></em><span>Connected Accounts</span></a></li>
app/Modules/User/Views/Dashboard/Account/ControlCenter.php:37:                <li><a href="<?php echo site_url('/Account/Notifications'); ?>"><em class="icon ni ni-bell-fill"></em><span>Notifications</span></a></li>
app/Modules/User/Views/Dashboard/Account/ControlCenter.php:38:                <li><a href="<?php echo site_url('/Account/Security'); ?>"><em class="icon ni ni-lock-alt-fill"></em><span>Security Settings</span></a></li>
app/Modules/User/Views/Dashboard/Account/ControlCenter.php:39:                <li><a href="<?php echo site_url('/Account/Social-Media'); ?>"><em class="icon ni ni-grid-add-fill-c"></em><span>Connected with Social</span></a></li>
app/Modules/User/Views/Dashboard/Profile/investor_strength_score.php:26:                <li>No Achievements Yet! <a href="<?= site_url('/MyMI-Gold/Goals/Daily') ?>">Get Started Here!</a></li>
app/Modules/User/Views/Dashboard/Profile/user_mymi_projects.php:23:                    <td><a href="<?= site_url('Projects/View/' . $project['id']); ?>"><?= esc($project['name']); ?></a></td>
app/Modules/User/Views/Dashboard/Search_Results.php:28:                                    <span class="tb-lead"><a href="<?= site_url('details/' . $item['id']); ?>"><?= $item['title']; ?></a></span>
app/Modules/User/Views/Dashboard/forms/onboarding.php:29:            url: "<?= site_url('/dashboard/completeOnboardingStep/') ?>" + step,
app/Modules/User/Views/Dashboard/modals/onboarding.php:32:        let url = `<?= site_url('Dashboard/Onboarding-Modal/')?>${formtype}${endpoint}${accountid}`;
app/Modules/User/Views/Dashboard/index/transaction-modal-02072025.php:43:        const url = `<?= site_url('Dashboard/Transaction-Modal/')?>${formtype}${endpoint}${accountid}${category}${platform}`;
app/Modules/User/Views/Dashboard/index/transaction-modal-02072025.php:109:                fetch('<?= site_url("/Wallets/MyMIGPayPalCallback") ?>', {
app/Modules/User/Views/Dashboard/index/transaction-modal-02072025.php:120:                    window.location.href = '<?= site_url("/Wallets/Purchase/Complete/MyMIGold") ?>';
app/Modules/User/Views/Dashboard/index/transaction-modal-copy.php:28:        let url = '<?php echo site_url(); ?>/' + endpoint + '/' + cuID;
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:35:			url: <?php echo '\'' . site_url('Deposit-Funds/' . $cuID) . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:52:        console.log(<?php echo '\'' . site_url('Deposit-Funds/' . $cuID) . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:62:			url: <?php echo '\'' . site_url('Deposit-Funds/' . $cuID) . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:76:        console.log(<?php echo '\'' . site_url('Deposit-Funds/' . $cuID) . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:86:			url: <?php echo '\'' . site_url('Withdraw-Funds/' . $cuID) . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:103:        console.log(<?php echo '\'' . site_url('Withdraw-Funds/' . $cuID) . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:113:			url: <?php echo '\'' . site_url('Withdraw-Funds/' . $cuID) . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:130:        console.log(<?php echo '\'' . site_url('Withdraw-Funds/' . $cuID) . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:139:			url: <?php echo '\'' . site_url('Add-Wallet-Deposit-Fetch/' . $cuID) . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:157:        console.log(<?php echo '\'' . site_url('Add-Wallet-Deposit-Fetch/' . $cuID) . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:167:			url: <?php echo '\'' . site_url('Add-Wallet-Withdraw-Fetch/' . $cuID) . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:184:        console.log(<?php echo '\'' . site_url('Add-Wallet-Withdraw-Fetch/' . $cuID) . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:194:			url: <?php echo '\'' . site_url('MyMI-Gold/Purchase/' . $cuID) . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:208:        console.log(<?php echo '\'' . site_url('MyMI-Gold/Purchase/' . $cuID) . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:218:			url: <?php echo '\'' . site_url('MyMI-Gold/Purchase/' . $cuID) . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:232:        console.log(<?php echo '\'' . site_url('MyMI-Gold/Purchase/' . $cuID) . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:243:			url: <?php echo '\'' . site_url('MyMI-Gold/Purchase/' . $cuID) . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:257:        console.log(<?php echo '\'' . site_url('MyMI-Gold/Purchase/' . $cuID) . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:268:			url: <?php echo '\'' . site_url('Purchase-Wallet/Fiat/' . $cuID) . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:282:        console.log(<?php echo '\'' . site_url('Purchase-Wallet/Fiat/' . $cuID) . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:293:			url: <?php echo '\'' . site_url('Purchase-Wallet/Digital/' . $cuID) . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:307:        console.log(<?php echo '\'' . site_url('Purchase-Wallet/Digital/' . $cuID) . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:317:			url: <?php echo '\'' . site_url('Wallets/Address-Generator') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:331:        console.log(<?php echo '\'' . site_url('Wallets/Address-Generator') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:341:			url: <?php echo '\'' . site_url('Add-Wallet/Fiat') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:359:        console.log(<?php echo '\'' . site_url('Add-Wallet/Fiat') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:369:			url: <?php echo '\'' . site_url('Add-Wallet/Fiat') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:386:        console.log(<?php echo '\'' . site_url('Add-Wallet/Fiat') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:396:			url: <?php echo '\'' . site_url('Add-Wallet/Digital') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:414:        console.log(<?php echo '\'' . site_url('Add-Wallet/Digital') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:424:			url: <?php echo '\'' . site_url('Add-Wallet/Digital') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:441:        console.log(<?php echo '\'' . site_url('Add-Wallet/Digital') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:451:			url: <?php echo '\'' . site_url('Wallets/Banking/Add/Account') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:468:        console.log(<?php echo '\'' . site_url('Wallets/Banking/Add/Account') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:478:			url: <?php echo '\'' . site_url('Wallets/Credit/Add/Account') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:495:        console.log(<?php echo '\'' . site_url('Wallets/Credit/Add/Account') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:505:	// 		url: <?php //echo '\'' . site_url('Budget/Add/Expense/Form') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:522:    //     console.log(<?php //echo '\'' . site_url('Budget/Add/Expense/Form') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:532:			url: <?php echo '\'' . site_url('Wallets/Investment/Add/Account/Modal') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:533:			// url: <?php //echo '\'' . site_url('Wallets/Connect-Bank-Account') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:550:        console.log(<?php echo '\'' . site_url('Wallets/Connect-Bank-Account') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:565:			url: <?php echo '\'' . site_url('Wallet-Selection/Fiat') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:582:        console.log(<?php echo '\'' . site_url('Wallet-Selection/Fiat') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:597:			url: <?php echo '\'' . site_url('Wallet-Selection') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:614:        console.log(<?php echo '\'' . site_url('Wallet-Selection') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:629:			url: <?php echo '\'' . site_url('Wallet-Selection') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:646:        console.log(<?php echo '\'' . site_url('Wallet-Selection') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:656:			url: <?php echo '\'' . site_url('Wallet-Selection/Free/Fiat') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:673:        console.log(<?php echo '\'' . site_url('Wallet-Selection/Free/Fiat') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:683:			url: <?php echo '\'' . site_url('Wallet-Selection/Digital') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:700:        console.log(<?php echo '\'' . site_url('Wallet-Selection/Digital') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:710:			url: <?php echo '\'' . site_url('Announcements/Post') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:727:        console.log(<?php echo '\'' . site_url('Announcements/Post') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:737:			url: <?php echo '\'' . site_url('Admin/Add-External-Site') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:754:        console.log(<?php echo '\'' . site_url('Admin/Add-External-Site') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:764:			url: <?php echo '\'' . site_url('Exchange/Coin-Listing/Asset-Information-Modal/Existing') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:781:        console.log(<?php echo '\'' . site_url('Exchange/Coin-Listing/Asset-Information-Modal/Existing') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:791:			url: <?php echo '\'' . site_url('Exchange/Coin-Listing/Request') . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:808:        console.log(<?php echo '\'' . site_url('Exchange/Coin-Listing/Request') . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:818:			url: <?php echo '\'' . site_url('Wallets/Delete/' . $pageURIC) . '\''; ?>,
app/Modules/User/Views/Dashboard/index/transaction-modal.orig.php:835:        console.log(<?php echo '\'' . site_url('Wallets/Delete/' . $pageURIC) . '\''; ?>);
app/Modules/User/Views/Dashboard/index/transaction-modal-12112024.php:45:        const url = `<?= site_url('Dashboard/Transaction-Modal/') ?>${formtype}${endpoint}${accountid}${category}${platform}?promo_code=${promoCode}`;
app/Modules/User/Views/Dashboard/index/transaction-modal-12112024.php:118:                fetch('<?= site_url("/Wallets/MyMIGPayPalCallback") ?>', {
app/Modules/User/Views/Dashboard/index/transaction-modal-12112024.php:129:                    window.location.href = '<?= site_url("/Wallets/Purchase/Complete/MyMIGold") ?>';
app/Modules/User/Views/Dashboard/index/transaction-modal.php:38:        let url = `<?= site_url('Dashboard/Transaction-Modal/')?>${formtype}${endpoint}${accountid}${category}${platform}`;
app/Modules/User/Views/Dashboard/index/transaction-modal.php:63:                    window.location.href = "<?= site_url('/login'); ?>";
app/Modules/User/Views/Dashboard/index/transaction-modal.php:76:                    window.location.href = "<?= site_url('/login'); ?>";
app/Modules/User/Views/Dashboard/index/transaction-modal.php:118:                fetch("<?= site_url("/Wallets/MyMIGPayPalCallback") ?>", {
app/Modules/User/Views/Dashboard/index/transaction-modal.php:131:                    window.location.href = "<?= site_url("/Wallets/Purchase/Complete/MyMIGold") ?>";
app/Modules/User/Controllers/DashboardController.php:537:                    $this->data['formAction']    = site_url("API/Wallets/Banking/Update/{$accountid}");
app/Modules/User/Controllers/DashboardController.php:1180:        $redirectURL = site_url('/Wallets');
app/Modules/User/Controllers/DashboardController-09102024.php:721:            $websiteLink = '<a href="' . site_url('/') . '">www.mymiwallet.com</a>';
app/Modules/User/Controllers/AuctionsController.php:67:            service('curlrequest')->post(site_url('/API/Auctions/fmv'), [
app/Modules/User/Controllers/ProjectsController.php:445:        $this->data['action'] = site_url("Projects/SubmitCommit/$projectId");
app/Modules/User/Controllers/ProjectsController.php:537:        $this->data['action'] = site_url("User/Projects/SubmitInvest/$projectId");
app/Modules/User/Controllers/ProjectsController.php:567:        $this->data['action'] = site_url("User/Projects/SubmitSell/$projectId");
app/Modules/User/Controllers/EmailController.php:23:        $link = rtrim(getenv('APP_URL') ?: site_url(), '/') . '/Account/verify-email/' . $token;
app/Modules/User/Controllers/SearchController.php:19:            $url = site_url('API/Investments/searchTickers?query=' . urlencode($q) . '&limit=15');
app/Modules/User/Controllers/BudgetController.new.php:234:        $referer = $this->request->getServer('HTTP_REFERER') ?? site_url('/Budget');
app/Modules/User/Controllers/BudgetController.new.php:283:                    session()->setFlashdata('message', 'There was an error submitting your changes. Contact support by clicking <a href="' . site_url('/Support') . '">here!</a>');
app/Modules/User/Controllers/InvestmentsController-09102024.php:943:            echo json_encode(['status' => 'new', 'redirectUrl' => site_url('complete_wallet_creation')]);
app/Modules/User/Controllers/BudgetController-06012024.php:566:                    session()->setFlashdata('message', 'There was an error submitting your changes. Contact support by clicking <a href="' . site_url('/Support') . '">here!</a>');
app/Modules/User/Controllers/BudgetController-06012024.php:578:        $referer = $this->request->getServer('HTTP_REFERER') ?? site_url('/Budget');
app/Modules/User/Controllers/PredictionsController.php:15:        return redirect()->to(site_url('Predictions/Markets'));
app/Modules/User/Controllers/BudgetController.php:475:                    session()->setFlashdata('message', 'There was an error submitting your changes. Contact support by clicking <a href="' . site_url('/Support') . '">here!</a>');
app/Modules/User/Controllers/ReferralController.php:277:            'referral_link' => site_url('/Referral/Register/' . $referrerCode),
app/Modules/ScriptStudio/Views/marketplace.php:42:                                <a class="btn btn-outline-primary btn-sm" href="<?= site_url('ScriptStudio/Preview/' . $script['id']) ?>">Preview</a>
app/Modules/ScriptStudio/Views/preview_emulator.php:18:                <a class="btn btn-sm btn-outline-dark" href="<?= site_url('ScriptStudio/Export/' . $script['id'] . '/pinescript') ?>">Export PineScript</a>
app/Modules/ScriptStudio/Views/preview_emulator.php:19:                <a class="btn btn-sm btn-outline-dark" href="<?= site_url('ScriptStudio/Export/' . $script['id'] . '/thinkscript') ?>">Export ThinkScript</a>
app/Modules/ScriptStudio/Views/index.php:4:        <a href="<?= site_url('ScriptStudio/Create') ?>" class="btn btn-primary">Create Script</a>
app/Modules/ScriptStudio/Views/index.php:41:                                <a class="btn btn-sm btn-outline-secondary" href="<?= site_url('ScriptStudio/Edit/' . $script['id']) ?>">Edit</a>
app/Modules/ScriptStudio/Views/index.php:42:                                <a class="btn btn-sm btn-outline-primary" href="<?= site_url('ScriptStudio/Preview/' . $script['id']) ?>">Preview</a>
app/Modules/ScriptStudio/Views/index.php:44:                                    <a class="btn btn-sm btn-outline-dark" href="<?= site_url('ScriptStudio/Export/' . $script['id'] . '/pinescript') ?>">Pine</a>
app/Modules/ScriptStudio/Views/index.php:45:                                    <a class="btn btn-sm btn-outline-dark" href="<?= site_url('ScriptStudio/Export/' . $script['id'] . '/thinkscript') ?>">Think</a>
app/Modules/ScriptStudio/Views/create_edit.php:16:    <form method="post" action="<?= isset($script) ? site_url('ScriptStudio/Update/' . $script['id']) : site_url('ScriptStudio/Store') ?>">
app/Modules/ScriptStudio/Views/create_edit.php:77:                <a href="<?= site_url('ScriptStudio') ?>" class="btn btn-link">Cancel</a>
app/Modules/Exchange/Views/Solana/viewWallet.php:39:        <form action="<?= site_url('Exchange/Solana/Edit-Wallet') ?>" class="form-horizontal gy-3" id="edit_solana_wallet" method="post">
app/Modules/Exchange/Views/Solana/viewWallet.php:165:                <a href="<?= site_url('Exchange/Solana/Wallet/Delete/' . rawurlencode($wallet_id)) ?>"
app/Modules/Exchange/Views/Solana/viewWallet.php:193:      fetch("<?= site_url('Exchange/Solana/Edit-Wallet') ?>", {
app/Modules/Exchange/Views/Solana/viewWallet.php:222:        window.location.href = "<?= site_url('Exchange/Solana/Wallet/Delete/') ?>" + encodeURIComponent(walletID);
app/Modules/Exchange/Views/Solana/assets.php:168:                                                                <li><a href="<?php echo site_url('Exchange/Solana/Token/' . $solanaTP['id']); ?>">View</a></li>
app/Modules/Exchange/Views/Solana/assets.php:244:                                                                <li><a href="<?php echo site_url('Exchange/Solana/Token/' . $solanaTP['id']); ?>">View</a></li>
app/Modules/Exchange/Views/Solana/swap-working.php:51:                                        <a href="<?php echo site_url('Exchange/Solana/Swap'); ?>" class="link">View All</a>
app/Modules/Exchange/Views/Solana/connectWallet.php:23:                <a type="button" class="btn btn-primary" href="<?php echo site_url('/Exchange/Solana'); ?>">Close</a>
app/Modules/Exchange/Views/Buy.php:69:            const result = await fetch("<?= site_url('Exchange/Order_Buy_Manager'); ?>", {
app/Modules/Exchange/Views/Coin_Listing_Asset_Information.php:52:                                            <a href="' . site_url('Assets') . '" class="btn btn-primary"><span>My Assets</span> <em class="icon icon-arrow-right"></em></a>	
app/Modules/Exchange/Views/Coin_Listing_Asset_Information.php:55:                                            <a href="' . site_url('Support') . '" class="btn btn-primary"><span>Support</span> <em class="icon icon-arrow-right"></em></a>	
app/Modules/Exchange/Views/Coin_Listing_Asset_Information.php:74:                                            <a href="' . site_url('Assets') . '" class="btn btn-primary"><span>My Assets</span> <em class="icon icon-arrow-right"></em></a>	
app/Modules/Exchange/Views/Coin_Listing_Asset_Information.php:77:                                            <a href="' . site_url('Support') . '" class="btn btn-primary"><span>Support</span> <em class="icon icon-arrow-right"></em></a>	
app/Modules/Exchange/Views/Coin_Listing_Asset_Information.php:244:            const result = await fetch("<?= site_url('Exchange/Application-Manager/' . $cuID); ?>", {
app/Modules/Exchange/Views/Coin_Listing_Asset_Information.php:253:		   location.href = <?php echo '\'' . site_url('/Exchange/Coin-Listing/Request-Complete') . '\'';?>;
app/Modules/Exchange/Views/includes/application-modal.php:22:			url: <?php echo '\'' . site_url('Exchange/Coin-Listing/Request') . '\''; ?>,
app/Modules/Exchange/Views/includes/application-modal.php:45:			url: <?php echo '\'' . site_url('Exchange/Coin-Listing/Asset-Information-Modal') . '\''; ?>,
app/Modules/Exchange/Views/includes/application-modal.php:68:			url: <?php echo '\'' . site_url('Exchange/Coin-Listing/Asset-Information') . '\''; ?>,
app/Modules/Exchange/Views/includes/application-modal.php:91:			url: <?php echo '\'' . site_url('Customer-Support/Member-Request/' . $cuID) . '\''; ?>,
app/Modules/Exchange/Views/includes/application-modal.php:114:			url: <?php echo '\'' . site_url('Exchange/Coin-Listing/Overview') . '\''; ?>,
app/Modules/Exchange/Views/includes/application-modal.php:137:			url: <?php echo '\'' . site_url('Exchange/Coin-Listing/Multiple-Applications') . '\''; ?>,
app/Modules/Exchange/Views/index.php:165:					<a class="nk-wgw-inner" href="' . site_url('Exchange/Market/' . $market_pair . '/' . $market). '" data-bs-toggle="tooltip" data-placement="bottom" title="' . $description . ' (' . $market . '-' . $market_pair . ')">
app/Modules/Exchange/Views/index.php:299:					// 		<a href="' . site_url('Exchange/Market/' . $market_pair . '/' . $market). '">
app/Modules/Exchange/Views/index.php:393:								// 			<a class="btn btn-lg btn-outline-primary" id="completeAppBtn" href="' . site_url('/Exchange/Coin-Listing/Asset-Information') . '">Continue Now!</a>
app/Modules/Exchange/Views/index.php:432:								// 			<a class="btn btn-lg btn-outline-primary" id="completeAppBtn" href="' . site_url('/Exchange/Coin-Listing/Asset-Information') . '">Apply Now!</a>
app/Modules/Exchange/Views/Sell.php:69:            const result = await fetch("<?= site_url('Exchange/Order_Sell_Manager'); ?>", {
app/Modules/Exchange/Views/Coin_Listing_Request.php:78:            const result = await fetch("<?= site_url('Exchange/Application-Manager/' . $cuID); ?>", {
app/Modules/Exchange/Views/Coin_Listing_Request.php:87:		   location.href = <?php echo '\'' . site_url('/Exchange/Coin-Listing/Asset-Information') . '\'';?>;
app/Modules/Exchange/Views/Coin_Listing_Asset_Information_Modal.orig.php:32:							<a href="<?php echo site_url('Exchange/Coin-Listing/Asset-Information/New'); ?>">
app/Modules/Exchange/Views/Coin_Listing_Asset_Information_Modal.orig.php:40:							<a href="<?php echo site_url('Exchange/Coin-Listing/Asset-Information/Existing'); ?>">
app/Modules/Exchange/Views/Coin_Listing_Asset_Information_Modal.php:143:            const result = await fetch("<?= site_url('Exchange/Application-Manager/' . $cuID); ?>", {
app/Modules/Exchange/Views/Coin_Listing_Asset_Information_Modal.php:152:		   location.href = <?php echo '\'' . site_url('/Exchange/Coin-Listing/Asset-Information') . '\'';?>;
app/Modules/Management/Views/Alerts/resources/rh-keygen.php:71:  const r = (p) => "<?= site_url('API/Alerts/') ?>" + p;
app/Modules/Management/Views/Alerts/resources/advisorMedia.php:69:            url: '<?= site_url("API/Alerts/generateNow") ?>',
app/Modules/Management/Views/Alerts/resources/management-tools.php:9:                            <a href="<?php echo site_url('Management/Alerts/Create'); ?>" class="project-title">
app/Modules/Management/Views/Alerts/resources/management-tools.php:39:                            <a href="<?php echo site_url('Management/Alerts/Review'); ?>" class="project-title">
app/Modules/Management/Views/Alerts/resources/management-tools.php:68:                            <a href="<?php echo site_url('Management/Alerts/Reports'); ?>" class="project-title">
app/Modules/Management/Views/Alerts/resources/sendDiscordAlert.php:14:        url: '<?php echo site_url("API/Alerts/sendDiscordAlertsBySymbol"); ?>',
app/Modules/Management/Views/Alerts/resources/action-center.php:29:                <a href="<?php echo site_url('/Management/Alerts/Settings'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Alerts/resources/action-center.php:39:                <a href="<?php echo site_url('/Management/Alerts/Settings'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Alerts/resources/action-center.php:49:                <a href="<?php echo site_url('/Management/Alerts/Audit/Emails'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Alerts/emails/trade_alerts.php:55:            <p><strong>Stock Ticker:</strong> <a href="<?= site_url('/Trades/Alerts/' . $tradeId) ?>"><?= $tradeId ?></a></p>
app/Modules/Management/Views/Alerts/emails/trade_alerts.php:56:            <p><strong>Stock Ticker:</strong>  <a href="<?= site_url('/Trades/Stocks/' . $ticker) ?>"><?= $ticker ?></a></p>
app/Modules/Management/Views/Alerts/research.php:35:                    <a href="<?= site_url('/Management'); ?>">â† Back to Management Dashboard</a>
app/Modules/Management/Views/Alerts/index.php:100:                        <a href="<?php echo site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>						
app/Modules/Management/Views/Alerts/index.php:155:                                                    <form class="row g-2 mb-3" method="get" action="<?= site_url('Management/Alerts'); ?>">
app/Modules/Management/Views/Alerts/index.php:374:    <form class="modal-content" method="post" action="<?= site_url('Management/Alerts/submitTradingView'); ?>">
app/Modules/Management/Views/Alerts/index.php:664:            url: '<?= site_url("API/Alerts/getFilteredAlerts"); ?>',
app/Modules/Management/Views/Alerts/index.php:689:            url: '<?= site_url("API/Alerts/getFilteredAlerts"); ?>',
app/Modules/Management/Views/Alerts/index.php:816:            url: '<?= site_url("API/Alerts/processTradeBatch"); ?>',
app/Modules/Management/Views/Alerts/index.php:855:                url: '<?= site_url("API/Alerts/getLatestPrices"); ?>',
app/Modules/Management/Views/Alerts/index.php:900:            url: '<?= site_url("API/Alerts/createTradeAlert"); ?>',
app/Modules/Management/Views/Alerts/index.php:923:    //         url: '<?= site_url("API/Alerts/createTradeAlert"); ?>',
app/Modules/Management/Views/Alerts/index.php:976:                url: '<?= site_url("API/Alerts/hideTradeAlert"); ?>',
app/Modules/Management/Views/Alerts/index.php:1004:      const res  = await fetch('<?= site_url('Management/Alerts/weeklyTopPerformance'); ?>?limit=' + limit);
app/Modules/Management/Views/Alerts/index.php:1030:      const res = await fetch('<?= site_url('API/Alerts/backfillCategories'); ?>', {
app/Modules/Management/Views/Alerts/Trades.php:74:						<a href="<?php echo site_url('/Management'); ?>">Back to Dashboard</a>						
app/Modules/Management/Views/Alerts/Trades.php:108:                                        <a href="<?php echo site_url('/Management/Assets'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Alerts/Trades.php:398:                                                        <li><a href="<?php echo site_url('Management/Assets'); ?>"><em class="icon ni ni-setting"></em><span>View Existing Assets</span></a></li>
app/Modules/Management/Views/Alerts/Trades.php:419:                                    <a href="<?php echo site_url('Management/Assets'); ?>" class="btn btn-primary btn-block"><i class="fa fa-eye"></i> Manage Assets</a>
app/Modules/Management/Views/Alerts/Trades.php:433:                                        <a href="<?php echo site_url('Management/Assets/Create'); ?>" class="project-title">
app/Modules/Management/Views/Alerts/Trades.php:515:                                            <a class="btn btn-primary" href="<?php echo site_url('Management/Debt-Collector/Clean-Up'); ?>">Clean Up</a>
app/Modules/Management/Views/Alerts/Trades.php:535:                                        <a href="<?php echo site_url('Management/Assets/Distribute'); ?>" class="project-title">
app/Modules/Management/Views/Alerts/modals/createTradeAlert-06282024.php:416:            url: "<?= site_url('API/Alerts/addTradeAlert') ?>",
app/Modules/Management/Views/Alerts/modals/createTradeAlert-06282024.php:430:                        $("#tradeAlertsTable").load("<?= site_url('Management/Alerts #tradeAlertsTable') ?>");
app/Modules/Management/Views/Alerts/modals/createTradeAlert-06282024.php:445:            url: "<?= site_url('API/Alerts/getTechnicalIndicators') ?>",
app/Modules/Management/Views/Alerts/modals/createTradeAlert-06282024.php:629:            url: '<?=site_url('API/Alerts/generateTradeAlertSummary')?>',
app/Modules/Management/Views/Alerts/modals/createTradeAlert-06282024.php:764:            url: '<?= site_url('API/Alerts/generateTradeAlertSummary') ?>',
app/Modules/Management/Views/Alerts/modals/createTradeAlert-06282024.php:831:            url: '<?= site_url('API/Alerts/validateSymbol') ?>',
app/Modules/Management/Views/Alerts/modals/createTradeAlert.php:413:            url: "<?= site_url('API/Alerts/addTradeAlert') ?>",
app/Modules/Management/Views/Alerts/modals/createTradeAlert.php:427:                        $("#tradeAlertsTable").load("<?= site_url('Management/Alerts #tradeAlertsTable') ?>");
app/Modules/Management/Views/Alerts/modals/createTradeAlert.php:451:                url: "<?= site_url('API/Alerts/getFullMetrics') ?>",
app/Modules/Management/Views/Alerts/modals/createTradeAlert.php:642:            url: `<?= site_url('API/Alerts/getFullMetrics') ?>`,
app/Modules/Management/Views/Alerts/modals/createTradeAlert.php:714:            url: "<?= site_url('API/Alerts/generateTradeAlertSummary') ?>",
app/Modules/Management/Views/Alerts/modals/manageTradeAlert copy.php:130:            url: '<?= site_url("API/Alerts/manageTradeAlert") ?>',
app/Modules/Management/Views/Alerts/modals/manageTradeAlert copy.php:175:            url: '<?=site_url("API/Alerts/generateAndStoreVoiceover")?>',
app/Modules/Management/Views/Alerts/modals/manageTradeAlert copy.php:214:            url: '<?= site_url("API/Alerts/storeMarketingContent") ?>',
app/Modules/Management/Views/Alerts/modals/manageTradeAlert copy.php:242:            url: '<?= site_url("API/Alerts/sendAlert") ?>',
app/Modules/Management/Views/Alerts/modals/manageTradeAlert copy.php:281://             url: '<?= site_url("API/Alerts/manageTradeAlert") ?>',
app/Modules/Management/Views/Alerts/modals/manageTradeAlert copy.php:325://             url: '<?= site_url("API/Alerts/storeMarketingContent") ?>',
app/Modules/Management/Views/Alerts/modals/manageTradeAlert copy.php:352://             url: '<?= site_url("API/Alerts/sendTradeAlert") ?>',
app/Modules/Management/Views/Alerts/modals/createTradeAlert-06162025.php:276:            url: "<?= site_url('API/Alerts/addTradeAlert') ?>",
app/Modules/Management/Views/Alerts/modals/createTradeAlert-06162025.php:290:                        $("#tradeAlertsTable").load("<?= site_url('Management/Alerts #tradeAlertsTable') ?>");
app/Modules/Management/Views/Alerts/modals/createTradeAlert-06162025.php:409:            url: '<?=site_url('API/Alerts/generateTradeAlertSummary')?>',
app/Modules/Management/Views/Alerts/modals/createTradeAlert-06162025.php:539:            url: '<?= site_url('API/Alerts/generateTradeAlertSummary') ?>',
app/Modules/Management/Views/Alerts/modals/manageTradeAlert.php:81:            url: '<?= site_url("API/Alerts/manageTradeAlert") ?>',
app/Modules/Management/Views/Alerts/modals/manageTradeAlert.php:130:            url: '<?= site_url("API/Alerts/storeMarketingContent") ?>',
app/Modules/Management/Views/Alerts/modals/manageTradeAlert.php:154:            url: '<?= site_url("API/Alerts/sendAlert") ?>',
app/Modules/Management/Views/Alerts/modals/viewTradeChart.php:218:            url: "<?= site_url('API/Alerts/updateExchange') ?>",
app/Modules/Management/Views/Alerts/modals/viewTradeChart.php:282:            url: "<?= site_url('API/Alerts/updateChartOverride') ?>",
app/Modules/Management/Views/Alerts/modals/updateExchange.php:53:            url: "<?= site_url('API/Alerts/updateExchange') ?>",
app/Modules/Management/Views/Alerts/index copy.php:79:                        <a href="<?php echo site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>						
app/Modules/Management/Views/Alerts/index copy.php:115:                                        <a href="<?php echo site_url('/Management/Alerts/Settings'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Alerts/index copy.php:410:                                        <a href="<?php echo site_url('Management/Alerts/Create'); ?>" class="project-title">
app/Modules/Management/Views/Alerts/index copy.php:440:                                        <a href="<?php echo site_url('Management/Alerts/Review'); ?>" class="project-title">
app/Modules/Management/Views/Alerts/index copy.php:469:                                        <a href="<?php echo site_url('Management/Alerts/Reports'); ?>" class="project-title">
app/Modules/Management/Views/Alerts/index copy.php:537:                                                    $detailsLink = '<a href="' . site_url('Management/Alerts/Trade/Details/' . $alert['id']) . '" target="_blank">Details</a>';
app/Modules/Management/Views/Alerts/index copy.php:538:                                                    $addDetailsLink = '<a href="' . site_url('Management/Alerts/Trade/Edit/' . $alert['id']) . '" target="_blank"><em class="icon ni ni-plus"></em> Add</a>';
app/Modules/Management/Views/Alerts/index copy.php:546:                                                    <td><a href="<?= site_url('Management/Alerts/Distribute/' . $alert['id']) ?>"><em class="icon ni ni-bell"></em></a></td>
app/Modules/Management/Views/Alerts/tradeAnalysis.php:13:$ctaLink = site_url('/X/register');
app/Modules/Management/Views/Alerts/tradeAnalysis.php:22:                    <a href="<?php echo site_url('/Trade-Tracker'); ?>" class="btn btn-primary">Back to Dashboard</a>
app/Modules/Management/Views/Wallets/Listing-Table.php:21:                            <td><a href="' . site_url('Management/Wallets/Details/' . $wallet['id']) . '">' . $wallet['id'] . '</a></td>
app/Modules/Management/Views/Wallets/Listing-Table.php:24:                            <td><a href="' . site_url('Management/Users/Profile/' . $wallet['user_id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Profile"><em class="icon ni ni-user"></em> ' . $wallet['nickname'] . '</a></td>
app/Modules/Management/Views/Wallets/Listing-Table.php:28:                                <a href="' . site_url('Management/Users/Profile/' . $wallet['user_id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Profile"><em class="icon ni ni-user"></em></a>
app/Modules/Management/Views/Wallets/Listing-Table.php:29:                                <a href="' . site_url('Management/Users/Assets/' . $wallet['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Assets"><em class="icon ni ni-coin"></em></a>
app/Modules/Management/Views/Wallets/Listing-Table.php:30:                                <a href="' . site_url('Management/Users/Distribute/' . $wallet['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="Distribute Coins"><em class="icon ni ni-coins"></em></a>
app/Modules/Management/Views/Wallets/Generate_Wallets.php:40:						<a href="<?php echo site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Wallets/Generate_Wallets.php:74:                                        <a href="<?php echo site_url('/Management/Assets'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Wallets/Generate_Wallets.php:159:                                            <a href="<?php echo site_url('Budget/Income'); ?>">
app/Modules/Management/Views/Wallets/Generate_Wallets.php:171:                                            <a href="<?php echo site_url('Budget/Expenses'); ?>">
app/Modules/Management/Views/Wallets/Generate_Wallets.php:216:                                                    <a class="link py-3" href="<?php echo site_url('Management/Assets/Create'); ?>"><i class="icon ni ni-plus-circle"></i> Add Asset</a>
app/Modules/Management/Views/Wallets/Reconcile_Report.php:40:          $editUrl = site_url("Dashboard/Transaction-Modal/Edit/{$editType}/{$i['wallet_id']}");
app/Modules/Management/Views/Wallets/Reconcile_Report.php:50:            <form method="post" action="<?=site_url('Management/Wallets/NotifyUser')?>" style="display:inline-block;">
app/Modules/Management/Views/Wallets/Reconcile.php:150:    const res = await fetch('<?= site_url('Management/Wallets/Reconcile') ?>', { headers: {'X-Requested-With': 'XMLHttpRequest'} });
app/Modules/Management/Views/Wallets/Reconcile.php:163:      const res = await fetch('<?= site_url('Management/Wallets/EmailUserAboutIssue') ?>/' + user + '/' + wallet, {
app/Modules/Management/Views/Wallets/index.php:42:						<a href="<?php echo site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Wallets/index.php:61:                                                        <li><a href="<?php echo site_url('/Management/Wallets/Generate-Wallets'); ?>"><em class="icon ni ni-wallet"></em><span>Generate Wallets</span></a></li>
app/Modules/Management/Views/Wallets/index.php:76:                                        <a href="<?php echo site_url('/Management/Assets'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Wallets/index.php:96:                                        <a href="<?= site_url('Management/Wallets/Reconcile') ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Wallets/index.php:178:                                                    <a class="link py-3" href="<?php echo site_url('Management/Assets/Create'); ?>"><i class="icon ni ni-plus-circle"></i> Add Asset</a>
app/Modules/Management/Views/Reporting.php:217:                                            <li><a href="<?php echo site_url('Management/Assets'); ?>"><em class="icon ni ni-setting"></em><span>View Existing Assets</span></a></li>
app/Modules/Management/Views/Reporting.php:239:                        <a href="<?php echo site_url('Management/Assets'); ?>" class="btn btn-primary btn-block"><i class="fa fa-eye"></i> Manage Assets</a>
app/Modules/Management/Views/Support/Reporting.php:63:						<a href="<?php echo site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Support/Reporting.php:97:                                        <a href="<?php echo site_url('Management/Assets/Support/Requests'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Support/Reporting.php:121:                                        <a href="<?php echo site_url('/Management/Assets'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Support/Template.php:17:						<a href="<?php echo site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Support/Requests/Details.php:11:                        <a href="<?php echo site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Support/Requests/Details.php:38:                                                            <li><a href="' . site_url('Users/Profile/' . $userInfo['id']) . '"><em class="icon ni ni-eye"></em><span>View Details</span></a></li>
app/Modules/Management/Views/Support/Requests/Details.php:41:                                                            <li><a href="' . site_url('Users/Force-Reset/' . $userInfo['id']) . '"><em class="icon ni ni-shield-star"></em><span>Reset Pass</span></a></li>
app/Modules/Management/Views/Support/Requests/Details.php:43:                                                            <li><a href="' . site_url('Users/Block/' . $userInfo['id']) . '"><em class="icon ni ni-na"></em><span>Suspend User</span></a></li>
app/Modules/Management/Views/Support/Requests/Details.php:64:                                                <a href="' . site_url('Management/Users/Profile/' . $userInfo['id']) . '" class="btn btn-block btn-dim btn-primary text-white"><span>View Profile</span></a>
app/Modules/Management/Views/Support/Requests/Listing-Table.php:23:                            <td><a href="' . site_url('Management/' . $pageURIB . '/Support/Requests/' . $support['id']) . '"><i class="icon icon-plus"></i></a></td>
app/Modules/Management/Views/Support/Requests/Listing.php:23:                            <td><a href="' . site_url('Management/' . $pageURIB . '/Support/Requests/' . $support['id']) . '"><i class="icon icon-details"></i></a></td>
app/Modules/Management/Views/Marketing/financialNews.php:84:            const response = await fetch('<?= site_url('/Management/Marketing/fetchMissingLogos') ?>', {
app/Modules/Management/Views/Marketing/financialNews.php:116:                const response = await fetch('<?= site_url('/Management/Marketing/fetchMissingLogos') ?>', {
app/Modules/Management/Views/Marketing/resources/standaloneLargeContentForm.php:2:<form class="form-horizontal" id="largeContentForm" enctype="multipart/form-data" method="POST" action="<?= site_url('API/Marketing/submitLargeContent') ?>">
app/Modules/Management/Views/Marketing/resources/standaloneLargeContentForm.php:78:    fetch('<?= site_url('Management/Marketing/submitLargeContent'); ?>', {
app/Modules/Management/Views/Marketing/resources/standaloneLargeContentForm.php:96:            window.location.href = '<?= site_url('Management/Marketing'); ?>';
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:30:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Monday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:37:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Monday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:44:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Monday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:52:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Tuesday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:59:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Tuesday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:66:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Tuesday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:74:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Wednesday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:81:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Wednesday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:88:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Wednesday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:96:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Thursday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:103:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Thursday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:110:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Thursday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:118:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Friday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:125:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Friday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:132:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Friday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:140:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Saturday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:147:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Saturday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:155:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Sunday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:162:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Sunday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneCalendar.php:169:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Sunday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/resources/standaloneScraperForm.php:11:            <a href="<?= site_url('/Marketing/Campaigns/Add'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/resources/standaloneScraperForm.php:56:        fetch('<?= site_url('Management/Marketing/Scrape-Link') ?>', {
app/Modules/Management/Views/Marketing/resources/standaloneScraperForm.php:101:    fetch(`<?= site_url('Management/Marketing/generatePostsFromSummary') ?>/${id}`)
app/Modules/Management/Views/Marketing/resources/standaloneScraperForm.php:111:    fetch(`<?= site_url('Management/Marketing/getScrapeDetails') ?>/${id}`)
app/Modules/Management/Views/Marketing/resources/standaloneScraperForm.php:121:    fetch(`<?= site_url('Management/Marketing/deleteScrape') ?>/${id}`, {
app/Modules/Management/Views/Marketing/resources/standaloneScraper.php:34:                            fetch('<?php echo site_url('Management/Marketing/Scrape-Link'); ?>', {
app/Modules/Management/Views/Marketing/resources/standaloneScraper.php:164:    fetch('<?php echo site_url('Management/Marketing/getRecentScrapes'); ?>')
app/Modules/Management/Views/Marketing/resources/standaloneShortLongPostForm.php:2:<form class="form-horizontal" id="manualContentForm" method="POST" enctype="multipart/form-data" action="<?= site_url('Management/Marketing/submitManualContent'); ?>">
app/Modules/Management/Views/Marketing/resources/standaloneShortLongPostForm.php:25:        fetch('<?= site_url('Management/Marketing/submitManualContent'); ?>', {
app/Modules/Management/Views/Marketing/resources/standaloneShortLongPostForm.php:32:                window.location.href = '<?= site_url('Management/Marketing'); ?>';
app/Modules/Management/Views/Marketing/resources/dripCampaignBlock.php:15:                        <a href="<?= site_url("Management/Drip-Campaigns/{$campaign['id']}/Steps") ?>"
app/Modules/Management/Views/Marketing/resources/dripCampaignBlock.php:25:            <a href="<?= site_url('Management/Drip-Campaigns/Create') ?>" class="btn btn-sm btn-success">
app/Modules/Management/Views/Marketing/resources/dripCampaignBlock.php:28:            <a href="<?= site_url('Management/Drip-Campaigns/TestCron') ?>" class="btn btn-sm btn-warning">
app/Modules/Management/Views/Marketing/resources/generatedSummaries.php:222:        fetch('<?= site_url("API/Marketing/getTopKeywordChart") ?>/' + defaultSummaryId)
app/Modules/Management/Views/Marketing/resources/generatedSummaries.php:341:        const response = await fetch('<?= site_url("API/Marketing/fetchGeneratedSummariesJson") ?>');
app/Modules/Management/Views/Marketing/resources/generatedSummaries.php:440:        const url = '<?= site_url("Management/Marketing/previewGeneratedPost") ?>/' + summary.id;
app/Modules/Management/Views/Marketing/resources/viewTempScrapedEmails.php:6:      <form action="<?= site_url('Marketing/GenerateFromSimilar/' . $email['id']) ?>" method="post">
app/Modules/Management/Views/Marketing/resources/viewTempScrapedEmails.php:10:      <form action="<?= site_url('Marketing/ForceGenerateFromTemp/' . $email['id']) ?>" method="post">
app/Modules/Management/Views/Marketing/resources/finalizedSummaries.php:11:                        <button class="btn btn-primary btn-sm" onclick='dynamicModalLoader("ðŸ“‹ Preview Generated Post", "<?= site_url('Management/Marketing/previewGeneratedPost/' . $post->id) ?>", "modal-lg")'>ðŸ“‹ Preview</button>
app/Modules/Management/Views/Marketing/resources/standaloneDailyLogForm.php:2:<form class="form-horizontal" id="dailyLogForm" enctype="multipart/form-data" method="POST" action="<?= site_url('Management/Marketing/submitDailyLog') ?>">
app/Modules/Management/Views/Marketing/resources/standaloneDailyLogForm.php:91:        fetch('<?= site_url("Management/Marketing/submitDailyLog") ?>', {
app/Modules/Management/Views/Marketing/resources/standaloneDailyLogForm.php:98:                window.location.href = '<?= site_url("Management/Marketing") ?>';
app/Modules/Management/Views/Marketing/resources/controlPanelBlock.php:18:            <a class="btn btn-warning" href="<?= site_url('API/Management/triggerBackfill'); ?>">
app/Modules/Management/Views/Marketing/resources/controlPanelBlock.php:21:            <a href="<?= site_url('Management/Marketing/View-Grouped-Summaries') ?>" class="btn btn-outline-info">
app/Modules/Management/Views/Marketing/resources/controlPanelBlock.php:24:            <a href="<?= site_url('API/Marketing/publishGroupedContentDraft') ?>" 
app/Modules/Management/Views/Marketing/resources/controlPanelBlock.php:55:            const response = await fetch("<?= site_url('API/Marketing/generateDailyContentDigest') ?>");
app/Modules/Management/Views/Marketing/resources/controlPanelBlock.php:80:                const response = await fetch("<?= site_url('API/Marketing/generateContentFromScraper') ?>");
app/Modules/Management/Views/Marketing/resources/controlPanelBlock.php:105:            const response = await fetch("<?= site_url('API/Marketing/massResendActivationEmails') ?>", {
app/Modules/Management/Views/Marketing/resources/controlPanelBlock.php:135:            const response = await fetch("<?= site_url('API/Marketing/reprocessIncompleteEmails') ?>");
app/Modules/Management/Views/Marketing/resources/controlPanelBlock.php:149:            const response = await fetch(`<?= site_url('API/Management/approveBufferItem/') ?>${id}`, {
app/Modules/Management/Views/Marketing/resources/controlPanelBlock.php:172:            const response = await fetch("<?= site_url('API/Management/runKeywordBackfillBatch') ?>");
app/Modules/Management/Views/Marketing/resources/controlPanelBlock.php:191:        window.open("<?= site_url('API/Management/exportBufferPosts') ?>", '_blank');
app/Modules/Management/Views/Marketing/resources/controlPanelBlock.php:199:            const res = await fetch("<?= site_url('API/Marketing/previewPendingSummaries') ?>");
app/Modules/Management/Views/Marketing/resources/controlPanelBlock.php:211:            const response = await fetch(`<?= site_url('API/Management/rejectBufferItem/') ?>${id}`, {
app/Modules/Management/Views/Marketing/resources/standaloneAddSubscriberForm.php:37:        fetch('<?php echo site_url('Management/Marketing/Add-Subscriber'); ?>', {
app/Modules/Management/Views/Marketing/resources/groupedSummariesView.php:5:        <a href="<?= site_url('API/Management/exportGroupedSummariesCSV') ?>" class="btn btn-sm btn-outline-secondary">ðŸ“ Export CSV</a>
app/Modules/Management/Views/Marketing/resources/groupedSummariesView.php:6:        <a href="<?= site_url('API/Management/shareGroupedSummaries/discord') ?>" class="btn btn-sm btn-outline-primary">ðŸ“¤ Share to Discord</a>
app/Modules/Management/Views/Marketing/resources/groupedSummariesView.php:7:        <a href="<?= site_url('API/Management/shareGroupedSummaries/linkedin') ?>" class="btn btn-sm btn-outline-info">ðŸ“¤ Share to LinkedIn</a>
app/Modules/Management/Views/Marketing/resources/groupedSummariesView.php:23:                            <a href="<?= site_url('Marketing/PreviewGeneratedPost/' . $summary['id']) ?>" class="btn btn-sm btn-outline-primary" target="_blank">Preview</a>
app/Modules/Management/Views/Marketing/Twitter.php:10:                        <a href="<?php echo site_url('/Management'); ?>">Back to Management Dashboard</a>
app/Modules/Management/Views/Marketing/keywords.php:30:                        <a href="<?= site_url('/Management/Marketing'); ?>">Back to Marketing Dashboard</a>
app/Modules/Management/Views/Marketing/contentGenerator.php:24:                        <a href="<?php echo site_url('/Management/Marketing'); ?>">Back to Marketing Dashboard</a>
app/Modules/Management/Views/Marketing/contentGenerator.php:62:                                <form action="<?php echo site_url('Management/Marketing/addContent'); ?>" method="post">
app/Modules/Management/Views/Marketing/contentGenerator.php:114:                                                <a href="<?php echo site_url('Management/Marketing/editContent/' . $content->id); ?>" class="btn btn-sm btn-warning">Edit</a>
app/Modules/Management/Views/Marketing/contentGenerator.php:115:                                                <a href="<?php echo site_url('Management/Marketing/deleteContent/' . $content->id); ?>" class="btn btn-sm btn-danger">Delete</a>
app/Modules/Management/Views/Marketing/contentGenerator.php:150:            window.location.href = "<?php // echo site_url('Management/Marketing/generateContent'); ?>";
app/Modules/Management/Views/Marketing/View_Blog.php:13:            <a href="<?= site_url('/Management/Marketing/Blogs/Edit/' . $blog->id) ?>" class="btn btn-warning">Edit</a>
app/Modules/Management/Views/Marketing/View_Blog.php:14:            <a href="<?= site_url('/Management/Marketing/Blogs') ?>" class="btn btn-secondary">Back to Blogs</a>
app/Modules/Management/Views/Marketing/index.04192025.php:64:                        <a href="<?php echo site_url('/Management'); ?>">Back to Management Dashboard</a>
app/Modules/Management/Views/Marketing/index.04192025.php:311://     fetch('<?php echo site_url('API/Marketing/generateDailyContentDigest'); ?>')
app/Modules/Management/Views/Marketing/index.04192025.php:334://         fetch('<?php echo site_url('API/Marketing/massResendActivationEmails'); ?>', {
app/Modules/Management/Views/Marketing/index.04192025.php:365://     fetch("<?= site_url('API/Marketing/generateContentFromScraper') ?>")
app/Modules/Management/Views/Marketing/index.04192025.php:385://             url: "<?= site_url('Management/reprocessIncompleteEmails') ?>",
app/Modules/Management/Views/Marketing/index.04192025.php:433:            const response = await fetch("<?= site_url('API/Marketing/generateDailyContentDigest') ?>");
app/Modules/Management/Views/Marketing/index.04192025.php:458:                const response = await fetch("<?= site_url('API/Marketing/generateContentFromScraper') ?>");
app/Modules/Management/Views/Marketing/index.04192025.php:483:            const response = await fetch("<?= site_url('API/Marketing/massResendActivationEmails') ?>", {
app/Modules/Management/Views/Marketing/index.04192025.php:513:            const response = await fetch("<?= site_url('Management/reprocessIncompleteEmails') ?>");
app/Modules/Management/Views/Marketing/index.04192025.php:527:            const response = await fetch(`<?= site_url('API/Management/approveBufferItem/') ?>${id}`, {
app/Modules/Management/Views/Marketing/index.04192025.php:542:        window.open("<?= site_url('API/Management/exportBufferPosts') ?>", '_blank');
app/Modules/Management/Views/Marketing/index.04192025.php:550:            const res = await fetch("<?= site_url('API/Marketing/previewPendingSummaries') ?>");
app/Modules/Management/Views/Marketing/index.04192025.php:562:            const response = await fetch(`<?= site_url('API/Management/rejectBufferItem/') ?>${id}`, {
app/Modules/Management/Views/Marketing/dashboard.txt:259:                'id'            => '<a href="' . site_url('Management/Users/Profile/' . $user['username']) . '">' . $user['id'] . '</a>',
app/Modules/Management/Views/Marketing/dashboard.txt:323:                'id'            => '<a href="' . site_url('Management/Users/Profile/' . $user['username']) . '">' . $user['id'] . '</a>',
app/Modules/Management/Views/Marketing/dashboard.txt:1739:                return redirect()->to(site_url('Management/Marketing/Exchanges/Edit/' . $id));
app/Modules/Management/Views/Marketing/dashboard.txt:1749:            'redirectURL' => site_url('Management/Marketing/Exchanges'),
app/Modules/Management/Views/Marketing/dashboard.txt:2073:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Views/Marketing/dashboard.txt:2397:            return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Views/Marketing/dashboard.txt:2616:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Views/Marketing/dashboard.txt:4774:            'url' => site_url('/Management/Marketing/Page-SEO/' . $task_info['seo_id']),
app/Modules/Management/Views/Marketing/dashboard.txt:6179:                        <a href="<?php echo site_url('/Management'); ?>">Back to Management Dashboard</a>
app/Modules/Management/Views/Marketing/dashboard.txt:6342:    fetch('<?php echo site_url('API/Marketing/generateDailyContentDigest'); ?>')
app/Modules/Management/Views/Marketing/dashboard.txt:6365:        fetch('<?php echo site_url('API/Marketing/massResendActivationEmails'); ?>', {
app/Modules/Management/Views/Marketing/dashboard.txt:6398:    fetch("<?= site_url('API/Marketing/generateContentFromScraper') ?>")
app/Modules/Management/Views/Marketing/dashboard.txt:6418:            url: "<?= site_url('Management/reprocessIncompleteEmails') ?>",
app/Modules/Management/Views/Marketing/dashboard.txt:6446:                <p><a href="<?php echo site_url('/Marketing/Campaigns/Add'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/dashboard.txt:6448:            <a href="<?php echo site_url('/Management/Marketing/Campaigns/Add'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/dashboard.txt:6460:                <p><a href="<?php echo site_url('/Management/Marketing/RunContentGeneration'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/dashboard.txt:6462:            <a href="<?php echo site_url('/Management/Marketing/RunContentGeneration'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/dashboard.txt:6474:                <p><a href="<?php echo site_url('/Management/Marketing/Blogs'); ?>"><strong><?php // echo $totalActiveUsers; ?> View & Manage</strong></a> all blog content that have been generated.</p>
app/Modules/Management/Views/Marketing/dashboard.txt:6476:            <a href="<?php echo site_url('/Management/Marketing/Blogs'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/dashboard.txt:6488:                <p><a href="<?php echo site_url('/Management/Marketing/fetchEmails'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/dashboard.txt:6490:            <a href="<?php echo site_url('/Management/Marketing/fetchEmails'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/dashboard.txt:6502:                <p><a href="<?php echo site_url('Management/Marketing/generateNewsletter'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/dashboard.txt:6504:            <a href="<?php echo site_url('/Management/Marketing/generateNewsletter'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/dashboard.txt:6516:                <p><a href="<?php echo site_url('Management/Marketing/scheduleNewsletters'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/dashboard.txt:6518:            <a href="<?php echo site_url('/Management/Marketing/scheduleNewsletters'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/dashboard.txt:6530:                <p><a href="<?php echo site_url('/Management/Marketing/Tools'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/dashboard.txt:6532:            <a href="<?php echo site_url('/Management/Marketing/Tools'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/dashboard.txt:6559:                <p><a href="<?php echo site_url('/Management/Marketing/Campaigns/Add'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/dashboard.txt:6561:            <a href="<?php echo site_url('/Management/Marketing/Campaigns/Add'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/dashboard.txt:6572:                <p><a href="<?php echo site_url('/Marketing/SEO/Tasks'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/dashboard.txt:6574:            <a href="<?php echo site_url('/Marketing/SEO/Tasks'); ?>" class="btn btn-warning btn-md">
app/Modules/Management/Views/Marketing/dashboard.txt:6585:                <p><a href="<?php echo site_url('/Marketing/Reports'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/dashboard.txt:6587:            <a href="<?php echo site_url('/Marketing/Reports'); ?>" class="btn btn-info btn-md">
app/Modules/Management/Views/Marketing/dashboard.txt:6598:                <p><a href="<?php echo site_url('/Marketing/Reports'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/dashboard.txt:6600:            <a href="<?php echo site_url('/Marketing/Tools'); ?>" class="btn btn-success btn-md">
app/Modules/Management/Views/Marketing/dashboard.txt:6708:        fetch('<?php echo site_url('Management/Marketing/getRecentScrapes'); ?>')
app/Modules/Management/Views/Marketing/dashboard.txt:6739:                    View The <a href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities'); ?>"><strong><?php  ?>Exchange Communities</strong></a> 
app/Modules/Management/Views/Marketing/dashboard.txt:6749:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Discord'); ?>">Discord</a></li>
app/Modules/Management/Views/Marketing/dashboard.txt:6750:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Facebook'); ?>">Facebook</a></li>
app/Modules/Management/Views/Marketing/dashboard.txt:6751:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Twitter'); ?>">X (Twitter)</a></li>
app/Modules/Management/Views/Marketing/dashboard.txt:6752:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Website'); ?>">Website</a></li>
app/Modules/Management/Views/Marketing/dashboard.txt:6764:                    View the <a href="<?php echo site_url('Management/Marketing/Exchanges/Top-Performers'); ?>"><strong><?php  ?>Top Performing Currencies</strong></a> 
app/Modules/Management/Views/Marketing/dashboard.txt:6987:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Monday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:6994:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Monday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7001:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Monday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7009:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Tuesday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7016:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Tuesday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7023:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Tuesday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7031:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Wednesday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7038:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Wednesday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7045:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Wednesday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7053:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Thursday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7060:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Thursday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7067:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Thursday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7075:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Friday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7082:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Friday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7089:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Friday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7097:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Saturday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7104:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Saturday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7112:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Sunday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7119:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Sunday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7126:                                                <a href="<?php echo site_url('/Management/Marketing/Schedule/Sunday'); ?>" class="btn btn-link">Details</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7185:                            <a class="link py-3" href="<?php echo site_url('Management/Marketing/MyMI-Gold/Tasks/Add'); ?>"><i class="icon ni ni-plus-circle"></i> <span class="pl-0" style="padding-top:3px;">Add News Task</span></a>
app/Modules/Management/Views/Marketing/dashboard.txt:7267:        url: '<?php echo site_url('/Management/Marketing/summarizeArticle/'); ?>' + articleId,
app/Modules/Management/Views/Marketing/dashboard.txt:7334:                                            <a href="' . site_url('Management/Marketing/Campaigns/View/' . $campaigns['id']) . '"><i class="icon myfs-md ni ni-eye"></i></a>
app/Modules/Management/Views/Marketing/dashboard.txt:7335:                                            <a href="' . site_url('Management/Marketing/Campaigns/Edit/' . $campaigns['id']) . '"><i class="icon myfs-md ni ni-edit"></i></a>
app/Modules/Management/Views/Marketing/dashboard.txt:7336:                                            <a href="' . site_url('Management/Marketing/Campaigns/Generate-Content/' . $campaigns['id']) . '"><i class="icon myfs-md ni ni-spark"></i></a>
app/Modules/Management/Views/Marketing/dashboard.txt:7337:                                            <a class="text-red" href="' . site_url('Management/Marketing/Campaigns/Delete/' . $campaigns['id']) . '"><i class="icon myfs-md ni ni-trash"></i></a>
app/Modules/Management/Views/Marketing/dashboard.txt:7377:                        <a href="<?php echo site_url('Marketing/Blog/Edit/' . $blog['id']); ?>" class="btn btn-sm btn-warning">Edit</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7378:                        <a href="<?php echo site_url('Marketing/Blog/Delete/' . $blog['id']); ?>" class="btn btn-sm btn-danger">Delete</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7406:                        <a href="<?php echo site_url('Marketing/SEO/Edit/' . $task['id']); ?>" class="btn btn-sm btn-warning">Edit</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7407:                        <a href="<?php echo site_url('Marketing/SEO/Delete/' . $task['id']); ?>" class="btn btn-sm btn-danger">Delete</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7433:                        <a href="<?php echo site_url('Marketing/News/Edit/' . $news['id']); ?>" class="btn btn-sm btn-warning">Edit</a>
app/Modules/Management/Views/Marketing/dashboard.txt:7434:                        <a href="<?php echo site_url('Marketing/News/Delete/' . $news['id']); ?>" class="btn btn-sm btn-danger">Delete</a>
app/Modules/Management/Views/Marketing/Add.php:23:    'redirectURL' => $redirectURL ?? site_url('/Management/Marketing'),
app/Modules/Management/Views/Marketing/Add.php:49:                        <form id="add_marketing_form" method="POST" action="<?= site_url('Management/Marketing/Add/' . $accountType) ?>">
app/Modules/Management/Views/Marketing/Add.php:106:                const response = await fetch("<?= site_url('Management/Marketing/SubmitForm'); ?>", {
app/Modules/Management/Views/Marketing/Add.php:122:                    window.location.href = "<?= site_url('/Management/Marketing/Campaigns'); ?>";
app/Modules/Management/Views/Marketing/News/Listing-Table.php:19:                        <a href="<?php echo site_url('Marketing/News/Edit/' . $news['id']); ?>" class="btn btn-sm btn-warning">Edit</a>
app/Modules/Management/Views/Marketing/News/Listing-Table.php:20:                        <a href="<?php echo site_url('Marketing/News/Delete/' . $news['id']); ?>" class="btn btn-sm btn-danger">Delete</a>
app/Modules/Management/Views/Marketing/News/Listing-Table.orig.php:11:                            <a class="link py-3" href="<?php echo site_url('Management/Marketing/Campaigns/Add'); ?>"><i class="icon ni ni-plus-circle"></i> <span class="pl-0" style="padding-top:3px;">Add News Article</span></a>
app/Modules/Management/Views/Marketing/News/Listing-Table.orig.php:58:    //         url: '<?php echo site_url('/Management/Marketing/getNewsArticles') ?>', // Replace with your API endpoint that returns the campaigns
app/Modules/Management/Views/Marketing/News/Listing-Table.orig.php:77:    //                 //     <a href="${site_url('Management/Marketing/Campaigns/Edit/' + data)}"><i class="icon myfs-md ni ni-edit"></i></a>
app/Modules/Management/Views/Marketing/News/Listing-Table.orig.php:78:    //                 //     <a href="${site_url('Management/Marketing/Campaigns/Copy/' + data)}"><i class="icon myfs-md ni ni-copy"></i></a>
app/Modules/Management/Views/Marketing/News/Listing-Table.orig.php:79:    //                 //     <a class="text-red" href="${site_url('Management/Marketing/Campaigns/Delete/' + data)}"><i class="icon myfs-md ni ni-trash"></i></a>
app/Modules/Management/Views/Marketing/News/Listing-Table.orig.php:91:        url: '<?php echo site_url('/Management/Marketing/summarizeArticle/'); ?>' + articleId,
app/Modules/Management/Views/Marketing/index.orig.php:66:						<a href="<?php echo site_url('/Management'); ?>">Back to Management Dashboard</a>							
app/Modules/Management/Views/Marketing/User/MyMIGold-Tasks.php:11:                            <a class="link py-3" href="<?php echo site_url('Management/Marketing/MyMI-Gold/Tasks/Add'); ?>"><i class="icon ni ni-plus-circle"></i> <span class="pl-0" style="padding-top:3px;">Add News Task</span></a>
app/Modules/Management/Views/Marketing/User/MyMIGold-Tasks.php:93:        url: '<?php echo site_url('/Management/Marketing/summarizeArticle/'); ?>' + articleId,
app/Modules/Management/Views/Marketing/Schedule.php:31:                                    <a class="btn btn-primary" href="<?= site_url('Management/Marketing/Add/Schedule'); ?>"><em class="icon myfs-md ni ni-plus"></em><span>Add New Schedule</span></a>
app/Modules/Management/Views/Marketing/Schedule/Add.php:164:                        <form method="post" action="<?php site_url('Management/Marketing/Add/Schedule') ?>">
app/Modules/Management/Views/Marketing/Schedule/Add.php:248:        const response = await fetch("<?php echo site_url('Management/Marketing/Marketing_Manager'); ?>", {
app/Modules/Management/Views/Marketing/research.php:35:                    <a href="<?= site_url('/Management'); ?>">â† Back to Management Dashboard</a>
app/Modules/Management/Views/Marketing/Tools/Exchange/Solana.php:38:                        <a class="btn btn-primary btn-block" href="<?= site_url('Exchange/Solana'); ?>"><i class="icon ni ni-eye"></i> View Assets</a>
app/Modules/Management/Views/Marketing/Tools/Exchange/Solana.php:56:                                            <li><a href="<?php echo site_url('Management/Marketing/Support'); ?>"><em class="icon ni ni-setting"></em><span>View Support</span></a></li>
app/Modules/Management/Views/Marketing/Tools/Exchange/Solana.php:57:                                            <li><a href="<?php echo site_url('Management/Services/Support/Requests'); ?>"><em class="icon ni ni-notify"></em><span>Pending Requests</span></a></li>
app/Modules/Management/Views/Marketing/Tools/Exchange/Solana.php:77:                        <a href="<?php echo site_url('Management/Marketing/Promote/Solana'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Dashhboard</a>
app/Modules/Management/Views/Marketing/Tools/Exchange/Solana.php:116:                        <a href="<?php echo site_url('/Management/Assets/Applications'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Partners</a>
app/Modules/Management/Views/Marketing/Tools/Exchange/Solana.php:194:                        <a href="<?php echo site_url('/Management/Assets/Transactions'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Assets</a>
app/Modules/Management/Views/Marketing/Tools/Exchange/Solana.php:233:                        <a href="<?php echo site_url('/Management/Marketing/Campaigns'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Fees</a>
app/Modules/Management/Views/Marketing/Tools/General.php:77:                        <a href="<?php echo site_url('/Management/Assets/Applications'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Partners</a>
app/Modules/Management/Views/Marketing/Tools/General.php:155:                        <a href="<?php echo site_url('/Management/Assets/Transactions'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Assets</a>
app/Modules/Management/Views/Marketing/Tools/General.php:194:                        <a href="<?php echo site_url('/Management/Marketing/Campaigns'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Fees</a>
app/Modules/Management/Views/Marketing/Tools/General.php:212:                                            <li><a href="<?php echo site_url('Management/Marketing/Support'); ?>"><em class="icon ni ni-setting"></em><span>View Support</span></a></li>
app/Modules/Management/Views/Marketing/Tools/General.php:213:                                            <li><a href="<?php echo site_url('Management/Services/Support/Requests'); ?>"><em class="icon ni ni-notify"></em><span>Pending Requests</span></a></li>
app/Modules/Management/Views/Marketing/Tools/General.php:233:                        <a href="<?php echo site_url('Management/Services/Support/Requests'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Tasks</a>
app/Modules/Management/Views/Marketing/Blogs.php:10:                        <a href="<?= site_url('/Management/Marketing') ?>">Back to Management Dashboard</a>
app/Modules/Management/Views/Marketing/Blogs.php:11:                        <a href="<?= site_url('/Management/Marketing/Blogs/Add') ?>" class="btn btn-sm btn-primary">Add New Blog Post</a>
app/Modules/Management/Views/Marketing/Blogs.php:37:                                            <a href="<?= site_url('/Management/Marketing/Blogs/Details/' . $blog->id) ?>" 
app/Modules/Management/Views/Marketing/Blogs.php:39:                                            <a href="<?= site_url('/Management/Marketing/Blogs/Edit/' . $blog->id) ?>" 
app/Modules/Management/Views/Marketing/Blogs.php:41:                                            <a href="<?= site_url('/Management/Marketing/Blogs/Delete/' . $blog->id) ?>" 
app/Modules/Management/Views/Marketing/Blogs.php:52:                                <p>No blog posts found. <a href="<?= site_url('/Management/Marketing/Blogs/Add') ?>">Add a new blog post</a>.</p>
app/Modules/Management/Views/Marketing/Blog/Listing-Table.php:19:                        <a href="<?php echo site_url('Marketing/Blog/Edit/' . $blog['id']); ?>" class="btn btn-sm btn-warning">Edit</a>
app/Modules/Management/Views/Marketing/Blog/Listing-Table.php:20:                        <a href="<?php echo site_url('Marketing/Blog/Delete/' . $blog['id']); ?>" class="btn btn-sm btn-danger">Delete</a>
app/Modules/Management/Views/Marketing/Blog/Subscribe.php:151:            const result = await fetch("<?= site_url('CFA/Analysis/Application/Account_Manager'); ?>", {
app/Modules/Management/Views/Marketing/Blog/Listing-Table.orig.php:11:                            <a class="link py-3" href="<?php echo site_url('Management/Marketing/Blog/Add'); ?>"><i class="icon ni ni-plus-circle"></i> <span class="pl-0" style="padding-top:3px;">Add News Blog</span></a>
app/Modules/Management/Views/Marketing/Blog/Listing-Table.orig.php:189:    //         url: '<?php echo site_url('/Management/Marketing/getBlogPosts') ?>', // Replace with your API endpoint that returns the campaigns
app/Modules/Management/Views/Marketing/Blog/Listing-Table.orig.php:208:    //                 //     <a href="${site_url('Management/Marketing/Campaigns/Edit/' + data)}"><i class="icon myfs-md ni ni-edit"></i></a>
app/Modules/Management/Views/Marketing/Blog/Listing-Table.orig.php:209:    //                 //     <a href="${site_url('Management/Marketing/Campaigns/Copy/' + data)}"><i class="icon myfs-md ni ni-copy"></i></a>
app/Modules/Management/Views/Marketing/Blog/Listing-Table.orig.php:210:    //                 //     <a class="text-red" href="${site_url('Management/Marketing/Campaigns/Delete/' + data)}"><i class="icon myfs-md ni ni-trash"></i></a>
app/Modules/Management/Views/Marketing/Blog/Listing-Table.orig.php:227:        url: '<?php echo site_url('/Management/Marketing/summarizeArticle/'); ?>' + articleId,
app/Modules/Management/Views/Marketing/Blog/Listing-Table.orig.php:241:        url: '<?php echo site_url('/Management/Marketing/getBlogPostDetails/'); ?>' + articleId,
app/Modules/Management/Views/Marketing/index.php:35:                    <a href="<?= site_url('/Management'); ?>">â† Back to Management Dashboard</a>
app/Modules/Management/Views/Marketing/index.php:145:    fetch("<?= site_url('Management/Marketing/Scrape-Link') ?>", {
app/Modules/Management/Views/Marketing/index.php:161:            fetch("<?= site_url('API/Marketing/fetchGeneratedSummariesBlock') ?>")
app/Modules/Management/Views/Marketing/index.php:168:            fetch("<?= site_url('API/Marketing/fetchFinalizedSummariesBlock') ?>")
app/Modules/Management/Views/Marketing/Campaigns/Listing-Table.php:55:                                            <a href="' . site_url('Management/Marketing/Campaigns/View/' . $campaigns['id']) . '"><i class="icon myfs-md ni ni-eye"></i></a>
app/Modules/Management/Views/Marketing/Campaigns/Listing-Table.php:56:                                            <a href="' . site_url('Management/Marketing/Campaigns/Edit/' . $campaigns['id']) . '"><i class="icon myfs-md ni ni-edit"></i></a>
app/Modules/Management/Views/Marketing/Campaigns/Listing-Table.php:57:                                            <a href="' . site_url('Management/Marketing/Campaigns/Generate-Content/' . $campaigns['id']) . '"><i class="icon myfs-md ni ni-spark"></i></a>
app/Modules/Management/Views/Marketing/Campaigns/Listing-Table.php:58:                                            <a class="text-red" href="' . site_url('Management/Marketing/Campaigns/Delete/' . $campaigns['id']) . '"><i class="icon myfs-md ni ni-trash"></i></a>
app/Modules/Management/Views/Marketing/Campaigns/action_center.php:15:                <p>Add New <a href="<?php echo site_url('/Management/Marketing/Campaigns'); ?>"><strong>Marketing Campaigns</strong></a> to share with the team.</p>
app/Modules/Management/Views/Marketing/Campaigns/action_center.php:28:                <p>Have new <a href="<?php echo site_url('/Management/Marketing/Ideas'); ?>"><strong>Marketing Ideas</strong></a>? Share them with the team here.</p>
app/Modules/Management/Views/Marketing/Campaigns/action_center.php:41:                <p>View <a href="<?php echo site_url('/Management/Marketing/Ideas'); ?>"><strong>Weekly Marketing Reports</strong></a> to view Analytics and more.</p>
app/Modules/Management/Views/Marketing/Campaigns/action_center.php:43:            <a href="<?php echo site_url('/Marketing/Reports'); ?>" class="btn btn-info btn-md">
app/Modules/Management/Views/Marketing/Campaigns/action_center.php:54:                <p>Additional <a href="<?php echo site_url('/Management/Marketing/Tools'); ?>"><strong>Marketing Tools</strong></a> to generate even more content.</p>
app/Modules/Management/Views/Marketing/Campaigns/action_center.php:56:            <a href="<?php echo site_url('/Management/Marketing/Tools'); ?>" class="btn btn-success btn-md">
app/Modules/Management/Views/Marketing/Campaigns/Overview.php:12:                            <a class="btn btn-primary text-white" href="<?= site_url('Management/Marketing/Campaigns/Edit/' . $campaign['id']); ?>">
app/Modules/Management/Views/Marketing/Campaigns/View.php:53:                            <a class="btn btn-primary text-white" href="<?= site_url('Management/Marketing/Campaigns/Edit/' . $campaign['id']) ?>">
app/Modules/Management/Views/Marketing/Campaigns/View.php:246:                                                $viewEmailUrl = site_url("Management/Marketing/View-Email/{$titleSlug}/{$messageId}");
app/Modules/Management/Views/Marketing/Campaigns/View.php:296://         url: '<?= site_url("API/Marketing/generateCampaignContent") ?>',
app/Modules/Management/Views/Marketing/Campaigns/View.php:345://         url: '<?= site_url("API/Marketing/generateCampaignStepContent") ?>',
app/Modules/Management/Views/Marketing/Campaigns/View.php:379:    generatePlatformMessages('Campaign', campaignId, '<?= site_url("API/Marketing/generateCampaignContent") ?>', '','true');
app/Modules/Management/Views/Marketing/Campaigns/View.php:383:    generatePlatformMessages('Step', stepId, '<?= site_url("API/Marketing/generateCampaignStepContent") ?>', '', 'true');
app/Modules/Management/Views/Marketing/Campaigns/View.php:428:            url: '<?= site_url("API/Marketing/updateCampaignLinks") ?>',
app/Modules/Management/Views/Marketing/Campaigns/View.php:495:        url: '<?= site_url("API/Marketing/updateCampaignMessageField") ?>',
app/Modules/Management/Views/Marketing/Campaigns/Priority-Listing-Table.php:55:                                            <a href="' . site_url('Management/Marketing/Campaigns/View/' . $campaigns['id']) . '"><i class="icon myfs-md ni ni-eye"></i></a>
app/Modules/Management/Views/Marketing/Campaigns/Priority-Listing-Table.php:56:                                            <a href="' . site_url('Management/Marketing/Campaigns/Edit/' . $campaigns['id']) . '"><i class="icon myfs-md ni ni-edit"></i></a>
app/Modules/Management/Views/Marketing/Campaigns/Priority-Listing-Table.php:57:                                            <a href="' . site_url('Management/Marketing/Campaigns/Generate-Content/' . $campaigns['id']) . '"><i class="icon myfs-md ni ni-spark"></i></a>
app/Modules/Management/Views/Marketing/Campaigns/Priority-Listing-Table.php:58:                                            <a class="text-red" href="' . site_url('Management/Marketing/Campaigns/Delete/' . $campaigns['id']) . '"><i class="icon myfs-md ni ni-trash"></i></a>
app/Modules/Management/Views/Marketing/Tasks/Listing-Table.php:11:                            <a class="link py-3" href="<?php echo site_url('Management/Marketing/Campaigns/Create'); ?>"><i class="icon ni ni-plus-circle"></i> <span class="pl-0" style="padding-top:3px;">Add Campaign</span></a>
app/Modules/Management/Views/Marketing/Tasks/Listing-Table.php:45:                                        <td><a href="' . site_url('/Management/Marketing/Tasks/Details/' . $tasks['id']) . '">' . $tasks['title'] . '</a></td>
app/Modules/Management/Views/Marketing/Tasks/action_center.php:28:                <a href="<?php echo site_url('/Management/Marketing/Tasks/Create'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/Tasks/action_center.php:38:                <a href="<?php echo site_url('/Management/Narketing/Collaborate'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/Tasks/action_center.php:48:                <a href="<?php echo site_url('/Management/Partners/Collaborate'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/Exchanges/Top_Communities.php:21:                        <a href="<?php echo site_url('/Management'); ?>">Back to Management Dashboard</a>
app/Modules/Management/Views/Marketing/Exchanges/includes/facebook.php:58:                        <a href="<?php echo site_url('/Management'); ?>">Back to Management Dashboard</a>
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:16:                <p><a href="<?php echo site_url('/Marketing/Campaigns/Add'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:18:            <a href="<?php echo site_url('/Management/Marketing/Campaigns/Add'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:30:                <p><a href="<?php echo site_url('/Management/Marketing/fetchEmails'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:32:            <a href="<?php echo site_url('/Management/Marketing/fetchEmails'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:44:                <p><a href="<?php echo site_url('Management/Marketing/generateNewsletter'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:46:            <a href="<?php echo site_url('/Management/Marketing/generateNewsletter'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:58:                <p><a href="<?php echo site_url('Management/Marketing/scheduleNewsletters'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:60:            <a href="<?php echo site_url('/Management/Marketing/scheduleNewsletters'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:72:                <p><a href="<?php echo site_url('/Management/Marketing/Tools'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:74:            <a href="<?php echo site_url('/Management/Marketing/Tools'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:85:                <p><a href="<?php echo site_url('/Management/Marketing/Campaigns/Add'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:87:            <a href="<?php echo site_url('/Management/Marketing/Campaigns/Add'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:98:                <p><a href="<?php echo site_url('/Marketing/SEO/Tasks'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:100:            <a href="<?php echo site_url('/Marketing/SEO/Tasks'); ?>" class="btn btn-warning btn-md">
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:111:                <p><a href="<?php echo site_url('/Marketing/Reports'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:113:            <a href="<?php echo site_url('/Marketing/Reports'); ?>" class="btn btn-info btn-md">
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:124:                <p><a href="<?php echo site_url('/Marketing/Reports'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/Exchanges/includes/action_center.php:126:            <a href="<?php echo site_url('/Marketing/Tools'); ?>" class="btn btn-success btn-md">
app/Modules/Management/Views/Marketing/Exchanges/includes/discord.php:58:                        <a href="<?php echo site_url('/Management'); ?>">Back to Management Dashboard</a>
app/Modules/Management/Views/Marketing/Exchanges/includes/discord.php:96:                                                        <a href="<?php echo site_url('/Management/Marketing/Top-Communities/Active/' . $token['id']); ?>" target="_blank"><em class="icon myfs-md ni ni-check text-success text-bold pl-2"></em></a>
app/Modules/Management/Views/Marketing/Exchanges/includes/discord.php:97:                                                        <a href="<?php echo site_url('/Management/Marketing/Top-Communities/Inactive' . $token['id']); ?>" target="_blank"><strong><em class="icon myfs-md ni ni-cross text-danger text-bold pl-2"></em></strong></a>
app/Modules/Management/Views/Marketing/Exchanges/includes/twitter.php:58:                        <a href="<?php echo site_url('/Management'); ?>">Back to Management Dashboard</a>
app/Modules/Management/Views/Marketing/Exchanges/includes/website.php:58:                        <a href="<?php echo site_url('/Management'); ?>">Back to Management Dashboard</a>
app/Modules/Management/Views/Marketing/Exchanges/includes/website.php:85:                                            <a href="<?= site_url('Management/Marketing/Exchanges/Top-Communities/Discord') ?>" class="btn btn-primary text-center w-100"><em class="icon bi bi-discord mr-2"></em> Discord</a>
app/Modules/Management/Views/Marketing/Exchanges/includes/website.php:89:                                            <a href="<?= site_url('Management/Marketing/Exchanges/Top-Communities/Facebook') ?>" class="btn btn-primary w-100"><em class="icon ni ni-facebook-f mr-2"></em> Facebook</a>
app/Modules/Management/Views/Marketing/Exchanges/includes/website.php:93:                                            <a href="<?= site_url('Management/Marketing/Exchanges/Top-Communities/Twitter') ?>" class="btn btn-primary w-100"><em class="icon ni ni-twitter mr-2"></em> Twitter</a>
app/Modules/Management/Views/Marketing/Exchanges/includes/website.php:97:                                            <a href="<?= site_url('Management/Marketing/Exchanges/Top-Communities/Telegram') ?>" class="btn btn-primary w-100"><em class="icon ni ni-telegram mr-2"></em> Telegram</a>
app/Modules/Management/Views/Marketing/Exchanges/includes/website.php:137:                                                        <a href="<?= site_url('Management/Marketing/Exchanges/Edit/' . $token['id']) ?>" target="_blank"><em class="icon myfs-md ni ni-plus"></em></a>
app/Modules/Management/Views/Marketing/Exchanges/includes/website.php:212:        fetch('<?= site_url('solana/market-refresh') ?>', {
app/Modules/Management/Views/Marketing/Exchanges/includes/all-tokens.php:59:                        <a href="<?php echo site_url('/Management'); ?>">Back to Management Dashboard</a>
app/Modules/Management/Views/Marketing/SEO/Listing-Table.php:21:                        <a href="<?php echo site_url('Marketing/SEO/Edit/' . $task['id']); ?>" class="btn btn-sm btn-warning">Edit</a>
app/Modules/Management/Views/Marketing/SEO/Listing-Table.php:22:                        <a href="<?php echo site_url('Marketing/SEO/Delete/' . $task['id']); ?>" class="btn btn-sm btn-danger">Delete</a>
app/Modules/Management/Views/Marketing/Tasks.php:85:						<a href="<?php echo site_url('/Management/Marketing'); ?>">Back to Marketing Dashboard</a>							
app/Modules/Management/Views/Marketing/Edit_Blog.php:2:    <form action="<?= isset($blog) ? site_url('/Management/Marketing/Blogs/Update/' . $blog->id) : site_url('/Management/Marketing/Blogs/Create') ?>" 
app/Modules/Management/Views/Marketing/Edit_Blog.php:22:        <a href="<?= site_url('/Management/Marketing/Blogs') ?>" class="btn btn-secondary">Cancel</a>
app/Modules/Management/Views/Marketing/index_orig/operational_tasks.php:6:                    <a href="<?php echo site_url('Management/Marketing/Analytics'); ?>" class="project-title">
app/Modules/Management/Views/Marketing/index_orig/operational_tasks.php:59:                    <a href="<?php echo site_url('Management/Marketing/Campaigns/Create'); ?>" class="project-title">
app/Modules/Management/Views/Marketing/index_orig/operational_tasks.php:155:                    <a href="<?php echo site_url('Management/Marketing/Analytics'); ?>" class="project-title">
app/Modules/Management/Views/Marketing/index_orig/operational_tasks.php:208:                    <a href="<?php echo site_url('Management/Assets/Distribute'); ?>" class="project-title">
app/Modules/Management/Views/Marketing/index_orig/action_center.php:26:                    <p><a href="<?php echo site_url('/Management/Users'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/index_orig/action_center.php:28:                <a href="<?php echo site_url('/Management/Users'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/index_orig/action_center.php:36:                    <p>There is <a href="<?php echo site_url('/Management/Marketing/Campaigns'); ?>"><strong><?php //echo $totalActiveCampaigns; ?></strong></a> Marketing Campaigns. View more <a href="<?php echo site_url('/Management/Assets/Support'); ?>"><strong>Analytics</strong></a> to track their progress. </p>
app/Modules/Management/Views/Marketing/index_orig/action_center.php:38:                <a href="<?php echo site_url('/Management/Marketing/Campaigns'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/index_orig/action_center.php:46:                    <p>There are currently <a href="<?php echo site_url('Management/Marketing/Tasks'); ?>"><strong><?php //echo $totalDepartmentTasks; ?> Total Tasks</strong></a> pending for the team.</p>
app/Modules/Management/Views/Marketing/index_orig/action_center.php:48:                <a href="<?php echo site_url('Management/Marketing/Tasks'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/index_orig/modals.php:28:  //         data-href="<?= site_url('Management/CreatePost') ?>">
app/Modules/Management/Views/Marketing/Content_Edit.php:2:    <form action="<?= site_url('/Management/Marketing/SaveContentEdit/' . $content['id']) ?>" method="POST">
app/Modules/Management/Views/Marketing/Content_Edit.php:10:        <a href="<?= site_url('/Management/Marketing/ContentReview') ?>" class="btn btn-secondary">Cancel</a>
app/Modules/Management/Views/Marketing/Forms/send_notifications.php:2:<form action="<?= site_url('marketing/sendNotification') ?>" method="post">
app/Modules/Management/Views/Marketing/Post.php:1:<form action="<?= site_url('marketing/postToFacebook') ?>" method="post">
app/Modules/Management/Views/Marketing/Post.php:13:<form action="<?= site_url('marketing/postToGroup') ?>" method="post">
app/Modules/Management/Views/Marketing/campaigns.php:42:                        <a href="<?= site_url('/Management/Marketing'); ?>">Back to Marketing Dashboard</a>
app/Modules/Management/Views/Marketing/modals/insightPreview.php:76:    fetch('<?= site_url("/API/Management/updateInsight") ?>', {
app/Modules/Management/Views/Marketing/modals/insightPreview.php:101:    fetch('<?= site_url('/API/Marketing/generateLivePreview') ?>', {
app/Modules/Management/Views/Marketing/modals/videoPreview.php:37:    <a href="<?= site_url('/Management') ?>" class="btn btn-outline-danger btn-sm">
app/Modules/Management/Views/Marketing/modals/generatePostMedia.php:95:        url: '<?= site_url("API/Marketing/generatePostMediaContent") ?>',
app/Modules/Management/Views/Marketing/modals/generatePostMedia.php:145:        url: '<?= site_url("API/Marketing/savePostMedia") ?>',
app/Modules/Management/Views/Marketing/Content_Review.php:11:                        <a href="<?= site_url('/Management/Marketing/EditContent/' . $content['id']) ?>" 
app/Modules/Management/Views/Marketing/Content_Review.php:13:                        <a href="<?= site_url('/Management/Marketing/ApproveContent/' . $content['id']) ?>" 
app/Modules/Management/Views/Marketing/Content_Review.php:15:                        <a href="<?= site_url('/Management/Marketing/RejectContent/' . $content['id']) ?>" 
app/Modules/Management/Views/Marketing/index copy.php:34:                    <a href="<?= site_url('/Management'); ?>">â† Back to Management Dashboard</a>
app/Modules/Management/Views/Marketing/Drip/create.php:4:    <form method="post" action="<?= site_url('Management/Drip-Campaigns/store') ?>" id="dripCampaignForm">
app/Modules/Management/Views/Marketing/Drip/create.php:135:            <a href="<?= site_url('Management/DripCampaigns') ?>" class="btn btn-secondary">Cancel</a>
app/Modules/Management/Views/Marketing/Drip/steps.php:4:    <a href="<?= site_url("Management/Drip-Campaigns/{$campaign['id']}/Steps/Add") ?>" class="btn btn-primary mb-3">+ Add Step</a>
app/Modules/Management/Views/Marketing/Drip/index.php:4:    <a href="<?= site_url('Management/Drip-Campaigns/Create') ?>" class="btn btn-primary mb-3">+ New Campaign</a>
app/Modules/Management/Views/Marketing/Drip/index.php:24:                                <a href="<?= site_url("Management/Drip-Campaigns/{$campaign['id']}/Steps") ?>" class="btn btn-sm btn-outline-info">View Steps</a>
app/Modules/Management/Views/Marketing/Drip/modals/deleteCampaign.php:7:    <form action="<?= site_url('API/Marketing/deleteCampaign/' . $campaign['id']) ?>" method="POST">
app/Modules/Management/Views/Marketing/Drip/modals/deleteCampaignStep.php:7:    <form action="<?= site_url('API/Marketing/deleteStep/' . $step['id']) ?>" method="POST">
app/Modules/Management/Views/Marketing/Drip/modals/generateCampaignStepContent.php:7:    <form action="<?= site_url('API/Marketing/generateStepContent/' . $step['id']) ?>" method="POST">
app/Modules/Management/Views/Marketing/Drip/modals/generateCampaignStepContent.php:29:            fetch(`<?= site_url('API/Marketing/generateCampaignStepContent/') ?>${stepId}`, {
app/Modules/Management/Views/Marketing/Drip/modals/generateCampaignContent.php:7:    <form action="<?= site_url('API/Marketing/generateCampaignContent/' . $campaign['id']) ?>" method="POST">
app/Modules/Management/Views/Marketing/Drip/modals/generateCampaignContent.php:29:            fetch(`<?= site_url('API/Marketing/generateCampaignContent/') ?>${campaignId}`, {
app/Modules/Management/Views/Marketing/Drip/modals/editCampaign.php:1:<form id="editCampaignForm" method="POST" action="<?= site_url('API/Marketing/updateCampaign/' . $campaign['id']) ?>">
app/Modules/Management/Views/Marketing/Drip/modals/editCampaignStep.php:1:<form id="editStepForm" method="POST" action="<?= site_url('API/Marketing/updateCampaignStep/' . $step['id']) ?>">
app/Modules/Management/Views/Marketing/Drip/add_step.php:42:        <a href="<?= site_url("Management/Drip-Campaigns/{$campaign_id}/Steps") ?>" class="btn btn-secondary">Cancel</a>
app/Modules/Management/Views/Marketing/index/most_recent_content.php:69:    fetch("<?= site_url('Management/Marketing/getRecentScrapes'); ?>")
app/Modules/Management/Views/Marketing/index/most_recent_content.php:90:        fetch(`<?= site_url('Management/Marketing/getScrapeDetails') ?>/${id}`)
app/Modules/Management/Views/Marketing/index/most_recent_content.php:109:        fetch(`<?= site_url('API/Marketing/generatePostsFromSummary') ?>/${id}`)
app/Modules/Management/Views/Marketing/index/most_recent_content.php:128:            fetch(`<?= site_url('Management/Marketing/deleteScrape') ?>/${id}`, { method: 'DELETE' })
app/Modules/Management/Views/Marketing/index/generated_summaries.php:9:                    <button class="btn btn-sm btn-outline-primary" onclick="dynamicModalLoader('<?= site_url('API/Marketing/PreviewGeneratedPost/' . $summary['id']) ?>')">
app/Modules/Management/Views/Marketing/index/action_center.php:15:                <p>Add New <a href="<?php echo site_url('/Management/Marketing/Campaigns'); ?>"><strong>Marketing Campaigns</strong></a> to share with the team.</p>
app/Modules/Management/Views/Marketing/index/action_center.php:17:            <a href="<?php echo site_url('/Marketing/Campaigns/Add'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/index/action_center.php:28:                <p>Have new <a href="<?php echo site_url('/Management/Marketing/Ideas'); ?>"><strong>Marketing Ideas</strong></a>? Share them with the team here.</p>
app/Modules/Management/Views/Marketing/index/action_center.php:30:            <a href="<?php echo site_url('/Management/Marketing/Ideas'); ?>" class="btn btn-warning btn-md">
app/Modules/Management/Views/Marketing/index/action_center.php:41:                <p>View <a href="<?php echo site_url('/Management/Marketing/Ideas'); ?>"><strong>Weekly Marketing Reports</strong></a> to view Analytics and more.</p>
app/Modules/Management/Views/Marketing/index/action_center.php:43:            <a href="<?php echo site_url('/Marketing/Reports'); ?>" class="btn btn-info btn-md">
app/Modules/Management/Views/Marketing/index/action_center.php:54:                <p>Additional <a href="<?php echo site_url('/Management/Marketing/Tools'); ?>"><strong>Marketing Tools</strong></a> to generate even more content.</p>
app/Modules/Management/Views/Marketing/index/action_center.php:56:            <a href="<?php echo site_url('/Management/Marketing/Tools'); ?>" class="btn btn-success btn-md">
app/Modules/Management/Views/Marketing/index/exchange_action_center.php:17:                    View The <a href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities'); ?>"><strong><?php  ?>Exchange Communities</strong></a> 
app/Modules/Management/Views/Marketing/index/exchange_action_center.php:27:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Discord'); ?>">Discord</a></li>
app/Modules/Management/Views/Marketing/index/exchange_action_center.php:28:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Facebook'); ?>">Facebook</a></li>
app/Modules/Management/Views/Marketing/index/exchange_action_center.php:29:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Twitter'); ?>">X (Twitter)</a></li>
app/Modules/Management/Views/Marketing/index/exchange_action_center.php:30:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Website'); ?>">Website</a></li>
app/Modules/Management/Views/Marketing/index/exchange_action_center.php:42:                    View the <a href="<?php echo site_url('Management/Marketing/Exchanges/Top-Performers'); ?>"><strong><?php  ?>Top Performing Currencies</strong></a> 
app/Modules/Management/Views/Marketing/index/modals.php:28:  //         data-href="<?= site_url('Management/CreatePost') ?>">
app/Modules/Management/Views/Marketing/index/action_center_new.php:17:                <p><a href="<?php echo site_url('/Marketing/Campaigns/Add'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/index/action_center_new.php:19:            <a href="<?php echo site_url('/Management/Marketing/Campaigns/Add'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/index/action_center_new.php:31:                <p><a href="<?php echo site_url('/Management/Marketing/RunContentGeneration'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/index/action_center_new.php:33:            <a href="<?php echo site_url('/Management/Marketing/RunContentGeneration'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/index/action_center_new.php:45:                <p><a href="<?php echo site_url('/Management/Marketing/Blogs'); ?>"><strong><?php // echo $totalActiveUsers; ?> View & Manage</strong></a> all blog content that have been generated.</p>
app/Modules/Management/Views/Marketing/index/action_center_new.php:47:            <a href="<?php echo site_url('/Management/Marketing/Blogs'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/index/action_center_new.php:59:                <p><a href="<?php echo site_url('/Management/Marketing/fetchEmails'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/index/action_center_new.php:61:            <a href="<?php echo site_url('/Management/Marketing/fetchEmails'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/index/action_center_new.php:73:                <p><a href="<?php echo site_url('Management/Marketing/generateNewsletter'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/index/action_center_new.php:75:            <a href="<?php echo site_url('/Management/Marketing/generateNewsletter'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/index/action_center_new.php:87:                <p><a href="<?php echo site_url('Management/Marketing/scheduleNewsletters'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/index/action_center_new.php:89:            <a href="<?php echo site_url('/Management/Marketing/scheduleNewsletters'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/index/action_center_new.php:101:                <p><a href="<?php echo site_url('/Management/Marketing/Tools'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/index/action_center_new.php:103:            <a href="<?php echo site_url('/Management/Marketing/Tools'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/index/action_center_new.php:130:                <p><a href="<?php echo site_url('/Management/Marketing/Campaigns/Add'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/index/action_center_new.php:132:            <a href="<?php echo site_url('/Management/Marketing/Campaigns/Add'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Marketing/index/action_center_new.php:143:                <p><a href="<?php echo site_url('/Marketing/SEO/Tasks'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/index/action_center_new.php:145:            <a href="<?php echo site_url('/Marketing/SEO/Tasks'); ?>" class="btn btn-warning btn-md">
app/Modules/Management/Views/Marketing/index/action_center_new.php:156:                <p><a href="<?php echo site_url('/Marketing/Reports'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/index/action_center_new.php:158:            <a href="<?php echo site_url('/Marketing/Reports'); ?>" class="btn btn-info btn-md">
app/Modules/Management/Views/Marketing/index/action_center_new.php:169:                <p><a href="<?php echo site_url('/Marketing/Reports'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Marketing/index/action_center_new.php:171:            <a href="<?php echo site_url('/Marketing/Tools'); ?>" class="btn btn-success btn-md">
app/Modules/Management/Views/Marketing/Promote/Solana/subViews/Communities.php:12:                <a href="<?php echo site_url('Exchange/Solana/Swap'); ?>" class="link">View All</a>
app/Modules/Management/Views/Marketing/Promote/Solana/subViews/Communities.php:226:                                                <li><a class="dropdown-item" href="<?= site_url($token['website']) ?>">Scrap Website</a></li>
app/Modules/Management/Views/Marketing/Promote/Solana/action_center.php:26:                    <p><a href="<?php echo site_url('/Management/Users'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php //echo $totalActivePartners; ?> Active Partners</strong></a> need to be reviewed.</p>
app/Modules/Management/Views/Marketing/Promote/Solana/action_center.php:28:                <a href="<?php echo site_url('/Management/Users'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/Promote/Solana/action_center.php:36:                    <p>There are <a href="<?php echo site_url('/Management/Marketing/Campaigns'); ?>"><strong><?php //echo $totalActiveCampaigns; ?></strong></a> Marketing Campaigns. View more <a href="<?php echo site_url('/Management/Assets/Support'); ?>"><strong>Analytics</strong></a> to track their progress.</p>
app/Modules/Management/Views/Marketing/Promote/Solana/action_center.php:38:                <a href="<?php echo site_url('/Management/Marketing/Campaigns'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/Promote/Solana/action_center.php:46:                    <p>There are currently <a href="<?php echo site_url('Management/Marketing/Tasks'); ?>"><strong><?php //echo $totalDepartmentTasks; ?> Total Tasks</strong></a> pending for the team.</p>
app/Modules/Management/Views/Marketing/Promote/Solana/action_center.php:48:                <a href="<?php echo site_url('Management/Marketing/Tasks'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/Promote/Solana/action_center.php:71:                                    <a href="<?php echo site_url('/Marketing/Solana/Discord'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/Promote/Solana/action_center.php:83:                                    <a href="<?php echo site_url('/Marketing/Solana/Facebook'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/Promote/Solana/action_center.php:95:                                    <a href="<?php echo site_url('/Marketing/Solana/Twitter'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/Promote/Solana/action_center.php:107:                                    <a href="<?php echo site_url('/Marketing/Solana/Reddit'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/Promote/Solana/action_center.php:119:                                    <a href="<?php echo site_url('/Marketing/Solana/Websites'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/Promote/Solana/action_center.php:134:                <a href="<?php echo site_url('/Marketing/Solana/CoinSwap'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/Promote/Solana/Dashboard.php:109:                        <a href="<?php echo site_url('/Management'); ?>">Back to Management Dashboard</a>                           
app/Modules/Management/Views/Marketing/Promote/Solana/Generate_Content.php:16:                        <a href="<?php echo site_url('/Management'); ?>">Back to Management Dashboard</a>
app/Modules/Management/Views/Marketing/Edit.php:5:$redirectURL = $this->agent->referrer() === $this->uri->uri_string() ? site_url('/Management/Marketing/Exchanges') : $this->agent->referrer();
app/Modules/Management/Views/Marketing/Edit.php:139:        const response = await fetch("<?php echo site_url('Management/Marketing/Exchanges/Edit/'.$token['id']); ?>", {
app/Modules/Management/Views/Marketing/Ideas/Listing-Table.php:63:                                            <a href="' . site_url('Management/Marketing/Ideas/Edit/' . $idea['id']) . '"><i class="icon myfs-md ni ni-edit"></i></a>
app/Modules/Management/Views/Marketing/Ideas/Listing-Table.php:64:                                            <a href="' . site_url('Management/Marketing/Ideas/Copy/' . $idea['id']) . '"><i class="icon myfs-md ni ni-copy"></i></a>
app/Modules/Management/Views/Marketing/Ideas/Listing-Table.php:65:                                            <a class="text-red" href="' . site_url('Management/Marketing/Ideas/Delete/' . $idea['id']) . '"><i class="icon myfs-md ni ni-trash"></i></a>
app/Modules/Management/Views/Marketing/Ideas/action_center.php:54:                <a href="<?php echo site_url('/Management/Partners/Collaborate'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/Ideas/action_center.php:64:                <a href="<?php echo site_url('/Management/Partners/Collaborate'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Marketing/Keywords/keyword_analytics_table.php:24:                                    <a href="<?= site_url('/Marketing/Generated/Keyword/' . urlencode($keyword['keyword'])) ?>" target="_blank" class="btn btn-sm btn-info">
app/Modules/Management/Views/Marketing/EmailDetail.php:13:                        <a href="<?php echo site_url('/Management/Marketing'); ?>" class="btn btn-sm btn-outline-primary mt-2">â† Back to Marketing Dashboard</a>
app/Modules/Management/Views/Marketing/EmailDetail.php:71:    fetch("<?= site_url('API/Marketing/generateFromEmailId/' . $emailData['id']) ?>")
app/Modules/Management/Views/Marketing/ideas.php:39:                        <a href="<?= site_url('/Management/Marketing'); ?>">Back to Marketing Dashboard</a>
app/Modules/Management/Views/HowTos/index.php:20:                            <a href="<?php echo site_url('/Dashboard'); ?>">Back to Main Dashboard</a>
app/Modules/Management/Views/HowTos/index.php:69:                                            <a href="<?php echo site_url('/Management/HowTo/Tasks'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/HowTos/index.php:85:                                            <a href="<?php echo site_url('Management/How-Tos/Employees/Account-Setup'); ?>" class="project-title">
app/Modules/Management/Views/HowTos/index.php:94:                                            <a href="<?php echo site_url('Management/How-Tos/Employees/Account-Setup'); ?>" class="btn btn-primary btn-sm">View</a>
app/Modules/Management/Views/HowTos/index.php:105:                                            <a href="<?php echo site_url('/Management/How-Tos/Employees/Email-Setup'); ?>" class="project-title">
app/Modules/Management/Views/HowTos/index.php:114:                                            <a href="<?php echo site_url('/Management/How-Tos/Employees/Email-Setup'); ?>" class="btn btn-primary btn-sm">View</a>
app/Modules/Management/Views/HowTos/index.php:125:                                            <a href="<?php echo site_url('Management/HowTo/Reports'); ?>" class="project-title">
app/Modules/Management/Views/HowTos/Employees/action_center.php:15:                <p><a href="<?php echo site_url('/Management/HowTos/Create'); ?>"><strong><?php // Placeholder for count variable ?></strong></a> new guides available to create.</p>
app/Modules/Management/Views/HowTos/Employees/action_center.php:17:            <a href="<?php echo site_url('/Management/HowTos/Create'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/HowTos/Employees/action_center.php:28:                <p><a href="<?php echo site_url('/Management/HowTos/Manage'); ?>"><strong><?php // Placeholder for count variable ?></strong></a> existing guides need management.</p>
app/Modules/Management/Views/HowTos/Employees/action_center.php:30:            <a href="<?php echo site_url('/Management/HowTos/Manage'); ?>" class="btn btn-warning btn-md">
app/Modules/Management/Views/HowTos/Employees/action_center.php:41:                <p><a href="<?php echo site_url('/Management/HowTos/Reports'); ?>"><strong><?php // Placeholder for report count ?></strong></a> guides have related reports available.</p>
app/Modules/Management/Views/HowTos/Employees/action_center.php:43:            <a href="<?php echo site_url('/Management/HowTos/Reports'); ?>" class="btn btn-info btn-md">
app/Modules/Management/Views/HowTos/Employees/action_center.php:56:            <a href="<?php echo site_url('/Management/HowTos/Tools'); ?>" class="btn btn-success btn-md">
app/Modules/Management/Views/HowTos/Employees/setupEmails.php:69:                                        <a href="<?= site_url('Support/Guides'); ?>" class="btn btn-primary">
app/Modules/Management/Views/Security/index.php:102:						<a href="<?php echo site_url('/Management'); ?>">Back to Management Dashboard</a>							
app/Modules/Management/Views/Security/index.php:194:                                    <a href="<?php echo site_url('/Management/Assets/Applications'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Subscribers</a>
app/Modules/Management/Views/Security/index.php:272:                                    <a href="<?php echo site_url('/Management/Assets/Transactions'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Assets</a>
app/Modules/Management/Views/Security/index.php:311:                                    <a href="<?php echo site_url('/Management/Services/Campaigns'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Fees</a>
app/Modules/Management/Views/Security/index.php:329:                                                        <li><a href="<?php echo site_url('Management/Assets/Support'); ?>"><em class="icon ni ni-setting"></em><span>View Support</span></a></li>
app/Modules/Management/Views/Security/index.php:330:                                                        <li><a href="<?php echo site_url('Management/Assets/Support/Requests'); ?>"><em class="icon ni ni-notify"></em><span>Pending Requests</span></a></li>
app/Modules/Management/Views/Security/index.php:348:                                    <a href="<?php echo site_url('Management/Services/Support/Requests'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Tasks</a>
app/Modules/Management/Views/Security/index/operational_tasks.php:6:                    <a href="<?php echo site_url('Management/Marketing/Analytics'); ?>" class="project-title">
app/Modules/Management/Views/Security/index/operational_tasks.php:59:                    <a href="<?php echo site_url('Management/Assets/Distribute'); ?>" class="project-title">
app/Modules/Management/Views/Security/index/operational_tasks.php:155:                    <a href="<?php echo site_url('Management/Marketing/Analytics'); ?>" class="project-title">
app/Modules/Management/Views/Security/index/operational_tasks.php:208:                    <a href="<?php echo site_url('Management/Assets/Distribute'); ?>" class="project-title">
app/Modules/Management/Views/Security/index/action_center.php:27:                    <p><a href="<?php echo site_url('/Management/Users'); ?>"><strong><?php echo $totalActiveServices; ?> Active Services</strong></a> and <a href="#active-assets-overview"><strong><?php echo $totalActiveSubscriptions; ?> Active Subscriptions</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Security/index/action_center.php:29:                <a href="<?php echo site_url('/Management/Users'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Security/index/action_center.php:37:                    <p>There is <a href="<?php echo site_url('/Management/Marketing/Campaigns/Services'); ?>"><strong><?php echo $totalActiveCampaigns; ?></strong></a> Marketing Campaigns. View more <a href="<?php echo site_url('/Management/Marketing/Campaigns/' . $department); ?>"><strong><?php echo $department; ?> Marketing Analytics</strong></a> to track our progress. </p>
app/Modules/Management/Views/Security/index/action_center.php:39:                <a href="<?php echo site_url('/Management/Marketing/Campaigns'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Security/index/action_center.php:47:                    <p>There are currently <a href="<?php echo site_url('Management/Marketing/Tasks'); ?>"><strong><?php echo $totalDepartmentTasks; ?> Total Tasks</strong></a> pending for the team.</p>
app/Modules/Management/Views/Security/index/action_center.php:49:                <a href="<?php echo site_url('Management/Marketing/Tasks'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Projects/management/project_control.php:8:        <form action="<?= site_url('Management/Projects/UpdateStatus/' . $project['id']); ?>" method="post">
app/Modules/Management/Views/Projects/management/project_overview.php:14:                <tr><th>Submitted By</th><td><strong><a href="<?= site_url('/Profile/' . $owner['cuUsername']) ?>"><?= esc($owner['cuUsername']); ?></a></strong></td></tr>
app/Modules/Management/Views/Projects/management/project_overview.php:54:            <a href="<?= site_url('Management/Projects/Approve/' . $project['id']); ?>" class="btn btn-success me-2" onclick="return confirm('Approve this project?');">Approve</a>
app/Modules/Management/Views/Projects/management/project_overview.php:55:            <a href="<?= site_url('Management/Projects/Reject/' . $project['id']); ?>" class="btn btn-danger me-2" onclick="return confirm('Reject this project?');">Reject</a>
app/Modules/Management/Views/Projects/management/project_overview.php:56:            <a href="<?= site_url('Management/Projects/Edit/' . $project['id']); ?>" class="btn btn-secondary me-2">Edit</a>
app/Modules/Management/Views/Projects/management/project_overview.php:57:            <a href="<?= site_url('Management/Projects/Message/' . $project['id']); ?>" class="btn btn-primary">Request More Information</a>
app/Modules/Management/Views/Projects/Add.php:13:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/Management/Views/Projects/Add.php:16:        $accountTypeAltURl                  =  site_url('/Budget/Add/Income');
app/Modules/Management/Views/Projects/Add.php:19:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/Management/Views/Projects/Add.php:27:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/Management/Views/Projects/Add.php:30:        $accountTypeAltURl                  =  site_url('/Budget/Add/Income');
app/Modules/Management/Views/Projects/Add.php:33:        $accountTypeAltURl                  = site_url('/Budget/Add/Expense');
app/Modules/Management/Views/Projects/Add.php:125:                                <a href="<?= site_url('Projects/List'); ?>" class="btn btn-white btn-dim btn-outline-primary">
app/Modules/Management/Views/Projects/Add.php:223:                url: '<?= site_url('Projects/Add'); ?>', // Controller method to handle the form submission
app/Modules/Management/Views/Projects/_quick_intake.php:32:    <a class="btn btn-light" href="<?= site_url('Management/Projects/quick-intake'); ?>">Standalone Page</a>
app/Modules/Management/Views/Projects/_quick_intake.php:48:  fetch('<?= site_url('API/Projects/ingest/real-estate'); ?>', {
app/Modules/Management/Views/Projects/index/top_projects.php:41:                            <a href="<?= site_url('Projects/View/' . $project['id']); ?>" class="btn btn-primary mt-2">View Details</a>
app/Modules/Management/Views/Projects/index/most_recent_content.php:101:        fetch('<?php echo site_url('Management/Marketing/getRecentScrapes'); ?>')
app/Modules/Management/Views/Projects/index/action_center.php:15:                <p>Add New <a href="<?php echo site_url('/Management/Marketing/Campaigns'); ?>"><strong>Marketing Campaigns</strong></a> to share with the team.</p>
app/Modules/Management/Views/Projects/index/action_center.php:17:            <a href="<?php echo site_url('/Marketing/Campaigns/Add'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Projects/index/action_center.php:28:                <p>Have new <a href="<?php echo site_url('/Management/Marketing/Ideas'); ?>"><strong>Marketing Ideas</strong></a>? Share them with the team here.</p>
app/Modules/Management/Views/Projects/index/action_center.php:30:            <a href="<?php echo site_url('/Management/Marketing/Ideas'); ?>" class="btn btn-warning btn-md">
app/Modules/Management/Views/Projects/index/action_center.php:41:                <p>View <a href="<?php echo site_url('/Management/Marketing/Ideas'); ?>"><strong>Weekly Marketing Reports</strong></a> to view Analytics and more.</p>
app/Modules/Management/Views/Projects/index/action_center.php:43:            <a href="<?php echo site_url('/Marketing/Reports'); ?>" class="btn btn-info btn-md">
app/Modules/Management/Views/Projects/index/action_center.php:54:                <p>Additional <a href="<?php echo site_url('/Management/Marketing/Tools'); ?>"><strong>Marketing Tools</strong></a> to generate even more content.</p>
app/Modules/Management/Views/Projects/index/action_center.php:56:            <a href="<?php echo site_url('/Management/Marketing/Tools'); ?>" class="btn btn-success btn-md">
app/Modules/Management/Views/Projects/index/exchange_action_center.php:17:                    View The <a href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities'); ?>"><strong><?php  ?>Exchange Communities</strong></a> 
app/Modules/Management/Views/Projects/index/exchange_action_center.php:27:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Discord'); ?>">Discord</a></li>
app/Modules/Management/Views/Projects/index/exchange_action_center.php:28:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Facebook'); ?>">Facebook</a></li>
app/Modules/Management/Views/Projects/index/exchange_action_center.php:29:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Twitter'); ?>">X (Twitter)</a></li>
app/Modules/Management/Views/Projects/index/exchange_action_center.php:30:                    <li><a class="dropdown-item" href="<?php echo site_url('/Management/Marketing/Exchanges/Top-Communities/Website'); ?>">Website</a></li>
app/Modules/Management/Views/Projects/index/exchange_action_center.php:42:                    View the <a href="<?php echo site_url('Management/Marketing/Exchanges/Top-Performers'); ?>"><strong><?php  ?>Top Performing Currencies</strong></a> 
app/Modules/Management/Views/Projects/index/modals.php:28:  //         data-href="<?= site_url('Management/CreatePost') ?>">
app/Modules/Management/Views/Projects/index/action_center_new.php:16:                <p><a href="<?php echo site_url('/Marketing/Campaigns/Add'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Projects/index/action_center_new.php:18:            <a href="<?php echo site_url('/Management/Marketing/Campaigns/Add'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Projects/index/action_center_new.php:30:                <p><a href="<?php echo site_url('/Management/Marketing/fetchEmails'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Projects/index/action_center_new.php:32:            <a href="<?php echo site_url('/Management/Marketing/fetchEmails'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Projects/index/action_center_new.php:44:                <p><a href="<?php echo site_url('Management/Marketing/generateNewsletter'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Projects/index/action_center_new.php:46:            <a href="<?php echo site_url('/Management/Marketing/generateNewsletter'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Projects/index/action_center_new.php:58:                <p><a href="<?php echo site_url('Management/Marketing/scheduleNewsletters'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Projects/index/action_center_new.php:60:            <a href="<?php echo site_url('/Management/Marketing/scheduleNewsletters'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Projects/index/action_center_new.php:72:                <p><a href="<?php echo site_url('/Management/Marketing/Tools'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Projects/index/action_center_new.php:74:            <a href="<?php echo site_url('/Management/Marketing/Tools'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Projects/index/action_center_new.php:85:                <p><a href="<?php echo site_url('/Management/Marketing/Campaigns/Add'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Projects/index/action_center_new.php:87:            <a href="<?php echo site_url('/Management/Marketing/Campaigns/Add'); ?>" class="btn btn-primary btn-md">
app/Modules/Management/Views/Projects/index/action_center_new.php:98:                <p><a href="<?php echo site_url('/Marketing/SEO/Tasks'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Projects/index/action_center_new.php:100:            <a href="<?php echo site_url('/Marketing/SEO/Tasks'); ?>" class="btn btn-warning btn-md">
app/Modules/Management/Views/Projects/index/action_center_new.php:111:                <p><a href="<?php echo site_url('/Marketing/Reports'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Projects/index/action_center_new.php:113:            <a href="<?php echo site_url('/Marketing/Reports'); ?>" class="btn btn-info btn-md">
app/Modules/Management/Views/Projects/index/action_center_new.php:124:                <p><a href="<?php echo site_url('/Marketing/Reports'); ?>"><strong><?php // echo $totalActiveUsers; ?> Active Users</strong></a> and <a href="#active-assets-overview"><strong><?php // echo $totalActivePartners; ?> Active Partners</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Projects/index/action_center_new.php:126:            <a href="<?php echo site_url('/Marketing/Tools'); ?>" class="btn btn-success btn-md">
app/Modules/Management/Views/Projects/index/project_creation.php:4:        <form action="<?= site_url('Projects/Create'); ?>" method="post">
app/Modules/Management/Views/Projects/index/project_list.php:21:                <a class="btn btn-primary full-width" href="<?= site_url('/Management/Projects') ?>">
app/Modules/Management/Views/Projects/index/project_list.php:64:                    <!-- <a href="<?= site_url('Projects/Export'); ?>" class="btn btn-sm btn-secondary">Export Projects</a>
app/Modules/Management/Views/Projects/index/project_list.php:65:                    <a href="<?= site_url('Projects/Report'); ?>" class="btn btn-sm btn-warning">Generate Report</a> -->
app/Modules/Management/Views/Projects/index/project_list.php:86:                            <td><a href="<?= site_url('Projects/View/' . $project['id']); ?>"><?= esc($project['name']); ?></a></td>
app/Modules/Management/Views/Projects/index/project_list.php:102:                                <a href="<?= site_url('Projects/View/' . $project['id']); ?>" class="btn btn-sm btn-primary mx-5"><em class="icon ni ni-eye"></em></a>
app/Modules/Management/Views/Projects/index/project_list.php:103:                                <!-- <a href="<?= site_url('Projects/Edit/' . $project['id']); ?>" class="btn btn-sm btn-secondary mx-5"><em class="icon ni ni-pen"></em></a>
app/Modules/Management/Views/Projects/index/project_list.php:104:                                <a href="<?= site_url('Projects/Delete/' . $project['id']); ?>" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this project?');"><em class="icon ni ni-cross"></em></a> -->
app/Modules/Management/Views/Projects/index/pending_projects.php:22:                    <!-- <a href="<?= site_url('Projects/Export'); ?>" class="btn btn-sm btn-secondary">Export Projects</a>
app/Modules/Management/Views/Projects/index/pending_projects.php:23:                    <a href="<?= site_url('Projects/Report'); ?>" class="btn btn-sm btn-warning">Generate Report</a> -->
app/Modules/Management/Views/Projects/index/pending_projects.php:44:                            <td><a href="<?= site_url('Projects/View/' . $project['id']); ?>"><?= esc($project['name']); ?></a></td>
app/Modules/Management/Views/Projects/index/pending_projects.php:61:                                <!-- <a href="<?= site_url('Projects/Edit/' . $project['id']); ?>" class="btn btn-sm btn-secondary mx-5"><em class="icon ni ni-pen"></em></a>
app/Modules/Management/Views/Projects/index/pending_projects.php:62:                                <a href="<?= site_url('Projects/Delete/' . $project['id']); ?>" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this project?');"><em class="icon ni ni-cross"></em></a> -->
app/Modules/Management/Views/Projects/index/investment_commitment.php:9:        <form action="<?= site_url('Projects/Commit'); ?>" method="post">
app/Modules/Management/Views/Projects/index/project_details.php:13:                    <a class="btn btn-primary text-white" href="<?= site_url('Projects/Edit/' . $project['id']); ?>">
app/Modules/Management/Views/Email/campaign_dashboard.php:59:        const response = await fetch(`<?= site_url('API/Email/fetchTagAnalytics') ?>`);
app/Modules/Management/Views/Email/campaign_dashboard.php:79:    const modal = await dynamicModalLoader('Campaign Analytics', "<?= site_url('Management/Email/viewCampaignStats') ?>/" + campaignId);
app/Modules/Management/Views/Email/campaign_dashboard.php:82:        const res = await fetch(`<?= site_url('API/Email/getCampaignStats') ?>/${campaignId}`);
app/Modules/Management/Views/Email/campaign_dashboard.php:98:        const response = await fetch("<?= site_url('API/Email/fetchCampaignAnalytics') ?>");
app/Modules/Management/Views/Email/resources/controlPanelBlock.php:42:            <a class="btn btn-warning" href="<?= site_url('API/Management/triggerBackfill') ?>">ðŸ” Run Backfill for Incomplete Posts</a>
app/Modules/Management/Views/Email/resources/controlPanelBlock.php:54:    const response = await fetch(`<?= site_url('API/Email/cloneCampaign/') ?>${campaignId}`);
app/Modules/Management/Views/Email/resources/controlPanelBlock.php:68:    const response = await fetch(`<?= site_url('API/Email/createDraftCampaign') ?>`, {
app/Modules/Management/Views/Email/resources/controlPanelBlock.php:88:        const response = await fetch("<?= site_url('API/Email/getEmailQueueStats') ?>");
app/Modules/Management/Views/Email/resources/controlPanelBlock.php:111:        const response = await fetch("<?= site_url('API/Email/sendMassTestCampaign') ?>?campaign_id=" + encodeURIComponent(campaignId));
app/Modules/Management/Views/Email/resources/controlPanelBlock.php:125:    dynamicModalLoader('Schedule Campaign', `<?= site_url('Management/Email/scheduleCampaignModal/') ?>${id}`, 'modal-md');
app/Modules/Management/Views/Email/campaignStats.php:8:    const response = await fetch("<?= site_url('API/Email/getCampaignMetrics/'.$campaign['id']) ?>");
app/Modules/Management/Views/Email/unsubscribe_success.php:12:                <a href="<?= site_url('/') ?>" class="btn btn-primary">Return to Home</a>
app/Modules/Management/Views/Email/index.php:27:                    <button class="btn btn-primary" onclick="dynamicModalLoader('Create New List', '<?= site_url('Management/Email/createList') ?>', 'modal-md')">
app/Modules/Management/Views/Email/index.php:49:                                        <button class="btn btn-sm btn-info" onclick="dynamicModalLoader('Add Member', '<?= site_url('Management/Email/addMember') ?>', 'modal-md')">
app/Modules/Management/Views/Email/index.php:52:                                        <button class="btn btn-sm btn-warning" onclick="dynamicModalLoader('Send Campaign', '<?= site_url('Management/Email/sendCampaign') ?>', 'modal-md')">
app/Modules/Management/Views/Email/queued.php:43:        const response = await fetch("<?= site_url('API/Email/fetchQueuedEmails') ?>?limit=" + limitPerPage + "&offset=" + offset + "&search=" + encodeURIComponent(search));
app/Modules/Management/Views/Email/queued.php:71:                    <button class="btn btn-primary btn-sm" onclick="dynamicModalLoader('Email Preview', '<?= site_url('Management/Email/previewQueuedEmail/') ?>${email.id}', 'modal-lg')">
app/Modules/Management/Views/Email/campaigns.php:88:                                                    <button class="btn btn-sm btn-primary" onclick='dynamicModalLoader("Edit Campaign","<?= site_url('Management/Email/editCampaign/' . $campaign['id']) ?>',"modal-lg")'>âœï¸ Edit</button>
app/Modules/Management/Views/Email/campaigns.php:135:        await fetch(`<?= site_url('API/Email/deleteCampaign') ?>/${campaignId}`, {
app/Modules/Management/Views/Email/campaigns.php:152:        await fetch(`<?= site_url('API/Email/scheduleCampaignApi') ?>/${campaignId}`, {
app/Modules/Management/Views/Email/campaigns.php:173:        await fetch(`<?= site_url('API/Email/scheduleCampaignApi') ?>/${campaignId}`, {
app/Modules/Management/Views/Email/campaigns.php:189:    const res = await fetch(`<?= site_url('API/Email/cloneCampaign/') ?>${campaignId}`);
app/Modules/Management/Views/Email/campaigns.php:203:        const response = await fetch("<?= site_url('API/Email/deleteCampaign') ?>/" + campaignId, {
app/Modules/Management/Views/Email/campaigns.php:229:    const response = await fetch("<?= site_url('API/Email/scheduleCampaignApi') ?>/" + campaignId, {
app/Modules/Management/Views/Email/campaigns.php:251:    const response = await fetch("<?= site_url('API/Email/scheduleCampaignApi') ?>/" + campaignId, {
app/Modules/Management/Views/Email/campaigns.php:276:    const modal = await dynamicModalLoader('Campaign Analytics', "<?= site_url('Management/Email/campaignStats') ?>/" + campaignId);
app/Modules/Management/Views/Email/modals/sendCampaign.php:37:    const response = await fetch(`<?= site_url('API/Email/createDraftCampaign') ?>`, {
app/Modules/Management/Views/Email/modals/createDraftCampaign.php:41:    const response = await fetch(`<?= site_url('API/Email/createDraftCampaign') ?>`, {
app/Modules/Management/Views/Email/modals/scheduleCampaign.php:2:<form method="post" action="<?= site_url('Management/Email/scheduleCampaign/'.$campaign['id']) ?>">
app/Modules/Management/Views/Email/modals/addMember.php:6:    <form id="addMemberForm" method="post" action="<?= site_url('Management/Email/addMember') ?>">
app/Modules/Management/Views/Email/modals/editCampaign.php:35:    const response = await fetch(`<?= site_url('API/Email/updateCampaign') ?>/${id}`, {
app/Modules/Management/Views/Email/modals/createQuickList.php:6:    <form id="createListForm" method="post" action="<?= site_url('Management/Email/createList') ?>">
app/Modules/Management/Views/Email/modals/cloneCampaign.php:24:    const response = await fetch(`<?= site_url('API/Email/cloneCampaign/') ?>${encodeURIComponent(campaignId)}`);
app/Modules/Management/Views/Assets/Create.php:28:                        <a href="<?php echo site_url('/Management'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Assets/Create.php:85:            const result = await fetch("<?= site_url('Exchange/Application-Manager/' . $cuID); ?>", {
app/Modules/Management/Views/Assets/Create.php:94:		   location.href = <?php echo '\'' . site_url('/Management/Assets') . '\'';?>;
app/Modules/Management/Views/Assets/Listing-Table.php:44:                                <a class="btn btn-icon" href="' . site_url('Management/' . $pageURIB . '/' . $asset['id']) . '"><i class="icon ni ni-bar-chart-alt"></i></a>                              
app/Modules/Management/Views/Assets/Listing-Table.php:45:                                <a class="btn btn-icon" href="' . site_url('Management/' . $pageURIB . '/' . $asset['id']) . '"><i class="icon ni ni-bar-chart-alt"></i></a>                              
app/Modules/Management/Views/Assets/Applications.php:58:						<a href="<?php echo site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Assets/Applications.php:92:                                        <a href="<?php echo site_url('/Management/Assets'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Assets/Applications.php:184:                                                    <a class="link py-3" href="<?php echo site_url('Management/Assets/Create'); ?>"><i class="icon ni ni-plus-circle"></i> Add Asset</a>
app/Modules/Management/Views/Assets/Distribute/By_User.php:11:                        <a href="<?php echo site_url('/Management'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Assets/Distribute/By_User.php:31:                                                    <li><a href="' . site_url('Users/Profile/' . $userAccount['cuID']) . '"><em class="icon ni ni-eye"></em><span>View Details</span></a></li>
app/Modules/Management/Views/Assets/Distribute/By_User.php:34:                                                    <li><a href="' . site_url('Users/Force-Reset/' . $userAccount['cuID']) . '"><em class="icon ni ni-shield-star"></em><span>Reset Pass</span></a></li>
app/Modules/Management/Views/Assets/Distribute/By_User.php:36:                                                    <li><a href="' . site_url('Users/Block/' . $userAccount['cuID']) . '"><em class="icon ni ni-na"></em><span>Suspend User</span></a></li>
app/Modules/Management/Views/Assets/Distribute/By_User.php:57:                                        <a href="' . site_url('Management/Users/Profile/' . $userAccount['cuID']) . '" class="btn btn-block btn-dim btn-primary text-white"><span>View Profile</span></a>
app/Modules/Management/Views/Assets/Distribute/By_User.php:211:                                            <span class="tb-odr-date"><a href="' . site_url('Exchange/Market/' . $userOrder['market_pair'] . '/' . $userOrder['market']) . '">' . $userOrder['market'] .'-' . $userOrder['market_pair'] . '</a></span>
app/Modules/Management/Views/Assets/Distribute/By_User.php:223:                                                <a href="' . site_url('Management/Users/Orders/' . $userOrder['id']) . '" class="btn btn-sm btn-primary">View</a>
app/Modules/Management/Views/Assets/Distribute/Overview.php:24:                        <a href="<?php echo site_url('/Management'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Assets/index.php:55:						<a href="<?php echo site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Assets/index.php:87:                                            <p><a href="<?php echo site_url('/Management/Assets/Applications'); ?>"><strong><?php echo $totalPendingAssets; ?> Pending Assets</strong></a> and <a href="#active-assets-overview"><strong><?php echo $totalApprovedAssets; ?> Asset Approvals</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Assets/index.php:89:                                        <a href="<?php echo site_url('/Management/Assets/Applications'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Assets/index.php:97:                                            <p>There is <a href="<?php echo site_url('/Management/Assets/Support/Requests'); ?>"><strong><?php echo $totalPendingSupport; ?></strong></a> support messages and <a href="<?php echo site_url('/Management/Assets/Support'); ?>"><strong><?php echo $totalCompleteSupport; ?></strong></a> completed request. </p>
app/Modules/Management/Views/Assets/index.php:99:                                        <a href="<?php echo site_url('/Management/Assets/Support/Requests'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Assets/index.php:107:                                            <p>We have reached <a href="<?php echo site_url('Management/Assets/Transactions'); ?>"><strong><?php echo $totalTransactions; ?> Total Transactions</strong></a>, <a href="<?php echo site_url('Management/Assets/Transactions'); ?>"><strong><?php echo $totalTransTotals; ?> Total Spend</strong></a>, and <a href="<?php echo site_url('Management/Assets/Transactions'); ?>"><strong><?php echo $totalTransFees; ?> Total</strong></a> in Transactional Fees.</p>
app/Modules/Management/Views/Assets/index.php:109:                                        <a href="<?php echo site_url('Management/Assets/Transactions'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Assets/index.php:244:                                    <a href="<?php echo site_url('/Management/Assets/Applications'); ?>" class="btn btn-primary btn-block"><i class="fa fa-eye"></i> Manage Applications</a>
app/Modules/Management/Views/Assets/index.php:322:                                    <a href="<?php echo site_url('/Management/Assets/Transactions'); ?>" class="btn btn-primary btn-block"><i class="fa fa-eye"></i> View Transactions</a>
app/Modules/Management/Views/Assets/index.php:361:                                    <a href="<?php echo site_url('/Management/Assets/Transaction-Fees'); ?>" class="btn btn-primary btn-block"><i class="fa fa-eye"></i> Manage Fees</a>
app/Modules/Management/Views/Assets/index.php:379:                                                        <li><a href="<?php echo site_url('Management/Assets/Support'); ?>"><em class="icon ni ni-setting"></em><span>Manage Support</span></a></li>
app/Modules/Management/Views/Assets/index.php:380:                                                        <li><a href="<?php echo site_url('Management/Assets/Support/Requests'); ?>"><em class="icon ni ni-notify"></em><span>Pending Requests</span></a></li>
app/Modules/Management/Views/Assets/index.php:400:                                    <a href="<?php echo site_url('Management/Assets/Support/Requests'); ?>" class="btn btn-primary btn-block"><i class="fa fa-eye"></i> Manage Tickets</a>
app/Modules/Management/Views/Assets/index.php:414:                                        <a href="<?php echo site_url('Management/Assets/Create'); ?>" class="project-title">
app/Modules/Management/Views/Assets/index.php:467:                                        <a href="<?php echo site_url('Management/Assets/Distribute'); ?>" class="project-title">
app/Modules/Management/Views/Assets/index.php:573:                                                    <a class="link py-3" href="<?php echo site_url('Management/Assets/Create'); ?>"><i class="icon ni ni-plus-circle"></i> <span class="pl-0" style="padding-top:3px;">Add Asset</span></a>
app/Modules/Management/Views/Assets/Applications/Details.php:51:    $coin_description                           = '<p class="card-text text-center">--- Description Currently Not Available ---<br><a class="btn btn-primary btn-md pt-3" href="' . site_url('Management/Assets/Request-Information/' . $userID . '/' . $appID) . '">Request Additional Information</a></p>'; 
app/Modules/Management/Views/Assets/Applications/Details.php:56:    $coin_file                                  = '<p class="card-text text-center">--- Files Currently Not Available ---<br><a class="btn btn-primary btn-md pt-3" href="' . site_url('Management/Assets/Request-Information/' . $userID . '/' . $appID) . '">Request Additional Information</a></p></p>';
app/Modules/Management/Views/Assets/Applications/Details.php:61:    $coin_links                                 = '<p class="card-text text-center">--- Links Currently Not Available ---<br><a class="btn btn-primary btn-md pt-3" href="' . site_url('Management/Assets/Request-Information/' . $userID . '/' . $appID) . '">Request Additional Information</a></p></p>';
app/Modules/Management/Views/Assets/Applications/Details.php:126:                        <a href="<?php echo site_url('/Management'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Assets/Applications/Details.php:235:                                            <span class="tb-odr-date"><a href="' . site_url('Exchange/Market/' . $usersAssets['blockchain'] . '/' . $usersAssets['symbol']) . '">' . $usersAssets['symbol'] .'-' . $usersAssets['blockchain'] . '</a></span>
app/Modules/Management/Views/Assets/Applications/Details.php:250:                                                <a href="' . site_url('Management/Users/Orders/' . $usersAssets['id']) . '" class="btn btn-sm btn-primary">View</a>
app/Modules/Management/Views/Assets/Applications/Listing-Table.php:30:                            <td><a href="' . site_url('Management/' . $pageURIB . '/Application/Details/' . $asset['id']) . '"><i class="icon icon-list"></i></a></td>
app/Modules/Management/Views/Assets/Applications/Approval.php:51:    $coin_description                           = '<p class="card-text text-center">--- Description Currently Not Available ---<br><a class="btn btn-primary btn-md pt-3" href="' . site_url('Management/Assets/Request-Information/' . $userID . '/' . $appID) . '">Request Additional Information</a></p>'; 
app/Modules/Management/Views/Assets/Applications/Approval.php:56:    $coin_file                                  = '<p class="card-text text-center">--- Files Currently Not Available ---<br><a class="btn btn-primary btn-md pt-3" href="' . site_url('Management/Assets/Request-Information/' . $userID . '/' . $appID) . '">Request Additional Information</a></p></p>';
app/Modules/Management/Views/Assets/Applications/Approval.php:61:    $coin_links                                 = '<p class="card-text text-center">--- Links Currently Not Available ---<br><a class="btn btn-primary btn-md pt-3" href="' . site_url('Management/Assets/Request-Information/' . $userID . '/' . $appID) . '">Request Additional Information</a></p></p>';
app/Modules/Management/Views/Assets/Applications/Approval.php:126:                        <a href="<?php echo site_url('/Management'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Assets/Applications/Approval.php:276:                                            <span class="tb-odr-date"><a href="' . site_url('Exchange/Market/' . $usersAssets['blockchain'] . '/' . $usersAssets['symbol']) . '">' . $usersAssets['symbol'] .'-' . $usersAssets['blockchain'] . '</a></span>
app/Modules/Management/Views/Assets/Applications/Approval.php:291:                                                <a href="' . site_url('Management/Users/Orders/' . $usersAssets['id']) . '" class="btn btn-sm btn-primary">View</a>
app/Modules/Management/Views/Assets/Applications/Details/User_Profile.php:10:                            <li><a href="' . site_url('Users/Profile/' . $userID) . '"><em class="icon ni ni-eye"></em><span>View Creator</span></a></li>
app/Modules/Management/Views/Assets/Applications/Details/User_Profile.php:15:                            <li><a href="' . site_url('Management/Asset/Application/' . $appID . '/Approve') . '"><em class="icon ni ni-check"></em><span>Approve Asset</span></a></li>
app/Modules/Management/Views/Assets/Applications/Details/User_Profile.php:16:                            <li><a href="' . site_url('Management/Asset/Application/' . $appID . '/Deny') . '"><em class="icon ni ni-na"></em><span>Deny Asset</span></a></li>
app/Modules/Management/Views/Assets/Applications/Details/User_Profile.php:20:                            <li><a href="' . site_url('Management/Asset/Application/' . $appID . '/Request-Approval') . '"><em class="icon ni ni-check"></em><span>Approve Asset</span></a></li>
app/Modules/Management/Views/Assets/Applications/Details/User_Profile.php:21:                            <li><a href="' . site_url('Management/Asset/Application/' . $appID . '/Request-Denial') . '"><em class="icon ni ni-na"></em><span>Deny Asset</span></a></li>
app/Modules/Management/Views/Assets/Applications/Details/User_Profile.php:45:                <a class="btn btn-primary btn-block mr-2" href="' . site_url('/Management/Assets/Application/Approve/' . $appID) . '">Approve</a>
app/Modules/Management/Views/Assets/Applications/Details/User_Profile.php:47:                <a class="btn btn-danger btn-block ml-2" href="' . site_url('/Management/Assets/Application/Deny/' . $appID) . '">Deny</a>
app/Modules/Management/Views/Assets/Applications/Details/Referral_Information.php:11:                            <li><a href="' . site_url('Users/Profile/' . $userID) . '"><em class="icon ni ni-eye"></em><span>View Details</span></a></li>
app/Modules/Management/Views/Assets/Applications/Details/Referral_Information.php:14:                            <li><a href="' . site_url('Users/Force-Reset/' . $userID) . '"><em class="icon ni ni-shield-star"></em><span>Reset Pass</span></a></li>
app/Modules/Management/Views/Assets/Applications/Details/Referral_Information.php:16:                            <li><a href="' . site_url('Users/Block/' . $userID) . '"><em class="icon ni ni-na"></em><span>Suspend User</span></a></li>
app/Modules/Management/Views/Assets/Applications/Details/Asset_Information.php:10:                            <li><a href="' . site_url('Users/Profile/' . $userID) . '"><em class="icon ni ni-eye"></em><span>View Creator</span></a></li>
app/Modules/Management/Views/Assets/Applications/Details/Asset_Information.php:15:                            <li><a href="' . site_url('Management/Asset/Application/' . $appID . '/Approve') . '"><em class="icon ni ni-check"></em><span>Approve Asset</span></a></li>
app/Modules/Management/Views/Assets/Applications/Details/Asset_Information.php:16:                            <li><a href="' . site_url('Management/Asset/Application/' . $appID . '/Deny') . '"><em class="icon ni ni-na"></em><span>Deny Asset</span></a></li>
app/Modules/Management/Views/Assets/Applications/Details/Asset_Information.php:20:                            <li><a href="' . site_url('Management/Asset/Application/' . $appID . '/Request-Approval') . '"><em class="icon ni ni-check"></em><span>Approve Asset</span></a></li>
app/Modules/Management/Views/Assets/Applications/Details/Asset_Information.php:21:                            <li><a href="' . site_url('Management/Asset/Application/' . $appID . '/Request-Denial') . '"><em class="icon ni ni-na"></em><span>Deny Asset</span></a></li>
app/Modules/Management/Views/Assets/Applications/Details/Asset_Information.php:45:                <a class="btn btn-primary btn-block mr-2" href="' . site_url('/Management/Assets/Application/Approve/' . $appID) . '">Approve</a>
app/Modules/Management/Views/Assets/Applications/Details/Asset_Information.php:47:                <a class="btn btn-danger btn-block ml-2" href="' . site_url('/Management/Assets/Application/Deny/' . $appID) . '">Deny</a>
app/Modules/Management/Views/Services/index.php:100:						<a href="<?php echo site_url('/Management'); ?>">Back to Management Dashboard</a>							
app/Modules/Management/Views/Services/index.php:192:                                    <a href="<?php echo site_url('/Management/Assets/Applications'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Subscribers</a>
app/Modules/Management/Views/Services/index.php:270:                                    <a href="<?php echo site_url('/Management/Assets/Transactions'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Assets</a>
app/Modules/Management/Views/Services/index.php:309:                                    <a href="<?php echo site_url('/Management/Services/Campaigns'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Fees</a>
app/Modules/Management/Views/Services/index.php:327:                                                        <li><a href="<?php echo site_url('Management/Assets/Support'); ?>"><em class="icon ni ni-setting"></em><span>View Support</span></a></li>
app/Modules/Management/Views/Services/index.php:328:                                                        <li><a href="<?php echo site_url('Management/Assets/Support/Requests'); ?>"><em class="icon ni ni-notify"></em><span>Pending Requests</span></a></li>
app/Modules/Management/Views/Services/index.php:346:                                    <a href="<?php echo site_url('Management/Services/Support/Requests'); ?>" class="btn btn-primary btn-block"><i class="icon ni ni-eye"></i> View Tasks</a>
app/Modules/Management/Views/Services/index/operational_tasks.php:6:                    <a href="<?php echo site_url('Management/Marketing/Analytics'); ?>" class="project-title">
app/Modules/Management/Views/Services/index/operational_tasks.php:59:                    <a href="<?php echo site_url('Management/Assets/Distribute'); ?>" class="project-title">
app/Modules/Management/Views/Services/index/operational_tasks.php:155:                    <a href="<?php echo site_url('Management/Marketing/Analytics'); ?>" class="project-title">
app/Modules/Management/Views/Services/index/operational_tasks.php:208:                    <a href="<?php echo site_url('Management/Assets/Distribute'); ?>" class="project-title">
app/Modules/Management/Views/Services/index/action_center.php:27:                    <p><a href="<?php echo site_url('/Management/Users'); ?>"><strong><?php echo $totalActiveServices; ?> Active Services</strong></a> and <a href="#active-assets-overview"><strong><?php echo $totalActiveSubscriptions; ?> Active Subscriptions</strong></a>, thats need to be reviewed.</p>
app/Modules/Management/Views/Services/index/action_center.php:29:                <a href="<?php echo site_url('/Management/Users'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Services/index/action_center.php:37:                    <p>There is <a href="<?php echo site_url('/Management/Marketing/Campaigns/Services'); ?>"><strong><?php echo $totalActiveCampaigns; ?></strong></a> Marketing Campaigns. View more <a href="<?php echo site_url('/Management/Marketing/Campaigns/' . $department); ?>"><strong><?php echo $department; ?> Marketing Analytics</strong></a> to track our progress. </p>
app/Modules/Management/Views/Services/index/action_center.php:39:                <a href="<?php echo site_url('/Management/Marketing/Campaigns'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Services/index/action_center.php:47:                    <p>There are currently <a href="<?php echo site_url('Management/Marketing/Tasks'); ?>"><strong><?php echo $totalDepartmentTasks; ?> Total Tasks</strong></a> pending for the team.</p>
app/Modules/Management/Views/Services/index/action_center.php:49:                <a href="<?php echo site_url('Management/Marketing/Tasks'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Reporting/Management.php:217:                                            <li><a href="<?php echo site_url('Management/Assets'); ?>"><em class="icon ni ni-setting"></em><span>View Existing Assets</span></a></li>
app/Modules/Management/Views/Reporting/Management.php:239:                        <a href="<?php echo site_url('Management/Assets'); ?>" class="btn btn-primary btn-block"><i class="fa fa-eye"></i> Manage Assets</a>
app/Modules/Management/Views/Web_Design/Test_Page_Email.php:84:				<a class="btn btn-primary" href="<?php echo site_url('Web-Design/Send-Email/' . $controller . '/' . $directory . '/' . $email); ?>">Send Test</a>
app/Modules/Management/Views/Web_Design/Content_Creator/FLinks/Flinks.php:10:$termsCondURL                       = site_url('/Terms-And-Conditions');
app/Modules/Management/Views/Web_Design/Content_Creator/Management/Update_Users.php:87:                        // 'ban_message'                       => 'Suspected Spam. Contact support@mymiwallet.com or visit ' . site_url('/Customer-Support'), 
app/Modules/Management/Views/Web_Design/Content_Creator/Management/Update_Users.php:132:                        'ban_message'                       => 'Suspected Spam. Contact support@mymiwallet.com or visit ' . site_url('/Customer-Support'), 
app/Modules/Management/Views/Web_Design/Content_Creator/Management/Users/Update_Users.php:87:                        // 'ban_message'                       => 'Suspected Spam. Contact support@mymiwallet.com or visit ' . site_url('/Customer-Support'), 
app/Modules/Management/Views/Web_Design/Content_Creator/Management/Users/Update_Users.php:132:                        'ban_message'                       => 'Suspected Spam. Contact support@mymiwallet.com or visit ' . site_url('/Customer-Support'), 
app/Modules/Management/Views/Web_Design/Content_Creator/Plaid/Integration.php:34:    'redirect_uri'              => site_url('/Content-Creator'),
app/Modules/Management/Views/Web_Design/Content_Creator/Plaid/Integration.php:59:            fetch('<?php echo site_url('/Institutions/Integrations/savePublicToken'); ?>', {
app/Modules/Management/Views/Web_Design/Content_Creator/Plaid/Integration.php:77:                fetch('<?php echo site_url('Institutions/Integrations/exchange_public_token'); ?>', {
app/Modules/Management/Views/Web_Design/Content_Creator/Plaid/Integration.php:105:                    fetch('<?php echo site_url('Institutions/Integrations/create_wallet'); ?>', {
app/Modules/Management/Views/Web_Design/Pages.php:10:							<td><a href="<?php echo site_url('/'); ?>">Landing Page</a></td>
app/Modules/Management/Views/Web_Design/Pages.php:13:							<td><a href="<?php echo site_url('/Free-Trial'); ?>">Free Trial</a></td>
app/Modules/Management/Views/Web_Design/Pages.php:16:							<td><a href="<?php echo site_url('/register'); ?>">User Registration</a></td>
app/Modules/Management/Views/Web_Design/Pages.php:19:							<td><a href="<?php echo site_url('/activate'); ?>">User Activation</a></td>
app/Modules/Management/Views/Web_Design/Pages.php:22:							<td><a href="<?php echo site_url('/Profile'); ?>">User Profile</a></td>
app/Modules/Management/Views/Web_Design/Pages.php:25:							<td><a href="<?php echo site_url('/Dashboard'); ?>">Investor Dashboard</a></td>
app/Modules/Management/Views/Web_Design/Pages.php:28:							<td><a href="<?php echo site_url('/Breakout-Stocks'); ?>">Breakout Stock Overview</a></td>
app/Modules/Management/Views/Web_Design/Pages.php:31:							<td><a href="<?php echo site_url('/Market-Movers'); ?>">Market Movers</a></td>
app/Modules/Management/Views/Web_Design/Pages.php:34:							<td><a href="<?php echo site_url('/Weekly-Options'); ?>">Weekly-Options</a></td>
app/Modules/Management/Views/Web_Design/Pages.php:37:							<td><a href="<?php echo site_url('/Weekly-Watchlist'); ?>">Weekly Watchlist</a></td>
app/Modules/Management/Views/Web_Design/Pages.php:40:							<td><a href="<?php echo site_url('/Dashboard/Weekly-Performance-Report'); ?>">Weekly Performance Report</a></td>
app/Modules/Management/Views/Web_Design/Infrastructure_Overview/Alerting_System/Market_Movers.php:35:<a class="btn btn-primary btn-sm" href="<?php echo site_url($setMarketMoversLink); ?>" target="_blank">Submit Market Movers</a>
app/Modules/Management/Views/Web_Design/Infrastructure_Overview/Alerting_System/Breakout_Stock_Alerts.php:33:<a class="btn btn-primary btn-sm" href="<?php echo site_url($setBreakoutStockAlertLink); ?>" target="_blank">Submit Breakout Alert</a>
app/Modules/Management/Views/Web_Design/Infrastructure_Overview/Alerting_System/Weekly_Options.php:17:<a class="btn btn-primary btn-sm" href="<?php echo site_url($setWeeklyWatchlistLink); ?>" target="_blank">Submit Weekly Watchlist</a>
app/Modules/Management/Views/Web_Design/Infrastructure_Overview/Alerting_System/Instant_Buy_Alerts.php:67:<a class="btn btn-primary btn-sm" href="<?php echo site_url($setInstantBuyAlertLink); ?>" target="_blank">Submit Breakout Alert</a>
app/Modules/Management/Views/Web_Design/Infrastructure_Overview/Alerting_System/Weekly_Watchlist.php:17:<a class="btn btn-primary btn-sm" href="<?php echo site_url($setWeeklyWatchlistLink); ?>" target="_blank">Submit Weekly Watchlist</a>
app/Modules/Management/Views/Web_Design/Content_Creator.php:107:                    url: "<?= site_url('User/Sports/getNBAPlayerStats/') ?>" + teamId,
app/Modules/Management/Views/Web_Design/Test_Page.php:34:						<a href="<?php echo site_url('/Trade-Tracker'); ?>">Test Page Environment</a>							
app/Modules/Management/Views/Web_Design/Forms/technician_fields.php:26:		<a class="align-left pl-2" href="<?php echo site_url('/Add-Techs'); ?>" role="button">
app/Modules/Management/Views/Web_Design/Edit_Dashboard.php:33:							<td><a href="<?php echo site_url('/') . $link; ?>"><?php echo $link; ?></a></td>
app/Modules/Management/Views/Web_Design/Edit_Dashboard.php:34:							<td><a href="<?php echo site_url('Dashboard-Management/Dashboard-Overview/') . $manDashboardID; ?>" target="_blank"><i class="icon-wrench"></i></a></td>
app/Modules/Management/Views/Exchange/index.php:81:                        <a href="<?php echo site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>                            
app/Modules/Management/Views/Exchange/index.php:115:                                        <a href="<?php echo site_url('/Management/Assets'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Exchange/index.php:201:                                        <a href="<?php echo site_url('Management/Assets/Create'); ?>" class="project-title">
app/Modules/Management/Views/Exchange/index.php:239:                                        <a href="<?php echo site_url('Management/Assets/Distribute'); ?>" class="project-title">
app/Modules/Management/Views/Exchange/index.php:324:                                                    <a class="link py-3" href="<?php echo site_url('Management/Assets/Create'); ?>"><i class="icon ni ni-plus-circle"></i> Add Asset</a>
app/Modules/Management/Views/Exchange/index.php:362:                                                    <a class="link py-3" href="<?php echo site_url('Management/Assets/Create'); ?>"><i class="icon ni ni-plus-circle"></i> Add Asset</a>
app/Modules/Management/Views/Exchange/index/Large_Transactions.php:27:                                <td><a href="' . site_url('/Management/Exchange/Transaction/' . $transID) . '">' . $transID . '</a></td>
app/Modules/Management/Views/Exchange/index/Large_Transactions.php:28:                                <td><a href="' . site_url('/Profile/' . $userID) . '">' . $userID . '</a></td>
app/Modules/Management/Views/Exchange/index/Large_Transactions.php:37:                                    <a class="btn btn-icon" href="' . site_url('Management/' . $pageURIB . '/' . $transaction['id']) . '"><i class="icon ni ni-eye-chart-alt"></i></a>                           
app/Modules/Management/Views/API/index.php:80:                        <a href="<?php echo site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>						
app/Modules/Management/Views/API/index.php:116:                                        <a href="<?php echo site_url('/Management/Alerts/Settings'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/API/index.php:411:                                        <a href="<?php echo site_url('Management/Alerts/Create'); ?>" class="project-title">
app/Modules/Management/Views/API/index.php:441:                                        <a href="<?php echo site_url('Management/Alerts/Review'); ?>" class="project-title">
app/Modules/Management/Views/API/index.php:470:                                        <a href="<?php echo site_url('Management/Alerts/Reports'); ?>" class="project-title">
app/Modules/Management/Views/index.php:47:            <a href="<?php echo site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>
app/Modules/Management/Views/index.php:80:                        <a href="<?php echo site_url('/Users'); ?>" class="btn btn-primary">Manage Users</a>
app/Modules/Management/Views/index.php:109:                        <a href="<?php echo site_url('/Users'); ?>" class="btn btn-primary">Manage Referrals</a>
app/Modules/Management/Views/index.php:140:                        <a href="<?php echo site_url('/Management/Assets'); ?>" class="btn btn-primary">Review</a>
app/Modules/Management/Views/index.php:169:                        <a href="<?php echo site_url('/Support'); ?>" class="btn btn-primary">View Support</a>
app/Modules/Management/Views/index.php:200:                        <a href="<?php echo site_url('/Management/Assets'); ?>" class="btn btn-primary">Review</a>
app/Modules/Management/Views/index.php:229:                        <a href="<?php echo site_url('/Support'); ?>" class="btn btn-primary">View Support</a>
app/Modules/Management/Views/index.php:242:                        <a href="<?php echo site_url('/Transactions'); ?>" class="btn btn-primary">Manage Transactions</a>
app/Modules/Management/Views/index.php:253:                        <a href="<?php echo site_url('/Management/Trades'); ?>" class="btn btn-primary">View Trades</a>
app/Modules/Management/Views/index.php:266:                        <a href="<?php echo site_url('/Partners'); ?>" class="btn btn-primary">View Partners</a>
app/Modules/Management/Views/index.php:277:                        <a href="<?php echo site_url('/Management/Wallets'); ?>" class="btn btn-primary">Manage Wallets</a>
app/Modules/Management/Views/index.php:291:            $.get('<?php echo site_url("/Management/runCronManually"); ?>', function (data) {
app/Modules/Management/Views/index.php:325:    //         '<?php echo site_url("/API/Management/getUsers"); ?>',
app/Modules/Management/Views/index.php:338:    //         '<?php echo site_url("/API/Management/getReferrals"); ?>',
app/Modules/Management/Views/index.php:351:    //         '<?php echo site_url("/API/Management/getAlerts"); ?>',
app/Modules/Management/Views/index.php:364:    //     //     '<?php echo site_url("/API/Management/getNews"); ?>',
app/Modules/Management/Views/index.php:377:    //     //     '<?php echo site_url("/API/Management/getAssets"); ?>',
app/Modules/Management/Views/index.php:390:    //     //     '<?php echo site_url("/API/Management/getSupport"); ?>',
app/Modules/Management/Views/Users/Profile.php:67:                                <a class="btn btn-primary btn-xs" href="' . site_url('My-Referrals') . '"><em class="icon ni ni-plus"></em><span>Share A Trade?</span></a>
app/Modules/Management/Views/Users/Profile.php:83:                                <a class="btn btn-success btn-xs" href="' . site_url('My-Referrals') . '"><em class="icon ni ni-plus"></em><span>Invite Friends!</span></a>
app/Modules/Management/Views/Users/Listing-Table.php:20:                            <td><a href="' . site_url('Management/Users/Profile/' . $user['id']) . '">' . $user['id'] . '</a></td>
app/Modules/Management/Views/Users/Listing-Table.php:28:                                    <a href="' . site_url('Management/Users/Profile/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Profile"><em class="icon ni ni-user"></em></a>
app/Modules/Management/Views/Users/Listing-Table.php:29:                                    <a href="' . site_url('Management/Users/Assets/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Assets"><em class="icon ni ni-coin"></em></a>
app/Modules/Management/Views/Users/Listing-Table.php:30:                                    <a href="' . site_url('Management/Users/Distribute/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="Distribute Coins"><em class="icon ni ni-coins"></em></a>
app/Modules/Management/Views/Users/Listing-Table.php:36:                                    <a href="' . site_url('Management/Users/Profile/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Profile"><em class="icon ni ni-user"></em></a>
app/Modules/Management/Views/Users/Listing-Table.php:37:                                    <a href="' . site_url('Management/Users/Assets/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Assets"><em class="icon ni ni-coin"></em></a>
app/Modules/Management/Views/Users/Listing-Table.php:38:                                    <a href="' . site_url('Management/Users/Distribute/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="Distribute Coins"><em class="icon ni ni-coins"></em></a>
app/Modules/Management/Views/Users/Listing-Table.php:40:                                    <a href="' . site_url('Management/Users/Block/' . $user['id']) . '" class="btn btn-trigger btn-icon text-danger"><em class="icon ni ni-na"></em></a>
app/Modules/Management/Views/Users/Listing-Table.php:46:                                    <a href="' . site_url('Management/Users/Profile/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Profile"><em class="icon ni ni-user"></em></a>
app/Modules/Management/Views/Users/Listing-Table.php:47:                                    <a href="' . site_url('Management/Users/Assets/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Assets"><em class="icon ni ni-coin"></em></a>
app/Modules/Management/Views/Users/Listing-Table.php:48:                                    <a href="' . site_url('Management/Users/Distribute/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="Distribute Coins"><em class="icon ni ni-coins"></em></a>
app/Modules/Management/Views/Users/Listing-Table.php:50:                                    <a href="' . site_url('Management/Users/Block/' . $user['id']) . '" class="btn btn-trigger btn-icon text-danger"><em class="icon ni ni-na"></em></a>
app/Modules/Management/Views/Users/MyMIGold-Tasks.php:19:                        <a href="<?php echo site_url('Marketing/User/EditTask/' . $task['id']); ?>" class="btn btn-sm btn-warning">Edit</a>
app/Modules/Management/Views/Users/MyMIGold-Tasks.php:20:                        <a href="<?php echo site_url('Marketing/User/DeleteTask/' . $task['id']); ?>" class="btn btn-sm btn-danger">Delete</a>
app/Modules/Management/Views/Users/Assets.php:59:                        <a href="<?php echo site_url('/Management'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Users/Assets.php:79:                                                    <li><a href="' . site_url('Users/Profile/' . $userAccount['cuID']) . '"><em class="icon ni ni-eye"></em><span>View Details</span></a></li>
app/Modules/Management/Views/Users/Assets.php:82:                                                    <li><a href="' . site_url('Users/Force-Reset/' . $userAccount['cuID']) . '"><em class="icon ni ni-shield-star"></em><span>Reset Pass</span></a></li>
app/Modules/Management/Views/Users/Assets.php:84:                                                    <li><a href="' . site_url('Users/Block/' . $userAccount['cuID']) . '"><em class="icon ni ni-na"></em><span>Suspend User</span></a></li>
app/Modules/Management/Views/Users/Assets.php:105:                                        <a href="' . site_url('Management/Users/Profile/' . $userAccount['cuID']) . '" class="btn btn-block btn-dim btn-primary text-white"><span>View Profile</span></a>
app/Modules/Management/Views/Users/Assets.php:200:                                            <span class="tb-odr-date"><a href="' . site_url('Exchange/Market/' . $userOrder['market_pair'] . '/' . $userOrder['market']) . '">' . $userOrder['market'] .'-' . $userOrder['market_pair'] . '</a></span>
app/Modules/Management/Views/Users/Assets.php:212:                                                <a href="' . site_url('Management/Users/Orders/' . $userOrder['id']) . '" class="btn btn-sm btn-primary">View</a>
app/Modules/Management/Views/Users/index.php:39:                        <a href="<?= site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>
app/Modules/Management/Views/Users/index.php:73:                                        <a href="<?= site_url('/Management/Assets'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Users/index.php:165:                                                    <a href="<?= site_url('Management/Assets/Create'); ?>" class="link py-3"><i class="icon ni ni-plus-circle"></i> Add Asset</a>
app/Modules/Management/Views/Users/index.php:203:                                                    <a href="<?= site_url('Management/Assets/Create'); ?>" class="link py-3"><i class="icon ni ni-plus-circle"></i> Add Asset</a>
app/Modules/Management/Views/Users/Inactive_Table.php:5:            <table class="table" id="management-inactive-users" data-url="<?= site_url('API/Management/ajaxGetInactiveUsers'); ?>">
app/Modules/Management/Views/Users/Inactive_Table.php:24:                            <td><a href="' . site_url('Management/Users/Profile/' . $user['username']) . '">' . $user['id'] . '</a></td>
app/Modules/Management/Views/Users/Inactive_Table.php:33:                                    <a href="' . site_url('Management/Users/Profile/' . $user['username']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Profile"><em class="icon ni ni-user"></em></a>
app/Modules/Management/Views/Users/Inactive_Table.php:34:                                    <a href="' . site_url('Management/Users/Assets/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Assets"><em class="icon ni ni-coin"></em></a>
app/Modules/Management/Views/Users/Inactive_Table.php:35:                                    <a href="' . site_url('Management/Users/Distribute/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="Distribute Coins"><em class="icon ni ni-coins"></em></a>
app/Modules/Management/Views/Users/Inactive_Table.php:41:                                    <a href="' . site_url('Management/Users/Profile/' . $user['username']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Profile"><em class="icon ni ni-user"></em></a>
app/Modules/Management/Views/Users/Inactive_Table.php:42:                                    <a href="' . site_url('Management/Users/Assets/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Assets"><em class="icon ni ni-coin"></em></a>
app/Modules/Management/Views/Users/Inactive_Table.php:43:                                    <a href="' . site_url('Management/Users/Distribute/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="Distribute Coins"><em class="icon ni ni-coins"></em></a>
app/Modules/Management/Views/Users/Active_Table.php:5:            <table class="table" id="management-active-users" data-url="<?= site_url('API/Management/ajaxGetActiveUsers'); ?>">
app/Modules/Management/Views/Users/Active_Table.php:22:                    //         <td><a href="' . site_url('Management/Users/Profile/' . $user['username']) . '">' . $user['id'] . '</a></td>
app/Modules/Management/Views/Users/Active_Table.php:31:                    //                 <a href="' . site_url('Management/Users/Profile/' . $user['username']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Profile"><em class="icon ni ni-user"></em></a>
app/Modules/Management/Views/Users/Active_Table.php:32:                    //                 <a href="' . site_url('Management/Users/Assets/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Assets"><em class="icon ni ni-coin"></em></a>
app/Modules/Management/Views/Users/Active_Table.php:33:                    //                 <a href="' . site_url('Management/Users/Distribute/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="Distribute Coins"><em class="icon ni ni-coins"></em></a>
app/Modules/Management/Views/Users/Active_Table.php:39:                    //                 <a href="' . site_url('Management/Users/Profile/' . $user['username']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Profile"><em class="icon ni ni-user"></em></a>
app/Modules/Management/Views/Users/Active_Table.php:40:                    //                 <a href="' . site_url('Management/Users/Assets/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="User Assets"><em class="icon ni ni-coin"></em></a>
app/Modules/Management/Views/Users/Active_Table.php:41:                    //                 <a href="' . site_url('Management/Users/Distribute/' . $user['id']) . '" class="btn btn-trigger btn-icon" data-bs-toggle="tooltip" data-placement="bottom" title="Distribute Coins"><em class="icon ni ni-coins"></em></a>
app/Modules/Management/Views/Users/partials/action_buttons.php:5:<a href="<?= site_url('Management/Users/Profile/' . $user['username']) ?>" class="btn btn-icon"><em class="icon ni ni-user"></em></a>
app/Modules/Management/Views/Users/partials/action_buttons.php:6:<a href="<?= site_url('Management/Users/Assets/' . $user['id']) ?>" class="btn btn-icon"><em class="icon ni ni-coin"></em></a>
app/Modules/Management/Views/Users/partials/action_buttons.php:7:<a href="<?= site_url('Management/Users/Distribute/' . $user['id']) ?>" class="btn btn-icon"><em class="icon ni ni-coins"></em></a>
app/Modules/Management/Views/Users/partials/action_buttons.php:13:    $.get('<?php echo site_url("/API/Management/checkForSpamUsers"); ?>', function (res) {
app/Modules/Management/Views/Budgets/index.php:37:						<a href="<?php echo site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Budgets/index.php:71:                                        <a href="<?php echo site_url('/Management/Assets'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Budgets/index.php:163:                                                    <a class="link py-3" href="<?php echo site_url('Management/Assets/Create'); ?>"><i class="icon ni ni-plus-circle"></i> Add Asset</a>
app/Modules/Management/Views/Budgeting/index.php:38:						<a href="<?php echo site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Budgeting/index.php:72:                                        <a href="<?php echo site_url('/Management/Assets'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Budgeting/index.php:164:                                                    <a class="link py-3" href="<?php echo site_url('Management/Assets/Create'); ?>"><i class="icon ni ni-plus-circle"></i> Add Asset</a>
app/Modules/Management/Views/Partners/Active_Partners.php:12:                            <a class="link py-3" href="<?php echo site_url('Management/Assets/Create'); ?>"><i class="icon ni ni-plus-circle"></i> Invite User</a>
app/Modules/Management/Views/Partners/Active_Partners.php:70:                                        <td><a href="' . site_url('/Management/Users/Profile/' . $partner['id']) . '">' . $partner['id'] . '</a></td>
app/Modules/Management/Views/Partners/index.php:58:						<a href="<?php echo site_url('/Trade-Tracker'); ?>">Back to Dashboard</a>							
app/Modules/Management/Views/Partners/index.php:92:                                        <a href="<?php echo site_url('/Management/Partners/Listing'); ?>" class="btn btn-icon btn-trigger me-n2"><em class="icon ni ni-forward-ios"></em></a>
app/Modules/Management/Views/Partners/index.php:382:                                                        <li><a href="<?php echo site_url('Management/Assets'); ?>"><em class="icon ni ni-setting"></em><span>View Existing Assets</span></a></li>
app/Modules/Management/Views/Partners/index.php:404:                                    <a href="<?php echo site_url('Management/Assets'); ?>" class="btn btn-primary btn-block"><i class="fa fa-eye"></i> Manage Referrals</a>
app/Modules/Management/Views/Partners/index.php:418:                                        <a href="<?php echo site_url('Management/Assets/Create'); ?>" class="project-title">
app/Modules/Management/Views/Partners/index.php:451:                                                <a class="btn btn-primary btn-md text-white" href="<?php echo site_url('Management/Partners/Listing'); ?>">View Partners</a>
app/Modules/Management/Views/Partners/index.php:478:                                        <a href="<?php echo site_url('Management/Partners/Assets'); ?>" class="project-title">
app/Modules/Management/Views/Partners/Active_Assets.php:12:                            <a class="link py-3" href="<?php echo site_url('Management/Assets/Create'); ?>"><i class="icon ni ni-plus-circle"></i> Add Asset</a>
app/Modules/Management/Controllers/HowTosController.php:585:                    session()->setFlashdata('message', 'There was an error submitting your changes. Contact support by clicking <a href="' . site_url('/Support') . '">here!</a>');
app/Modules/Management/Controllers/AlertsController.php:1166:            return redirect()->to(site_url('Management/Alerts'))->with('message', 'TradingView post submitted.');
app/Modules/Management/Controllers/AdminController.php:564:                    session()->setFlashdata('message', 'There was an error submitting your changes. Contact support by clicking <a href="' . site_url('/Support') . '">here!</a>');
app/Modules/Management/Controllers/MarketingController.php:827:                return redirect()->to(site_url('Management/Marketing/Exchanges/Edit/' . $id));
app/Modules/Management/Controllers/MarketingController.php:837:            'redirectURL' => site_url('Management/Marketing/Exchanges'),
app/Modules/Management/Controllers/MarketingController.php:1187:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Controllers/MarketingController.php:1630:            return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Controllers/MarketingController.php:1851:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Controllers/UsersController.php:260:                'link' => site_url("/Account-Information/{$userID}")
app/Modules/Management/Controllers/ServicesController.php:171:            $html = file_get_contents(site_url($uriString));
app/Modules/Management/Controllers/ServicesController.php:197:            'url' => site_url('/Management/Marketing/Page-SEO/' . $taskInfo['seo_id']),
app/Modules/Management/Controllers/ManagementController.php:597:                    session()->setFlashdata('message', 'There was an error submitting your changes. Contact support by clicking <a href="' . site_url('/Support') . '">here!</a>');
app/Modules/Management/Controllers/WalletsController.php:328:                $editUrl = site_url('Dashboard/Transaction-Modal/Edit/'. $this->guessEditEndpoint($r) .'/'. ($wid ?: ($r['id'] ?? 0)));
app/Modules/Management/Controllers/WalletsController.php:329:                $emailUrl = site_url('Management/Wallets/NotifyUserMissingInfo/'. $uid .'/'. ($wid ?: ($r['id'] ?? 0)));
app/Modules/Management/Controllers/WalletsController.php:405:        $editUrl = site_url("Dashboard/Transaction-Modal/Edit/{$map['endpoint']}/{$subId}");
app/Modules/Management/Controllers/MarketingController.11202024.php:364:                return redirect()->to(site_url('Management/Marketing/Exchanges/Edit/' . $id));
app/Modules/Management/Controllers/MarketingController.11202024.php:374:            'redirectURL' => site_url('Management/Marketing/Exchanges'),
app/Modules/Management/Controllers/MarketingController.11202024.php:682:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Controllers/MarketingController.11202024.php:727:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Controllers/MarketingController.11202024.php:1060:            return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Management/Controllers/MarketingController.11202024.php:1118:        return redirect()->to(site_url('Management/Marketing/Content/Listing'))
app/Modules/Blog/Views/PersonalBudgeting/Importance_Of_Personal_Financial_Budgeting.php:10:        $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/PersonalBudgeting/Importance_Of_Personal_Financial_Budgeting.php:12:        $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/PersonalBudgeting/Importance_Of_Personal_Financial_Budgeting.php:16:    $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/PersonalBudgeting/Importance_Of_Personal_Financial_Budgeting.php:124:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Investing/The-Fundamentals-Of-Investing'); ?>" id="tab1-tab"><strong>The Fundamentals Of Investing</strong></a></li>
app/Modules/Blog/Views/PersonalBudgeting/Importance_Of_Personal_Financial_Budgeting.php:125:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Investing/Tips-For-Effective-Investment-Portfolio-Management'); ?>" id="tab1-tab"><strong>Tips for Effective Investment Portfolio Management</strong></a></li>
app/Modules/Blog/Views/PersonalBudgeting/Importance_Of_Personal_Financial_Budgeting.php:126:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/IRS/IRS-Expanded-Home-Energy-Tax-Credits'); ?>" id="tab1-tab"><strong>IRS Announces Expanded Home Energy Tax Credits</strong></a></li>
app/Modules/Blog/Views/PersonalBudgeting/Importance_Of_Personal_Financial_Budgeting.php:527:                                $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/PersonalBudgeting/Importance_Of_Personal_Financial_Budgeting.php:529:                                $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/PersonalBudgeting/Importance_Of_Personal_Financial_Budgeting.php:533:                            $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/PersonalBudgeting/Importance_Of_Personal_Financial_Budgeting.php:549:                                            <a class="btn btn-primary" href="' . site_url('/Dashboard') . '">Get Started!</a> 
app/Modules/Blog/Views/IRS/IRS_Expanded_Home_Energy_Tax_Credits.php:10:        $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/IRS/IRS_Expanded_Home_Energy_Tax_Credits.php:12:        $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/IRS/IRS_Expanded_Home_Energy_Tax_Credits.php:16:    $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/IRS/IRS_Expanded_Home_Energy_Tax_Credits.php:99:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Personal-Budgeting/The-Importance-of-Personal-Financial-Budgeting'); ?>" id="tab1-tab"><strong>The Importance of Personal Financial Budgeting</strong></a></li>
app/Modules/Blog/Views/IRS/IRS_Expanded_Home_Energy_Tax_Credits.php:100:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Investing/The-Fundamentals-Of-Investing'); ?>" id="tab1-tab"><strong>The Fundamentals Of Investing</strong></a></li>
app/Modules/Blog/Views/IRS/IRS_Expanded_Home_Energy_Tax_Credits.php:101:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Investing/Tips-For-Effective-Investment-Portfolio-Management'); ?>" id="tab1-tab"><strong>Tips for Effective Investment Portfolio Management</strong></a></li>
app/Modules/Blog/Views/IRS/IRS_Expanded_Home_Energy_Tax_Credits.php:246:                                $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/IRS/IRS_Expanded_Home_Energy_Tax_Credits.php:248:                                $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/IRS/IRS_Expanded_Home_Energy_Tax_Credits.php:252:                            $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/IRS/IRS_Expanded_Home_Energy_Tax_Credits.php:268:                                            <a class="btn btn-primary" href="' . site_url('/Dashboard') . '">Get Started!</a> 
app/Modules/Blog/Views/Investing/Tips_For_Effective_Investment_Portfolio_Management.php:10:        $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/Investing/Tips_For_Effective_Investment_Portfolio_Management.php:12:        $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/Investing/Tips_For_Effective_Investment_Portfolio_Management.php:16:    $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/Investing/Tips_For_Effective_Investment_Portfolio_Management.php:140:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Personal-Budgeting/The-Importance-of-Personal-Financial-Budgeting'); ?>" id="tab1-tab"><strong>The Importance of Personal Financial Budgeting</strong></a></li>
app/Modules/Blog/Views/Investing/Tips_For_Effective_Investment_Portfolio_Management.php:141:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Investing/The-Fundamentals-Of-Investing'); ?>" id="tab1-tab"><strong>The Fundamentals Of Investing</strong></a></li>
app/Modules/Blog/Views/Investing/Tips_For_Effective_Investment_Portfolio_Management.php:142:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/IRS/IRS-Expanded-Home-Energy-Tax-Credits'); ?>" id="tab1-tab"><strong>IRS Announces Expanded Home Energy Tax Credits</strong></a></li>
app/Modules/Blog/Views/Investing/Tips_For_Effective_Investment_Portfolio_Management.php:1179:                                $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/Investing/Tips_For_Effective_Investment_Portfolio_Management.php:1181:                                $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/Investing/Tips_For_Effective_Investment_Portfolio_Management.php:1185:                            $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/Investing/Tips_For_Effective_Investment_Portfolio_Management.php:1201:                                            <a class="btn btn-primary" href="' . site_url('/Dashboard') . '">Get Started!</a> 
app/Modules/Blog/Views/Investing/The_Fundamentals_Of_Investing.php:10:        $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/Investing/The_Fundamentals_Of_Investing.php:12:        $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/Investing/The_Fundamentals_Of_Investing.php:16:    $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/Investing/The_Fundamentals_Of_Investing.php:129:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Personal-Budgeting/The-Importance-of-Personal-Financial-Budgeting'); ?>" id="tab1-tab"><strong>The Importance of Personal Financial Budgeting</strong></a></li>
app/Modules/Blog/Views/Investing/The_Fundamentals_Of_Investing.php:130:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Investing/Tips-For-Effective-Investment-Portfolio-Management'); ?>" id="tab1-tab"><strong>Tips for Effective Investment Portfolio Management</strong></a></li>
app/Modules/Blog/Views/Investing/The_Fundamentals_Of_Investing.php:131:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/IRS/IRS-Expanded-Home-Energy-Tax-Credits'); ?>" id="tab1-tab"><strong>IRS Announces Expanded Home Energy Tax Credits</strong></a></li>
app/Modules/Blog/Views/Investing/The_Fundamentals_Of_Investing.php:1229:                                $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/Investing/The_Fundamentals_Of_Investing.php:1231:                                $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/Investing/The_Fundamentals_Of_Investing.php:1235:                            $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/Investing/The_Fundamentals_Of_Investing.php:1251:                                            <a class="btn btn-primary" href="' . site_url('/Dashboard') . '">Get Started!</a> 
app/Modules/Blog/Views/Investing/The_Beginners_Guide_To_Option_Trading.php:10:        $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/Investing/The_Beginners_Guide_To_Option_Trading.php:12:        $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/Investing/The_Beginners_Guide_To_Option_Trading.php:16:    $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/Investing/The_Beginners_Guide_To_Option_Trading.php:118:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Personal-Budgeting/The-Importance-of-Personal-Financial-Budgeting'); ?>" id="tab1-tab"><strong>The Importance of Personal Financial Budgeting</strong></a></li>
app/Modules/Blog/Views/Investing/The_Beginners_Guide_To_Option_Trading.php:119:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Investing/Tips-For-Effective-Investment-Portfolio-Management'); ?>" id="tab1-tab"><strong>Tips for Effective Investment Portfolio Management</strong></a></li>
app/Modules/Blog/Views/Investing/The_Beginners_Guide_To_Option_Trading.php:120:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/IRS/IRS-Expanded-Home-Energy-Tax-Credits'); ?>" id="tab1-tab"><strong>IRS Announces Expanded Home Energy Tax Credits</strong></a></li>
app/Modules/Blog/Views/Investing/The_Beginners_Guide_To_Option_Trading.php:230:                                        For more financial insights, investment advice, and tools to optimize your investment portfolio, view our <a href="<?php echo site_url('/Blog'); ?>">Financial Blog</a>: <a href="<?php echo site_url('/Blog'); ?>">Discover More!</a>.<br>
app/Modules/Blog/Views/Investing/The_Beginners_Guide_To_Option_Trading.php:556:                                $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/Investing/The_Beginners_Guide_To_Option_Trading.php:558:                                $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/Investing/The_Beginners_Guide_To_Option_Trading.php:562:                            $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/Investing/The_Beginners_Guide_To_Option_Trading.php:578:                                            <a class="btn btn-primary" href="' . site_url('/Dashboard') . '">Get Started!</a> 
app/Modules/Blog/Views/HowItWorks/Daily_Financial_News.php:4:$btnURL = empty($cuID) ? ($beta === 0 ? site_url('/Free/register') : site_url('/Beta/register')) : site_url('/Dashboard');
app/Modules/Blog/Views/HowItWorks/Purchase_MyMI_Gold.php:39:                                <li class="breadcrumb-item"><a href="<?php echo site_url('/How-To-Guides'); ?>">How It Works</a></li>
app/Modules/Blog/Views/HowItWorks/Features_And_Plans.php:12:                                <li class="breadcrumb-item"><a href="<?= site_url('/How-To-Guides'); ?>">How It Works</a></li>
app/Modules/Blog/Views/HowItWorks/Personal_Budgeting.php:11:        $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/HowItWorks/Personal_Budgeting.php:13:        $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/HowItWorks/Personal_Budgeting.php:17:    $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/HowItWorks/Personal_Budgeting.php:108:                            <!-- Utilize our <a href="<?php //echo site_url('/Marketplace'); ?>">MyMI Asset Marketplace</a> &amp; <a href="<?php //echo site_url('/Exchange'); ?>">Exchange</a> to profit from your investment data, build liquidity, and more at MyMI Wallet.  -->
app/Modules/Blog/Views/HowItWorks/Personal_Budgeting.php:122:                        <!-- Utilize our <a href="<?php //echo site_url('/Marketplace'); ?>">MyMI Asset Marketplace</a> &amp; <a href="<?php //echo site_url('/Exchange'); ?>">Exchange</a> to profit from your investment data, build liquidity, and more at MyMI Wallet.  -->
app/Modules/Blog/Views/HowItWorks/Personal_Budgeting.php:125:                        <li><strong class="list-blue-header pl-3">Creating Your Account</strong> Sign up for an account with MyMI Wallet, if you haven't already. This will require providing some basic personal and financial information, such as your name, email address, and contact information. Click <a href="<?php echo site_url('How-It-Works/Registering-An-Account'); ?>">here</a> for more information on <a href="<?php echo site_url('How-It-Works/Registering-An-Account'); ?>">Account & Security Settings</a>.</li><br>
app/Modules/Blog/Views/HowItWorks/Personal_Budgeting.php:129:                        <li><strong class="list-blue-header pl-3">Adding Your Wallets:</strong> Before creating your budget, you first need to know what your Checking &amp; Savings account balances are. You are also currently able to use MyMI Wallets to represent your Credit Card Accounts and their individual account balances to ensure your capture all of the financial resources you have available. Learn more about our <a href="<?php echo site_url('How-It-Works/MyMI-Wallets'); ?>">MyMI Wallets</a> and how they work by clicking <a href="<?php echo site_url('How-It-Works/MyMI-Wallets'); ?>">here</a>.</li><br>
app/Modules/Blog/Views/HowItWorks/Personal_Budgeting.php:142:                        <li><strong class="list-blue-header pl-3">Account Issues &amp; Support:</strong> If you are having trouble creating an account or managing your account settings, simply contact us at <a href="<?php echo site_url('/Customer-Support'); ?>">MyMI Support</a> or via email at <a href="mailto:support@mymiwallet.com">support@mymiwallet.com</a>. Our Hours are Operations are as follows: Mon-Fri 8am-5pm (CST) excluded some recommended holidays.</li><br>
app/Modules/Blog/Views/HowItWorks/Personal_Budgeting.php:180:                        <li><strong class="list-blue-header pl-3">Determine your financial goals:</strong> Based on the result of your current budget, what do you want to achieve with your money? Do you want to save for a down payment on a house, pay off debt, or save for retirement? Identifying your financial goals will help you create a plan to reach them. Learn more about <a href="<?php echo site_url('/How-It-Works/Determining-Your-Financial-Goals'); ?>">Determining Financial Goals</a> below.</li><br>
app/Modules/Blog/Views/HowItWorks/Personal_Budgeting.php:321:                            <div class="g mt-4 mt-md-0"><a href="<?php echo site_url('Knowledgebase/Trade-Tracker'); ?>" target="_blank" class="btn btn-lg btn-primary"><span>Learn More!</span></a></div>
app/Modules/Blog/Views/HowItWorks/index.php:20:        $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/HowItWorks/index.php:22:        $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/HowItWorks/index.php:26:    $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/HowItWorks/index.php:139:                                    <li class="nav-item"><a class="nav-link" href="<?php echo site_url('/Blog/Personal-Budgeting/The-Importance-of-Personal-Financial-Budgeting'); ?>" id="tab1-tab"><strong>The Importance of Personal Financial Budgeting</strong></a></li>
app/Modules/Blog/Views/HowItWorks/index.php:140:                                    <li class="nav-item"><a class="nav-link" href="<?php echo site_url('/Blog/Investing/The-Fundamentals-Of-Investing'); ?>" id="tab1-tab"><strong>The Fundamentals Of Investing</strong></a></li>
app/Modules/Blog/Views/HowItWorks/index.php:141:                                    <li class="nav-item"><a class="nav-link" href="<?php echo site_url('/Blog/IRS/IRS-Expanded-Home-Energy-Tax-Credits'); ?>" id="tab1-tab"><strong>IRS Announces Expanded Home Energy Tax Credits</strong></a></li>
app/Modules/Blog/Views/HowItWorks/index.php:183:                                    <a class="btn btn-primary text-white float-right" href="<?php echo site_url('/How-It-Works/Registering-An-Account'); ?>">Read More...</a>
app/Modules/Blog/Views/HowItWorks/index.php:197:                                    <a class="btn btn-primary text-white float-right" href="<?php echo site_url('/How-It-Works/Personal-Budgeting'); ?>">Read More...</a>
app/Modules/Blog/Views/HowItWorks/index.php:211:                                    <a class="btn btn-primary text-white float-right" href="<?php echo site_url('/How-It-Works/Determining-Your-Financial-Goals'); ?>">Read More...</a>
app/Modules/Blog/Views/HowItWorks/index.php:244:                                    <a class="btn btn-primary text-white float-right" href="<?php echo site_url('Blog/Personal-Budgeting/The-Importance-of-Personal-Financial-Budgeting'); ?>">Read More...</a>  
app/Modules/Blog/Views/HowItWorks/index.php:274:                                    <a class="btn btn-primary text-white float-right" href="<?php echo site_url('/Blog/Investing/The-Fundamentals-Of-Investing'); ?>">Read More...</a>  
app/Modules/Blog/Views/HowItWorks/index.php:289:                                    <a class="btn btn-primary text-white float-right" href="<?php echo site_url('Blog/Investing/Tips-For-Effective-Investment-Portfolio-Management'); ?>">Read More...</a>  
app/Modules/Blog/Views/HowItWorks/index.php:304:                                    <a class="btn btn-primary text-white float-right" href="<?php echo site_url('Blog/Investing/The-Beginners-Guide-To-Option-Trading'); ?>">Read More...</a>     
app/Modules/Blog/Views/HowItWorks/index.php:334:                                    <a class="btn btn-primary text-white float-right" href="<?php echo site_url('Blog/IRS/IRS-Expanded-Home-Energy-Tax-Credits'); ?>">Read More...</a>    
app/Modules/Blog/Views/HowItWorks/index.php:423:                                $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/HowItWorks/index.php:425:                                $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/HowItWorks/index.php:429:                            $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/HowItWorks/index.php:445:                                            <a class="btn btn-primary" href="' . site_url('/Dashboard') . '">Get Started!</a> 
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:8:$btnURL = empty($cuID) ? ($beta === 0 ? site_url('/Free/register') : site_url('/Beta/register')) : site_url('/Dashboard');
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:257:        <a href="<?= site_url('Memberships/Customize'); ?>" class="btn btn-primary btn-lg mb-3">Customize Your Plan</a>
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:258:        <a href="<?= site_url('How-It-Works/Personal-Budgeting'); ?>" class="btn btn-outline-primary btn-lg mb-3">Explore Budgeting Tools</a>
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:299:            <a href="<?= site_url('Budgeting') ?>" class="btn btn-success btn-lg">Start Budgeting</a>
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:311:            'ctaLink' => site_url('Services/Financial-Coach')
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:332:$btnURL = empty($cuID) ? ($beta === 0 ? site_url('/Free/register') : site_url('/Beta/register')) : site_url('/Dashboard');
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:581:        <a href="<?= site_url('Memberships/Customize'); ?>" class="btn btn-primary btn-lg mb-3">Customize Your Plan</a>
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:582:        <a href="<?= site_url('How-It-Works/Personal-Budgeting'); ?>" class="btn btn-outline-primary btn-lg mb-3">Explore Budgeting Tools</a>
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:623:            <a href="<?= site_url('Budgeting') ?>" class="btn btn-success btn-lg">Start Budgeting</a>
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:635:            'ctaLink' => site_url('Services/Financial-Coach')
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals.php:8:$btnURL = empty($cuID) ? ($beta === 0 ? site_url('/Free/register') : site_url('/Beta/register')) : site_url('/Dashboard');
app/Modules/Blog/Views/HowItWorks/Investment_Portfolio_Management.php:4:$btnURL = empty($cuID) ? ($beta === 0 ? site_url('/Free/register') : site_url('/Beta/register')) : site_url('/Dashboard');
app/Modules/Blog/Views/HowItWorks/Manage_Finances.php:12:                                <li class="breadcrumb-item"><a href="<?= site_url('/How-To-Guides'); ?>">How It Works</a></li>
app/Modules/Blog/Views/HowItWorks/MyMI_Gold.php:101:										<li class="breadcrumb-item"><a href="<?php echo site_url('/How-To-Guides'); ?>">How It Works</a></li>
app/Modules/Blog/Views/HowItWorks/MyMI_Gold.php:207:									<!-- <li><a href="<?php echo site_url('Premium-Features/Wallets'); ?>">Additional Wallets (Trading Accounts)</a></li>
app/Modules/Blog/Views/HowItWorks/MyMI_Gold.php:208:									<li><a href="<?php echo site_url('Premium-Features/Advanced-Trade-Tracker'); ?>">Advanced Charting Integrations</a></li> -->
app/Modules/Blog/Views/HowItWorks/MyMI_Gold.php:211:                                            <a href="<?php echo site_url('Features/Advanced-Investment-Portfoio-Manager'); ?>"><strong>MyMI Trade Tracker <small>(Advanced Portfolio Manager)</small></strong></a> - 
app/Modules/Blog/Views/HowItWorks/MyMI_Gold.php:219:                                            <a href="<?php echo site_url('Features/Brokerage-Integration'); ?>"><strong>Banking/Brokerage Integration Tool</strong></a> - 
app/Modules/Blog/Views/HowItWorks/MyMI_Gold.php:225:									<!-- <li><a href="<?php echo site_url('Premium-Features/Brokerage-API-Integration'); ?>">Brokerage Account API Integration</a></li>
app/Modules/Blog/Views/HowItWorks/MyMI_Gold.php:226:									<li><a href="<?php echo site_url('Premium-Features/Due-Diligence-Database'); ?>">Community Due Diligence Database</a></li> -->
app/Modules/Blog/Views/HowItWorks/MyMI_Gold.php:235:										<a href="<?php echo site_url('How-It-Works/Purchase-MyMI-Gold'); ?>">How to purchase MyMI Gold</a>
app/Modules/Blog/Views/HowItWorks/MyMI_Gold.php:238:										<a href="<?php echo site_url('Premium-Features/Wallets'); ?>">How to purchase Additional Wallets</a>
app/Modules/Blog/Views/HowItWorks/MyMI_Gold.php:241:										<a href="<?php echo site_url('Premium-Features/Advanced-Trade-Tracker'); ?>">How to use Advanced Trade Tracker</a>
app/Modules/Blog/Views/HowItWorks/MyMI_Gold.php:244:										<a href="<?php echo site_url('Premium-Features/Advanced-Charting'); ?>">How to use Advanced Charting</a> 
app/Modules/Blog/Views/HowItWorks/MyMI_Gold.php:247:										<a href="<?php echo site_url('Premium_Features/Brokerage-Integrations'); ?>">How to integrate Brokerage Accounts</a>
app/Modules/Blog/Views/HowItWorks/MyMI_Gold.php:250:										<a href="<?php echo site_url('Premium-Features/Due-Diligence-Database'); ?>">How our Due Database works</a>   
app/Modules/Blog/Views/HowItWorks/Registering_An_Account.php:10:        $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/HowItWorks/Registering_An_Account.php:12:        $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/HowItWorks/Registering_An_Account.php:16:    $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/HowItWorks/Registering_An_Account.php:54:                                    Welcome to <a href="<?php echo site_url(); ?>">MyMI Wallet</a>! As you start your journey towards financial wellness, it's important to have clear and achievable financial goals. 
app/Modules/Blog/Views/HowItWorks/Registering_An_Account.php:95:                            <!-- Utilize our <a href="<?php //echo site_url('/Marketplace'); ?>">MyMI Asset Marketplace</a> &amp; <a href="<?php //echo site_url('/Exchange'); ?>">Exchange</a> to profit from your investment data, build liquidity, and more at MyMI Wallet.  -->
app/Modules/Blog/Views/HowItWorks/Registering_An_Account.php:311:                            <div class="g mt-4 mt-md-0"><a href="<?php echo site_url('Knowledgebase/Trade-Tracker'); ?>" target="_blank" class="btn btn-lg btn-primary"><span>Learn More!</span></a></div>
app/Modules/Blog/Views/Blog/index.php:14:                    <a href="<?= site_url('/Management') ?>">Back to Management Dashboard</a>
app/Modules/Blog/Views/index.php:18:        $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/index.php:20:        $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/index.php:24:    $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/index.php:137:                                    <li class="nav-item"><a class="nav-link" href="<?php echo site_url('/Blog/Personal-Budgeting/The-Importance-of-Personal-Financial-Budgeting'); ?>" id="tab1-tab"><strong>The Importance of Personal Financial Budgeting</strong></a></li>
app/Modules/Blog/Views/index.php:138:                                    <li class="nav-item"><a class="nav-link" href="<?php echo site_url('/Blog/Investing/The-Fundamentals-Of-Investing'); ?>" id="tab1-tab"><strong>The Fundamentals Of Investing</strong></a></li>
app/Modules/Blog/Views/index.php:139:                                    <li class="nav-item"><a class="nav-link" href="<?php echo site_url('/Blog/IRS/IRS-Expanded-Home-Energy-Tax-Credits'); ?>" id="tab1-tab"><strong>IRS Announces Expanded Home Energy Tax Credits</strong></a></li>
app/Modules/Blog/Views/index.php:185:                                    <a class="btn btn-primary text-white float-right" href="<?php echo site_url('/Blog/News-And-Updates/The-Roadmap-To-The-Future-Of-Finance'); ?>">Read More...</a>
app/Modules/Blog/Views/index.php:201:                                    <a class="btn btn-primary text-white float-right" href="<?php echo site_url('/Blog/News-And-Updates/Integrating-With-Plaid'); ?>">Read More...</a>
app/Modules/Blog/Views/index.php:234:                                    <a class="btn btn-primary text-white float-right" href="<?php echo site_url('Blog/Personal-Budgeting/The-Importance-of-Personal-Financial-Budgeting'); ?>">Read More...</a>  
app/Modules/Blog/Views/index.php:264:                                    <a class="btn btn-primary text-white float-right" href="<?php echo site_url('/Blog/Investing/The-Fundamentals-Of-Investing'); ?>">Read More...</a>  
app/Modules/Blog/Views/index.php:279:                                    <a class="btn btn-primary text-white float-right" href="<?php echo site_url('Blog/Investing/Tips-For-Effective-Investment-Portfolio-Management'); ?>">Read More...</a>  
app/Modules/Blog/Views/index.php:294:                                    <a class="btn btn-primary text-white float-right" href="<?php echo site_url('Blog/Investing/The-Beginners-Guide-To-Option-Trading'); ?>">Read More...</a>     
app/Modules/Blog/Views/index.php:324:                                    <a class="btn btn-primary text-white float-right" href="<?php echo site_url('Blog/IRS/IRS-Expanded-Home-Energy-Tax-Credits'); ?>">Read More...</a>    
app/Modules/Blog/Views/index.php:412:                                $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/index.php:414:                                $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/index.php:418:                            $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/index.php:434:                                            <a class="btn btn-primary" href="' . site_url('/Dashboard') . '">Get Started!</a> 
app/Modules/Blog/Views/NewsAndUpdates/Integrating_With_Plaid.php:20:        $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/NewsAndUpdates/Integrating_With_Plaid.php:22:        $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/NewsAndUpdates/Integrating_With_Plaid.php:26:    $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/NewsAndUpdates/Integrating_With_Plaid.php:116:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Personal-Budgeting/The-Importance-of-Personal-Financial-Budgeting'); ?>" id="tab1-tab"><strong>The Importance of Personal Financial Budgeting</strong></a></li>
app/Modules/Blog/Views/NewsAndUpdates/Integrating_With_Plaid.php:117:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Investing/The-Fundamentals-Of-Investing'); ?>" id="tab1-tab"><strong>The Fundamentals Of Investing</strong></a></li>
app/Modules/Blog/Views/NewsAndUpdates/Integrating_With_Plaid.php:118:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Investing/Tips-For-Effective-Investment-Portfolio-Management'); ?>" id="tab1-tab"><strong>Tips for Effective Investment Portfolio Management</strong></a></li>
app/Modules/Blog/Views/NewsAndUpdates/Integrating_With_Plaid.php:380:                                $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/NewsAndUpdates/Integrating_With_Plaid.php:382:                                $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/NewsAndUpdates/Integrating_With_Plaid.php:386:                            $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/NewsAndUpdates/Integrating_With_Plaid.php:401:                                            <a class="btn btn-primary" href="' . site_url('/Dashboard') . '">Get Started!</a> 
app/Modules/Blog/Views/NewsAndUpdates/The_Roadmap_To_The_Future_Of_Finance.php:18:        $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/NewsAndUpdates/The_Roadmap_To_The_Future_Of_Finance.php:20:        $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/NewsAndUpdates/The_Roadmap_To_The_Future_Of_Finance.php:24:    $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/NewsAndUpdates/The_Roadmap_To_The_Future_Of_Finance.php:113:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Personal-Budgeting/The-Importance-of-Personal-Financial-Budgeting'); ?>" id="tab1-tab"><strong>The Importance of Personal Financial Budgeting</strong></a></li>
app/Modules/Blog/Views/NewsAndUpdates/The_Roadmap_To_The_Future_Of_Finance.php:114:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Investing/The-Fundamentals-Of-Investing'); ?>" id="tab1-tab"><strong>The Fundamentals Of Investing</strong></a></li>
app/Modules/Blog/Views/NewsAndUpdates/The_Roadmap_To_The_Future_Of_Finance.php:115:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php echo site_url('/Blog/Investing/Tips-For-Effective-Investment-Portfolio-Management'); ?>" id="tab1-tab"><strong>Tips for Effective Investment Portfolio Management</strong></a></li>
app/Modules/Blog/Views/NewsAndUpdates/The_Roadmap_To_The_Future_Of_Finance.php:667:                                        Learn more about how MyMI Wallet is working to integrate with Plaid in more detail by visiting:<br><a href="<?php echo site_url('/Blog/News-And-Updates/Integrating-With-Plaid'); ?>">MyMI Wallet Blog: Integrating with Plaid</a>
app/Modules/Blog/Views/NewsAndUpdates/The_Roadmap_To_The_Future_Of_Finance.php:688:                                $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/NewsAndUpdates/The_Roadmap_To_The_Future_Of_Finance.php:690:                                $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/NewsAndUpdates/The_Roadmap_To_The_Future_Of_Finance.php:694:                            $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/NewsAndUpdates/The_Roadmap_To_The_Future_Of_Finance.php:709:                                            <a class="btn btn-primary" href="' . site_url('/Dashboard') . '">Get Started!</a> 
app/Modules/Blog/Views/Earnings/update_earnings_form.php:2:<form action="<?= site_url('earnings/update') ?>" method="post">
app/Modules/Blog/Views/Earnings/TSLA/10192023.php:16:        $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/Earnings/TSLA/10192023.php:18:        $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/Earnings/TSLA/10192023.php:22:    $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/Earnings/TSLA/10192023.php:177:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php // echo site_url('/Blog/Investing/The-Fundamentals-Of-Investing'); ?>" id="tab1-tab"><strong>The Fundamentals Of Investing</strong></a></li>
app/Modules/Blog/Views/Earnings/TSLA/10192023.php:178:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php // echo site_url('/Blog/Investing/Tips-For-Effective-Investment-Portfolio-Management'); ?>" id="tab1-tab"><strong>Tips for Effective Investment Portfolio Management</strong></a></li>
app/Modules/Blog/Views/Earnings/TSLA/10192023.php:179:                                    <li class="nav-item"><a class="nav-link pl-3 pr-0" href="<?php // echo site_url('/Blog/IRS/IRS-Expanded-Home-Energy-Tax-Credits'); ?>" id="tab1-tab"><strong>IRS Announces Expanded Home Energy Tax Credits</strong></a></li>
app/Modules/Blog/Views/Earnings/TSLA/10192023.php:431:                                $btnURL         = site_url('/Free/register'); 
app/Modules/Blog/Views/Earnings/TSLA/10192023.php:433:                                $btnURL         = site_url('/Beta/register'); 
app/Modules/Blog/Views/Earnings/TSLA/10192023.php:437:                            $btnURL             = site_url('/Dashboard'); 
app/Modules/Blog/Views/Earnings/TSLA/10192023.php:453:                                            <a class="btn btn-primary" href="' . site_url('/Dashboard') . '">Get Started!</a> 
app/Modules/Blog/Views/Earnings/2024/10/21.php:339:                <a href="<?php echo site_url('/Blog/subscribe'); ?>" class="btn btn-primary">Subscribe for Updates</a>
app/Modules/Blog/Views/Earnings/2024/10/28.php:339:                <a href="<?php echo site_url('/Blog/subscribe'); ?>" class="btn btn-primary">Subscribe for Updates</a>
app/Modules/Blog/Views/Earnings/2024/10/14.php:340:                <a href="<?php echo site_url('/Blog/subscribe'); ?>" class="btn btn-primary">Subscribe for Updates</a>
app/Sitemap/Providers/RouteIntrospector.php:60:        return site_url($pattern);
app/Views/Auth/_footer.php:7:<script src="<?= base_url('assets/vendor/jquery/jquery-3.6.0.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/Auth/_footer.php:8:<script src="<?= base_url('assets/vendor/bootstrap5/bootstrap.bundle.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/Auth/register_form.php:19:    <img class="mb-3" src="<?php echo base_url('assets/images/MyMI-Wallet-Logo-Black.png'); ?>" srcset="<?php echo base_url('assets/images/MyMI-Wallet-Logo-Black.png'); ?>" alt="MyMI Wallet - Investment Accounting/Analytical Software & Crypto Asset Marketplace/Exchange">
app/Views/Auth/register/The-Mission.php:10:    background-image: url(<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>);
app/Views/Auth/register/Jailin.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/MattCardon.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/Ken.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/YouTube.php:10:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/Auth/register/Solana.php:9:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/Auth/register/Free.php:10:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/Auth/register/Twitter.php:10:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/Auth/register/LinkedIn.php:10:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/Auth/register/MyMI.php:10:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/Auth/register/Discord.php:10:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/Auth/register/AnneAlicia.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/X.php:10:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/Auth/register/TBI.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/Jasmine.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/Earl.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/Facebook.php:10:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/Auth/register/Jeremy.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/ITT.php:10:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/Auth/register/Alicia.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/Kristie.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/KenFlores.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/Manee.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/TikTok.php:10:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/Auth/register/Apex.php:10:    /* background-image: url('<?php echo base_url("assets/images/Partners/TBI-Solutions-Background1.png"); ?>');
app/Views/Auth/register/Dubose.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/Deon.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/MattHill.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/Michael.php:9:        background-image: url('<?php echo base_url('assets/images/Partners/TBI-Solutions-Background1.png'); ?>');
app/Views/Auth/register/Monetized-Creators.php:11:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/Auth/layout.php:49:<script src="<?= base_url('assets/vendor/bootstrap5/bootstrap.bundle.min.js'); ?>" <?= $nonce['script'] ?? '' ?> defer></script>
app/Views/Auth/layout.php:51:<link rel="stylesheet" href="<?= base_url('assets/vendor/aos/aos.css'); ?>">
app/Views/Auth/layout.php:52:<script src="<?= base_url('assets/vendor/aos/aos.js'); ?>" defer></script>
app/Views/Auth/layout.php:56:<script src="<?= base_url('assets/js/login-init.js'); ?>" <?= $nonce['script'] ?? '' ?> defer></script>
app/Views/themes/public/home.php:57:                <img src="' . base_url('assets/images/Company-Logos/TradingView-white-short-logo.png') . '" class="bi bi-facebook" style="height: 100%; object-fit: cover;"/>
app/Views/themes/public/home.php:89:    background: url(<?= base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed;
app/Views/themes/public/resources/Getting-Started/Projects.php:9:        background-image: url('<?php echo base_url('assets/images/MyMI-Wallet-Projects-Background.jpeg'); ?>');
app/Views/themes/public/resources/Getting-Started/default.orig.php:10:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/themes/public/resources/Getting-Started/default.php:12:        background-image: url('<?= base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/themes/public/home copy.php:18:        background: url(<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed; 
app/Views/themes/public/economicCalendar.php:83:                                <img src="<?= base_url($logoPath); ?>" alt="<?= $symbol; ?>" class="img-fluid" style="width: 100px;">
app/Views/themes/public/memberships.php:3:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/themes/public/gettingStarted.php:9:    background-image: url('<?= base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/themes/public/layouts/header_min.php:19:    <link rel="shortcut icon" href="<?= base_url('favicon.ico'); ?>" type="image/x-icon">
app/Views/themes/public/layouts/header_min.php:22:    <link rel="stylesheet" href="<?= base_url('assets/vendor/bootstrap5/bootstrap.min.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/public/layouts/header_min.php:23:    <link rel="stylesheet" href="<?= base_url('assets/vendor/fontawesome/css/all.min.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/public/layouts/header_min.php:24:    <link rel="stylesheet" href="<?= base_url('assets/css/dashlite.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/public/layouts/header_min.php:25:    <link rel="stylesheet" href="<?= base_url('assets/css/dashlite3.css?ver=3.0.2'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/public/layouts/header_min.php:26:    <link rel="stylesheet" href="<?= base_url('assets/css/bootstrap-select.min.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/public/layouts/header_min.php:27:    <link rel="stylesheet" href="<?= base_url('assets/css/responsive-overrides.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/public/layouts/css-links.php:2:<link rel="stylesheet" href="<?= base_url('assets/vendor/bootstrap5/bootstrap.min.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/public/layouts/css-links.php:3:<link rel="stylesheet" href="<?= base_url('assets/vendor/bootstrap-select/bootstrap-select.min.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/public/layouts/css-links.php:4:<link rel="stylesheet" href="<?= base_url('assets/css/dashlite.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/public/layouts/css-links.php:5:<link rel="stylesheet" href="<?= base_url('assets/css/dashlite3.css?ver=3.0.2'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/public/layouts/css-links.php:6:<link rel="stylesheet" href="<?= base_url('assets/vendor/fontawesome/css/all.min.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/public/layouts/css-links.php:7:<link rel="stylesheet" href="<?= base_url('assets/vendor/aos/aos.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/public/layouts/css-links.php:8:<link rel="stylesheet" href="<?= base_url('assets/css/responsive-overrides.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/public/layouts/css-links.php:9:<link rel="stylesheet" href="<?= base_url('assets/vendor/datatables/1.11.5/css/jquery.dataTables.min.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/public/layouts/css-links.php:11:<link rel="stylesheet" href="<?= base_url('assets/css/inline-fixes.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/public/layouts/metadata-information.php:5:$defaultImage = base_url('/assets/images/Company/MyMI-Wallet-The-Future-Of-Finance-SQ.png');
app/Views/themes/public/layouts/_sitenav.php:37:                    <img class="logo-img logo-dark img-fluid w-100 d-none d-md-block ml-0" id="main_logo" src="<?php echo base_url('assets/images/Millennial-Investments.png'); ?>" srcset="<?php echo base_url('assets/images/Millennial-Investments.png'); ?>" alt="MyMI Wallet - Investment Accounting/Analytical Software & Crypto Asset Marketplace/Exchange">
app/Views/themes/public/layouts/_sitenav.php:44:                    <img class="logo-img logo-dark img-fluid" id="mobile_logo" src="<?php echo base_url('assets/images/MyMI-Wallet.png'); ?>" srcset="<?php echo base_url('assets/images/MyMI-Wallet.png'); ?>" alt="MyMI Wallet - Investment Accounting/Analytical Software & Crypto Asset Marketplace/Exchange">
app/Views/themes/public/layouts/_sitenav-new.php:93:                        <img class="logo-img logo-dark img-fluid w-100 d-none d-md-block ml-0" id="main_logo" src="<?php echo base_url('assets/images/MyMI-Wallet-Logo-White.png'); ?>" srcset="<?php echo base_url('assets/images/MyMI-Wallet-Logo-White.png'); ?>" alt="MyMI Wallet - Investment Accounting/Analytical Software & Crypto Asset Marketplace/Exchange">
app/Views/themes/public/layouts/_sitenav-new.php:100:                        <img class="logo-img logo-dark img-fluid" id="mobile_logo" src="<?php echo base_url('assets/images/MyMI-Wallet.png'); ?>" srcset="<?php echo base_url('assets/images/MyMI-Wallet.png'); ?>" alt="MyMI Wallet - Investment Accounting/Analytical Software & Crypto Asset Marketplace/Exchange">
app/Views/themes/public/layouts/_sitenav-new.php:179:                        <img class="logo-img logo-dark img-fluid w-100 d-none d-md-block ml-0" id="main_logo" src="<?php echo base_url('assets/images/MyMI-Wallet-Logo-White.png'); ?>" srcset="<?php echo base_url('assets/images/MyMI-Wallet-Logo-White.png'); ?>" alt="MyMI Wallet - Investment Accounting/Analytical Software & Crypto Asset Marketplace/Exchange">
app/Views/themes/public/layouts/_sitenav-new.php:186:                        <img class="logo-img logo-dark img-fluid" id="mobile_logo" src="<?php echo base_url('assets/images/MyMI-Wallet.png'); ?>" srcset="<?php echo base_url('assets/images/MyMI-Wallet.png'); ?>" alt="MyMI Wallet - Investment Accounting/Analytical Software & Crypto Asset Marketplace/Exchange">
app/Views/themes/public/layouts/header.php:29:    <link rel="shortcut icon" href="<?= base_url('favicon.ico'); ?>" type="image/x-icon">
app/Views/themes/public/layouts/js-links.php:14:<script src="<?= base_url('assets/vendor/jquery/jquery-3.6.0.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:15:<script src="<?= base_url('assets/vendor/bootstrap5/bootstrap.bundle.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:18:<script src="<?= base_url('assets/vendor/bootstrap-select/bootstrap-select.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:21:<script src="<?= base_url('assets/vendor/datatables/1.11.5/js/jquery.dataTables.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:22:<script src="<?= base_url('assets/vendor/datatables/1.11.5/js/dataTables.bootstrap5.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:25:<script src="<?= base_url('assets/vendor/chart.js/2.1.2/Chart.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:28:<script src="<?= base_url('assets/js/bundle.js?ver=3.0.3'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:31:<script src="<?= base_url('assets/vendor/aos/aos.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:36:<script defer src="<?= base_url('assets/js/navbar-search.js') . '?v=' . $navbarSearchV; ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:44:<script src="<?= base_url('assets/vendor/jquery-validation/jquery.validate.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:48:<script src="<?= base_url('assets/vendor/jquery-knob/jquery.knob.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:52:<script src="<?= base_url('assets/vendor/select2/js/select2.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:56:<script src="<?= base_url('assets/vendor/flatpickr/js/flatpickr.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:60:<script src="<?= base_url('assets/vendor/summernote/js/summernote.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:64:<script src="<?= base_url('assets/vendor/datatables/1.13.6/js/jquery.dataTables.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:65:<script src="<?= base_url('assets/vendor/datatables/1.13.6/js/dataTables.bootstrap5.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/js-links.php:69:<script src="<?= base_url('assets/vendor/popper/1.12.3/popper.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/public/layouts/header-information.php:5:<link rel="shortcut icon" href="<?= base_url('favicon.ico'); ?>" type="image/x-icon">
app/Views/themes/public/layouts/metadata-information copy.php:17:$defaultImage = base_url('/assets/images/Company/MyMI-Wallet-The-Future-Of-Finance-SQ.png');
app/Views/themes/public/gettingStarted.orig.php:10:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Views/themes/public/corporateEarnings.php:89:                            <img src="<?= base_url($logoPath); ?>" alt="<?= $symbol; ?>" class="img-fluid" style="width: 100px;">
app/Views/themes/dashboard/partials/bitcoin-scripts.php:2:<script src="<?= base_url('assets/js/BitcoinJS-lib/bitcoin.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/partials/bitcoin-scripts.php:3:<script src="<?= base_url('assets/js/crypto/bitcoin-adapter.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/partials/bitcoin-scripts.php:4:<script src="<?= base_url('assets/js/crypto/btc-send-flow.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/partials/custom-js/modals.php:21:                    <li class="p-1"><a class="btn btn-outline-default" href="<?= base_url('/Exchange/Solana/Wallet/MetaMask') ?>">MetaMask</a></li>
app/Views/themes/dashboard/partials/custom-js/modals.php:22:                    <li class="p-1"><a class="btn btn-outline-default" href="<?= base_url('/Exchange/Solana/Wallet/Phantom') ?>">Phantom</a></li>
app/Views/themes/dashboard/partials/custom-js/modals.php:23:                    <li class="p-1"><a class="btn btn-outline-default" href="<?= base_url('/Exchange/Solana/Wallet/Solflare') ?>">Solflare</a></li>
app/Views/themes/dashboard/partials/custom-js/modals.php:24:                    <li class="p-1"><a class="btn btn-outline-default" href="<?= base_url('/Exchange/Solana/Wallet/TrustWallet') ?>">Trust Wallet</a></li>
app/Views/themes/dashboard/partials/custom-js/Digibyte-js.php:3:<script src="<?= base_url('assets/js/BitcoinJS-lib/bitcoin.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/partials/custom-js/Digibyte-js.php:4:<script src="<?= base_url('assets/js/crypto/digibyte-adapter.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/partials/custom-js/Digibyte-js.php:5:<script src="<?= base_url('assets/js/crypto/dgb-send-flow.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/partials/custom-js/datatables.php:3:<script src="<?= base_url('assets/vendor/datatables/1.11.5/js/jquery.dataTables.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/partials/custom-js/datatables.php:4:<script src="<?= base_url('assets/vendor/datatables/1.11.5/js/dataTables.bootstrap5.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/partials/custom-js/datepicker.php:4:<script src="<?= base_url('assets/vendor/datepicker/jquery-ui.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/partials/custom-js/datepicker.php:5:<script src="<?= base_url('assets/vendor/daterangepicker/moment.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/partials/custom-js/datepicker.php:6:<script src="<?= base_url('assets/vendor/daterangepicker/daterangepicker.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/sidebar-09092024.php:56:				// 	<img class="logo-light logo-img responsive-logo" src="' . base_url('assets/images/Millennial-Investments-179x54.png') . '" srcset="' . base_url('assets/images/Millennial-Investments-179x54.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar-09092024.php:57:				// 	<img class="logo-dark logo-img responsive-logo" style="" src="' . base_url('assets/images/Millennial-Investments-179x54.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar-09092024.php:61:				// 	<img class="logo-light logo-img responsive-logo w-60 my-2 d-lg-block" src="' . base_url('assets/images/Millennial-Investments.png') . '" srcset="' . base_url('assets/images/Millennial-Investments.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar-09092024.php:62:				// 	<img class="logo-dark logo-img responsive-logo w-60 my-2 d-lg-block" src="' . base_url('assets/images/Millennial-Investments.png') . '" srcset="' . base_url('assets/images/Millennial-Investments-213x70.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar-09092024.php:66:                <img class="logo-light logo-img responsive-logo w-90 h-90 d-lg-block" src="' . base_url('assets/images/Company/MyMI-Wallet-White.png') . '" srcset="' . base_url('assets/images/Company/MyMI-Wallet-White.png') . '" alt="logo"/>
app/Views/themes/dashboard/layouts/sidebar-09092024.php:67:			    <img class="logo-dark logo-img responsive-logo w-80 my-2 d-lg-block" src="' . base_url('assets/images/Company/MyMI-Wallet-White.png') . '" srcset="' . base_url('assets/images/Company/MyMI-Wallet-White.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar-05172024.php:56:				// 	<img class="logo-light logo-img responsive-logo" src="' . base_url('assets/images/Millennial-Investments-179x54.png') . '" srcset="' . base_url('assets/images/Millennial-Investments-179x54.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar-05172024.php:57:				// 	<img class="logo-dark logo-img responsive-logo" style="" src="' . base_url('assets/images/Millennial-Investments-179x54.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar-05172024.php:61:				// 	<img class="logo-light logo-img responsive-logo w-60 my-2 d-lg-block" src="' . base_url('assets/images/Millennial-Investments.png') . '" srcset="' . base_url('assets/images/Millennial-Investments.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar-05172024.php:62:				// 	<img class="logo-dark logo-img responsive-logo w-60 my-2 d-lg-block" src="' . base_url('assets/images/Millennial-Investments.png') . '" srcset="' . base_url('assets/images/Millennial-Investments-213x70.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar-05172024.php:66:                <img class="logo-light logo-img responsive-logo w-90 h-90 d-lg-block" src="' . base_url('assets/images/Millennial-Investments.png') . '" srcset="' . base_url('assets/images/Millennial-Investments.png') . '" alt="logo"/>
app/Views/themes/dashboard/layouts/sidebar-05172024.php:67:			    <img class="logo-dark logo-img responsive-logo w-80 my-2 d-lg-block" src="' . base_url('assets/images/Millennial-Investments.png') . '" srcset="' . base_url('assets/images/Millennial-Investments-213x70.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar-09012025.php:60:				// 	<img class="logo-light logo-img responsive-logo" src="' . base_url('assets/images/Millennial-Investments-179x54.png') . '" srcset="' . base_url('assets/images/Millennial-Investments-179x54.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar-09012025.php:61:				// 	<img class="logo-dark logo-img responsive-logo" style="" src="' . base_url('assets/images/Millennial-Investments-179x54.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar-09012025.php:65:				// 	<img class="logo-light logo-img responsive-logo w-60 my-2 d-lg-block" src="' . base_url('assets/images/Millennial-Investments.png') . '" srcset="' . base_url('assets/images/Millennial-Investments.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar-09012025.php:66:				// 	<img class="logo-dark logo-img responsive-logo w-60 my-2 d-lg-block" src="' . base_url('assets/images/Millennial-Investments.png') . '" srcset="' . base_url('assets/images/Millennial-Investments-213x70.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar-09012025.php:70:                <img class="logo-light logo-img responsive-logo w-90 h-90 d-lg-block" src="' . base_url('assets/images/Company/MyMI-Wallet-White.png') . '" srcset="' . base_url('assets/images/Company/MyMI-Wallet-White.png') . '" alt="logo"/>
app/Views/themes/dashboard/layouts/sidebar-09012025.php:71:			    <img class="logo-dark logo-img responsive-logo w-80 my-2 d-lg-block" src="' . base_url('assets/images/Company/MyMI-Wallet-White.png') . '" srcset="' . base_url('assets/images/Company/MyMI-Wallet-White.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/css-links.php:1:<link rel="stylesheet" href="<?= base_url('assets/vendor/bootstrap5/bootstrap.min.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/dashboard/layouts/css-links.php:2:<link rel="stylesheet" href="<?= base_url('assets/vendor/datatables/1.11.5/css/jquery.dataTables.min.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/dashboard/layouts/css-links.php:3:<link rel="stylesheet" href="<?= base_url('assets/css/dashlite.css') . '?v=' . (is_file(FCPATH.'assets/css/dashlite.css') ? filemtime(FCPATH.'assets/css/dashlite.css') : '1'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/dashboard/layouts/css-links.php:4:<link id="skin-default" rel="stylesheet" href="<?= base_url('assets/css/theme.css') . '?v=' . (is_file(FCPATH.'assets/css/theme.css') ? filemtime(FCPATH.'assets/css/theme.css') : '1'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/dashboard/layouts/css-links.php:5:<link rel="stylesheet" href="<?= base_url('assets/css/dashlite-new.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/dashboard/layouts/css-links.php:6:<link rel="stylesheet" href="<?= base_url('assets/css/website.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/dashboard/layouts/css-links.php:7:<link rel="stylesheet" href="<?= base_url('assets/css/libs/bootstrap-icons.css') . '?v=' . (is_file(FCPATH.'assets/css/libs/bootstrap-icons.css') ? filemtime(FCPATH.'assets/css/libs/bootstrap-icons.css') : '1'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/dashboard/layouts/css-links.php:8:<link rel="stylesheet" href="<?= base_url('assets/css/responsive-overrides.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/dashboard/layouts/css-links.php:9:<link rel="shortcut icon" href="<?= base_url('dev/public/favicon.ico') ?>" type="image/x-icon">
app/Views/themes/dashboard/layouts/css-links.php:10:<link rel="stylesheet" href="<?= base_url('assets/css/inline-fixes.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Views/themes/dashboard/layouts/js-links_old.php:17:<!-- <script <?= $nonce['script'] ?? '' ?>>window.jQuery || document.write('<script src="<?php echo base_url(); ?>jquery-1.7.2.min.js"><\/script>');</script> -->
app/Views/themes/dashboard/layouts/js-links_old.php:20:<script src="<?php echo base_url('/assets/js/bundle.js?ver=3.1.0'); ?>"></script>
app/Views/themes/dashboard/layouts/js-links_old.php:21:<script src="<?php echo base_url('/assets/js/scripts.js?ver=3.1.0'); ?>"></script>
app/Views/themes/dashboard/layouts/js-links_old.php:22:<script src="<?php echo base_url('/assets/js/charts/gd-invest.js?ver=3.1.0'); ?>"></script>
app/Views/themes/dashboard/layouts/footer.php:123:                <div class="col-lg-2 col-md-6 mt-1"><img class="footer-brand-logo w-100 mt-2 mb-1" src="<?php echo base_url($siteSettings->companyLogo); ?>" alt="<?php echo $siteSettings->companyMetaTitle; ?>">
app/Views/themes/dashboard/layouts/metadata-information.php:34:$defaultImage = base_url('/assets/images/Company/MyMI-Wallet-White.png');
app/Views/themes/dashboard/layouts/custom-js copy.php:261:    fetch('<?= base_url('/Exchange/Solana/createSolanaWallet') ?>', {
app/Views/themes/dashboard/layouts/custom-js copy.php:320:    fetch('<?= base_url('/Exchange/Solana/Import/Wallet') ?>', {
app/Views/themes/dashboard/layouts/_sitenav.php:35:                    <img class="logo-light logo-img" src="<?php echo base_url('assets/images/MyMI-Wallet.png'); ?>" srcset="<?php echo base_url('assets/images/MyMI-Wallet.png'); ?> 2x" alt="logo">
app/Views/themes/dashboard/layouts/_sitenav.php:36:                    <img class="logo-dark logo-img" src="<?php echo base_url('assets/images/MyMI-Wallet.png'); ?>" srcset="<?php echo base_url('assets/images/MyMI-Wallet.png'); ?> 2x" alt="logo-dark">
app/Views/themes/dashboard/layouts/_sitenav.php:155:                                <img class="icon" src="<?php echo base_url('assets/images/flags/english-sq.png'); ?>" alt="">
app/Views/themes/dashboard/layouts/_sitenav.php:161:                                    <img src="<?php echo base_url('assets/images/flags/english.png'); ?>" alt="" class="language-flag">
app/Views/themes/dashboard/layouts/_sitenav.php:165:                                    <img src="<?php echo base_url('assets/images/flags/spanish.png'); ?>" alt="" class="language-flag">
app/Views/themes/dashboard/layouts/_sitenav.php:169:                                    <img src="<?php echo base_url('assets/images/flags/french.png'); ?>" alt="" class="language-flag">
app/Views/themes/dashboard/layouts/_sitenav.php:173:                                    <img src="<?php echo base_url('assets/images/flags/turkey.png'); ?>" alt="" class="language-flag">
app/Views/themes/dashboard/layouts/sidebar.php:57:				// 	<img class="logo-light logo-img responsive-logo" src="' . base_url('assets/images/Millennial-Investments-179x54.png') . '" srcset="' . base_url('assets/images/Millennial-Investments-179x54.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar.php:58:				// 	<img class="logo-dark logo-img responsive-logo" style="" src="' . base_url('assets/images/Millennial-Investments-179x54.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar.php:62:				// 	<img class="logo-light logo-img responsive-logo w-60 my-2 d-lg-block" src="' . base_url('assets/images/Millennial-Investments.png') . '" srcset="' . base_url('assets/images/Millennial-Investments.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar.php:63:				// 	<img class="logo-dark logo-img responsive-logo w-60 my-2 d-lg-block" src="' . base_url('assets/images/Millennial-Investments.png') . '" srcset="' . base_url('assets/images/Millennial-Investments-213x70.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/sidebar.php:67:                <img class="logo-light logo-img responsive-logo w-90 h-90 d-lg-block" src="' . base_url('assets/images/Company/MyMI-Wallet-White.png') . '" srcset="' . base_url('assets/images/Company/MyMI-Wallet-White.png') . '" alt="logo"/>
app/Views/themes/dashboard/layouts/sidebar.php:68:			    <img class="logo-dark logo-img responsive-logo w-80 my-2 d-lg-block" src="' . base_url('assets/images/Company/MyMI-Wallet-White.png') . '" srcset="' . base_url('assets/images/Company/MyMI-Wallet-White.png') . '" alt="logo" />
app/Views/themes/dashboard/layouts/js-links.php:26:<script src="<?= base_url('assets/js/vendor/jquery-3.6.0.min.js') ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/js-links.php:38:?><script defer src="<?= base_url('assets/js/vendor/bootstrap.bundle.min.js') ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/js-links.php:39:<script defer src="<?= base_url('assets/js/vendor/bootstrap-select.min.js') ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/js-links.php:41:  <script defer src="<?= base_url('assets/js/vendor/summernote.min.js') ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/js-links.php:43:<script defer src="<?= base_url('assets/js/vendor/select2.min.js') ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/js-links.php:48:<script defer src="<?= base_url('assets/js/vendor/jquery.validate.min.js') ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/js-links.php:49:<script defer src="<?= base_url('assets/js/vendor/jquery.knob.min.js') ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/js-links.php:50:<script defer src="<?= base_url('assets/js/vendor/flatpickr.min.js') ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/js-links.php:55:<script src="<?= base_url('assets/js/BitcoinJS-lib/bitcoin.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/js-links.php:56:<script src="<?= base_url('assets/js/crypto/bitcoin-adapter.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/js-links.php:57:<script src="<?= base_url('assets/js/crypto/btc-send-flow.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/js-links.php:62:<script defer src="<?= base_url('assets/js/bundle.js?ver=3.0.3'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/js-links.php:63:<script defer src="<?= base_url('assets/js/scripts.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/js-links.php:69:<script defer src="<?= base_url('assets/js/navbar-search.js') . '?v=' . $navbarSearchV; ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/js-links.php:75:  <script defer src="<?= base_url('assets/js/vendor/chart.min.js') ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Views/themes/dashboard/layouts/js-links.php:83:<script defer src="<?= base_url('assets/js/charts/gd-invest.js') . '?v=' . $gdInvestV; ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Controllers/BaseController.php:16:    /** Make base_url() available for self-hosted assets */
app/Services/MetaService.php:19:        $this->defaultImage       = base_url('/assets/images/Company/MyMI-Wallet-The-Future-Of-Finance-SQ.png');
app/Services/MetaService.php:101:            'page_url'         => base_url($slug),
app/Services/MetaService.php:120:            'page_url'         => $row['page_url']         ?? base_url($row['page_internal_url'] ?? ''),
app/Services/MetaService.php:150:            'page_url'         => base_url($norm),
app/Services/MetaService.php:194:                'page_url'          => base_url($slug),
app/Services/ReferralService.php:76:        $baseReferralURL = base_url('/referral');
app/Services/ReferralService.php:91:        $basicReferralLink = base_url("/referral/$referrerCode/basic");
app/Services/ReferralService.php:92:        $premiumReferralLink = base_url("/referral/$referrerCode/premium");
app/Services/ReferralService.php:93:        $goldReferralLink = base_url("/referral/$referrerCode/gold");
app/Services/ReferralService.php:349:            "Join MyMI Wallet today and take control of your finances! Track your spending, manage your investments, and grow your wealth. Sign up now: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:350:            "Ready to simplify your finances? With MyMI Wallet, you can budget smarter and invest better. Start your journey today: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:351:            "Donâ€™t miss out! Manage your income, expenses, and investments all in one place with MyMI Wallet. Start now: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:354:            "Looking to track your investments in real-time? MyMI Wallet offers the best tools to monitor and optimize your portfolio. Get started today: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:355:            "Manage your assets with MyMI Wallet's robust investment tracking tools. Whether it's crypto or stocks, we've got you covered. Sign up here: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:356:            "Take control of your investment portfolio and grow your assets faster with MyMI Walletâ€™s advanced investment tools. Join now: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:359:            "Want to achieve your financial goals? MyMI Walletâ€™s budgeting tools make it easy to plan your expenses and save more. Join now: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:360:            "Budget smarter with MyMI Wallet! Set your savings goals, track spending, and stay on top of your financial game. Start today: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:361:            "MyMI Wallet's budgeting tools help you stay in control of your money and achieve your financial dreams. Join today: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:364:            "Automate your financial reports and analysis with MyMI Wallet! Get insights into your spending, income, and investments. Sign up now: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:365:            "With MyMI Wallet's automated financial reports, you can easily track and optimize your budget and investment performance. Start here: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:366:            "Get automatic financial insights with MyMI Wallet. From budgeting to investing, we make money management easy. Sign up today: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:369:            "Earn rewards with MyMI Wallet! Refer friends and get rewarded while helping them manage their finances. Start sharing today: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:370:            "Get more from MyMI Wallet by referring friends! Earn commissions and grow your financial community. Sign up now: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:371:            "Love MyMI Wallet? Share it with friends and earn rewards through our referral program! Join today: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:374:            "Stay on track with your financial goals using MyMI Wallet. Whether saving or investing, we help you stay focused. Join now: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:375:            "Achieve your financial goals with MyMI Wallet! Use our goal tracking tools to save, invest, and succeed. Sign up today: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:378:            "Looking for the best way to manage crypto investments? MyMI Wallet offers powerful tools to track your crypto assets. Join now: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:379:            "Crypto and stocks in one place! MyMI Wallet allows you to manage all your investments with ease. Sign up here: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:380:            "Track your crypto assets and more with MyMI Wallet. Start optimizing your investments today: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:383:            "Take control of your financial future with MyMI Wallet! Learn more about budgeting, investing, and managing your money. Start now: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:384:            "Learn to manage your finances like a pro with MyMI Walletâ€™s educational tools. Budget, save, and invest smarter. Join today: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:387:            "Manage your finances on the go with MyMI Wallet! Our mobile-friendly platform allows you to track your budget and investments anywhere. Sign up now: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:388:            "Access MyMI Wallet from anywhere! Whether on your phone or computer, manage your money with ease. Join here: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:391:            "Your security matters! MyMI Wallet provides top-notch security features to keep your financial data safe. Sign up today: " . base_url('/referral/' . $cuID),
app/Services/ReferralService.php:392:            "Keep your finances secure with MyMI Walletâ€™s advanced encryption and privacy protection. Join today: " . base_url('/referral/' . $cuID),
app/Helpers/asset_helper.php:39:            $out .= '<link rel="stylesheet" href="'. base_url('assets/build/'.$css) .'">'.PHP_EOL;
app/Helpers/asset_helper.php:41:        $out .= '<script type="module" src="'. base_url('assets/build/'.$manifest[$key]['file']) . '"'. $nonceAttr .'></script>';
app/Helpers/url_safe_helper.php:14:        return base_url($uri ?? '', $protocol);
app/Libraries/MyMIMarketing-06162025.php:2182:            return base_url("uploads/voiceovers/' . basename($filePath)");
app/Libraries/MyMIMarketing-06162025.php:3210:                'image' => base_url('/assets/images/Company/MyMI-Wallet-White.png'),
app/Libraries/MyMIMarketing-06162025.php:4207:                'voiceover' => base_url('uploads/voiceover.mp3')
app/Libraries/MyMIMarketing-06162025.php:4466:        // return base_url("writable/uploads/{$filename}");
app/Libraries/MyMIAdvisor.php:277:        return base_url("writable/uploads/voiceovers/{$filename}.mp3");
app/Libraries/MyMIAdvisor.php:335:        return base_url('writable/files/capcut_templates/' . basename($filePath));
app/Libraries/MyMIAdvisor.php:388:        return base_url("writable/files/" . basename($zipPath));
app/Libraries/MyMIMarketing-05122025.php:1748:            return base_url('uploads/voiceovers/' . basename($filePath));
app/Libraries/MyMIMarketing-05122025.php:2473:                'image' => base_url('/assets/images/Company/MyMI-Wallet-White.png'),
app/Libraries/MyMIMarketing-05122025.php:3259:                'voiceover' => base_url('uploads/voiceover.mp3')
app/Libraries/MyMIMarketing-05122025.php:3435:        return base_url('uploads/voiceover.mp3');
app/Libraries/MyMIMarketing.php:632:            'background_chart' => base_url('static/sample_chart.jpg'), // Replace with generated chart
app/Libraries/MyMIMarketing.php:639:        return base_url('writable/capcut_templates/' . basename($filename));
app/Libraries/MyMIMarketing.php:2413:            return base_url("uploads/voiceovers/' . basename($filePath)");
app/Libraries/MyMIMarketing.php:4090:                'image' => base_url('/assets/images/Company/MyMI-Wallet-White.png'),
app/Libraries/MyMIMarketing.php:5148:                'voiceover' => base_url('uploads/voiceover.mp3')
app/Libraries/MyMIMarketing.php:5418:        // return base_url("writable/uploads/{$filename}");
app/Libraries/test.txt:2464:            return redirect()->to(base_url('Management/Marketing/Schedule'))->with('success', 'New schedule added successfully.');
app/Libraries/test.txt:2938:            $fileUrl = base_url('uploads/' . basename($outputFile));
app/Libraries/test.txt:3996:                        $filePaths[] = base_url('assets/images/Marketing/Ideas/' . $newName);
app/Libraries/test.txt:5959:            return base_url('uploads/voiceovers/' . basename($filePath));
app/Libraries/test.txt:6677:                'image' => base_url('/assets/images/Company/MyMI-Wallet-White.png'),
app/Libraries/test.txt:7441:                'voiceover' => base_url('uploads/voiceover.mp3')
app/Libraries/test.txt:7617:        return base_url('uploads/voiceover.mp3');
app/Libraries/test.txt:9513:<script src="<?= base_url('assets/vendor/chart.js/2.1.2/Chart.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Libraries/test.txt:9686:<script src="<?= base_url('assets/vendor/chart.js/2.1.2/Chart.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Modules/Advertise/Controllers/Features.php:143:                'page_sitemap_url' => base_url('/sitemap.xml'),
app/Modules/Advertise/Controllers/Features.php:144:                'page_image' => base_url('/assets/images/default-seo-image.png'),
app/Modules/chatgpt.txt:1:<?php namespace App\Modules\Management\Controllers;use CodeIgniter\Controller;use Config\Services;use App\Config\{APIs,Auth,SiteSettings,SocialMedia};use App\Controllers\UserController;use App\Libraries\{BaseLoader,HtmlFormatter,MyMIAnalytics,MyMIAlerts,MyMIBudget,MyMIDashboard,MyMIExchange,MyMIMarketing,MyMIUser};use App\Models\{AlertsModel,AnnouncementModel,InvestmentModel,ManagementModel,MarketingModel,MyMIGoldModel,SolanaModel,UserModel};use App\Services\{DashboardService,GoalTrackingService,MarketingService,SolanaService,UserService};use CodeIgniter\API\ResponseTrait;use GuzzleHttp\Client;use GuzzleHttp\Exception\RequestException;use voku\helper\HtmlDomParser;class MarketingController extends UserController{use ResponseTrait;use BaseLoader;protected $API;protected $auth;protected $cuID;protected $data;protected $debug;protected $helpers=['auth','form','url'];protected $logger;protected $request;protected $session;protected $uri;protected $siteSettings;protected $NewsEmail;protected $HtmlFormatter;protected $MyMIAnalytics;protected $MyMIAlerts;protected $MyMIBudget;protected $MyMIDashboard;protected $MyMIExchange;protected $MyMIMarketing;protected $MyMIUser;protected $dashboardService;protected $goalTrackingService;protected $marketingService;protected $solanaService;protected $userService;protected $alertsModel;protected $investmentModel;protected $marketingModel;protected $userModel;protected $userAccount;protected $userDashboard;protected $getBlogPosts;protected $departmentTasks;protected $marketing;protected $reporting;public function __construct(){$this->API=config('APIs');$this->auth=service('authentication');$this->logger=service('logger');$this->NewsEmail=config('NewsEmailServer');$this->request=service('request');$this->session=Services::session();$this->siteSettings=config('SiteSettings');$this->debug=$this->siteSettings->debug;$this->uri=$this->request->getUri();$this->alertsModel=new AlertsModel();$this->investmentModel=new InvestmentModel();$this->marketingModel=new MarketingModel();$this->userDashboard=$this->getMyMIDashboard()->dashboardInfo($this->cuID);$this->departmentTasks=$this->getMyMIAnalytics()->get_department_tasks($this->uri->getSegment(2),['Page SEO Edit']);$this->getBlogPosts=$this->getMyMIMarketing()->getBlogPosts();$this->cuID=$this->session->get('user_id')?? $this->auth->id();if(!$this->cuID){log_message('error','Investments ControllerFailed to retrieve valid User ID in MyMIInvestments');throw new \RuntimeException('User ID could not be retrieved.');}log_message('debug',"InvestmentsController: cuID initialized as {$this->cuID}");$this->userAccount=$this->getMyMIUser()->getUserInformation($this->cuID);$userBudget=$this->getMyMIBudget()->getUserBudget($this->cuID);log_message('info','DashboardController L72 - $checkingSummary: '.$userBudget['checkingSummary']);$this->data['checkingSummary']=$userBudget['checkingSummary'];}public function commonData(): array{$this->data=$this->data ??[];$userData=$this->getuserService()->commonData();$this->data=array_merge($this->data,$userData);$this->data['siteSettings']=$this->siteSettings;$this->data['beta']=(string)$this->siteSettings->beta;$this->data['uri']=$this->request->getUri();$this->data['date']=$this->siteSettings->date;$this->data['time']=$this->siteSettings->time;$this->data['hostTime']=$this->siteSettings->hostTime;$dashboardInfo=$this->getDashboardService()->getDashboardInfo($this->cuID);$this->data['completedGoals']=$this->getGoalTrackingService()->getCompletedGoals($this->cuID);$this->data['pendingGoals']=$this->getGoalTrackingService()->getPendingGoals($this->cuID);$this->data['promotionalBanners']=$dashboardInfo['promotionalBanners'];$userBudget=$this->getBudgetService()->getUserBudget($this->cuID);$this->data['totalAccountBalance']=$userBudget['totalAccountBalance']?? 0;$this->data['totalAccountBalanceFMT']=$userBudget['totalAccountBalanceFMT']?? '0.00';$userSolanaData=$this->getSolanaService()->getSolanaData($this->cuID);$this->data['cuSolanaDW']=$userSolanaData['userSolanaWallets']['cuSolanaDW']?? null;$this->data['solanaNetworkStatus']=$userSolanaData['solanaNetworkStatus'];$this->data['cuSolanaTotal']=$userSolanaData['userSolanaWallets']['cuSolanaTotal']?? 0;$this->data['cuSolanaValue']=$userSolanaData['userSolanaWallets']['cuSolanaValue']?? 0;$this->data=array_merge($this->data,$userData);if($this->debug===1){}}public function index(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['recentMarketingPosts']=$this->getMyMIMarketing()->getRecentPosts(5);if(empty($this->data['recentMarketingPosts'])){log_message('info','ðŸ“­ No recent posts found. Running fallback generation...');$this->getMyMIMarketing()->generateFromTempScraper(5);$this->data['recentMarketingPosts']=$this->getMyMIMarketing()->getRecentPosts(25);}$this->data['todaysStory']=$this->marketingModel->getTodaysStory();$this->data['generatedSummaries']=$this->marketingModel->getLatestGeneratedSummaries(25);$this->data['marketingBuffer']=$this->marketingModel->getMarketingBuffer();if(empty($this->data['todaysStory'])){log_message('info','ðŸ“… No content generated today. Triggering summary fallback...');$this->getMyMIMarketing()->generateFromTempScraper(5);$this->data['todaysStory']=$this->marketingModel->where('DATE(created_at)',date('Y-m-d'))->orderBy('created_at','DESC')->findAll();}$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\index',$this->data);}public function add($type=null){log_message('debug','MarketingController L183 - add() method called with type: '.(is_null($type)?'null':$type));if(!empty($type)){if($this->request->getMethod()==='POST'){log_message('debug','Handling POST request for type: '.$type);if($type==='Schedule'){log_message('info','Processing Schedule submission');try{$this->marketingModel->addMarketingSchedule($this->request->getPost());log_message('info','Schedule data saved successfully');if($this->request->isAJAX()){return $this->response->setJSON(['success'=>true,'message'=>'Schedule added successfully']);}else{return redirect()->to('/Management/Marketing/Schedule')->with('success','Schedule added successfully');}}catch(\Exception $e){log_message('error','Error saving schedule: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to save schedule.']);}}elseif($type==='Campaign'){log_message('info','Processing Campaign submission');try{$campaignData=['beta'=>$this->request->getPost('beta'),'config_mode'=>$this->request->getPost('config_mode'),'form_mode'=>$this->request->getPost('form_mode'),'escalated'=>$this->request->getPost('escalated'),'user_id'=>$this->request->getPost('user_id'),'user_email'=>$this->request->getPost('user_email'),'username'=>$this->request->getPost('username'),'assigned_to'=>$this->request->getPost('assigned_to'),'date'=>$this->siteSettings->date,'time'=>$this->siteSettings->time,'campaign_name'=>$this->request->getPost('campaign_name'),'promotionalLinks'=>json_encode($this->request->getPost('promotionalLinks')),'overall_campaign_description'=>$this->request->getPost('overall_campaign_description'),'voice_script'=>$this->request->getPost('voice_script'),'facebookMessage'=>$this->request->getPost('facebookMessage'),'linkedinMessage'=>$this->request->getPost('linkedinMessage'),'discordMessage'=>$this->request->getPost('discordMessage'),'stocktwitsMessage'=>$this->request->getPost('stocktwitsMessage'),'tiktokMessage'=>$this->request->getPost('tiktokMessage'),'youtubeMessage'=>$this->request->getPost('youtubeMessage'),'emailMessage'=>$this->request->getPost('emailMessage'),'additionalInfo'=>$this->request->getPost('additionalInfo'),'hashtags'=>$this->request->getPost('hashtags'),];$this->marketingModel->addMarketingCampaign($campaignData);log_message('info','Campaign data saved successfully');if($this->request->isAJAX()){log_message('info','MarketingController L251 - This is using the $this->request->isAJAX() Form Submission');return $this->response->setJSON(['success'=>true,'message'=>'Campaign added successfully']);}else{log_message('info','MarketingController L251 - This is NOT using the $this->request->isAJAX() Form Submission');return redirect()->to('/Management/Marketing/Campaigns')->with('success','Campaign added successfully');}}catch(\Exception $e){log_message('error','Error saving campaign: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to save campaign.']);}}else{log_message('error','Unrecognized type in POST request: '.$type);return $this->response->setJSON(['error'=>'Unrecognized type in POST request']);}}if($this->request->getMethod()==='get'){log_message('debug','Handling GET request for type: '.$type);if($type==='Schedule'){log_message('debug','Loading view for Schedule');try{$response=$this->renderTheme('ManagementModule\Views\Marketing\Schedule\Add',$this->data);log_message('debug','View for Schedule loaded successfully');return $response;}catch(\Exception $e){log_message('error','Failed to load view for Schedule: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to load view for Schedule']);}}elseif($type==='Campaign'){log_message('debug','Loading view for Campaign');try{$response=$this->renderTheme('ManagementModule\Views\Marketing\Campaign\Add',$this->data);log_message('debug','View for Campaign loaded successfully');return $response;}catch(\Exception $e){log_message('error','Failed to load view for Campaign: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to load view for Campaign']);}}else{log_message('error','Unrecognized type in GET request: '.$type);return $this->response->setJSON(['error'=>'Unrecognized type in GET request']);}}}else{log_message('warning','No type provided; redirecting to /Management/Marketing');return redirect()->to('/Management/Marketing')->with('error','No type provided');}}public function addSchedule(){if($this->request->getMethod()==='post'){$additionalInfo=$this->request->getPost('additional_info');$jsonData=null;if(!empty($additionalInfo)){$jsonData=json_decode($additionalInfo,true);if(json_last_error()!==JSON_ERROR_NONE){return redirect()->back()->withInput()->with('error','Invalid JSON format in Additional Information.');}}$scheduleData=['day'=>$this->request->getPost('day'),'time'=>$this->request->getPost('time'),'activity'=>$this->request->getPost('activity'),'link'=>$this->request->getPost('link'),'additional_info'=>json_encode($jsonData)];$this->marketingModel->addMarketingSchedule($scheduleData);return redirect()->to(base_url('Management/Marketing/Schedule'))->with('success','New schedule added successfully.');}$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Schedule\Add');}public function addSubscriber(){helper('email');$rawRequestBody=$this->request->getBody();$jsonData=json_decode($rawRequestBody,true);$marketingModel=new MarketingModel();$subscriberData=['email'=>$jsonData['email'],'category'=>$jsonData['category'],'referral'=>$jsonData['referral'],'beta'=>$this->siteSettings->beta,'date'=>date('Y-m-d H:i:s'),'hostTime'=>date('Y-m-d H:i:s'),'time'=>date('H:i:s'),'user_id'=>session('user_id'),'user_ip'=>$this->request->getIPAddress()];if($marketingModel->addSubscriber($subscriberData)){$emailService=\Config\Services::email();$emailService->setTo($subscriberData['email']);$emailService->setSubject('ðŸŽ‰ Welcome to Investorâ€™s Talk | MyMI Wallet');$emailService->setMessage(view('emails/welcomeInvestor',['siteSettings'=>$this->siteSettings,'socialMedia'=>config('SocialMedia'),]));if($emailService->send()){log_message('info','Management/MarketingController L346 - $emailService: '.print_r($emailService,true));return $this->response->setJSON(['success'=>true,'message'=>'Subscriber email sent successfully']);}else{log_message('error','Management/MarketingController L346 - Error Submitting: $emailService: '.print_r($emailService,true));return $this->response->setJSON(['success'=>false,'message'=>'Failed to send Welcome Email']);}}else{return $this->response->setJSON(['success'=>false,'message'=>'Failed to add subscriber']);}}public function approveBufferItem($id){$this->marketingModel->updateBufferStatus($id,'approved');return $this->respond(['status'=>'success','message'=>'Approved']);}public function approveLogo(){$symbol=$this->request->getPost('symbol');$imageUrl=$this->request->getPost('imageUrl');try{$this->marketingModel->saveApprovedLogo($symbol,$imageUrl);return $this->response->setJSON(['success'=>true,'message'=>'Logo approved successfully.',]);}catch(\Exception $e){log_message('error','Failed to approve logo: '.$e->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to approve logo.',]);}}public function approveAndDownloadLogo(){$imageUrl=$this->request->getPost('selectedImage');$symbol=$this->request->getPost('symbol');try{$imageContent=file_get_contents($imageUrl);$imagePath=WRITEPATH.'uploads/Company-Logos/'.$symbol.'.png';file_put_contents($imagePath,$imageContent);$publicPath=FCPATH.'assets/images/Company-Logos/'.$symbol.'.png';rename($imagePath,$publicPath);return redirect()->to('/Management/Marketing/upcomingEarnings')->with('success','Logo approved and saved successfully.');}catch(\Exception $e){log_message('error','Failed to download or save logo: '.$e->getMessage());return redirect()->back()->with('error','Failed to save the logo.');}}public function approveContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['status'=>'approved']);return redirect()->back()->with('success','Content approved successfully.');}public function blogs(){$this->data['pageTitle']='MyMI Blogs | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['blogs']=$this->marketingModel->getBlogs();$this->data['totalBlogs']=$this->marketingModel->countBlogs();$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Blogs',$this->data);}public function campaigns(){$this->data['pageTitle']='Marketing Campaigns | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['getActiveCampaigns']=$this->marketing['department']['getActiveCampaigns'];$this->data['getActivePriorityCampaigns']=$this->marketing['department']['getActivePriorityCampaigns'];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\campaigns',$this->data);}public function contentGenerator(){try{$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\contentGenerator',$this->data);}catch(\Throwable $th){log_message('error','MarketingController contentGenerator error: '.$th->getMessage());}}public function contentReview(){$generatedContent=$this->session->get('generatedContent');if(empty($generatedContent)){return redirect()->to('/Management/Marketing')->with('error','No generated content available for review.');}return $this->renderTheme('ManagementModule\Views\Marketing\Content_Review',['generatedContent'=>$generatedContent]);}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);log_message('debug','âœ… Content digest completed.');}public function cronFetchAndStoreEmails(){try{log_message('debug','Starting cronFetchAndStoreEmails');$this->marketingService->scrapeAndStoreEmailsToTemp();log_message('debug','Finished cronFetchAndStoreEmails');return $this->respond(['status'=>'success']);}catch(\Throwable $e){log_message('error','cronFetchAndStoreEmails Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();log_message('debug','âœ… Inbox scrape completed.');}public function cronFetchMarketingEmails(){log_message('info','CRON: Starting Marketing Email Fetch');$service=new MarketingService();$emailsFetched=$this->getMyMIMarketing()->fetchAndStoreEmails('newsletters');log_message('info','CRON: Fetched '.$emailsFetched.' marketing emails');return $this->respond(['status'=>'success','fetched'=>$emailsFetched]);}public function cronGenerateContentFromTemp(){try{log_message('debug','Starting cronGenerateContentFromTemp');$this->marketingService->generateFinalContentFromTemp();log_message('debug','Finished cronGenerateContentFromTemp');return $this->respond(['status'=>'success']);}catch(\Throwable $e){log_message('error','cronGenerateContentFromTemp Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function cronSendDailyLog(){date_default_timezone_set('America/Chicago');$contentData=$this->getLogsOrFallback();$emailView=view('emails/daily_log_summary',['contentData'=>$contentData['data'],'contentType'=>$contentData['type'],]);$subject=($contentData['type']==='logs')?'Daily Log Summary for '.date('F j, Y'):'Fallback Content - Daily Summary '.date('F j, Y');$this->email->setTo('community@mymiwallet.com')->setSubject($subject)->setMessage($emailView)->send();$this->email->setTo('team@mymiwallet.com')->setSubject('Reminder: Daily Log Email Pending Confirmation')->setMessage('The daily log email is scheduled to be sent at 3 PM CST. Please review the content to ensure everything is accurate.')->send();}public function edit($id=null){if($id===null){throw new \CodeIgniter\Exceptions\PageNotFoundException('Exchange ID not provided');}$tokenData=$this->marketingModel->getExchangeTokenById($id);if(!$tokenData){throw new \CodeIgniter\Exceptions\PageNotFoundException('Token not found');}if($this->request->getMethod()==='post'){$validation=\Config\Services::validation();$validation->setRules(['coin_name'=>'required','market_cap'=>'required|numeric','website'=>'required|valid_url','discord'=>'permit_empty|valid_url','facebook'=>'permit_empty|valid_url','telegram'=>'permit_empty|valid_url','twitter'=>'permit_empty|valid_url',]);if($validation->withRequest($this->request)->run()){$updatedData=['coin_name'=>$this->request->getPost('coin_name'),'market_cap'=>$this->request->getPost('market_cap'),'website'=>$this->request->getPost('website'),'discord'=>$this->request->getPost('discord'),'facebook'=>$this->request->getPost('facebook'),'telegram'=>$this->request->getPost('telegram'),'twitter'=>$this->request->getPost('twitter'),];if($this->marketingModel->updateExchangeToken($id,$updatedData)){$this->session->setFlashdata('success','Exchange token updated successfully');}else{$this->session->setFlashdata('error','Failed to update the exchange token');}return redirect()->to(site_url('Management/Marketing/Exchanges/Edit/'.$id));}else{$this->session->setFlashdata('validation_errors',$validation->getErrors());}}return $this->renderTheme('ManagementModule\Views\Marketing\Exchanges\edit',['token'=>$tokenData,'validation'=>$this->session->getFlashdata('validation_errors'),'redirectURL'=>site_url('Management/Marketing/Exchanges'),]);}public function editContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}return $this->renderTheme('ManagementModule\Views\Marketing\Content_Edit',['content'=>$content]);}public function fetchBufferPaginated(){$page=(int) $this->request->getGet('page')?:1;$limit=(int) $this->request->getGet('limit')?:20;$data=$this->marketingModel->fetchBufferPaginated($page,$limit);return $this->respond($data);}public function fetchLatestSummaries(){$generatedSummaries=$this->marketingModel->getLatestGeneratedSummaries(25);return $this->renderTheme('ManagementModule\Views\Marketing\resources\generatedSummaries',['generatedSummaries'=>$generatedSummaries]);}public function fetchMissingLogos(){$postData=$this->request->getJSON(true);$csrfName=csrf_token();$csrfHash=csrf_hash();if(!isset($postData[$csrfName])||$postData[$csrfName]!==$csrfHash){log_message('error','fetchMissingLogos: CSRF validation failed');return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['error'=>'Invalid CSRF token.']);}$symbols=$postData['symbols']?? null;if(empty($symbols)||!is_array($symbols)){log_message('error','fetchMissingLogos: Invalid symbols input');return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['error'=>'Invalid symbols input.']);}$results=[];foreach($symbols as $symbol){$results[]=['symbol'=>$symbol,'status'=>'not_found',];}return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['results'=>$results]);}public function financialNews(){$symbols=$this->investmentModel->getAllSymbolsByEarnings();$approvedLogos=$this->marketingModel->getApprovedLogos();$existingSymbols=array_column($approvedLogos,'symbol');$missingSymbols=array_filter($symbols,function($symbol)use($existingSymbols){return!in_array($symbol['symbol'],$existingSymbols);});$this->data['approvedLogos']=$approvedLogos ??[];$this->data['missingSymbols']=$missingSymbols ??[];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\financialNews',$this->data);}public function generateAudio(){$text=$this->request->getPost('text');$fileName=$this->request->getPost('fileName')?:uniqid('tts_',true);$directory=WRITEPATH.'uploads/';$outputFile=$directory.$fileName.'.mp3';if(empty($text)){return $this->response->setJSON(['status'=>'error','message'=>'Text cannot be empty.',]);}if(!is_dir($directory)){mkdir($directory,0777,true);}$command=sprintf('python3 gtts_script.py %s %s',escapeshellarg($text),escapeshellarg($outputFile));exec($command,$output,$status);if($status===0&&file_exists($outputFile)){$fileUrl=base_url('uploads/'.basename($outputFile));return $this->response->setJSON(['status'=>'success','message'=>'Audio file generated successfully.','file_url'=>$fileUrl,]);}else{return $this->response->setJSON(['status'=>'error','message'=>'Failed to generate audio.',]);}}private function generateAutomatedContent(){$scraperContent=$this->marketingModel->getRecentScrapes();$tempContent=$this->marketingModel->getRecentTempScrapes();$campaigns=$this->marketingModel->getActiveCampaignsLimited(50);$allContent=array_merge($scraperContent,$tempContent,$campaigns);$generatedContent=[];foreach($allContent as $content){$generatedContent[]=$this->getMarketingService()->generateContentFromPost($content->title ?? 'Untitled',$content->content ?? '',$content->tags?explode(',',$content->tags):[]);}foreach($generatedContent as $content){$slug=$this->marketingModel->createSlug($content['title']);$this->db->table('bf_marketing_blog_posts')->insert(['title'=>$content['title']?? 'Generated Content','content'=>$content['summary']?? '','slug'=>$slug,'tags'=>implode(',',$content['keywords']??[]),'created_on'=>date('Y-m-d H:i:s'),]);$this->marketingModel->saveDailyLog(['title'=>$content['title'],'content'=>$content['summary'],'type'=>'Automated','tags'=>implode(',',$content['keywords']),'date_time'=>date('Y-m-d H:i:s'),'author_information'=>'MyMI Automated System','created_on'=>date('Y-m-d H:i:s'),]);}return $generatedContent;}public function generateContent($platform,$postId){$post=$this->marketingModel->getSchedulePostById($postId);if(!$post){return redirect()->back()->with('error','Post not found.');}$content=$this->getMyMIMarketing()->generateContentFromGPT($post['subjects'],$post['descriptions'],$platform);$contentData=['post_id'=>$postId,'platform'=>$platform,'generated_content'=>$content,];$this->marketingModel->storeGeneratedContent($contentData);return redirect()->to("\Management\Marketing\Schedule")->with('success','Content generated successfully.');}public function generateContentDigestFromStored(){log_message('info','Marketing: Starting summary generation from stored marketing emails.');$model=new MarketingModel();$records=$model->getRecentUnprocessedTempEmails(5);$results=[];foreach($records as $record){if(empty($record['content'])||strlen($record['content'])<1000){log_message('debug',"âš ï¸ Skipping record ID {$record['id']} due to insufficient content length.");continue;}if(empty($record['title'])||empty($record['content'])){log_message('debug','Skipped record due to missing title/content ID: '.$record['id']);continue;}try{$summary=$this->getMarketingService()->generateContentFromRaw($record['title'],$record['content']);$model->storeFinalMarketingContent(['source_id'=>$record['id'],'title'=>$record['title'],'summary'=>$summary,'created_at'=>date('Y-m-d H:i:s')]);$model->markTempRecordAsProcessed($record['id']);$results[]=$record['title'];}catch(\Throwable $e){log_message('error','Failed to process record ID '.$record['id'].': '.$e->getMessage());}}return $this->respond(['status'=>'complete','processed_titles'=>$results]);}public function generateContentFromTweet($tweetId){$tweet=$this->marketingModel->getTweetById($tweetId);if(!$tweet){return $this->failNotFound('Tweet not found');}$generatedContent=$this->getMyMIMarketing()->generateContentFromTweets([$tweet]);$this->marketingModel->storeGeneratedContent(['tweet_id'=>$tweetId,'content'=>json_encode($generatedContent),'created_at'=>date('Y-m-d H:i:s')]);$this->getMyMIMarketing()->postToTwitter($generatedContent['platform_content']['Twitter']);return $this->respond(['message'=>'Content generated and posted successfully']);}public function generateDailyContentDigest(){log_message('debug','ðŸ§  Start Memory Usage: '.memory_get_usage(true));@ini_set('memory_limit','768M');$limit=5;$summary=[];$rawRecords=$this->marketingModel->getLatestUnprocessedEmails($limit);foreach($rawRecords as $record){$content=$record['content']?? '';if(empty($content)||strlen($content)<500){log_message('debug',"â­ï¸ Skipped record ID {$record['id']} - insufficient content.");continue;}$contentSize=strlen($content);log_message('debug','ðŸ“Œ Processing record ID '.$record['id'].' with content size: '.$contentSize);log_message('debug','Management/MarketingController L770 - $record Array: '.print_r($record,true));if($contentSize===0){log_message('debug',"â­ï¸ Skipped record ID {$record['id']} - empty content.");continue;}try{gc_collect_cycles();$processed=$this->getMarketingService()->generateContentFromRaw($record);if($processed===null){log_message('debug',"âš ï¸ Skipped record ID {$record['id']} - generateContentFromRaw() returned null.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$summary[]=['title'=>$processed['headline'],'summary'=>$processed['summary'],'subtopics'=>$processed['subtopics'],'platform_posts'=>$processed['posts'],];}catch(\Throwable $e){log_message('error',"âŒ generateDailyContentDigest failed on record ID {$record['id']}: {$e->getMessage()}");}}$this->marketingModel->markEmailsAsProcessed(array_column($rawRecords,'id'));log_message('debug','ðŸ Peak Memory Usage: '.memory_get_peak_usage(true));return $this->response->setJSON(['digest'=>$summary]);}public function generateNewsletterContent(){$emailContents=$this->marketingModel->getEmailContentsForNewsletter();$content=$this->getMyMIMarketing()->generateNewsletterContent($emailContents);$newsletterData=['title'=>'Monthly Financial Newsletter - '.date('F Y'),'content'=>$content,'status'=>'draft','created_at'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeNewsletterDraft($newsletterData);return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Newsletter content generated successfully');}private function generateSummarizedFallbackContent($contentArray){$summarizedContent=[];$summarizer=new \App\Libraries\ContentSummarizer();foreach($contentArray as $content){$summarizedContent[]=['title'=>$content->title ?? 'Untitled','summary'=>$summarizer->summarize($content->content ?? '',200),'url'=>$content->url ?? null,];}return $summarizer->combineSummaries($summarizedContent);}private function getLogsOrFallback(){$logs=$this->marketingModel->getDailyLogsByDate(date('Y-m-d'));if(!empty($logs)){return['type'=>'logs','data'=>$logs];}$scrapedContent=$this->marketingModel->getRecentScrapes();$campaigns=$this->marketingModel->getActiveCampaignsLimited(50);$combinedContent=array_merge($scrapedContent,$campaigns['result']);$fallbackContent=$this->generateSummarizedFallbackContent($combinedContent);foreach($fallbackContent as $content){$this->marketingModel->saveDailyLog(['title'=>$content['title']?? 'Automated Content','content'=>$content['summary']?? '','type'=>'Automated','tags'=>implode(',',$content['keywords']??[]),'date_time'=>date('Y-m-d H:i:s'),'author_information'=>'MyMI Automated System','created_on'=>date('Y-m-d H:i:s'),]);}return['type'=>'fallback','data'=>$fallbackContent];}public function getRecentScrapes(){try{$scrapes=$this->marketingModel->getRecentScrapes();return $this->response->setJSON(['success'=>true,'scrapes'=>$scrapes]);}catch(\Throwable $th){log_message('error','getRecentScrapes: Exception - '.$th->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to fetch recent scrapes.']);}}private function handleMediaUpload($mediaFiles){$uploadedMedia=[];foreach($mediaFiles as $file){if($file->isValid()&&!$file->hasMoved()){$newFileName=$file->getRandomName();$file->move(WRITEPATH.'uploads/media/',$newFileName);$uploadedMedia[]=['file_name'=>$file->getClientName(),'file_path'=>WRITEPATH.'uploads/media/'.$newFileName,'file_size'=>$file->getSize(),'file_type'=>$file->getMimeType(),];}}return $uploadedMedia;}public function ideas(){$this->data['pageTitle']='Marketing Campaigns | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['getActiveIdeas']=$this->marketingModel->getActiveIdeas();$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\ideas',$this->data);}public function importScheduleCSV(){if($this->request->getMethod()==='post'){$file=$this->request->getFile('csv_file');if($file->isValid()&&!$file->hasMoved()){$filePath=WRITEPATH.'uploads/'.$file->store();$csvData=array_map('str_getcsv',file($filePath));foreach($csvData as $row){$scheduleData=['day'=>$row[0],'time'=>$row[1],'activity'=>$row[2],];$scheduleId=$this->marketingModel->addMarketingSchedule($scheduleData);$campaignData=['sched_id'=>$scheduleId,'title'=>$row[3],'platform'=>$row[4],'content'=>$row[5],];$this->marketingModel->addMarketingCampaign($campaignData);}return redirect()->back()->with('success','Schedule and campaigns imported successfully.');}return redirect()->back()->with('error','Invalid CSV file.');}return $this->renderTheme('ManagementModule\Views\Marketing\importCSV');}public function previewBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Item not found.");return $this->renderTheme('ManagementModule\Views\Marketing\modals\bufferPreview',['item'=>$record]);}public function previewGeneratedPost($id){try{$post=$this->marketingModel->find($id);if(!$post){return $this->failNotFound('Post not found.');}return $this->renderTheme('App\Modules\Management\Views\Marketing\modals/previewGeneratedPost',['post'=>$post]);}catch(\Throwable $e){log_message('error','âŒ Failed to load post preview: '.$e->getMessage());return $this->failServerError('Unable to preview post.');}}public function previewPendingSummaries(){try{$pendingSummaries=$this->marketingModel->getPendingScraperSummaries(10);return $this->renderTheme('App\Modules\Management\Views\Marketing\partials\previewPendingSummaries',['pendingSummaries'=>$pendingSummaries]);}catch(\Throwable $e){log_message('error','âŒ previewPendingSummaries failed: '.$e->getMessage());return $this->failServerError('Could not load summaries.');}}public function previewVideoScript($id){$post=$this->marketingModel->getGeneratedPostById($id);if(!$post)return $this->failNotFound('Post not found.');$posts=json_decode($post['posts'],true);$videoScript=$posts['video']?? 'No video script generated yet.';return $this->renderTheme('MarketingModule\Views\Marketing\modals\video_preview_modal',['title'=>$post['title'],'videoScript'=>$videoScript,]);}public function processScheduledPosts(){$currentTimestamp=date('Y-m-d H:i:s');$scheduledPosts=$this->marketingModel->getPendingScheduledPosts($currentTimestamp);foreach($scheduledPosts as $post){$payload=['platform'=>$post->platform,'content'=>$post->content,'media_url'=>$post->media_url,];try{$response=$this->sendToZapier($post->zapier_webhook_url,$payload);if($response->getStatusCode()===200){$this->marketingModel->updatePostStatus($post->id,'posted');}else{throw new Exception("Zapier response error: {$response->getBody()}");}}catch(Exception $e){$this->handlePostFailure($post,$e->getMessage());}}}private function sendToZapier($webhookUrl,$payload){$client=new \GuzzleHttp\Client();return $client->post($webhookUrl,['headers'=>['Content-Type'=>'application/json'],'json'=>$payload,]);}private function handlePostFailure($post,$error){$this->marketingModel->incrementRetryCount($post->id);log_message('error',"Failed to post to Zapier for Post ID {$post->id}: {$error}");if($post->retry_count>=3){$this->marketingModel->updatePostStatus($post->id,'failed');}}public function postCreator(){try{$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\index',$this->data);}catch(\Throwable $th){log_message('error','MarketingController postCreator error: '.$th->getMessage());}}public function promote(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['exchangeAssets']=[];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Promote',$this->data);}public function publishBlog($blogId){$blog=$this->marketingModel->getBlogPostDetails($blogId);if(!$blog){return redirect()->back()->with('error','Blog post not found.');}$this->marketingModel->update($blogId,['status'=>'published']);return redirect()->to('/Management/Marketing/Blogs')->with('success','Blog published successfully.');}public function rejectBufferItem($id){$this->marketingModel->updateBufferStatus($id,'rejected');return $this->respond(['status'=>'success','message'=>'Rejected']);}public function rejectContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['status'=>'rejected']);return redirect()->back()->with('success','Content rejected successfully.');}public function reviewBuffer(){$buffer=$this->marketingModel->getBufferItems();$this->data['pageTitle']='Marketing Buffer Dashboard';$this->data['buffer']=$buffer;return $this->renderTheme('ManagementModule\Views\Marketing\BufferDashboard',$this->data);}public function runContentGeneration(){$generatedContent=$this->generateAutomatedContent();$this->session->set('generatedContent',$generatedContent);return redirect()->to('/Management/Marketing/ContentReview')->with('success',count($generatedContent).' content items generated successfully. Please review and approve.');}private function sanitizeContent($content){$content=preg_replace('#<script(.*?)>(.*?)</script>#is','',$content);$content=preg_replace('#<style(.*?)>(.*?)</style>#is','',$content);$content=strip_tags($content);$content=preg_replace('/\s+/',' ',$content);return trim($content);}private function saveCampaign($formData){$data=['title'=>$formData['title'],'description'=>$formData['description'],];$this->marketingModel->addMarketingCampaign($data);}public function saveContentEdit($id){$postData=$this->request->getPost();$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['content'=>$postData['content'],'status'=>'pending',]);return redirect()->to('/Management/Marketing/ContentReview')->with('success','Content updated successfully.');}private function saveSchedule($formData){$scheduleModel=new \App\Models\ScheduleModel();$data=['title'=>$formData['title'],'description'=>$formData['description'],];$scheduleModel->insert($data);}public function schedule($day=null){if(!empty($day)){$this->data['marketingSchedule']=$this->marketingModel->getScheduleByDay($day);foreach($this->data['marketingSchedule']as&$schedule){$schedule['campaigns']=$this->marketingModel->getCampaignsBySchedId($schedule['id']);}$this->data['scheduleByDay']='Yes';}else{$this->data['marketingSchedule']=$this->marketingModel->getUpcomingSchedule();foreach($this->data['marketingSchedule']as&$schedule){$schedule['campaigns']=$this->marketingModel->getCampaignsBySchedId($schedule['id']);}$this->data['scheduleByDay']='No';}$this->commonData();$this->data['pageTitle']='Daily Schedule | Management | MyMI Wallet';return $this->renderTheme('ManagementModule\Views\Marketing\Schedule',$this->data);}public function scheduleNewsletterCampaign(){$newsletterDraft=$this->marketingModel->getLatestNewsletterDraft();if(!$newsletterDraft){return $this->response->setJSON(['success'=>false,'message'=>'No newsletter draft found']);}$campaignData=['title'=>$newsletterDraft['title'],'content'=>$newsletterDraft['content'],'status'=>'scheduled','send_date'=>$this->request->getPost('send_date'),'target_audience'=>'all_users','created_at'=>date('Y-m-d H:i:s'),];if($this->marketingModel->scheduleNewsletterCampaign($campaignData)){return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Newsletter campaign scheduled successfully');}else{return redirect()->back()->with('error','Failed to schedule newsletter campaign');}}private function scrapeGoogleSearch($query){$searchUrl='https://www.google.com/search?q='.urlencode($query);$client=new Client();try{$response=$client->get($searchUrl);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$dom=new \DOMDocument();libxml_use_internal_errors(true);$dom->loadHTML($html);libxml_clear_errors();$xpath=new \DOMXPath($dom);$results=[];foreach($xpath->query('//a[@href]')as $link){$href=$link->getAttribute('href');if(strpos($href,'/url?q=')===0){$href=substr($href,7,strpos($href,'&')-7);$text=$link->nodeValue;$results[]=['href'=>$href,'text'=>$text];}}return $results;}else{log_message('error','scrapeGoogleSearch: Could not retrieve content, HTTP status code - '.$response->getStatusCode());return['error'=>'Could not retrieve content, HTTP status code - '.$response->getStatusCode()];}}catch(RequestException $e){log_message('error','scrapeGoogleSearch: RequestException - '.$e->getMessage());return['error'=>'RequestException error: '.$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeGoogleSearch: General error - '.$e->getMessage());return['error'=>'General error: '.$e->getMessage()];}return[];}public function scrapeLink(){$rawRequestBody=$this->request->getBody();$jsonData=json_decode($rawRequestBody,true);$url=$jsonData['url']?? null;if(!$url){log_message('error','scrapeLink: URL is missing');return $this->response->setJSON(['success'=>false,'message'=>'URL is required.']);}try{log_message('debug','scrapeLink: Scraping URL - '.$url);$scrapedData=$this->scrapeWebsiteWithFallback($url);if(isset($scrapedData['error'])){log_message('error','scrapeLink: '.$scrapedData['error']);return $this->response->setJSON(['success'=>true,'message'=>'Partially scraped data, proceeding with available data.']);}if(!empty($scrapedData['content'])){$this->marketingModel->storeTempScrapedData(['title'=>$scrapedData['title'],'content'=>$scrapedData['content'],'links'=>json_encode($scrapedData['links']),'url'=>$scrapedData['url'],'scraped_at'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),]);return $this->response->setJSON(['success'=>true,'message'=>'Scraped data stored successfully.','data'=>$scrapedData]);}else{log_message('error','scrapeLink: Scraped data is empty');return $this->response->setJSON(['success'=>false,'message'=>'Scraping failed. Please check the URL and try again.']);}}catch(\Throwable $th){log_message('error','scrapeLink: Exception - '.$th->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'An error occurred during scraping.']);}}private function scrapeLinks($links){$scrapedLinksData=[];foreach($links as $link){$url=filter_var($link['href'],FILTER_SANITIZE_URL);if(filter_var($url,FILTER_VALIDATE_URL)){$scrapedData=$this->scrapeWebsite($url);if(!empty($scrapedData['content'])){$scrapedLinksData[]=$scrapedData;}}}return $scrapedLinksData;}private function scrapeWebsite($url){$client=new Client();try{$response=$client->get($url,['stream'=>true,'headers'=>['User-Agent'=>'MyMI Wallet Bot'],'timeout'=>10,'http_errors'=>false ]);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$dom=HtmlDomParser::str_get_html($html);if($dom instanceof \voku\helper\HtmlDomParser){$title=$dom->find('title',0)->text ?? 'No title found';$bodyNode=$dom->find('body',0);$bodyContent=$bodyNode?$this->sanitizeContent($bodyNode->innerHtml()):'No body content found';$links=[];foreach($dom->find('a')as $link){$href=$link->getAttribute('href');$text=$link->text;$links[]=['href'=>$href,'text'=>$text];}log_message('debug','scrapeWebsite: Scraping successful for URL - '.$url);return['title'=>$title,'content'=>$bodyContent,'links'=>$links,'url'=>$url];}else{log_message('error','scrapeWebsite: DOM parsing failed for URL - '.$url);return['error'=>'DOM parsing failed.'];}}else{log_message('error','scrapeWebsite: Could not retrieve content, HTTP status code - '.$response->getStatusCode());return['error'=>'Could not retrieve content, HTTP status code - '.$response->getStatusCode()];}}catch(RequestException $e){if($e->hasResponse()&&$e->getResponse()->getStatusCode()==401){log_message('error','scrapeWebsite: Unauthorized access for URL - '.$url);return['error'=>'Unauthorized access. Skipping URL.'];}log_message('error','scrapeWebsite: RequestException - '.$e->getMessage());return['error'=>'RequestException error: '.$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeWebsite: General error - '.$e->getMessage());return['error'=>'General error: '.$e->getMessage()];}}private function scrapeWebsiteWithFallback($url){try{log_message('debug','scrapeWebsiteWithFallback: Scraping URL - '.$url);$scrapedData=$this->scrapeWebsite($url);if(empty($scrapedData['content'])){log_message('debug','scrapeWebsiteWithFallback: Scraped data is empty, performing Google search fallback');$googleSearchResults=$this->scrapeGoogleSearch($url);$scrapedLinksData=$this->scrapeLinks($googleSearchResults);$scrapedData['google_search_results']=$scrapedLinksData;}return $scrapedData;}catch(RequestException $e){log_message('error','scrapeWebsiteWithFallback: RequestException - '.$e->getMessage());return['error'=>$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeWebsiteWithFallback: General error - '.$e->getMessage());return['error'=>$e->getMessage()];}}public function searchAndApproveLogo($symbol){$query=$symbol.' logo png transparent';$searchUrl='https://www.google.com/search?q='.urlencode($query).'&tbm=isch';try{$response=$this->client->request('GET',$searchUrl);$htmlContent=$response->getBody()->getContents();$dom=new \DOMDocument();@$dom->loadHTML($htmlContent);$xpath=new \DOMXPath($dom);$imageNodes=$xpath->query('//img');$imageUrls=[];foreach($imageNodes as $imageNode){$src=$imageNode->getAttribute('src');if($src){$imageUrls[]=$src;}}return $this->renderTheme('ManagementModule\Views\Marketing\approve_logo',['symbol'=>$symbol,'imageUrls'=>$imageUrls,]);}catch(RequestException $e){log_message('error','Google Search Request Failed: '.$e->getMessage());return redirect()->back()->with('error','Failed to fetch logo suggestions.');}}public function sendScheduledNewsletter(){$campaigns=$this->marketingModel->getScheduledCampaigns();foreach($campaigns as $campaign){$this->getMyMIMarketing()->sendNewsletter($campaign['content'],$campaign['target_audience']);$this->marketingModel->updateCampaignStatus($campaign['id'],'sent');}return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Scheduled newsletters sent successfully');}public function standaloneAddSubscriber(){$this->data['pageTitle']='Add Subscriber | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneAddSubscriber',$this->data);}public function standaloneScrape(){$this->data['pageTitle']='Quick Scraper | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneScraper',$this->data);}private function storeScrapedData($scrapedData){$db=\Config\Database::connect();$builder=$db->table('bf_marketing_temp_scraper');$data=['title'=>$scrapedData['title'],'content'=>$scrapedData['content'],'links'=>json_encode($scrapedData['links']),'url'=>$scrapedData['url'],'created_at'=>date('Y-m-d H:i:s'),'updated_at'=>date('Y-m-d H:i:s'),];$builder->insert($data);}public function submitContent(){$request=service('request');$validationRules=['campaignName'=>'required|min_length[3]','promotionalLinks'=>'required','facebookMessage'=>'required','linkedinMessage'=>'required','discordMessage'=>'required','stockTwitsMessage'=>'required','tiktokMessage'=>'required','youtubeMessage'=>'required','emailMessage'=>'required',];if(!$this->validate($validationRules)){return redirect()->back()->with('errors',$this->validator->getErrors())->withInput();}$campaignData=['name'=>$request->getPost('campaignName'),'promotional_links'=>json_encode($request->getPost('promotionalLinks')),'facebook_message'=>$request->getPost('facebookMessage'),'linkedin_message'=>$request->getPost('linkedinMessage'),'discord_message'=>$request->getPost('discordMessage'),'stocktwits_message'=>$request->getPost('stockTwitsMessage'),'tiktok_message'=>$request->getPost('tiktokMessage'),'youtube_message'=>$request->getPost('youtubeMessage'),'email_message'=>$request->getPost('emailMessage'),'additional_info'=>$request->getPost('additionalInfo'),'created_on'=>date('Y-m-d H:i:s'),'status'=>1,'stage'=>'draft',];$marketingModel=new MarketingModel();if($marketingModel->insert($campaignData)){return redirect()->to('/Marketing/Success')->with('success','Marketing content submitted successfully.');}else{return redirect()->back()->with('error','Failed to submit marketing content.')->withInput();}}public function submitDailyLog(){$data=['title'=>$this->request->getPost('subject'),'content'=>$this->request->getPost('log_content'),'subcontent'=>json_encode($this->request->getPost('subcontent')),'tags'=>$this->request->getPost('tags'),'type'=>$this->request->getPost('content_type'),'url'=>$this->request->getPost('url'),'author_information'=>$this->request->getPost('author_information'),'date_time'=>$this->request->getPost('date_time'),'trade_alert_subcategory'=>$this->request->getPost('trade_alert_subcategory'),'created_on'=>date('Y-m-d H:i:s'),];if($this->marketingModel->saveDailyLog($data)){return $this->response->setJSON(['success'=>true,'message'=>'Daily log submitted successfully!']);}else{return $this->response->setJSON(['success'=>false,'message'=>'Failed to submit daily log.']);}}public function submitLargeContent(){log_message('debug','submitLargeContent method called');try{$subject=$this->request->getPost('subject');$url=$this->request->getPost('url');$content=$this->request->getPost('large_content');$tags=$this->request->getPost('tags');$uploadedFiles=$this->request->getFiles();$contentType=$this->request->getPost('content_type');$mediaAssets=$this->handleMediaUpload($uploadedFiles['media_assets']);if(empty($content)||strlen($content)<50){throw new \Exception('Content too short or empty');}$generatedContent=$this->getMyMIMarketing()->generateContentFromLargeText($content,$tags);$keywords=is_array($generatedContent['keywords'])?$generatedContent['keywords']:[];$this->marketingModel->storeScrapedContent(['status'=>'pending','type'=>$contentType,'url'=>$url,'title'=>$subject,'summary'=>$generatedContent['summary'],'content'=>$content,'keywords'=>implode(', ',$keywords),'created_on'=>date('Y-m-d H:i:s'),]);return $this->response->setJSON(['success'=>true]);}catch(\Exception $e){log_message('error','submitLargeContent error: '.$e->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to submit content.']);}}public function submitLargeContentForm(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();$this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneLargeContentForm',$this->data);}public function submitMarketingCampaign(){helper(['form','url']);$data=['name'=>$this->request->getPost('campaignName'),'assigned_to'=>$this->request->getPost('assigned_to'),'promotional_links'=>json_encode($this->request->getPost('promotionalLinks')),'facebook_message'=>htmlentities($this->request->getPost('facebookMessage'),ENT_QUOTES,'UTF-8'),'linkedin_message'=>htmlentities($this->request->getPost('linkedinMessage'),ENT_QUOTES,'UTF-8'),'discord_message'=>htmlentities($this->request->getPost('discordMessage'),ENT_QUOTES,'UTF-8'),'stocktwits_message'=>htmlentities($this->request->getPost('stocktwitsMessage'),ENT_QUOTES,'UTF-8'),'tiktok_message'=>htmlentities($this->request->getPost('tiktokMessage'),ENT_QUOTES,'UTF-8'),'youtube_message'=>htmlentities($this->request->getPost('youtubeMessage'),ENT_QUOTES,'UTF-8'),'email_message'=>htmlentities($this->request->getPost('emailMessage'),ENT_QUOTES,'UTF-8'),'additional_info'=>htmlentities($this->request->getPost('additionalInfo'),ENT_QUOTES,'UTF-8'),'overall_campaign_description'=>htmlentities($this->request->getPost('overall_campaign_description'),ENT_QUOTES,'UTF-8'),'voice_script'=>htmlentities($this->request->getPost('voice_script'),ENT_QUOTES,'UTF-8')];if($this->validate(['name'=>'required','facebook_message'=>'required',])){$this->marketingModel->submitCampaignContent($data);return redirect()->to('/dashboard')->with('success','Campaign submitted successfully.');}else{return redirect()->back()->withInput()->with('errors',$this->validator->getErrors());}}public function submitMarketIdeas(){if($this->request->getMethod()==='post'){$data=['title'=>$this->request->getPost('title'),'description'=>htmlentities($this->request->getPost('description'),ENT_QUOTES,'UTF-8'),'created_by'=>session()->get('user_id'),'assigned_to'=>$this->request->getPost('assigned_to'),'priority'=>$this->request->getPost('priority'),'status'=>'draft','platforms'=>json_encode($this->request->getPost('platforms')),'additional_info'=>htmlentities($this->request->getPost('additional_info'),ENT_QUOTES,'UTF-8'),];$uploadedFiles=$this->request->getFiles();$filePaths=[];if($uploadedFiles&&isset($uploadedFiles['imageFiles'])){foreach($uploadedFiles['imageFiles']as $file){if($file->isValid()&&!$file->hasMoved()){$newName=$file->getRandomName();$file->move(FCPATH.'public/assets/images/Marketing/Ideas',$newName);$filePaths[]=base_url('assets/images/Marketing/Ideas/'.$newName);}}}if(!empty($filePaths)){$data['image_paths']=json_encode($filePaths);}if($this->validate(['title'=>'required','description'=>'required'])){$this->marketingModel->submitIdea($data);return redirect()->back()->with('success','Idea submitted successfully.');}else{return redirect()->back()->withInput()->with('errors',$this->validator->getErrors());}}}public function topCommunities($channel=null){$this->commonData();$MyMIExchange=new MyMIExchange();$exchangeTokens=$MyMIExchange->getSolanaTokens();if(!empty($channel)){if($channel==='Discord'){$this->data['tokens']=$exchangeTokens['discord'];$this->data['pageTitle']='Discord Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\discord',$this->data);}elseif($channel==='Facebook'){$this->data['tokens']=$exchangeTokens['facebook'];$this->data['pageTitle']='Facebook Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\facebook',$this->data);}elseif($channel==='Twitter'){$this->data['tokens']=$exchangeTokens['x_twitter'];$this->data['pageTitle']='Twitter Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\twitter',$this->data);}elseif($channel==='Website'){$this->data['tokens']=$exchangeTokens['website'];$this->data['pageTitle']='Website Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\website',$this->data);}else{$this->data['tokens']=$exchangeTokens['all'];$this->data['pageTitle']='All Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\all_tokens',$this->data);}}else{$this->data['tokens']=$exchangeTokens['all'];$this->data['pageTitle']='All Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\all_tokens',$this->data);}}public function triggerPostAutogenOnEmpty(){$today=date('Y-m-d');$existing=$this->marketingModel->getLatestGeneratedSummaries(5,$today);if(!empty($existing)){return $this->response->setJSON(['status'=>'skipped','message'=>'Summaries already exist for today.']);}try{$this->getMyMIMarketing()->generateFromTempScraper(5);return $this->response->setJSON(['status'=>'generated','message'=>'Generated new summaries.']);}catch(\Throwable $e){log_message('error','triggerPostAutogenOnEmpty error: '.$e->getMessage());return $this->failServerError('Failed to generate summaries.');}}public function twitterDashboard(){$data=['pageTitle'=>'Twitter Dashboard','hashtags'=>$this->request->getPost('hashtags')?? '','tweets'=>[]];if($this->request->getMethod()==='post'){$hashtags=$this->request->getPost('hashtags');$tweets=$this->getMyMIMarketing()->fetchTweets($hashtags);$data['tweets']=$tweets;}return $this->renderTheme('Management/Marketing/Twitter',$data);}public function upcomingEarnings(){$model=new \App\Models\EarningsModel();$upcomingEarnings=$model->getUpcomingEarnings();$this->data['upcomingEarnings']=$upcomingEarnings;return $this->renderTheme('ManagementModule\Views\Marketing\upcoming_earnings',$this->data);}public function updatePlatformToggle($id){$post=$this->request->getJSON(true);$platform=$post['platform'];$enabled=(bool) $post['enabled'];$record=$this->marketingModel->getBufferItem($id);$platforms=json_decode($record['platforms']?? '{}',true);$platforms[$platform]=$enabled;$this->marketingModel->updateBufferItem($id,['platforms'=>json_encode($platforms)]);return $this->respond(['status'=>'success']);}public function viewBlog($slug){$blogPost=$this->marketingModel->getBlogPostBySlug($slug);if(!$blogPost){throw new \CodeIgniter\Exceptions\PageNotFoundException('Blog post not found');}return $this->renderTheme('blog/view',['blogPost'=>$blogPost]);}public function viewCampaign($campaign_id){$campaignModel=new CampaignModel();$campaign=$this->marketingModel->getCampaignsById($campaign_id);if(!$campaign){throw new \CodeIgniter\Exceptions\PageNotFoundException("Campaign not found");}return $this->renderTheme('ManagementModule\Views\Marketing\Campaigns\View',['campaign'=>$campaign]);}public function viewDailyLogs($date=null){$date=$this->siteSettings->date ?? date('Y-m-d');$this->data['pageTitle']='Marketing Daily Log | '.$date.' | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['logs']=$this->marketingModel->getDailyLogsByDate($date);$this->commonData();return $this->renderTheme('ManagementModul\Views\Marketing\Daily_Logs',['logs'=>$logs,'date'=>$date]);}public function viewEmail($titleEncoded=null,$messageId=null){log_message('debug','ðŸ“§ ManagementController::viewEmail called');try{if(empty($messageId)){return redirect()->back()->with('error','Invalid email identifier.');}$emailRecord=$this->marketingModel->getEmailByMessageId($messageId);if(!$emailRecord){return redirect()->back()->with('error','Email not found.');}$socialMediaPosts=$this->getMarketingService()->generateContentFromRaw($emailRecord);$emailRecord['social_media']=$socialMediaPosts['posts']??[];return $this->renderTheme('Management/Marketing/EmailDetail',['email'=>$emailRecord]);}catch(\Throwable $e){log_message('error','âŒ viewEmail() failed: '.$e->getMessage());return $this->failServerError('Unable to load email.');}}public function viewGeneratedContent(){$contentData=$this->marketingModel->getLastGeneratedContent();$platformsContent=json_decode($contentData['platforms_content'],true);$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['platforms_content']=$platformsContent;$this->commonData();$this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneGeneratedContent',$this->data);}public function viewGeneratedSummaries(){$this->data['pageTitle']='Generated Summaries';$this->data['generatedSummaries']=$this->marketingModel->getLatestGeneratedSummaries(25);$this->renderTheme('ManagementModule\Views\Marketing\resources\generatedSummaries',$this->data);}} ?><?php namespace App\Modules\APIs\Controllers;use CodeIgniter\API\ResponseTrait;use CodeIgniter\Controller;use App\Libraries\{BaseLoader,MyMIMarketing};use App\Services\MarketingService;use App\Models\MarketingModel;class MarketingController extends Controller{use ResponseTrait;use BaseLoader;protected $MyMIMarketing;protected $marketingService;protected $marketingModel;public function __construct(){$this->MyMIMarketing=new MyMIMarketing();$this->marketingModel=new MarketingModel();}public function approveBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Record not found.");$this->marketingModel->updateBufferItem($id,['status'=>'approved']);$posts=$this->MyMIMarketing->generateSocialPost($record);$this->MyMIMarketing->distributeContent('discord',$posts['discord']);$this->MyMIMarketing->distributeContent('linkedin',$posts['linkedin']);return $this->respond(['status'=>'success','message'=>'Content approved & promoted!']);}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);return $this->respond(['status'=>'success','message'=>'Content analysis completed.']);}public function cronFetchAndGenerateNews(){try{$this->MyMIMarketing->cronFetchAndGenerateNews();return $this->respond(['status'=>'success','message'=>'News fetched and generated.']);}catch(\Throwable $e){return $this->failServerError($e->getMessage());}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();return $this->respond(['status'=>'success','message'=>'Inbox scraped.']);}public function cronFetchMarketingEmails(){log_message('info','ðŸ“¬ CRON: Fetching marketing emails via inbox scrape');try{$result=$this->getMyMIMarketing()->scrapeInboxAndStore();return $this->respond(['status'=>'success','message'=>'Marketing inbox scrape completed.','result'=>$result]);}catch(\Throwable $e){log_message('error','âŒ cronFetchMarketingEmails() failed: '.$e->getMessage());return $this->failServerError('Inbox fetch failed: '.$e->getMessage());}}public function distributeHighScoreContent(){try{$this->getMyMIMarketing()->autoSendToZapier(80);return $this->respond(['status'=>'success','message'=>'Top scoring posts sent to Zapier']);}catch(\Throwable $e){return $this->failServerError($e->getMessage());}}public function exportBufferPosts(){helper('text');$model=new \App\Models\MarketingModel();$bufferPosts=$model->fetchBufferPostsForScoring();$filename='buffer-posts-'.date('Ymd_His').'.csv';$csvHeader=['ID','Keyword','Summary','Score','Tag Score','Category','Status','Created At'];$csvData=[$csvHeader];foreach($bufferPosts as $post){$csvData[]=[$post['id'],$post['keyword'],word_limiter(strip_tags($post['summary']),10),$post['score'],$post['tag_score'],$post['category'],$post['status'],$post['created_at']?? '',];}header('Content-Type: text/csv');header("Content-Disposition: attachment; filename=\"$filename\"");$f=fopen('php://output','w');foreach($csvData as $row){fputcsv($f,$row);}fclose($f);exit;}public function fetchBufferPaginated(){$request=service('request');$page=(int) $request->getGet('page')?? 1;$limit=(int) $request->getGet('limit')?? 20;$keyword=$request->getGet('keyword');$category=$request->getGet('category');$minTagScore=$request->getGet('min_tag_score')?? 0;$onlySuggested=(bool) $request->getGet('only_suggested');$result=$this->marketingModel->fetchBufferPaginatedWithFilters(['page'=>$page,'limit'=>$limit,'keyword'=>$keyword,'category'=>$category,'min_tag_score'=>$minTagScore,'only_suggested'=>$onlySuggested]);return $this->respond(['status'=>'success','data'=>$result['data'],'pagination'=>$result['pagination']]);}public function fetchGeneratedSummaries(){try{$summaries=$this->marketingModel->getRecentPosts(5);return $this->respond(['status'=>'success','summaries'=>$summaries,]);}catch(\Throwable $e){log_message('error','âŒ fetchGeneratedSummaries Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function fetchGeneratedSummariesBlock(){try{helper('text');$todaysStory=$this->marketingModel->where('DATE(created_at)',date('Y-m-d'))->orderBy('created_at','desc')->findAll();return $this->renderTheme('App\Modules\Management\Views\Marketing\index/generatedSummariesBlock',['todaysStory'=>$todaysStory]);}catch(\Throwable $e){log_message('error','âŒ Failed to fetch summaries block: '.$e->getMessage());return $this->failServerError('Unable to refresh summaries.');}}public function generateContentFromScraper(){try{$this->getMyMIMarketing()->generateFromTempScraper(25);return $this->respond(['status'=>'success','message'=>'Content generated from scraper.']);}catch(\Throwable $e){log_message('error','âŒ generateContentFromScraper Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function generateContentDigestFromStored(){$records=$this->marketingModel->getRecentUnprocessedTempEmails(5);$processedTitles=[];foreach($records as $record){$recordId=$record['id']?? 0;try{if(empty($record['title'])){$record['title']='Fallback Title - ID '.$recordId;}$insertResult=$this->getMyMIMarketing()->generateContentAndInsert($record);if($insertResult){$this->marketingModel->markTempScraperProcessed($recordId);$processedTitles[]=$insertResult['title'];log_message('info',"âœ… Inserted content for ID {$recordId}");}else{log_message('warning',"âš ï¸ Skipped record ID {$recordId} â€” summary not stored");}}catch(\Throwable $e){log_message('error',"âŒ Exception on record ID {$recordId}: {$e->getMessage()}");}}return $this->respond(['status'=>'complete','processed_titles'=>$processedTitles]);}public function generateDailyContentDigest(){@ini_set('memory_limit','768M');$records=$this->marketingModel->getValidUnprocessedEmails(5);$insertedSummaries=[];foreach($records as $record){if(!is_array($record)){log_message('error','âŒ Invalid record structure: Expected array, got '.gettype($record));continue;}try{log_message('debug','ðŸ” Processing record ID '.$record['id']);$result=$this->getMyMIMarketing()->generateContentAndInsert($record);if($result){$this->marketingModel->markTempScraperProcessed($record['id']);$insertedSummaries[]=$result['title']?? '(no title)';log_message('info',"âœ… Successfully processed and inserted record ID {$record['id']}");}else{log_message('warning',"âš ï¸ Skipped or failed to insert record ID {$record['id']}");}}catch(\Throwable $e){log_message('error',"âŒ Exception on record ID {$record['id']}: ".$e->getMessage());}}return $this->respond(['status'=>'success','inserted'=>$insertedSummaries]);}public function generatePostsFromSummary($summaryId=null){try{$summary=$this->marketingModel->find($summaryId);if(!$summary){return $this->failNotFound('Summary not found.');}$decodedTitleRaw=$summary['title']?? '';$decodedSummaryRaw=$summary['summary']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$decodedSummary=quoted_printable_decode($decodedSummaryRaw);$decodedSummary=preg_replace('/=\r?\n/','',$decodedSummary);$decodedSummary=html_entity_decode($decodedSummary,ENT_QUOTES|ENT_HTML5,'UTF-8');$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$decodedTitle);$cleanedSummary=html_entity_decode(strip_tags($decodedSummary));$keywords=$this->MyMIMarketing->extractKeywords($cleanedSummary);$posts=$this->MyMIMarketing->generateSocialPosts($cleanedSummary,$keywords);$this->marketingModel->update($summaryId,['keywords'=>json_encode($keywords),'posts'=>json_encode($posts),]);return $this->respond(['status'=>'success','message'=>'Content generated and stored successfully.','original'=>$summary,'cleaned'=>['title'=>$cleanTitle,'summary'=>$cleanedSummary,'keywords'=>$keywords,'posts'=>$posts,],]);}catch(\Throwable $e){log_message('error','âŒ generatePostsFromSummary() failed: '.$e->getMessage());return $this->failServerError('Error generating posts.');}}public function generateScheduledPosts(){helper('text');$marketingModel=new MarketingModel();$marketing=new MyMIMarketing();$buffer=$marketingModel->getTopBufferPosts(3,6.5);if(empty($buffer)){return $this->respond(['status'=>'empty','message'=>'No queued posts available.']);}foreach($buffer as $post){$marketingModel->updateBufferItem($post['id'],['status'=>'promoted']);$generated=$marketing->generateSocialPost($post);if(json_decode($post['platforms'])->discord ?? false){$marketing->distributeContent('discord',$generated['discord']);}if(json_decode($post['platforms'])->linkedin ?? false){$marketing->distributeContent('linkedin',$generated['linkedin']);}$marketing->notifyModerators($post);}return $this->respond(['status'=>'success','message'=>'Posts published!']);}public function generateVoiceScriptManually(){try{log_message('info','ðŸŽ¤ generateVoiceScriptManually() triggered.');$script=$this->getMyMIMarketing()->generateVoiceoverScript();return $this->response->setJSON(['status'=>'success','script'=>$script]);}catch(\Throwable $e){log_message('error','âŒ Error in generateVoiceScriptManually: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()]);}}public function massResendActivationEmails(){$userModel=new \App\Models\UserModel();$users=$userModel->getPendingActivationUsers();$activator=service('activator');$success=0;$failure=0;foreach($users as $user){if($activator->send($user)){$success++;}else{$failure++;}}return $this->respond(['status'=>'success','message'=>"$success emails sent, $failure failed."]);}public function monitorKeywordsAndScrape(){log_message('info','ðŸ§  Keyword Monitor Started');$keywords=$this->getMyMIMarketing()->getKeywordCandidates();if(empty($keywords)){return $this->respond(['status'=>'no_keywords']);}$results=[];foreach($keywords as $keyword){try{$scrapedData=$this->getMyMIMarketing()->scrapeGoogleSearch($keyword);if(!empty($scrapedData)){$summary=$this->getMyMIMarketing()->generateContentFromScrapedData($scrapedData,'generic');if($summary){$score=$this->getMyMIMarketing()->scoreKeywordRelevance($keyword,$summary);$results[]=['keyword'=>$keyword,'summary'=>$summary,'score'=>$score];$this->marketingModel->storeFinalMarketingContent(['source_id'=>null,'title'=>"Keyword: $keyword",'summary'=>$summary,'keywords'=>$keyword,'score'=>$score,'created_at'=>date('Y-m-d H:i:s')]);}}}catch(\Throwable $e){log_message('error',"âŒ Failed keyword scrape for {$keyword}: ".$e->getMessage());}}return $this->respond(['status'=>'complete','processed'=>$results]);}public function processMarketingTempEmails($limit=5,$mode='daily',$id=null){try{log_message('debug',"ðŸ§  Running unified email processor with mode={$mode}, limit={$limit}, id={$id}");if($id){$record=$this->marketingModel->getEmailRecordById($id);if(!$record||empty($record['content'])){return $this->failNotFound("No valid temp email record found for ID {$id}");}$cleanText=strip_tags($record['content']);$summary=$this->getMyMIMarketing()->summarizeText($cleanText);$keywords=$this->getMyMIMarketing()->extractKeywords($cleanText);if(empty($summary)||empty($keywords)){return $this->fail("Failed to generate summary or keywords for record ID {$id}");}$testPosts=['discord'=>"ðŸ’¬ *{$record['title']}*: {$summary} #".implode(' #',$keywords),'linkedin'=>"ðŸ“¢ {$record['title']} â€” {$summary}",'email'=>"Subject: {$record['title']}\n\n{$summary}",'x'=>substr($summary,0,250).'...'];$generated=['summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts];$this->marketingModel->insertFinalScraper($record,$generated);$this->marketingModel->markTempScraperProcessed($id);return $this->respond(['status'=>'success','message'=>"âœ… Test record stored for ID {$id}",'summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts]);}$records=($mode==='backfill')?$this->marketingModel->getOlderUnprocessedEmails($limit):$this->marketingModel->getValidUnprocessedEmails($limit);$results=[];foreach($records as $record){$recordId=$record['id']?? 0;if(empty($record['title'])){$record['title']="Fallback Title - ID {$recordId}";}try{$insert=$this->getMyMIMarketing()->generateContentAndInsert($record);if($insert){$this->marketingModel->markTempScraperProcessed($recordId);log_message('info',"âœ… Inserted record ID {$recordId}");$results[]=$insert['title'];}else{log_message('warning',"âš ï¸ Skipped ID {$recordId} â€” No summary generated.");}}catch(\Throwable $e){log_message('error',"âŒ Exception on ID {$recordId}: ".$e->getMessage());}}return $this->respond(['status'=>'success','mode'=>$mode,'inserted'=>$results]);}catch(\Throwable $e){return $this->failServerError("ðŸ”¥ Unified content processor failed: ".$e->getMessage());}}public function rankBufferPostsDaily(){$marketingModel=new MarketingModel();$marketing=new MyMIMarketing();$threshold=getenv('MARKETING_TFIDF_THRESHOLD')?:7.5;$pendingPosts=$marketingModel->getPendingBufferItems();foreach($pendingPosts as $post){$scoreData=$marketing->getTopKeywordScores(['summary'=>$post['summary'],]);$update=['score'=>$scoreData['score']?? 0,'tag_score'=>$scoreData['tag_score']?? 0,'tfidf_score'=>$scoreData['tfidf_score']?? 0,'auto_suggest'=>($scoreData['tfidf_score']?? 0)>=$threshold?1:0,];$marketingModel->updateBufferItem($post['id'],$update);}return $this->respond(['status'=>'success','message'=>'Buffer ranks updated.']);}public function rejectBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Record not found.");$this->marketingModel->updateBufferItem($id,['status'=>'rejected']);return $this->respond(['status'=>'success','message'=>'Content rejected.']);}public function runBackfillForTempEmails(){try{log_message('info','[ðŸ”„ Backfill] Starting backfill for unprocessed temp emails...');$unprocessedRecords=$this->marketingModel->where('status',null)->orWhere('status','')->findAll(25);if(empty($unprocessedRecords)){return $this->respond(['status'=>'complete','message'=>'No unprocessed records found.']);}$processedTitles=[];foreach($unprocessedRecords as $record){try{$result=$this->MyMIMarketing->generateContentAndInsert($record);if($result){$this->marketingModel->markTempScraperProcessed($record['id']);$processedTitles[]=$result['title'];}}catch(\Throwable $e){log_message('error','[âŒ Backfill Error] ID '.$record['id'].' â€” '.$e->getMessage());}}return $this->respond(['status'=>'success','processed'=>$processedTitles]);}catch(\Throwable $e){return $this->failServerError('[ðŸ”¥ Backfill Failure] '.$e->getMessage());}}public function testGenerateFromTempEmail($id){try{helper('text');$record=$this->marketingModel->getEmailRecordById($id);if(!$record||empty($record['content'])){return $this->failNotFound("No valid temp email record found for ID {$id}");}log_message('info',"ðŸ§ª Starting test content generation for temp record ID: {$id}");$cleanText=strip_tags($record['content']);$summary=$this->getMyMIMarketing()->summarizeText($cleanText);$summary=quoted_printable_decode($summary);$summary=mb_convert_encoding($summary,'UTF-8','UTF-8');$keywords=$this->getMyMIMarketing()->extractKeywords($cleanText);if(empty($summary)||empty($keywords)){return $this->fail("Failed to generate summary or keywords for record ID {$id}");}$decodedTitleRaw=$record['title']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$decodedTitle);$testPosts=['discord'=>"ðŸ’¬ *{$cleanTitle}*: {$summary} #".implode(' #',$keywords),'linkedin'=>"ðŸ“¢ {$cleanTitle} â€” {$summary}",'email'=>"Subject: {$cleanTitle}\n\n{$summary}",'x'=>substr($summary,0,250).'...',];$generated=['summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts];$this->marketingModel->insertFinalScraper($record,$generated);$this->marketingModel->markTempScraperProcessed($id);log_message('info',"âœ… Test record stored in bf_marketing_scraper for temp ID {$id}");return $this->respond(['status'=>'success','message'=>"Content generated and stored successfully.",'summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts]);}catch(\Throwable $e){log_message('critical',"âŒ testGenerateFromTempEmail({$id}) failed: ".$e->getMessage());return $this->failServerError("An error occurred: ".$e->getMessage());}}public function testTfIdfEdgeCases(){$cases=['Empty String'=>'','Whitespace Only'=>'     ','Single Word'=>'Bitcoin','HTML Only'=>'<div><p></p></div>','Malformed UTF-8'=>"\xB1\x31",'Link-Only Spam'=>'http://marketwatch.com https://example.com','Token Noise'=>str_repeat('$$$!!!@@@###',10),];$results=[];foreach($cases as $label=>$input){try{log_message('info',"ðŸ§ª Running TF-IDF Test Case: $label");$cleanInput=is_string($input)?strip_tags(trim($input)):'';if(strlen($cleanInput)<10||substr_count($cleanInput,' ')<2){log_message('debug',"âš ï¸ Skipping test: $label â€” input too short or lacks structure.");$results[$label]='[Skipped â€” Too short or unstructured]';continue;}$summary=$this->MyMIMarketing->summarizeText($cleanInput);log_message('debug',"Result - Summary: $summary");$results[$label]=$summary;}catch(\Throwable $e){log_message('error',"âŒ $label threw error: ".$e->getMessage());$results[$label]='[Error: '.$e->getMessage().']';}}return $this->renderTheme('App\Modules\Management\Views\Marketing\debugTfIdfResults',['results'=>$results,]);}public function triggerPostAutogenOnEmpty(){try{$existingPosts=$this->marketingModel->where('DATE(scraped_at)',date('Y-m-d'))->countAllResults();if($existingPosts===0){log_message('debug','[ðŸª„ AutoGen Trigger] No posts found for today. Running fallback generatorâ€¦');$this->marketingService->generatePostsFromTodaysSummaries();return $this->respond(['status'=>'success','message'=>'No posts found. Generated fresh content.']);}else{return $this->respond(['status'=>'success','message'=>'Posts already exist for today. No action taken.']);}}catch(\Throwable $e){log_message('error','[âŒ AutoGen Trigger Error] '.$e->getMessage());return $this->respond(['status'=>'error','message'=>'Failed to trigger autogen.','error'=>$e->getMessage()]);}}public function updateBufferScheduleInterval($id){$data=$this->request->getJSON(true);$interval=(int)($data['interval']?? 0);$updated=$this->marketingModel->updateBufferItem($id,['schedule_interval'=>$interval,'scheduled_at'=>null ]);if($updated){return $this->respond(['status'=>'success']);}else{return $this->fail('Failed to update interval.');}}public function updatePlatformToggle($id){$data=$this->request->getJSON(true);$platform=$data['platform'];$enabled=$data['enabled'];$record=$this->marketingModel->find($id);if(!$record){return $this->failNotFound("Record not found.");}$platforms=json_decode($record['platforms']?? '{}',true);$platforms[$platform]=$enabled;$this->marketingModel->update($id,['platforms'=>json_encode($platforms)]);return $this->respond(['status'=>'success']);}} ?><?php namespace App\Libraries;use App\Config\{SiteSettings,SocialMedia};use App\Libraries\{BaseLoader,MyMIInvestments};use App\Libraries\Traits\TextProcessor;use App\Models\{AnalyticalModel,MarketingModel};use App\Services\{EmailService,MarketingService,SolanaService};use CodeIgniter\HTTP\RequestInterface;use CodeIgniter\Session\Session;use Myth\Auth\Authorization\GroupModel;use Exception;use HTMLPurifier;use HTMLPurifier_Config;use Phpml\FeatureExtraction\TokenCountVectorizer;use Phpml\Tokenization\WhitespaceTokenizer;use Phpml\FeatureExtraction\TfIdfTransformer;use NlpTools\Tokenizers\WhitespaceTokenizer as NlpWhitespaceTokenizer;use NlpTools\Similarity\CosineSimilarity;use Facebook\Facebook;use Abraham\TwitterOAuth\TwitterOAuth;use Happyr\LinkedIn\LinkedIn;use Discord\Discord;use Discord\Parts\Channel\Message;use GuzzleHttp\Client;use Scrapemax\ScrapemaxClient;use Pscrape\Pscrape\Scrape as PscrapeScraper;use Symfony\Component\DomCrawler\Crawler;use Google\Cloud\TextToSpeech\V1\TextToSpeechClient;use Google\Cloud\TextToSpeech\V1\SynthesisInput;use Google\Cloud\TextToSpeech\V1\VoiceSelectionParams;use Google\Cloud\TextToSpeech\V1\AudioConfig;use Google\Cloud\TextToSpeech\V1\AudioEncoding;class MyMIMarketing{use BaseLoader;use TextProcessor;protected $auth;protected $cuID;protected $data;protected $debug;protected $logger;protected $request;protected $session;protected $uri;protected $APIs;protected $emailService;protected $solanaService;protected $siteSettings;protected $marketingModel;protected $analyticalModel;protected $socialMedia;protected $facebook;protected $twitter;protected $linkedin;protected $discord;protected $scrapemax;protected $pscrape;public function __construct(){$this->auth=service('authentication');$this->logger=service('logger');$this->request=service('request');$this->session=service('session');$this->uri=$this->request->getUri();$this->APIs=config('APIs');$this->socialMedia=config('SocialMedia');$this->siteSettings=config('SiteSettings');$this->debug=$this->siteSettings->debug;$this->socialMedia=config('SocialMedia');$this->marketingModel=new MarketingModel();$this->analyticalModel=new AnalyticalModel();$this->emailService=service('email');$this->solanaService=new SolanaService();$this->scrapemax=new ScrapemaxClient('https://api.scrapemax.com',$this->APIs->scrapemax_api_key);$this->pscrape=new PscrapeScraper();}public function marketing(){$department=$this->department();$links=$this->social_media();return['links'=>$links,'department'=>$department];}public function distributeTradeAlert($alert,$action='BUY'){$message=$this->generateTradeAlertMessage($alert,$action);$this->postToDiscord($message);$this->postToTwitter($message);$this->postToFacebook($message);$this->postToLinkedIn($message);}public function generateRandomMarketingContent(array $tradeAlert):array{$intros=["ðŸš¨ Breaking Market Update!","ðŸ“¢ Urgent Trade Alert!","ðŸ”¥ High-Momentum Stock Pick!","ðŸš€ Skyrocketing Stocks!","ðŸ’° Smart Money Moves!","âš¡ Quick Market Insight!","ðŸ“ˆ Bullish Breakout Alert!","ðŸ“Š Technical Setup Unfolding!","ðŸ§ Deep Market Analysis!","ðŸ’¡ Pro-Level Trading Insight!"];$emoticons=['ðŸš€','ðŸ”¥','ðŸ’°','ðŸ“ˆ','ðŸ“Š','âš¡','âœ…','ðŸ¤–','ðŸŽ¯','ðŸ”'];$outros=["ðŸ“Š Stay ahead of the markets!","â³ Don't miss this setup!","ðŸ’° Trade smart & maximize gains!","ðŸš€ Follow for more trade alerts!","ðŸ“ˆ Watch this ticker closely!","ðŸ”¥ This could be the next big mover!","ðŸ’¡ Insights that matter. Stay tuned!","ðŸ’Ž Precision trading at its best!","âš¡ More insights coming soon!","ðŸ“¢ Tap in for more premium setups!"];$intro=$intros[array_rand($intros)];$outro=$outros[array_rand($outros)];$emote1=$emoticons[array_rand($emoticons)];$emote2=$emoticons[array_rand($emoticons)];$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$tradeDesc=trim($tradeAlert['trade_description']?? '');$news=trim($tradeAlert['financial_news']?? '');$details=trim($tradeAlert['details']?? '');$price=number_format($tradeAlert['price']?? 0,2);$link=trim($tradeAlert['tv_chart']?? $tradeAlert['tv_chart_link']?? '');$chartText=(!empty($link))?"ðŸ“‰ Chart: [View Here]({$link})\n":'';$fixedLength=strlen($intro)+strlen($outro)+strlen($emote1)+strlen($emote2)+strlen($chartText)+12;$maxMessageLength=2000-$fixedLength;$coreMessage="Trade Alert for **{$ticker}** ({$company}):\n"."Price: \${$price}\n"."Signal: {$tradeDesc}\n"."News: {$news}\n"."Details: {$details}\n".$chartText;if(strlen($coreMessage)>$maxMessageLength){$coreMessage=substr($coreMessage,0,$maxMessageLength-3)."...";}$finalMessage="{$emote1} {$intro}\n{$coreMessage}\n{$outro} {$emote2}";return['twitter'=>substr($finalMessage,0,280),'facebook'=>substr($finalMessage,0,2000),'linkedin'=>substr($finalMessage,0,2000),'discord'=>substr($finalMessage,0,2000)];}public function generateEmailContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$news=$tradeAlert['financial_news']?? '';$details=$tradeAlert['details']?? '';$content="Email Alert for {$ticker} ({$company}):\n"."Current Price: \${$price}\n"."Trade Signal: {$tradeDesc}\n"."Latest News: {$news}\n"."Analysis Details: {$details}\n"."For more information, visit our website.";return $content;}public function generateBlogContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$news=$tradeAlert['financial_news']?? '';$details=$tradeAlert['details']?? '';$content="Blog Post: In-depth Market Analysis on {$ticker} ({$company})\n\n"."Current Price: \${$price}\n\n"."Trade Analysis: {$tradeDesc}\n\n"."Financial News: {$news}\n\n"."Detailed Analysis: {$details}\n\n"."Stay tuned for more insights!";return $content;}public function generateVoiceoverScriptContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$script="Voiceover Script:\n"."Welcome to today's market update. Our focus is on {$ticker} from {$company}.\n"."The current trading price is \${$price}.\n"."Trade insight: {$tradeDesc}.\n"."Thank you for watching. Stay tuned for more updates.";return $script;}public function generateTradeAlertEmailContent(array $tradeAlert):string{$defaultTemplate=<<<S
app/Modules/chatgpt.txt:44:S;}public function formatSocialPost(string $headline,string $summary,string $platform='generic'):string{$hashtags='#MyMIWallet #InvestSmarter #FinancialFreedom';switch($platform){case 'facebook':case 'linkedin':return"{$headline}\n\n{$summary}\n\nStart your journey: https://www.mymiwallet.com\n\n{$hashtags}";case 'twitter':case 'x':$shortSummary=substr($summary,0,180);return"{$headline} â€” {$shortSummary}...\nhttps://www.mymiwallet.com\n{$hashtags}";default:return"{$headline}\n\n{$summary}\nhttps://www.mymiwallet.com";}}public function formatDiscordPost(string $headline,string $summary):string{return"**{$headline}**\n\n{$summary}\n\nðŸ‘‰ <https://www.mymiwallet.com>";}private function normalizeUtf8($text){return mb_convert_encoding($text,'UTF-8',mb_detect_encoding($text,'UTF-8, ISO-8859-1',true));}private function notifyAdminOnError($subject,$message){$this->emailService->setFrom('no-reply@mymiwallet.com','MyMI Wallet');$this->emailService->setTo('team@mymiwallet.com');$this->emailService->setSubject($subject);$this->emailService->setMessage($message);if(!$this->emailService->send()){$this->logger->error('Failed to send error notification email: '.print_r($this->emailService->printDebugger(),true));}}public function notifyModerators(array $post){$platforms=json_decode($post['platforms']?? '{}',true);$used=implode(', ',array_keys(array_filter($platforms)));$subject="ðŸ“¢ Buffer Post Promoted: {$post['keyword']}";$message="âœ… Post ID: {$post['id']}\n\n"."Summary: ".wordwrap($post['summary'],80)."\n\n"."Promoted Platforms: {$used}\n\n".site_url('Marketing/PreviewGeneratedPost/'.$post['id']);$email=\Config\Services::email();$email->setTo('moderators@mymiwallet.com');$email->setSubject($subject);$email->setMessage($message);$email->send();log_message('info',"ðŸ“¬ Sent moderator alert for Buffer ID {$post['id']}");}public function reprocessIncompleteEmails(){$incompleteRecords=$this->marketingModel->getEmailsMissingTitleOrUrl(20);log_message('debug','ðŸ“‹ MyMIMarketing L986 - Incomplete records fetched: '.count($incompleteRecords));foreach($incompleteRecords as $record){try{$emailId=$record['message_id']?? null;$content=$record['content']?? '';$title=$record['title']?? '';$url=$record['url']?? '';if(!$emailId)continue;$email=$this->fetchEmailByMessageId($emailId);if($email){$content=$email['body']?? $content;$title=$email['subject']?? $title;$url=$email['link']?? $url;}$title=$title?:'Untitled Email - '.date('Y-m-d H:i');$url=$url?:'https://mymiwallet.com/news/fallback';$this->marketingModel->updateEmailFields($record['id'],$title,$url,$content);}catch(\Throwable $e){log_message('error','âŒ Error backfilling email ID '.$record['id'].': '.$e->getMessage());}}}private function retry($function,$attempts=3,$delay=2000){$attempt=0;while($attempt<$attempts){try{return $function();}catch(Exception $e){$attempt++;if($attempt>=$attempts){throw $e;}sleep($delay/1000);}}}private function sanitizeContent($content){$content=preg_replace('#<script(.*?)>(.*?)</script>#is','',$content);$content=preg_replace('#<noscript(.*?)>(.*?)</noscript>#is','',$content);$content=strip_tags($content)?? '';$content=preg_replace('/\.\s*/','. ',$content);return $content;}public function sanitizeRawEmailContent(string $rawContent):string{log_message('debug','ðŸ§ª MyMIMarketing L1140 - Raw Email Before Cleaning: {raw}',['raw'=>$rawContent]);$clean=preg_replace("/=\r\n|\=\n/",'',$rawContent);$clean=quoted_printable_decode($clean);$clean=html_entity_decode($clean,ENT_QUOTES|ENT_HTML5,'UTF-8');$clean=strip_tags($clean);$clean=preg_replace('/\s+/',' ',$clean);$clean=mb_convert_encoding($clean,'UTF-8','UTF-8');log_message('debug','âœ… MyMIMarketing L1159 - Cleaned Email Output: {clean}',['clean'=>$clean]);return trim($clean);}private function sanitizeText(string $text):string{return strip_tags(html_entity_decode($text));}public function saveTradingViewChart($chartUrl,$ticker){$saveDir=FCPATH.'assets/images/Alerts/Charts/';if(!is_dir($saveDir)){mkdir($saveDir,0777,true);}$timestamp=time();$filename="{$ticker}_chart_{$timestamp}.jpg";$savePath=$saveDir.$filename;$ch=curl_init($chartUrl);$fp=fopen($savePath,'wb');curl_setopt($ch,CURLOPT_FILE,$fp);curl_setopt($ch,CURLOPT_HEADER,0);curl_exec($ch);curl_close($ch);fclose($fp);if(file_exists($savePath)){return $filename;}else{return null;}}public function scoreKeywordRelevance(string $keyword,string $summary):int{$keyword=strtolower($keyword);$summaryText=strtolower(strip_tags($summary));$totalWords=str_word_count($summaryText);if($totalWords===0)return 0;$matches=substr_count($summaryText,$keyword);$score=min(100,round(($matches/$totalWords)*500));return $score;}public function scrapeTokenContent($tokenInfo){$scrapedData=[];foreach($tokenInfo as $token){if(!empty($token['website'])){log_message('debug','MyMIMarketing L101 - $token[website]: '.$token['website']);$websiteData=$this->scrapeWebsite($token['website']);log_message('debug','MyMIMarketing L103 - $websiteData: '.print_r($websiteData,true));$this->storeTemporaryData($websiteData);$scrapedData[]=$websiteData;}if(!empty($token['facebook'])){log_message('debug','MyMIMarketing L109 - $token[facebook]: '.$token['facebook']);$facebookData=$this->scrapeFacebook($token['facebook']);log_message('debug','MyMIMarketing L111 - $facebookData: '.print_r($facebookData,true));$this->storeTemporaryData($facebookData);$scrapedData[]=$facebookData;}if(!empty($token['twitter'])){log_message('debug','MyMIMarketing L117 - $token[twitter]: '.$token['twitter']);$twitterData=$this->scrapeTwitter($token['twitter']);log_message('debug','MyMIMarketing L119 - $twitterData: '.print_r($twitterData,true));$this->storeTemporaryData($twitterData);$scrapedData[]=$twitterData;}log_message('debug','MyMIMarketing L117 - $token[symbol] $token[name]: '.$token['symbol'].' '.$token['coin_name']);$googleData=$this->scrapeGoogleSearch($token['symbol'].' '.$token['coin_name']);$this->storeTemporaryData($googleData);$scrapedData[]=$googleData;}return $scrapedData;}public function scrapeAndGenerateContent($accountid,$category,$platform=null){$generatedData=[];if($category==='Solana'){$this->solanaModel=new SolanaModel();$tokenInfo=$this->solanaModel->getTokenInfoByID($accountid);}else{$tokenInfo=[];}if(!empty($tokenInfo)){$scrapedData=[];try{log_message('debug','Attempting to scrape token content.');$scrapedData=$this->scrapeTokenContent($tokenInfo);log_message('debug','Scraped Data: '.print_r($scrapedData,true));}catch(\GuzzleHttp\Exception\ClientException $e){if($e->getResponse()->getStatusCode()==403){log_message('critical','403 Forbidden encountered while scraping website: '.$e->getMessage());}else{log_message('critical','ClientException: '.$e->getMessage());}}catch(\Exception $e){log_message('critical','An error occurred while scraping token content: '.$e->getMessage());}try{if(!empty($scrapedData)){log_message('debug','Attempting to generate content from scraped data.');$generatedData=$this->generateContentFromScrapedData($scrapedData,$platform);log_message('debug','Generated Data: '.print_r($generatedData,true));}else{log_message('debug','Scraped data is empty.');}}catch(\Exception $e){log_message('critical','An error occurred while generating content: '.$e->getMessage());}}else{log_message('debug','Token information is empty.');}return $generatedData;}private function scrapeWebsite($url){try{$client=new Client();$response=$client->get($url);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$crawler=new \Symfony\Component\DomCrawler\Crawler($html);return['title'=>$crawler->filter('title')->text(),'content'=>$this->sanitizeContent($crawler->filter('body')->html()),];}}catch(RequestException $e){$this->logger->error('Error scraping website: '.$e->getMessage());}return[];}private function scrapeFacebook($url){return $this->scrapeWithRetries('facebook',$url,function($content){return['title'=>$content['page_title']?? 'No title','content'=>$this->sanitizeContent($content['posts']?? 'No posts'),];});}private function scrapeTwitter($url){return $this->scrapeWithRetries('twitter',$url,function($content){return['title'=>$content['profile']?? 'No title','content'=>$this->sanitizeContent($content['tweets']?? 'No tweets'),];});}private function scrapeWithRetries($type,$url,$transform,$retries=3){$backoff=1;for($i=0;$i<$retries;$i++){try{$response=$this->scrapemax->scrape(['target_url'=>$url,'type'=>'data','js_enabled'=>1,'base64_encoded'=>0]);$content=json_decode($response->getBody()->getContents(),true);if(empty($content)){throw new \Exception("No content returned");}return $transform($content);}catch(ServerException $e){if($i<$retries-1){sleep($backoff);$backoff*=2;continue;}$this->logger->error("Error scraping $type: ".$e->getMessage());}catch(RequestException $e){$this->logger->error("Error scraping $type: ".$e->getMessage());break;}catch(\Exception $e){$this->logger->error("General error scraping $type: ".$e->getMessage());break;}}return['title'=>'No title','content'=>'No content'];}private function scrapeGoogleSearch($query){try{$results=$this->pscrape->rollingCurl('rollingCurl');$results->request('https://www.google.com/search?q='.urlencode($query));$content='';$resultsData=$results->execute();if(!is_array($resultsData)){throw new \Exception("Google search did not return an array");}foreach($resultsData as $result){$content.=$result['title'].' '.$result['link'].' ';}return['title'=>'Google Search Results for '.$query,'content'=>$this->sanitizeContent($content),];}catch(\Exception $e){$this->logger->error('Error scraping Google Search: '.$e->getMessage());}return[];}public function sendZapierTradeAlert($tradeAlert){$zapierWebhookUrl="YOUR_ZAPIER_WEBHOOK_URL";$payload=json_encode(['ticker'=>$tradeAlert['ticker'],'price'=>$tradeAlert['price'],'sentiment'=>$tradeAlert['market_sentiment'],'chart_link'=>$tradeAlert['link'],'created_on'=>$tradeAlert['created_on']]);$ch=curl_init($zapierWebhookUrl);curl_setopt($ch,CURLOPT_HTTPHEADER,['Content-Type: application/json']);curl_setopt($ch,CURLOPT_POST,1);curl_setopt($ch,CURLOPT_POSTFIELDS,$payload);curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);$response=curl_exec($ch);curl_close($ch);return $response;}public function standaloneScrapeWebsite($url){try{$client=new Client();$response=$client->get($url);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$crawler=new Crawler($html);$content=$crawler->filter('body')->each(function($node){return $node->text();});$content=array_filter($content,function($text){return!str_contains($text,'footer')&&!str_contains($text,'head');});$data=['url'=>$url,'content'=>implode(' ',$content),'scraped_at'=>date('Y-m-d H:i:s')];$this->saveTemporaryScrapedData($data);return $data;}else{log_message('error','Failed to scrape website. HTTP status code: '.$response->getStatusCode());}}catch(RequestException $e){log_message('error','RequestException while scraping website: '.$e->getMessage());}catch(\Throwable $th){log_message('error','Throwable error while scraping website: '.$th->getMessage());}return false;}public function saveTemporaryScrapedData($data){$marketingModel=new \App\Models\MarketingModel();return $this->marketingModel->insertTemporaryData($data);}private function storeTemporaryData($data){if(!empty($data)){$this->marketingModel->insertTemporaryData($data);}else{$this->logger->warning('Attempted to store empty data.');}}private function selectSummarySentences($sentences,$scores,$topN=5){arsort($scores,SORT_NUMERIC);$topSentenceIndexes=array_keys(array_slice($scores,0,$topN,true));$summary=array_intersect_key($sentences,array_flip($topSentenceIndexes));usort($summary,function($a,$b)use($sentences){return array_search($a,$sentences)-array_search($b,$sentences);});return $summary;}private function splitIntoSentences($content){$content=preg_replace('/\s+/',' ',trim($content));$sentences=preg_split('/(?<=[.!?])\s+/',$content,-1,PREG_SPLIT_NO_EMPTY);return array_filter($sentences,function($sentence){return strlen(trim($sentence))>0;});}public function summarize($text,$method='textrank',$charLimit=500){$text=$this->cleanText($text);if($method==='tfidf'){return $this->summarizeText($text);}else{return $this->summarizeContent($text,$charLimit);}}public function summarizeContent($content,$charLimit=500){if(empty(trim($content))){$this->logger->error('$content is Empty for summarizeContent() function');return[];}$sentences=$this->splitIntoSentences($content);if(empty($sentences)){log_message('warning','âš ï¸ MyMIMarketing L1306 - summarizeContent(): No valid sentences found in content.');return null;}if(empty($sentences)){$this->logger->error('No sentences found for summarization');return[];}$tokens=$this->tokenizeWithNlpTools($content);$features=$this->extractFeaturesWithPhpMl($content);$wordFrequencies=$this->calculateWordFrequencies($content,$this->getStopWords());$similarityMatrix=$this->buildSimilarityMatrix($sentences,$wordFrequencies);$scores=$this->pageRank($similarityMatrix);$summary=$this->buildSummaryToCharLimit($sentences,$scores,$charLimit);$finalSummary=$this->convertUrlsToLinks($summary);return!empty($finalSummary)?['sentences'=>$sentences,'tokens'=>$tokens,'features'=>$features,'wordFrequencies'=>$wordFrequencies,'similarityMatrix'=>$similarityMatrix,'scores'=>$scores,'summary'=>$finalSummary,]:$summary;}public function summarizeContentFromHtml(string $html,$recordId=null):array{$html=quoted_printable_decode($html);$html=html_entity_decode($html,ENT_QUOTES|ENT_HTML5,'UTF-8');$html=preg_replace('/=\r?\n/','',$html);$plainText=strip_tags(html_entity_decode($html));$cleaned=$this->sanitizeRawEmailContent($plainText);if(strlen($cleaned)<300||substr_count($cleaned,' ')<20){$logSuffix=$recordId?" (ID: $recordId)":'';log_message('info',"[MyMIMarketing] summarizeContentFromHtml(): Skipping â€” content too short or lacks structure{$logSuffix}");return['summary'=>'','keywords'=>[]];}$cleaned=preg_replace('/\s{2,}/',' ',$cleaned);$summaryData=$this->summarizeContent($cleaned);if(!is_array($summaryData)||empty($summaryData['summary'])){return['summary'=>'','keywords'=>[]];}$keywords=$this->marketingModel->extractKeywords($cleaned);return['summary'=>$summaryData['summary'],'keywords'=>$keywords ??[],'featureScore'=>$summaryData['featureScore']?? null,'keywordScore'=>$summaryData['keywordScore']?? null,'pageRankScore'=>$summaryData['pageRankScore']?? null,'semanticDiversityScore'=>$summaryData['semanticDiversityScore']?? null,];}public function summarizeContentTextRank($content){$sentences=$this->splitIntoSentences($content);$similarityMatrix=$this->buildSimilarityMatrix($sentences);$scores=$this->pageRank($similarityMatrix);return $this->extractTopSentences($sentences,$scores);}public function summarizeText($text,$maxSentences=5){if(!is_string($text)||empty(trim($text))){log_message('error','summarizeText(): Empty or invalid input text provided.');return 'Summary not available.';}$sentences=$this->splitIntoSentences($text);if(empty($sentences)||count($sentences)<2){log_message('warning','summarizeText(): Not enough content to summarize.');return implode(' ',$sentences);}$vectorizer=new TokenCountVectorizer(new WhitespaceTokenizer());$vectorizer->fit($sentences);$vectorizer->transform($sentences);$tfidf=new TfIdfTransformer();try{$tfidf->fit($sentences);$tfidf->transform($sentences);}catch(\Throwable $e){log_message('error','summarizeText(): TF-IDF transform failed â€” '.$e->getMessage());return 'Summary unavailable due to processing error.';}$scores=[];foreach($sentences as $i=>$vector){$score=0;foreach($vector as $value){$score+=(float)$value;}$scores[$i]=$score;}arsort($scores);$topIndexes=array_slice(array_keys($scores),0,$maxSentences);sort($topIndexes);$originalSentences=$this->splitIntoSentences($text);$summary=implode(' ',array_map(fn($i)=>$originalSentences[$i],$topIndexes));return $summary;}private function tokenizeSmart($text,$method='nlp'){return $method==='nlp'?$this->tokenizeWithNlpTools($text):$this->tokenizeText($text);}private function tokenizeText($text){$text=strtolower(strip_tags($text));return preg_split('/\W+/',$text,-1,PREG_SPLIT_NO_EMPTY);}public function tokenizeWithNlpTools($content){$tokenizer=new NlpWhitespaceTokenizer();$tokens=$tokenizer->tokenize($content);$this->logger->debug('Tokens: '.print_r($tokens,true));return $tokens;}public function insertFinalScraper($record,$summary){$model=new MarketingModel();if(!isset($record['id'])||!$summary){log_message('error','âŒ Missing record ID or summary when calling insertFinalScraper()');return false;}$existing=$model->where('source_id',$record['id'])->first();if($existing){log_message('info',"âš ï¸ Final scrape already exists for source_id: {$record['id']}");return false;}$cleanSummary=mb_convert_encoding($summary['summary'],'UTF-8','UTF-8');$cleanTitle=isset($record['title'])?$record['title']:word_limiter($cleanSummary,12);$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$cleanTitle);$data=['source_id'=>$record['id'],'title'=>trim($cleanTitle),'summary'=>trim($cleanSummary),'keywords'=>isset($summary['keywords'])?implode(',',$summary['keywords']):'','date_created'=>date('Y-m-d H:i:s'),];$result=$model->insert($data);if($result){log_message('info',"âœ… Final scraped content inserted for source_id: {$record['id']}");}else{log_message('error',"âŒ Failed to insert final scrape for source_id: {$record['id']}");}return $result;}private function cleanText($text){$text=$this->decodeSpecialCharacters($text);$text=$this->sanitizeRawEmailContent($text);return $this->normalizeUtf8(strip_tags($text));}private function combineScores($featureScore,$keywordScore,$pageRankScore,$semanticDiversityScore){$featureScore=is_numeric($featureScore)?(float)$featureScore:0.0;$keywordScore=is_numeric($keywordScore)?(float)$keywordScore:0.0;$pageRankScore=is_numeric($pageRankScore)?(float)$pageRankScore:0.0;$semanticDiversityScore=is_numeric($semanticDiversityScore)?(float)$semanticDiversityScore:0.0;$combinedScore=0.4*$featureScore+0.2*$keywordScore+0.3*$pageRankScore+0.1*$semanticDiversityScore;$this->logger->debug('âœ… Combined Score for sentence: '.$combinedScore);return $combinedScore;}private function buildSimilarityMatrix($sentences,$wordFrequencies){$matrix=[];$sentenceLength=count($sentences);for($i=0;$i<$sentenceLength;$i++){for($j=0;$j<$sentenceLength;$j++){if($i!=$j){$matrix[$i][$j]=$this->calculateSimilarity($sentences[$i],$sentences[$j],$wordFrequencies);}}}return $matrix;}private function calculateSimilarity($sentence1,$sentence2,$wordFrequencies){$sentence1=is_string($sentence1)?strtolower($sentence1):'';$sentence2=is_string($sentence2)?strtolower($sentence2):'';$words1=array_unique(str_word_count($sentence1,1));$words2=array_unique(str_word_count($sentence2,1));$commonWords=array_intersect($words1,$words2);$score=0;foreach($commonWords as $word){$score+=(float)($wordFrequencies[$word]?? 0);}$logWordCount1=count($words1)>0?log(count($words1)):0;$logWordCount2=count($words2)>0?log(count($words2)):0;if($logWordCount1+$logWordCount2==0){return 0;}return $score/($logWordCount1+$logWordCount2);}private function calculateWordFrequencies($content,$stopWords){$frequencies=[];$words=preg_split('/\s+/',strtolower($content));foreach($words as $word){if(!in_array($word,$stopWords)&&strlen($word)>1){$frequencies[$word]=($frequencies[$word]?? 0)+1;}}arsort($frequencies);return $frequencies;}public function decodeMimeHeaderSafe($string){try{return mb_decode_mimeheader($string);}catch(\Throwable $e){log_message('error','decodeMimeHeaderSafe() failed: '.$e->getMessage());return $string;}}private function decodeSpecialCharacters($text){return html_entity_decode($text,ENT_QUOTES|ENT_HTML5,'UTF-8');}public function getScrapesByKeyword($keyword){return $this->marketingModel->getScrapesByKeyword($keyword);}private function getStopWords(){return["a","the","and","of","in","to","is","you","that","it","he","was","for","on","are","as","with","his","they","I","at","be","this","have","from","or","one","had","by","word","but","not","what","all","were","we","when","your","can","said","there","use","an","each","which","she","do","how","their","if","will","up","other","about","out","many","then","them","these","so","some","her","would","make","like","him","into","time","has","look","two","more","write","go","see","number","no","way","could","people","my","than","first","water","been","call","who","oil","its","now","find","long","down","day","did","get","come","made","may","part"];}public function getTopKeywordScores($content,$max=10){if(!is_string($content)){log_message('error','MyMIMarketing L1706 - getTopKeywordScores(): Content must be a string');return[];}$content=$this->normalizeUtf8($content);$sentences=$this->splitIntoSentences($content);if(empty($sentences)){log_message('error','MyMIMarketing L1713 - getTopKeywordScores(): No valid sentences to process');return[];}$tfIdf=new TfIdfTransformer();$tokenized=array_values(array_filter(array_map(function($sentence){$cleaned=strtolower($this->normalizeUtf8(trim($sentence)));$tokens=array_filter(explode(' ',$cleaned),fn($w)=>strlen($w)>1);return count($tokens)>0?$tokens:null;},$sentences)));if(empty($tokenized)||!isset($tokenized[0])||!is_array($tokenized[0])||empty($tokenized[0])){log_message('error','âŒ MyMIMarketing L1725 - Tokenized input invalid for TF-IDF. Tokenized: '.json_encode($tokenized));return[];}try{$tfIdf->fit($tokenized);log_message('debug','ðŸ“Š MyMIMarketing L1731 - TF-IDF Document Preview: '.json_encode(array_slice($tokenized,0,1)));$tfIdf->transform($tokenized);}catch(\Throwable $e){log_message('error','âŒ MyMIMarketing L1734 - TF-IDF error: '.$e->getMessage());return[];}$scores=[];foreach($tokenized as $docIndex=>$tokens){foreach($tokens as $token){if(!is_string($token))continue;if(!isset($scores[$token])){$scores[$token]=0.0;}$scores[$token]+=1.0;}}if(empty($scores)){log_message('error','âŒ MyMIMarketing L1752 - No TF-IDF scores generated');return[];}arsort($scores);return array_keys(array_slice($scores,0,$max,true));}private function isSemanticallyDifferent($sentence1,$sentence2,$tokens){$tokens1=array_intersect($tokens,str_word_count(strtolower($sentence1),1));$tokens2=array_intersect($tokens,str_word_count(strtolower($sentence2),1));$overlap=count(array_intersect($tokens1,$tokens2));$threshold=2;return $overlap<$threshold;}private function pageRank($matrix,$dampingFactor=0.85,$maxIterations=100,$tolerance=1e-6){$numSentences=count($matrix);if($numSentences==0){return[];}$pagerank=array_fill(0,$numSentences,1/$numSentences);$tempRank=array_fill(0,$numSentences,0);for($iter=0;$iter<$maxIterations;$iter++){for($i=0;$i<$numSentences;$i++){$tempRank[$i]=(1-$dampingFactor)/$numSentences;for($j=0;$j<$numSentences;$j++){if($i!=$j&&isset($matrix[$j][$i])){$matrixRowSum=array_sum($matrix[$j]);if($matrixRowSum!=0){$tempRank[$i]+=$dampingFactor*($matrix[$j][$i]*$pagerank[$j]/$matrixRowSum);}}}}$diff=0;for($i=0;$i<$numSentences;$i++){$diff+=abs($tempRank[$i]-$pagerank[$i]);}if($diff<$tolerance){break;}$pagerank=$tempRank;}return $pagerank;}private function extractTopSentences($sentences,$scores,$topN=5){asort($scores,SORT_NUMERIC);$topSentenceIndexes=array_keys(array_slice($scores,-$topN,$topN,true));$summary=[];foreach($topSentenceIndexes as $index){$summary[]=trim($sentences[$index]);}return $summary;}public function enqueueEmailJob($emailData){$data=['type'=>'email_processing','data'=>json_encode($emailData)];$this->marketingModel->insertJobQueue($data);}private function stripHtmlTags($htmlContent){return strip_tags($htmlContent);}public function social_media(){return['discord'=>$this->socialMedia->discord,'facebook_page'=>$this->socialMedia->facebook_page,'facebook_group'=>$this->socialMedia->facebook_group,'linkedin'=>$this->socialMedia->linkedin,'twitter'=>$this->socialMedia->twitter,'youtube'=>$this->socialMedia->youtube,];}public function department(){$activeCampaigns=$this->marketingModel->getActiveCampaigns();$totalActiveCampaigns=$activeCampaigns['num_rows'];$activePriorityCampaigns=$this->marketingModel->getActivePriorityCampaigns();$totalActivePriorityCampaigns=$activePriorityCampaigns['num_rows'];return['getActiveCampaigns'=>$activeCampaigns['result'],'totalActiveCampaigns'=>$totalActiveCampaigns,'getActivePriorityCampaigns'=>$activePriorityCampaigns['result'],'totalActivePriorityCampaigns'=>$totalActivePriorityCampaigns,];}public function seoCheck(){$uri_string=$this->request->getUri()->getPath();$query=$this->marketingModel->where('url',$uri_string)->first();if(!$query){$data=['url'=>$uri_string,'title'=>str_replace(['_','/'],[' ',' - '],$uri_string),'description'=>"Experience the future of personal finance with MyMI Wallet. We provide advanced budgeting and investment portfolio management solutions, empowering individuals to better manage their finances. Streamline your financial journey with our intuitive online fintech application and service.",'image'=>base_url('/assets/images/Company/MyMI-Wallet-White.png'),];$this->marketingModel->insert($data);$insert_id=$this->marketingModel->getInsertID();$task_info=['task'=>'Page SEO Edit','title'=>str_replace(['_','/'],[' ',' - '],$uri_string),'seo_id'=>$insert_id,'url'=>$uri_string,];$this->assignMarketingTask($task_info);}}public function assignMarketingTask($task_info){$data=['status'=>'Pending','group'=>'Marketing','task'=>$task_info['task'],'title'=>$task_info['title'],'description'=>'Complete SEO for '.$task_info['url'],'url'=>site_url('/Management/Marketing/Page-SEO/'.$task_info['seo_id']),];$this->marketingModel->insertManagementTask($data);}public function autoDistributeHighRelevanceSummaries($minScore=75){$posts=$this->marketingModel->getRecentPosts(10);foreach($posts as $post){if(($post['score']?? 0)>=$minScore){$message="**{$post['title']}**\n\n".word_limiter(strip_tags($post['summary']),60);$this->sendToDiscordNotification($message);}}}public function autoSendToZapier($minScore=75){$posts=$this->marketingModel->getRecentPosts(10);foreach($posts as $post){if(($post['score']?? 0)>=$minScore){$this->sendToZapier('facebook',$post['summary']);}}}public function getPageHeaders(){$getPageSEO=$this->marketingModel->getMarketingPageSeo();$pageSEOData=[];foreach($getPageSEO as $pageSEO){$pageSEOData[]=['page_id'=>$pageSEO['id'],'page_name'=>$pageSEO['page_name'],'page_title'=>$pageSEO['page_title'],'page_url'=>$pageSEO['page_url'],'page_sitemap_url'=>$pageSEO['page_sitemap_url'],'page_internal_url'=>$pageSEO['page_internal_url'],'page_controller'=>$pageSEO['page_controller'],'page_controller_url'=>$pageSEO['page_controller_url'],'page_controller_directory'=>$pageSEO['page_controller_directory'],'page_file_directory'=>$pageSEO['page_file_directory'],'page_image'=>$pageSEO['page_image'],'page_description'=>$pageSEO['page_description'],'page_address'=>$pageSEO['page_address'],'page_city'=>$pageSEO['page_city'],'page_state'=>$pageSEO['page_state'],'page_country'=>$pageSEO['page_country'],'page_zipcode'=>$pageSEO['page_zipcode'],'page_facebook'=>$pageSEO['page_facebook'],'linked'=>$pageSEO['linked'],'functionality'=>$pageSEO['functionality'],'design'=>$pageSEO['design'],'seo'=>$pageSEO['seo'],'ext_links'=>$pageSEO['ext_links'],'grammar'=>$pageSEO['grammar'],'d_optimize'=>$pageSEO['d_optimize'],'load_perf'=>$pageSEO['load_perf'],'additional_notes'=>$pageSEO['additional_notes'],];}return $pageSEOData;}public function getPageHeadersByName($pageName){$getPageSEO=$this->marketingModel->getMarketingPageSeoByName($pageName);$pageSEOData=[];foreach($getPageSEO as $pageSEO){$pageSEOData[]=['page_id'=>$pageSEO['id'],'page_name'=>$pageSEO['page_name'],'page_title'=>$pageSEO['page_title'],'page_url'=>$pageSEO['page_url'],'page_sitemap_url'=>$pageSEO['page_sitemap_url'],'page_internal_url'=>$pageSEO['page_internal_url'],'page_controller'=>$pageSEO['page_controller'],'page_controller_url'=>$pageSEO['page_controller_url'],'page_controller_directory'=>$pageSEO['page_controller_directory'],'page_file_directory'=>$pageSEO['page_file_directory'],'page_image'=>$pageSEO['page_image'],'page_description'=>$pageSEO['page_description'],'page_address'=>$pageSEO['page_address'],'page_city'=>$pageSEO['page_city'],'page_state'=>$pageSEO['page_state'],'page_country'=>$pageSEO['page_country'],'page_zipcode'=>$pageSEO['page_zipcode'],'page_facebook'=>$pageSEO['page_facebook'],'linked'=>$pageSEO['linked'],'functionality'=>$pageSEO['functionality'],'design'=>$pageSEO['design'],'seo'=>$pageSEO['seo'],'ext_links'=>$pageSEO['ext_links'],'grammar'=>$pageSEO['grammar'],'d_optimize'=>$pageSEO['d_optimize'],'load_perf'=>$pageSEO['load_perf'],'additional_notes'=>$pageSEO['additional_notes'],];}return $pageSEOData;}public function postToDiscord($message){$discordWebhookUrl=getenv('DISCORD_WEBHOOK_URL');if(strlen($message)>2000){$message=substr($message,0,1997)."...";}$payload=json_encode(["content"=>$message]);$ch=curl_init($discordWebhookUrl);curl_setopt($ch,CURLOPT_HTTPHEADER,['Content-Type: application/json']);curl_setopt($ch,CURLOPT_POST,1);curl_setopt($ch,CURLOPT_POSTFIELDS,$payload);curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);$response=curl_exec($ch);curl_close($ch);return $response;}public function postToFacebookPage($pageId,$message){try{$response=$this->facebook->post("/{$pageId}/feed",['message'=>$message,],$this->facebook->getAccessToken());return $response->getGraphNode();}catch(Facebook\Exceptions\FacebookResponseException $e){log_message('error','Graph returned an error: '.$e->getMessage());return false;}catch(Facebook\Exceptions\FacebookSDKException $e){log_message('error','Facebook SDK returned an error: '.$e->getMessage());return false;}}public function postToFacebookGroup($groupId,$message){try{$response=$this->facebook->post("/{$groupId}/feed",['message'=>$message,],$this->facebook->getAccessToken());return $response->getGraphNode();}catch(Facebook\Exceptions\FacebookResponseException $e){log_message('error','Graph returned an error: '.$e->getMessage());return false;}catch(Facebook\Exceptions\FacebookSDKException $e){log_message('error','Facebook SDK returned an error: '.$e->getMessage());return false;}}public function sendNotification($type,$viewPath,$data,$targetGroup=null,$socialMedia=[]){$userModel=new UserModel();if($targetGroup){$users=$userModel->where('group',$targetGroup)->findAll();}else{$users=$userModel->findAll();}$viewContent=view($viewPath,$data);$notoCount=0;$emailNotoCount=0;if(in_array('in-app',$type)){foreach($users as $user){$this->sendInAppNotification($user,$viewContent);$notoCount++;}}if(in_array('email',$type)){foreach($users as $user){$this->sendEmailNotification($user,$viewContent);$emailNotoCount++;}}foreach($socialMedia as $platform){switch($platform){case 'facebook':$this->postToFacebook($data['message']);break;case 'twitter':$this->postToTwitter($data['message']);break;case 'linkedin':$this->postToLinkedIn($data['message']);break;case 'discord':$this->postToDiscord($data['message']);break;}}$notificationData=['active'=>1,'message'=>$viewContent,'created_at'=>date('Y-m-d H:i:s'),'created_by'=>session('user_id'),'noto_count'=>$notoCount,'email_noto_count'=>$emailNotoCount,];$this->marketingModel->storeNotification($notificationData);}private function sendInAppNotification($user,$content){$db=\Config\Database::connect();$db->table('user_notifications')->insert(['user_id'=>$user->id,'content'=>$content,'created_at'=>date('Y-m-d H:i:s')]);}private function sendEmailNotification($user,$content){$email=\Config\Services::email();$email->setTo($user->email);$email->setSubject('Notification');$email->setMessage($content);$email->send();}public function postToSocialMedia($content){try{$this->postToFacebook($content);$this->postToTwitter($content);$this->postToLinkedIn($content);}catch(\Throwable $e){$this->logger->error('âŒ postToSocialMedia() failed: '.$e->getMessage());}}private function postToFacebook($message){try{$response=$this->facebook->post('/me/feed',['message'=>$message],$this->socialMedia->facebook_access_token);return $response->getGraphNode();}catch(Facebook\Exceptions\FacebookResponseException $e){$this->logger->error('Facebook Graph returned an error: '.$e->getMessage());return false;}catch(Facebook\Exceptions\FacebookSDKException $e){$this->logger->error('Facebook SDK returned an error: '.$e->getMessage());return false;}}public function fetchTweets($query,$count=100){try{$tweets=$this->twitter->get('search/tweets',['q'=>$query,'count'=>$count]);if($this->twitter->getLastHttpCode()===200){$processedTweets=[];foreach($tweets->statuses as $tweet){$processedTweets[]=['tweet_id'=>$tweet->id_str,'content'=>$tweet->text,'author'=>$tweet->user->screen_name,'created_at'=>$tweet->created_at,'url'=>"https://twitter.com/{$tweet->user->screen_name}/status/{$tweet->id_str}"];}foreach($processedTweets as $tweetData){$this->marketingModel->storeScrapedContent(['title'=>$tweetData['content'],'url'=>$tweetData['url'],'content'=>$tweetData['content'],'keywords'=>json_encode([$tweetData['author']]),'scraped_at'=>date('Y-m-d H:i:s')]);}return $processedTweets;}else{throw new \Exception('Failed to fetch tweets: '.$this->twitter->getLastBody());}}catch(\Throwable $th){log_message('error','Error fetching tweets: '.$th->getMessage());return[];}}public function generateContentFromTweets($tweets){$summary=$this->summarizeText(implode(' ',array_column($tweets,'content')));$keywords=$this->extractKeywords($summary);return['summary'=>$summary,'keywords'=>$keywords,'platform_content'=>$this->generatePlatformContent($summary,$keywords)];}public function generateFromTempScraper($limit=5){$records=$this->marketingModel->getLatestTempRecords($limit);if(empty($records)){log_message('info','No temp scraper records found to process.');return;}foreach($records as $record){try{log_message('debug','ðŸ§ª Processing record ID '.$record['id']);$summary=$this->generateContentFromRaw($record);if($summary){$this->marketingModel->markTempScraperProcessed($record['id']);log_message('info','âœ… Processed and stored content for record ID '.$record['id']);}else{log_message('warning','âš ï¸ Summary was null/empty for record ID '.$record['id']);}}catch(\Throwable $e){log_message('error','âŒ Error generating content for record ID '.$record['id'].': '.$e->getMessage());}}}public function postToTwitter($content){try{$response=$this->twitter->post('statuses/update',['status'=>$content]);if($this->twitter->getLastHttpCode()===200){log_message('info','Successfully posted to Twitter: '.$content);return $response;}else{throw new \Exception('Failed to post to Twitter: '.json_encode($response));}}catch(\Throwable $th){log_message('error','Error posting to Twitter: '.$th->getMessage());return false;}}private function postToLinkedIn($message){try{$response=$this->linkedin->post('/people/~/shares',['comment'=>$message,'visibility'=>['code'=>'anyone']],$this->socialMedia->linkedin_access_token);return $response;}catch(Exception $e){$this->logger->error('LinkedIn API returned an error: '.$e->getMessage());return false;}}private function postToBlog($content){$client=new Client(['base_uri'=>$this->siteSettings->wordpress_site_url,]);try{$response=$client->post('/wp-json/wp/v2/posts',['auth'=>[$this->siteSettings->wordpress_username,$this->siteSettings->wordpress_password],'json'=>['title'=>substr($content,0,50),'content'=>$content,'status'=>'publish',],]);if($response->getStatusCode()==201){$this->logger->info('Posted to blog: '.$content);return json_decode($response->getBody(),true);}else{$this->logger->error('Failed to post to blog: '.$response->getBody());return false;}}catch(RequestException $e){$this->logger->error('Blog post request error: '.$e->getMessage());return false;}}public function distributeContentToSocialMedia($content){$twitterPost="ï¿½ **Stock Market Highlights** ï¿½\n";$facebookPost="ï¿½ **Market Movers Update** ï¿½\n";$linkedinPost="ï¿½ **Today's Market Summary** ï¿½\n";$discordPost="ï¿½ **TRADE ALERTS UPDATE!** ï¿½\n";foreach($content['expandedContent']as $post){$twitterPost.=$post."\n";$facebookPost.=$post."\n";$linkedinPost.=$post."\n";$discordPost.=$post."\n";}$this->postToTwitter($twitterPost);$this->postToFacebook($facebookPost);$this->postToLinkedIn($linkedinPost);$this->postToDiscord($discordPost);return['twitter'=>$twitterPost,'facebook'=>$facebookPost,'linkedin'=>$linkedinPost,'discord'=>$discordPost];}public function generateAndPostContent(){$emailSummaries=$this->marketingModel->getEmailSummariesForReview();foreach($emailSummaries as $summary){log_message('info','Generating content for email summary: '.$summary['email_subject']);$content=$this->generateMarketingContent($summary['summary']);log_message('debug','Generated content: '.print_r($content,true));$this->postToSocialMedia($content);$this->postToBlog($content);$this->marketingModel->updateEmailStatus($summary['email_identifier'],'Posted');log_message('info','Updated email status to Posted for: '.$summary['email_subject']);}}public function generateMarketingContent():void{$topStories=$this->marketingModel->getTopStories(10);$count=0;foreach($topStories as $story){if(empty(trim($story['title']?? ''))){log_message('debug','â­ Skipped record ID '.$story['id'].' - no title provided.');continue;}if($count>=5){break;}$headline=$story['title'];$url=$story['source_url']?? '#';$summary=$this->generateSummary($story);$hashtags=$this->extractHashtags($story['title'].' '.$story['email_body']);$platformPosts=['discord'=>"**{$headline}**\n{$summary}\nðŸ”— {$url}\n{$hashtags}",'twitter'=>"{$headline} {$url} {$hashtags}",'linkedin'=>"{$headline}\n{$summary}\nRead more: {$url} {$hashtags}",'facebook'=>"{$headline}\n{$summary}\n{$url} {$hashtags}",'email'=>['subject'=>$headline,'body'=>"{$summary}\n\nRead More: {$url}\n{$hashtags}",],];$this->marketingModel->storeGeneratedContent($story['id'],$platformPosts);$count++;}}private function logScrapeError($url,$error){log_message('error',"Scraping failed for URL: $url, Error: $error");}public function generateContentFromData($title,$content,$tags){$summary=$this->summarizeContent($content);return $title." - ".$summary." Tags: ".implode(', ',$tags);}public function generateContentFromScrapedData($scrapedData,$platform=null){if(empty($scrapedData)||!is_array($scrapedData)){log_message('error','âŒ generateContentFromScrapedData() called with empty or invalid $scrapedData');return[];}$cleanedSummaries=[];foreach($scrapedData as $record){$rawContent=$record['content']?? '';$cleaned=$this->sanitizeRawEmailContent($rawContent);if(strlen($cleaned)<300||substr_count($cleaned,' ')<20){log_message('warning','[MyMIMarketing] Skipped record due to short or unstructured content (Title: '.($record['title']?? 'Untitled').')');continue;}try{$summaryData=$this->summarizeContent($cleaned);if(!is_array($summaryData)||empty($summaryData['summary'])){log_message('warning','âš ï¸ generateContentFromScrapedData(): Summary was null/empty for record title: '.($record['title']?? 'Untitled'));continue;}$headline=$this->generateHeadline($summaryData['summary']);$platformPosts=$this->generatePlatformContent($summaryData['summary'],$summaryData['tokens']??[]);$payload=['title'=>$record['title']?? $headline,'source'=>$record['url']?? 'unknown','summary'=>$summaryData['summary'],'keywords'=>$summaryData['tokens']??[],'headline'=>$headline,'platform_content'=>$platformPosts,'platform'=>$platform,'created_on'=>date("Y-m-d H:i:s"),];$this->marketingModel->storeGeneratedContent($record['id']?? null,$platformPosts);$cleanedSummaries[]=$payload;}catch(\Throwable $e){log_message('error','âŒ Exception in generateContentFromScrapedData(): '.$e->getMessage());}}return $cleanedSummaries;}public function generateContentFromLargeText($content,$tags){if(empty($content)){log_message('error','Content is empty in generateContentFromLargeText.');return['summary'=>'','keywords'=>[],'platforms_content'=>[],];}$tokenizer=new WhitespaceTokenizer();$samples=[$tokenizer->tokenize($content)];log_message('debug','Tokenized samples: '.print_r($samples,true));if(empty($samples)||!isset($samples[0])||!is_array($samples[0])||empty($samples[0])){log_message('error','ðŸš« Empty or malformed document array before TF-IDF.');return['summary'=>'','keywords'=>[],'platforms_content'=>[],];}try{$tfidf=new TfIdfTransformer();$tfidf->fit($samples);$tfidf->transform($samples);log_message('debug','TfIdf transformation successful.');}catch(\Exception $e){log_message('error','TfIdfTransformer failed: '.$e->getMessage());return['summary'=>'','keywords'=>[],'platforms_content'=>[],];}$summary=$this->summarizeText($content);$keywords=$this->extractKeywords($content);$platforms_content=$this->generatePlatformContent($summary,$keywords);return['summary'=>$summary,'keywords'=>$keywords,'platforms_content'=>$platforms_content,];}public function generateCanvaVideo(){$scriptResponse=$this->generateVoiceoverScript();if(!$scriptResponse['status']==='success'){return $this->respond(['status'=>'error','message'=>'Voiceover script not found'],404);}$scriptText=$scriptResponse['script'];$canvaApiUrl="https://api.canva.com/v1/projects";$headers=['Authorization: Bearer YOUR_CANVA_API_KEY','Content-Type: application/json'];$payload=['title'=>'MyMI Trade Alerts Video','template'=>'YOUR_CANVA_TEMPLATE_ID','elements'=>['text'=>$scriptText,'voiceover'=>base_url('uploads/voiceover.mp3')]];$ch=curl_init($canvaApiUrl);curl_setopt($ch,CURLOPT_HTTPHEADER,$headers);curl_setopt($ch,CURLOPT_POST,true);curl_setopt($ch,CURLOPT_POSTFIELDS,json_encode($payload));curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);$response=curl_exec($ch);curl_close($ch);return $this->respond(['status'=>'success','message'=>'Video generated','video_url'=>json_decode($response)->video_url]);}public function generateEnhancedContent($voiceScript){$summary=$this->summarizeContent($voiceScript);$checkedContent=$this->spellCheckAndRefine($summary);$expandedContent=$this->contentGenerator($checkedContent);return['summary'=>$summary,'checkedContent'=>$checkedContent,'expandedContent'=>$expandedContent];}private function generatePrimaryContent($scrapedData){$content="";foreach($scrapedData as $data){$content.="Source: {$data['source']}\n";$content.="Title: {$data['title']}\n";$content.="Content: ".substr($data['content'],0,200)."...\n";$content.="Link: ".($data['url']?? 'N/A')."\n\n";}return $content;}public function generatePlatformContent($summary,$keywords,$mediaAssets=[]){$facebookContent="Facebook Post: ".$summary."\n\n"."Related: #".implode(' #',$keywords);$twitterContent="Twitter: ".substr($summary,0,280)."\n\n#".implode(' #',$keywords);$stocktwitsContent="StockTwits: ".substr($summary,0,250)."\n\n".implode(' ',$keywords);$discordContent="Discord: ".$summary."\n\nJoin the discussion! #".implode(' #',$keywords);$blogContent="Blog Post\n\n".$summary."\n\nKeywords: ".implode(', ',$keywords);$emailContent="Email Notification: ".$summary."\n\nRead more on our blog.";$browserNotificationContent="New Update: ".substr($summary,0,100)."... Click to learn more.";$tiktokScript=$this->generateTikTokScript($summary,$keywords,$mediaAssets);$youtubeScript=$this->generateYouTubeScript($summary,$keywords,$mediaAssets);return['Facebook'=>$facebookContent,'Twitter'=>$twitterContent,'StockTwits'=>$stocktwitsContent,'Discord'=>$discordContent,'Blog'=>$blogContent,'Email'=>$emailContent,'BrowserNotification'=>$browserNotificationContent,'TikTok'=>$tiktokScript,'YouTube'=>$youtubeScript];}public function generateSocialPost(array $summary):array{$text=$summary['summary']?? '';$keywords=$summary['keywords']??[];$hashtags=implode(' ',array_map(function($word){return '#'.ucfirst(trim($word));},array_slice($keywords,0,5)));return['twitter'=>substr("{$text} {$hashtags}",0,280),'facebook'=>"{$text}\n\n{$hashtags}",'linkedin'=>"{$text}\n\n#StayInformed {$hashtags}",'discord'=>"**News Summary:**\n{$text}\n\n{$hashtags}",];}private function generateSocialMediaContent($scrapedData){$facebookContent="Facebook: ";$twitterContent="Twitter: ";$linkedinContent="LinkedIn: ";foreach($scrapedData as $data){$facebookContent.=$data['title']." ".($data['url']?? '')."\n";$twitterContent.=$data['title']." ".($data['url']?? '')."\n";$linkedinContent.=$data['title']." ".($data['url']?? '')."\n";}return['Facebook'=>$facebookContent,'Twitter'=>$twitterContent,'LinkedIn'=>$linkedinContent,];}protected function generateSummary(array $story):string{return substr(strip_tags($story['email_body']?? ''),0,250).'...';}public function generateTikTokScript($summary,$keywords,$mediaAssets=[]){$hook="Did you know?";$cta="Follow us for more updates!";$mediaInclusion=!empty($mediaAssets)?"Include these images/videos: ".implode(", ",$mediaAssets):"";return"TikTok Video Script:\n1. Hook: \"{$hook}\"\n2. Summary: {$summary}\n3. Media: {$mediaInclusion}\n4. CTA: {$cta}";}public function generateYouTubeScript($summary,$keywords,$mediaAssets=[]){$hook="Breaking news in the world of finance...";$cta="Like, subscribe, and share for more updates!";$mediaInclusion=!empty($mediaAssets)?"Include these images/videos: ".implode(", ",$mediaAssets):"";return"YouTube Video Script:\n1. Hook: \"{$hook}\"\n2. Detailed Summary: {$summary}\n3. Media: {$mediaInclusion}\n4. CTA: {$cta}";}public function generateVoiceoverAudio($text){$client=new TextToSpeechClient();$input=new SynthesisInput();$input->setText($text);$voice=new VoiceSelectionParams();$voice->setLanguageCode('en-US');$voice->setSsmlGender('MALE');$audioConfig=new AudioConfig();$audioConfig->setAudioEncoding(AudioEncoding::MP3);$response=$client->synthesizeSpeech($input,$voice,$audioConfig);$audioContent=$response->getAudioContent();$filePath=WRITEPATH.'uploads/voiceover.mp3';file_put_contents($filePath,$audioContent);return base_url('uploads/voiceover.mp3');}public function generateVoiceoverScript(){$tradeAlerts=$this->alertsModel->getFilteredTradeAlerts(['start'=>date('Y-m-d 00:00:00'),'end'=>date('Y-m-d 23:59:59')])->get()->getResultArray();if(empty($tradeAlerts)){return $this->respond(['status'=>'error','message'=>'No trade alerts found for today.'],404);}$script="**Voiceover Script: MyMI Trade Alerts - Top Stock Movers**\n\n[INTRO]\n";$script.="Welcome to todayâ€™s MyMI Trade Alerts! Weâ€™re breaking down the hottest stocks in the market based on momentum, volume, and breakout potential. Letâ€™s jump right in!\n\n";foreach($tradeAlerts as $alert){$script.="**[{$alert['ticker']} - {$alert['company']}]**\n";$script.="**Price:** \${$alert['price']}  |  **% Change:** {$alert['change']}%  |  **Volume:** {$alert['volume']}M\n";$script.="ï¿½ 52-Week High: \${$alert['high']}  |  ï¿½ 52-Week Low: \${$alert['low']}\n";$script.="Market Cap: {$alert['market_cap']}\n\n";}$script.="[OUTRO]\nThatâ€™s it for todayâ€™s MyMI Trade Alerts! Donâ€™t forget to like, subscribe, and stay tuned for more market insights. Drop your thoughts in the commentsâ€”whatâ€™s your top stock pick today? See you in the next update!\n";return $this->respond(['status'=>'success','script'=>$script]);}public function generateStockInformation($cuID){$MyMIInvestments=new MyMIInvestments();$investmentData=$MyMIInvestments->getInvestmentDashboard($cuID);$symbols=$this->getSymbolsByAssetType($investmentData['getSymbols']);$forecastData=[];$riskData=[];foreach($symbols as $type=>$symbolList){switch($type){case 'stocks':$forecastData['stocks']=$MyMIInvestments->performARIMAForecast($symbolList);$riskData['stocks']=$MyMIInvestments->generateRiskManagementTools($cuID,'stocks');break;case 'etfs':$forecastData['etfs']=$MyMIInvestments->performARIMAForecast($symbolList);$riskData['etfs']=$MyMIInvestments->generateRiskManagementTools($cuID,'etfs');break;case 'crypto':$forecastData['crypto']=$MyMIInvestments->performARIMAForecast($symbolList);$riskData['crypto']=$MyMIInvestments->generateRiskManagementTools($cuID,'crypto');break;}}$content=$this->generateContent($forecastData,$riskData);return $content;}private function getSymbolsByAssetType($symbols){$result=['stocks'=>[],'etfs'=>[],'crypto'=>[]];foreach($symbols as $symbol){if(preg_match('/^[A-Z]{1,5}$/',$symbol)){$result['stocks'][]=$symbol;}elseif(preg_match('/^[A-Z]{1,5}$/',$symbol)){$result['etfs'][]=$symbol;}else{$result['crypto'][]=$symbol;}}return $result;}private function generateContent($forecastData,$riskData){$content="";if(!empty($forecastData['stocks'])){$content.="### Stock Investment Forecast\n";foreach($forecastData['stocks']as $symbol=>$forecast){$content.="- **{$symbol}**: ".json_encode($forecast)."\n";}}if(!empty($forecastData['etfs'])){$content.="### ETF Investment Forecast\n";foreach($forecastData['etfs']as $symbol=>$forecast){$content.="- **{$symbol}**: ".json_encode($forecast)."\n";}}if(!empty($forecastData['crypto'])){$content.="### Crypto Investment Forecast\n";foreach($forecastData['crypto']as $symbol=>$forecast){$content.="- **{$symbol}**: ".json_encode($forecast)."\n";}}$content.="\n### Risk Management Insights\n";foreach($riskData as $type=>$riskMetrics){$content.="#### ".ucfirst($type)." Risks\n";foreach($riskMetrics as $riskMetric=>$details){$content.="- **{$riskMetric}**: ".json_encode($details)."\n";}}return $content;}public function getRecentPosts($limit=5){return $this->marketingModel->getRecentPosts($limit);}public function pullFinancialNews():void{$response=$this->client->get('https://www.marketaux.com/api/v1/news/all',['query'=>['api_token'=>getenv('marketaux.apiKey'),'language'=>'en','country'=>'us','published_after'=>date('Y-m-d\TH:i:s\Z',strtotime('-1 hour')),'limit'=>50,],]);$data=json_decode($response->getBody(),true);if(isset($data['data'])){foreach($data['data']as $story){$this->marketingModel->saveNews($story);}}}public function rankBufferCandidates(){$buffer=$this->marketingModel->fetchBufferPostsForScoring();foreach($buffer as $post){$keywords=$this->extractKeywords($post['summary']);$score=array_sum(array_column($keywords,'score'));$tagScore=min($score/10,10);$this->marketingModel->updateBufferItem($post['id'],['tag_score'=>$tagScore]);}}public function rankNewsArticles():void{$unrankedNews=$this->marketingModel->getUnrankedNews();foreach($unrankedNews as $news){$content=strtolower(($news['title']?? '').' '.($news['email_subject']?? '').' '.($news['email_body']?? ''));$words=str_word_count(strip_tags($content),1);$wordFreq=array_count_values($words);$filtered=array_filter($wordFreq,fn($freq,$word)=>strlen($word)>3&&$freq>1,ARRAY_FILTER_USE_BOTH);arsort($filtered);$score=array_sum(array_values($filtered));$topKeywords=array_slice(array_keys($filtered),0,5);$this->marketingModel->updateRankedNews($news['id'],$score,implode(',',$topKeywords));}}public function summarizeMultipleArticles(array $articles):string{$allContent='';foreach($articles as $article){$content=$article['content']?? '';$allContent.=strip_tags($content).' ';}if(empty(trim($allContent))){log_message('error','summarizeMultipleArticles() received empty content.');return 'No content available to summarize.';}$summaryData=$this->summarizeContent($allContent);return is_array($summaryData)&&isset($summaryData['summary'])?$summaryData['summary']:substr($allContent,0,300).'...';}} ?><?php namespace App\Models;use CodeIgniter\Model;use Phpml\FeatureExtraction\TfIdfTransformer;use Phpml\Tokenization\WhitespaceTokenizer;class MarketingModel extends Model{protected $table='bf_marketing_scraper';protected $primaryKey='id';protected $useAutoIncrement=true;protected $returnType='object';protected $useSoftDeletes=false;protected $allowedFields=['title','description','created_on','modified_on','status','type','day','time','activity','link','url','summary','content','email_identifier','email_date','email_sender','email_subject','email_body','email_attachments','keywords','scraped_at','links','images','videos','metadata','structured_data','sched_id','escalated','audience_type','stage','name','assigned_on','assigned_to','completed_on','scheduled_at','primary_content','secondary_content','html_content','voice_script','shared','shared_users','blog','in_app','email','discord','facebook','linkedin','telegram','twitter','website','promotional_links','facebook_message','linkedin_message','discord_message','stocktwits_message','tiktok_message','youtube_message','email_message','additional_info','image_paths'];protected $useTimestamps=true;protected $createdField='created_on';protected $updatedField='modified_on';public function addMarketingCampaign($campaignData){log_message('debug','MarketingModel L206 - $marketingData: '.(print_r($campaignData,true)));$dbData=['beta'=>$campaignData['beta'],'config_mode'=>$campaignData['config_mode'],'form_mode'=>$campaignData['form_mode'],'escalated'=>$campaignData['escalated'],'created_by'=>$campaignData['user_id'],'user_id'=>$campaignData['user_id'],'user_email'=>$campaignData['user_email'],'username'=>$campaignData['username'],'assigned_to'=>$campaignData['assigned_to'],'assigned_on'=>$campaignData['date'].' - '.$campaignData['time'],'name'=>$campaignData['campaign_name'],'promotional_links'=>$campaignData['promotionalLinks'],'overall_campaign_description'=>$campaignData['overall_campaign_description'],'voice_script'=>$campaignData['voice_script'],'facebook_message'=>$campaignData['facebookMessage'],'linkedin_message'=>$campaignData['linkedinMessage'],'discord_message'=>$campaignData['discordMessage'],'stocktwits_message'=>$campaignData['stocktwitsMessage'],'tiktok_message'=>$campaignData['tiktokMessage'],'youtube_message'=>$campaignData['youtubeMessage'],'email_message'=>$campaignData['emailMessage'],'additional_info'=>$campaignData['additionalInfo'],'hashtags'=>$campaignData['hashtags'],];log_message('debug','MarketingModel L206 - $marketingData: '.(print_r($dbData,true)));if($this->db->table('bf_marketing_campaigns')->insert($dbData)){log_message('info','Campaign created successfully.');return $this->getInsertID();}else{log_message('error','DB Insert Error: '.json_encode($this->errors()));return false;}}public function addMarketingSchedule($data){$data['zapier_webhook_url']=$data['zapier_webhook_url']?? null;$data['post_status']='pending';$this->db->table('bf_marketing_schedule')->insert($data);return $this->db->insertID();}public function addSubscriber($subscriberData){if($this->db->table('bf_users_subscribers')->insert($subscriberData)){log_message('info','Subscriber added successfully.');return true;}else{log_message('error','DB Insert Error: '.json_encode($this->errors()));return false;}}public function cleanHtmlEmailContent($raw):string{$raw=is_string($raw)?$raw:'';$decoded=quoted_printable_decode($raw);$decoded=is_string($decoded)?$decoded:'';$text=strip_tags($decoded);$text=preg_replace('/\s+/',' ',str_replace(["\r","\n","\t",'&nbsp;'],' ',$text));return trim(substr($text,0,5000));}public function copyMarketingCampaign($marketingData){unset($marketingData['id']);if($this->insert($marketingData)){log_message('info','Campaign copied successfully.');return $this->getInsertID();}else{log_message('error','DB Insert Error: '.json_encode($this->errors()));return false;}}public function countBlogs(){return $this->db->table('bf_marketing_blog_posts')->countAllResults();}public function countNewlyInsertedToday():int{return $this->where('DATE(scraped_at)',date('Y-m-d'))->countAllResults();}public function createSlug($title){$slug=url_title($title,'-',true);$existing=$this->db->table('bf_marketing_blog_posts')->where('slug',$slug)->countAllResults();return $existing?$slug.'-'.uniqid():$slug;}public function deleteMarketingCampaign($id){if($this->delete($id)){log_message('info','Campaign deleted successfully.');return true;}else{log_message('error','DB Delete Error: '.json_encode($this->errors()));return false;}}public function deleteSchedule($id){return $this->db->table('bf_marketing_schedule')->where('id',$id)->delete();}public function editMarketingCampaign($marketingData){if($this->update($marketingData['id'],$marketingData)){log_message('info','Campaign updated successfully.');return true;}else{log_message('error','DB Update Error: '.json_encode($this->errors()));return false;}}public function extractKeywords($text){if(empty($text)||strlen(trim($text))<50){return[];}$tokenizer=new WhitespaceTokenizer();$tokens=array_filter($tokenizer->tokenize($text));if(empty($tokens)){return[];}$documents=[$tokens];$tfidf=new TfIdfTransformer();try{$tfidf->transform($documents);}catch(\Exception $e){log_message('error','TfIdfTransformer failed: '.$e->getMessage());return[];}$keywordScores=[];foreach($documents[0]as $word=>$score){$keywordScores[$word]=$score;}arsort($keywordScores);return array_slice(array_keys($keywordScores),0,10);}public function fetchBufferPaginated($page=1,$limit=20){$offset=($page-1)*$limit;$builder=$this->db->table('bf_marketing_buffer')->where('status !=','promoted')->orderBy('tag_score','DESC')->limit($limit,$offset);$results=$builder->get()->getResultArray();$total=$this->db->table('bf_marketing_buffer')->where('status !=','promoted')->countAllResults();return['data'=>$results,'pagination'=>['page'=>$page,'pages'=>ceil($total/$limit),]];}public function fetchBufferPaginatedWithFilters(array $params=[]){$page=$params['page']?? 1;$limit=$params['limit']?? 20;$offset=($page-1)*$limit;$keyword=$params['keyword']?? null;$category=$params['category']?? null;$minTagScore=$params['min_tag_score']?? 0;$onlySuggested=$params['only_suggested']?? false;$builder=$this->db->table('bf_marketing_buffer')->where('status !=','promoted');if(!empty($keyword)){$builder->like('keyword',$keyword);}if(!empty($category)){$builder->where('category',$category);}if(!empty($minTagScore)){$builder->where('tag_score >=',$minTagScore);}if($onlySuggested){$builder->where('auto_suggest',1);}$totalQuery=clone $builder;$total=$totalQuery->countAllResults(false);$results=$builder->orderBy('tag_score','DESC')->limit($limit,$offset)->get()->getResultArray();return['data'=>$results,'pagination'=>['page'=>$page,'limit'=>$limit,'pages'=>ceil($total/$limit),'total'=>$total,],];}public function fetchBufferPostsForReview($limit=25){return $this->db->table('bf_marketing_buffer')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getBufferItem($id){return $this->db->table('bf_marketing_buffer')->where('id',$id)->get()->getRowArray();}public function getPendingAutoSuggested($limit=5){return $this->db->table('bf_marketing_buffer')->where('status','pending')->where('auto_suggest',1)->orderBy('tfidf_score','DESC')->limit($limit)->get()->getResultArray();}public function getPendingScheduledPosts($currentTimestamp){return $this->db->table('bf_marketing_schedule')->where('post_time <=',$currentTimestamp)->where('post_status','pending')->get()->getResult();}public function getPendingScraperSummaries($limit=10){return $this->db->table('bf_marketing_scraper')->where('status',null)->orWhere('status','')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getProcessedEmails($date=null){$builder=$this->select('email_identifier');if($date){$builder->where('DATE(email_date)',$date);}$results=$builder->get()->getResultArray();$identifiers=[];foreach($results as $row){if(!empty($row->email_identifier)){$identifiers[]=$row->email_identifier;}}return $identifiers;}public function findBufferItem($id){return $this->db->table('bf_marketing_buffer')->where('id',$id)->get()->getRowArray();}public function findFinalizedById($id){return $this->db->table('bf_marketing_scraper')->where('id',$id)->get()->getRowArray();}public function getActiveCampaigns(){$builder=$this->db->table('bf_marketing_campaigns');$num_rows=$builder->where('status',1)->countAllResults(false);$result=$builder->where('status',1)->get()->getResultArray();return['result'=>$result,'num_rows'=>$num_rows];}public function getActiveIdeas(){return $this->db->table('bf_marketing_ideas')->where('status !=','approved')->get()->getResultArray();}public function getActivePriorityCampaigns(){$builder=$this->db->table('bf_marketing_campaigns');$num_rows=$builder->where('status',1)->where('escalated',1)->countAllResults(false);$result=$builder->where('status',1)->where('escalated',1)->get()->getResultArray();return['result'=>$result,'num_rows'=>$num_rows];}public function getApprovedBufferWithoutSchedule(){return $this->db->table('bf_marketing_buffer')->where('status','approved')->where('scheduled_at IS NULL',null,false)->where('schedule_interval >',0)->orderBy('tag_score','DESC')->limit(10)->get()->getResultArray();}public function getApprovedLogos(){return $this->db->table('bf_company_logos')->get()->getResultArray();}public function getBlogPostBySlug($slug){return $this->db->table('bf_marketing_blog_posts')->where('slug',$slug)->get()->getRow();}public function getBlogPostDetails($id){return $this->find($id);}public function getBlogPosts(){return $this->where('type','Email/Newsletters')->limit(50)->get()->getResultArray();}public function getBlogs(){return $this->db->table('bf_marketing_blog_posts')->orderBy('created_on','DESC')->get()->getResult();}public function getBufferItems($limit=50){return $this->builder()->where('status','pending')->orderBy('score','DESC')->limit($limit)->get()->getResultArray();}public function getCampaignById($campaign_id){return $this->db->table('bf_marketing_campaigns')->where('id',$campaign_id)->get()->getResultArray();}public function getCampaignsBySchedId($accountid){return $this->db->table('bf_marketing_campaigns')->where('sched_id',$accountid)->get()->getResultArray();}public function getDailyLogsByDate($date){return $this->db->table('bf_marketing_scraper')->where('DATE(created_on)',$date)->get()->getResult();}public function getEmailRecordById($id){return $this->db->table('bf_marketing_temp_scraper')->where('id',$id)->get()->getRowArray();}public function getEmailByMessageId($messageId){return $this->db->table('bf_marketing_temp_scraper')->where('email_identifier',$messageId)->get()->getRowArray();}public function getEmailContentsForNewsletter(){return $this->where('include_newsletter',false)->limit(50)->get()->getResultArray();}public function getEmailsMissingTitleOrUrl($limit=20){return $this->db->table('bf_marketing_temp_scraper')->where('(title IS NULL OR title = "" OR url IS NULL OR url = "")',null,false)->orderBy('date_scraped','DESC')->limit($limit)->get()->getResultArray();}public function getEmailSummariesForReview(){return $this->where('status','In Review')->limit(50)->get()->getResultArray();}public function getExchangeTokenById($id){return $this->db->table('bf_exchanges_assets')->where('id',$id)->get()->getRowArray();}public function getExistingLogoBySymbol($symbol){return $this->db->table('bf_company_logos')->where('symbol',$symbol)->get()->getRow();}public function getFeatures(){return $this->db->table('bf_users_memberships')->where('active',1)->orderBy('feature_level','ASC')->orderBy('feature_name','ASC')->get()->getResultArray();}public function getGeneratedContent($postId){return $this->db->table('bf_marketing_campaigns')->where('sched_id',$postId)->get()->getRowArray();}public function getGeneratedPostsBySourceId($id){$row=$this->db->table('bf_marketing_scraper')->where('source_id',$id)->get()->getRowArray();if(!$row||empty($row['platforms']))return[];$decoded=json_decode($row['platforms'],true);if(!is_array($decoded))return[];return $decoded;}public function getLatestGeneratedSummaries($limit=25){return $this->db->table('bf_marketing_scraper')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getLatestNewsletterDraft(){return $this->db->table('bf_marketing_newsletters')->orderBy('created_at','DESC')->first();}public function getLatestTempRecords($limit=5){return $this->db->table('bf_marketing_temp_scraper')->where('status','In Review')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getLatestUnprocessedEmails($limit=10){return $this->db->table('bf_marketing_temp_scraper')->where('status','In Review')->orderBy('scraped_at','DESC')->limit($limit)->get()->getResultArray();}public function getMarketingBuffer($status='Pending'){return $this->builder()->where('status',$status)->orderBy('created_at','DESC')->get()->getResultArray();}public function getMarketingPageSeoByName($pageTitle){return $this->where('page_name',$pageTitle)->get()->getResultArray();}public function getMarketingTeam(){$result=$this->db->table('bf_management_positions')->where('department','Marketing')->get()->getResultArray();return $result;}public function getNewsArticles(){$result=$this->select('articles_json')->first();return json_decode($result->articles_json ?? '[]',true);}public function getNewEmails(){return $this->db->table('bf_marketing_raw_emails')->where('status','unprocessed')->get()->getResultArray();}public function getNewsPosts(){return $this->where('type','news_post')->limit(50)->get()->getResultArray();}public function getNextScheduledPost(){return $this->db->table('bf_marketing_buffer')->where('status','approved')->where('tag_score >=',7.0)->orderBy('tag_score','DESC')->limit(1)->get()->getRowArray();}public function getRecentPosts($limit=5){$results=$this->asObject()->select("id, title, category, created_at, blog_content")->orderBy('created_at','DESC')->limit($limit)->findAll();log_message('info','MarketingModel L437 - $result Array: '.(print_r($results,true)));foreach($results as $r){$r->short_description=substr(strip_tags($r->blog_content ?? 0),0,150);}return $results;}public function getRecentScrapes(){return $this->db->table('bf_marketing_temp_scraper')->orderBy('scraped_at','DESC')->limit(5)->get()->getResult();}public function getRecentSummaries($limit=5){return $this->db->table('bf_marketing_scraper')->select('id, title, summary, keywords, scraped_at')->where("CHAR_LENGTH(summary) >=",100)->where("summary LIKE",'% % % % % % % % % %')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getRecentUnprocessedTempEmails($limit=5){return $this->db->table('bf_marketing_temp_scraper')->where('status','In Review')->orderBy('id','DESC')->limit($limit)->get()->getResultArray();}public function getScheduledBufferPosts($timestamp){return $this->db->table('bf_marketing_buffer')->where('status','approved')->where('scheduled_at <=',$timestamp)->orderBy('scheduled_at','ASC')->limit(3)->get()->getResultArray();}public function getScheduledCampaigns(){return $this->db->table('bf_marketing_newsletters')->where('status','scheduled')->where('scheduled_date <=',date('Y-m-d H:i:s'))->get()->getResultArray();}public function getScheduleByDay($day){return $this->db->table('bf_marketing_calendar')->where('day',ucfirst($day))->get()->getResultArray();}public function getScheduleById($id){return $this->db->table('bf_marketing_schedule')->where('id',$id)->get()->getRow();}public function getScrapesByDate($date){return $this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',$date)->orderBy('scraped_at','DESC');if($limit){$builder->limit($limit);}return $builder->get()->getResultArray();}public function getScrapesByKeyword($keyword){return $this->db->table('bf_marketing_scraper')->like('summary',$keyword)->orLike('keywords',$keyword)->orderBy('created_on','DESC')->limit(10)->get()->getResultArray();}public function getTodaysNewsContent($limit=10){$builder=$this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',date('Y-m-d'))->where('type !=','todays_story')->orderBy('scraped_at','DESC')->limit($limit);$query=$builder->get();$results=$query->getResultArray();if(empty($results)){log_message('info','No scraped content found for today.');}return $results;}public function getTodaysScrapedContent(){return $this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',date('Y-m-d'))->orderBy('feature_score','DESC')->get()->getResultArray();}public function getTodaysStory(){return $this->db->table('bf_marketing_temp_scraper')->where('type','todays_story')->where('DATE(scraped_at)',date('Y-m-d'))->orderBy('scraped_at','DESC')->get()->getRowArray();}public function getTopBufferPosts($limit=5,$minTagScore=7.5){return $this->builder('bf_marketing_buffer')->where('status','approved')->where('tag_score >=',$minTagScore)->orderBy('tag_score','DESC')->limit($limit)->get()->getResultArray();}public function getTopStories($limit=10){return $this->db->table('bf_marketing_scraper')->where('status','pending')->where('title IS NOT NULL')->where('title !=','')->orderBy('feature_score','DESC')->limit($limit)->get()->getResultArray();}public function getTopTempRecords($limit=5){return $this->db->table('bf_marketing_temp_scraper')->where('title IS NOT NULL')->orderBy('created_at','desc')->limit($limit)->get()->getResultArray();}public function getUpcomingSchedule(){return $this->db->table('bf_marketing_schedule')->select('id, post_date, completed, GROUP_CONCAT(DISTINCT platform ORDER BY platform ASC SEPARATOR ", ") as platforms, MIN(content_subject) as subjects, MIN(content_description) as descriptions')->where('post_date >=',date('Y-m-d'))->groupBy('post_date')->orderBy('post_date','ASC')->get()->getResultArray();}public function getUpcomingEarnings(){$builder=$this->db->where('bf_investment_calendar')->where('date >=',date('Y-m-d'))->where('event_type','Earnings')->orderBy('date','ASC')->get()->getResultArray();log_message('debug','MarketingModel L211 - getUpcomingEvents $builder Array: '.(print_r($builder,true)));return $builder;}public function getValidUnprocessedEmails($limit=10){$builder=$this->db->table('bf_marketing_temp_scraper');$builder->where('processed',0);$builder->limit($limit*2);$query=$builder->get();$results=$query->getResultArray();$valid=[];foreach($results as $row){$id=$row['id'];if(empty($row['title'])){log_message('debug',"ðŸª“ Skipping record ID {$id} â€” Missing title.");continue;}if(empty($row['content'])||strlen(strip_tags($row['content']))<100){log_message('debug',"ðŸª“ Skipping record ID {$id} â€” Content empty or too short.");continue;}$textContent=strip_tags($row['content']);$htmlRatio=strlen($textContent)/strlen($row['content']?? '');if($htmlRatio<0.3){log_message('debug',"ðŸª“ Skipping record ID {$id} â€” HTML-dominant content ({$htmlRatio}).");continue;}$valid[]=$row;if(count($valid)>=$limit){break;}}return $valid;}public function getValidUnprocessedEmailsFromToday($limit=10){return $this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',date('Y-m-d'))->where('content IS NOT NULL',null,false)->where('title IS NOT NULL',null,false)->where('CHAR_LENGTH(content) >',250)->orderBy('id','DESC')->limit($limit)->get()->getResultArray();}public function incrementRetryCount($id){return $this->db->table('bf_marketing_schedule')->where('id',$id)->set('retry_count','retry_count + 1',false)->update(['last_attempt_at'=>date('Y-m-d H:i:s')]);}public function insertBufferItem(array $summary){$MyMIMarketing=new \App\Libraries\MyMIMarketing();$scoreData=$MyMIMarketing->getTopKeywordScores($summary['summary']);$threshold=getenv('MARKETING_TFIDF_THRESHOLD')?:7.5;$bufferRecord=['keyword'=>$scoreData['top_keyword']?? 'general','summary'=>$summary['summary'],'score'=>$scoreData['score']?? 0,'tag_score'=>$scoreData['tag_score']?? 0,'category'=>$scoreData['category']?? 'Uncategorized','status'=>'pending','tfidf_score'=>$scoreData['tfidf_score']?? 0,'auto_suggest'=>($scoreData['tfidf_score']?? 0)>=$threshold?1:0,'platforms'=>json_encode(['discord'=>true,'linkedin'=>true,'x'=>false,'email'=>false,]),'created_at'=>date('Y-m-d H:i:s'),];return $this->insert($bufferRecord);}public function insertFinalScraper(array $record,array $summary){$data=['source_id'=>$record['id'],'title'=>$record['title']?? '(No Title)','summary'=>$summary['summary']?? '','keywords'=>json_encode($summary['keywords']??[]),'platforms'=>json_encode($summary['posts']??[]),'status'=>'ready','created_on'=>date('Y-m-d H:i:s'),];return $this->db->table('bf_marketing_scraper')->insert($data);}public function insertNewsContent(array $newsItem,string $ticker){$data=['title'=>$newsItem['title']?? '','summary'=>$newsItem['summary']?? '','content'=>$newsItem['content']?? '','type'=>'financial_news','status'=>'Published','created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),'scraped_at'=>date('Y-m-d H:i:s'),'keywords'=>json_encode($newsItem['keywords']??[]),'links'=>json_encode($newsItem['links']??[]),'audience_type'=>'investor','activity'=>$ticker,];return $this->db->table('bf_marketing_scraper')->insert($data);}public function insertTempScraper($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function idleFetchEmails(){$config=config('NewsEmailServer');$connectionString="{$config->host}:{$config->port}/imap/{$config->encryption}";$inbox=@imap_open($connectionString,$config->username,$config->password);if(!$inbox){log_message('error','Cannot connect to email server: '.imap_last_error());return;}try{while(true){if(function_exists('imap_idle')){$status=imap_idle($inbox);}else{log_message('warning','ðŸ“­ imap_idle not supported on this server. Falling back to polling.');sleep(30);continue;}$status=imap_idle($inbox);if($status){$emails=imap_search($inbox,'ALL');if($emails){foreach($emails as $email_number){$overview=imap_fetch_overview($inbox,$email_number,0)[0];$sender=$overview->from;$subject=$overview->subject;$body=imap_fetchbody($inbox,$email_number,1);$data=['status'=>'In Review','type'=>'Email/Newsletters','email_identifier'=>md5($subject.$sender.$overview->date),'email_date'=>date('Y-m-d H:i:s',strtotime($overview->date)),'email_sender'=>$sender,'email_subject'=>$subject,'email_body'=>$body,'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];if($this->isEmailProcessed($data['email_identifier'])){log_message('debug','Email already processed: '.$data['email_identifier']);}else{$this->storeEmailContent($data);}}}else{log_message('debug','No new emails found or imap_search returned false');}}sleep(30);}}catch(\Exception $e){log_message('error','An exception occurred during email fetching: '.$e->getMessage());}finally{imap_close($inbox);}}public function isEmailProcessed($emailIdentifier){return $this->where('email_identifier',$emailIdentifier)->countAllResults()>0;}private function mapToContextualHashtags($keywords){return array_map(fn($keyword)=>'#'.preg_replace('/\s+/','',ucfirst($keyword)),$keywords);}public function markEmailsAsProcessed($ids=[]){if(!empty($ids)){return $this->db->table('bf_marketing_temp_scraper')->whereIn('id',$ids)->update(['status'=>'Processed']);}return false;}public function markTempRecordAsProcessed($id){return $this->db->table('bf_marketing_temp_scraper')->where('id',$id)->update(['status'=>'Processed','updated_at'=>date('Y-m-d H:i:s')]);}public function markTempScraperProcessed($id){$this->db->table('bf_marketing_temp_scraper')->where('id',$id)->update(['status'=>'Processed']);}public function processText($emailBody){$summary=$this->summarizeText($emailBody);$keywords=$this->extractKeywords($emailBody);$hashtags=$this->mapToContextualHashtags($keywords);if(empty($summary)||empty($hashtags)){log_message('error','Text processing failed');return false;}return $summary.' '.implode(' ',$hashtags);}public function saveApprovedLogo($symbol,$imageUrl){$symbol=strtoupper(trim($symbol));$data=['symbol'=>$symbol,'image_url'=>$imageUrl,'approved_at'=>date('Y-m-d H:i:s'),'updated_at'=>date('Y-m-d H:i:s'),];try{$existingLogo=$this->db->table('bf_company_logos')->where('symbol',$symbol)->get()->getRow();if($existingLogo){if($existingLogo->image_url!==$imageUrl){$this->db->table('bf_company_logos')->where('symbol',$symbol)->update($data);log_message('info',"Logo for symbol {$symbol} updated in bf_company_logos.");}else{log_message('info',"Logo for symbol {$symbol} already exists and is up to date.");}}else{$this->db->table('bf_company_logos')->insert($data);log_message('info',"Logo for symbol {$symbol} added to bf_company_logos.");}}catch(\Exception $e){log_message('error',"Failed to save or update logo for symbol {$symbol}: ".$e->getMessage());}}public function saveDailyLog($data){return $this->db->table('bf_marketing_scraper')->insert($data);}public function saveLogo($data){$symbol=strtoupper(trim($data['symbol']));$existing=$this->db->table('bf_company_logos')->where('symbol',$symbol)->get()->getRow();$data['symbol']=$symbol;$data['updated_at']=date('Y-m-d H:i:s');if($existing){$this->db->table('bf_company_logos')->where('symbol',$symbol)->update($data);log_message('info',"Logo for symbol {$symbol} updated in bf_company_logos.");}else{$data['created_at']=date('Y-m-d H:i:s');$this->db->table('bf_company_logos')->insert($data);log_message('info',"Logo for symbol {$symbol} added to bf_company_logos.");}}public function scheduleNewsletterCampaign($data){return $this->db->table('bf_marketing_newsletters')->insert($data);}public function storeContentAnalytics(array $data){return $this->db->table('bf_marketing_analysis')->insert($data);}public function storeEmail($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function storeEmailContent($data){return $this->insert($data);}public function storeFinalMarketingContent($data){return $this->db->table('bf_marketing_scraper')->insert($data);}public function storeTodaysStory($title,$content){$data=['title'=>$title,'content'=>$content,'links'=>json_encode([]),'url'=>'','type'=>'todays_story','scraped_at'=>date('Y-m-d H:i:s'),'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function submitCampaignContent($data){if(isset($data['promotional_links'])&&is_array($data['promotional_links'])){$data['promotional_links']=json_encode($data['promotional_links']);}$data['status']=$data['status']?? 1;$data['stage']=$data['stage']?? 'draft';$data['created_on']=date('Y-m-d H:i:s');return $this->save($data);}public function storeNewsletterDraft($data){return $this->db->table('bf_marketing_newsletters')->insert($data);}public function storeNotification($data){return $this->db->table('bf_users_promotional_messages')->insert($data);}public function storeScrapedContent($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function storeTempScrapedData($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function summarizeText($text){if(empty($text)){return '';}$sentences=explode('.',$text);if(count($sentences)<=1){return substr($text,0,200);}$tokenizer=new WhitespaceTokenizer();$documents=array_map([$tokenizer,'tokenize'],$sentences);$documents=array_filter($documents);if(empty($documents)){return '';}$tfidf=new TfIdfTransformer();try{$tfidf->transform($documents);}catch(\Exception $e){log_message('error','TfIdfTransformer failed: '.$e->getMessage());return '';}$sentenceScores=[];foreach($documents as $index=>$document){$sentenceScores[$index]=array_sum($document);}arsort($sentenceScores);$numSentences=min(5,count($sentenceScores));$summarySentences=array_slice(array_keys($sentenceScores),0,$numSentences);return implode('. ',array_intersect_key($sentences,array_flip($summarySentences)));}public function updateBufferItem($id,$data){return $this->db->table('bf_marketing_buffer')->where('id',$id)->update($data);}public function updateBufferStatus($id,$status){return $this->db->table('bf_marketing_buffer')->where('id',$id)->update(['status'=>$status]);}public function updateCampaignStatus($id,$status){return $this->db->table('bf_marketing_newsletters')->where('id',$id)->update(['status'=>$status]);}public function updateEmailFields($id,$title,$url,$content=null){$data=['title'=>$title,'url'=>$url];if(!empty($content)){$data['content']=$content;}return $this->db->table('bf_marketing_temp_scraper')->where('id',$id)->update($data);}public function updateExchangeToken($id,$data){return $this->update($id,$data);}public function updateNotification($data){return $this->db->table('bf_users_promotional_messages')->update($data);}public function updateSchedule($id,$data){return $this->db->table('bf_marketing_schedule')->where('id',$id)->update($data);}public function updatePostStatus($id,$status){return $this->db->table('bf_marketing_schedule')->where('id',$id)->update(['post_status'=>$status,'last_attempt_at'=>date('Y-m-d H:i:s')]);}} ?><?php namespace App\Services;use App\Libraries\{BaseLoader,MyMIMarketing};use App\Models\{MarketingModel};use GuzzleHttp\Client;class MarketingService{use BaseLoader;protected $MyMIMarketing;protected $marketingModel;protected $httpClient;public function __construct(){$this->MyMIMarketing=new MyMIMarketing();$this->marketingModel=new MarketingModel();$this->httpClient=new Client(['timeout'=>5,'stream'=>true,'http_errors'=>false,'headers'=>['User-Agent'=>'MyMI Content Bot','Accept-Encoding'=>'gzip, deflate, br',]]);}public function distributeContent($platform,$message){switch($platform){case 'discord':return $this->sendToDiscordWebhook($message);case 'facebook':return $this->sendToZapier('facebook',$message);case 'linkedin':return $this->sendToZapier('linkedin',$message);default:return false;}}public function extractTopKeywords($summary){return $this->getMyMIMarketing()->extractKeywords($summary['summary']);}public function fetchUnprocessedEmailSummaries(){return $this->getMyMIMarketing()->getEmailSummariesForReview();}public function getEmailRecordById($id){return $this->marketingModel->getEmailRecordById($id);}public function getFeatures(){$getFeatures=$this->getMyMIMarketing()->getFeatures();return $getFeatures;}public function gatherKeywordBasedContent($keywords){$allContent=[];foreach($keywords as $keyword){$secData=$this->getMyMIMarketing()->scrapeGoogleSearch("SEC filings {$keyword}");$alphaVantageData=$this->getMyMIMarketing()->scrapeGoogleSearch("AlphaVantage {$keyword}");$googleData=$this->getMyMIMarketing()->scrapeGoogleSearch($keyword,$this->httpClient);$internalData=$this->getMyMIMarketing()->getScrapesByKeyword($keyword);$allContent[]=array_merge([$secData],[$alphaVantageData],[$googleData],$internalData);}return $allContent;}public function generateContentFromPost($title,$content,$tags){$summaryData=$this->getMyMIMarketing()->summarizeContent($content);if(empty($summaryData)||empty($summaryData['summary'])){log_message('error','generateContentFromPost() failed to generate summary.');return null;}return $this->getMyMIMarketing()->generatePlatformContent($summaryData['summary'],$tags);}public function generateFinalContentFromTemp(){$records=$this->marketingModel->getTopTempRecords(5);foreach($records as $record){if(empty($record['title'])||empty($record['content']))continue;$summary=$this->summarizeContent($record['content']);$socialMediaPost=$this->generateSocialPost($summary);$final=['title'=>$record['title'],'content'=>$summary,'post_text'=>$socialMediaPost,'source'=>'email','created_at'=>date('Y-m-d H:i:s'),];$this->marketingModel->insertFinalScraper($final);}}public function generatePlatformPosts($content){$summaryText=implode(" ",array_column($content,'content'));return $this->getMyMIMarketing()->generateContentFromLargeText($summaryText,[]);}public function getManagementTeam(){$getManagementTeam=$this->getMyMIMarketing()->getManagementTeam();return $getManagementTeam;}public function getMarketingData($accountid,$category,$platform){$data=[];if($category&&$accountid){$scrapedData=$this->getMyMIMarketing()->scrapeTokenContentByAccountId($accountid);if($scrapedData){$data['generatedData']=$this->getMyMIMarketing()->generateContentFromScrapedData($scrapedData,$platform);}else{$data['generatedData']=[];}}return $data;}public function getPromotionalBanners($userId){return $this->getMyMIMarketing()->fetchPromotionalBanners($userId);}public function getRecentGeneratedContent($limit=10){return $this->db->table('bf_marketing_scraper')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function regeneratePostsFromEmailId($id){$record=$this->getEmailRecordById($id);if(!$record||empty($record['content'])){log_message('error',"âŒ Email record not found or empty for ID: $id");return null;}$processed=$this->getMyMIMarketing()->generateContentFromRaw($record);if($processed){$this->marketingModel->insertFinalScraper($record,$processed);$this->marketingModel->markEmailsAsProcessed([$id]);return $processed;}return null;}public function sanitizeAndSummarize($content){$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($content);return $this->getMyMIMarketing()->summarizeContent($cleanedBody);}public function storeGeneratedPostsForDashboard($posts){$this->getMyMIMarketing()->storeGeneratedContent(['primary_content'=>$posts['summary'],'social_media_content'=>json_encode($posts['platforms_content']),'status'=>'Generated','created_on'=>date('Y-m-d H:i:s'),]);}protected function sendToDiscordWebhook($message){$webhook=getenv('DISCORD_WEBHOOK_URL');if(!$webhook)return false;$client=\Config\Services::curlrequest();$payload=['content'=>$message];$response=$client->post($webhook,['json'=>$payload]);return $response->getStatusCode()===204;}protected function sendToZapier($platform,$message){$zapierHooks=['facebook'=>getenv('ZAPIER_FACEBOOK_WEBHOOK'),'linkedin'=>getenv('ZAPIER_LINKEDIN_WEBHOOK'),];$hook=$zapierHooks[$platform]?? null;if(!$hook)return false;$client=\Config\Services::curlrequest();$payload=['message'=>$message,'platform'=>$platform];$response=$client->post($hook,['json'=>$payload]);return $response->getStatusCode()===200;}public function storeScrapedContent($content){foreach($content as $data){$this->getMyMIMarketing()->storeTempScrapedData(['title'=>$data['title'],'content'=>$data['content'],'scraped_at'=>date('Y-m-d H:i:s'),'type'=>'keyword_summary',]);}}} ?><?php namespace App\Modules\APIs\Controllers;use CodeIgniter\Controller;use App\Modules\APIs\Controllers\MarketingController;use App\Libraries\{BaseLoader,MyMIAlerts,MyMIMarketing};use App\Models\{AlertsModel,ExchangeModel,MarketingModel,ReferralModel,SupportModel,UserModel};use App\Services\{MarketingService};use CodeIgniter\API\ResponseTrait;class ManagementController extends UserController{use BaseLoader;use ResponseTrait;protected $alertManager;protected $MyMIMarketing;protected $marketingService;protected $alertsModel;protected $exchangeModel;protected $marketingModel;protected $userModel;protected $referralModel;protected $supportModel;public function __construct(){$this->alertManager=new MyMIAlerts();$this->MyMIMarketing=new MyMIMarketing();$this->alertsModel=new AlertsModel();$this->exchangeModel=new ExchangeModel();$this->marketingModel=new MarketingModel();$this->marketingService=new MarketingService();$this->referralModel=new ReferralModel();$this->supportModel=new SupportModel();$this->userModel=new UserModel();}public function runCRONTasks(){log_message('info','ðŸ› ï¸ ManagementController::runCRONTasks() initiated.');$marketingController=new MarketingController();log_message('info','ðŸ“Œ Step 1: cronFetchAndGenerateNews()');try{$marketingController->cronFetchAndGenerateNews();}catch(\Throwable $e){log_message('error','âŒ cronFetchAndGenerateNews failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 3: generateDailyContentDigest()');try{$todayNews=$this->marketingModel->getTodaysScrapedContent();if(!empty($todayNews)){$marketingController->generateDailyContentDigest();}else{log_message('info','ðŸ›‘ Skipping summary generation â€” no scraped news available today.');}}catch(\Throwable $e){log_message('error','âŒ generateDailyContentDigest() failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 4: cronFetchInbox()');try{$marketingController->cronFetchInbox();}catch(\Throwable $e){log_message('error','âŒ cronFetchInbox() failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 5: cronAnalyzeContent()');try{$marketingController->cronAnalyzeContent();}catch(\Throwable $e){log_message('error','âŒ cronAnalyzeContent() failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 6: reprocessIncompleteEmails()');try{$marketingController->runBackfillForTempEmails();}catch(\Throwable $e){log_message('error','âŒ reprocessIncompleteEmails() failed: '.$e->getMessage());}log_message('info','âœ… ManagementController::runCRONTasks() completed.');}public function ajaxGetActiveUsers(){log_message('debug','ðŸ“¥ ajaxGetActiveUsers() called.');$request=service('request');$post=$request->getPost();log_message('debug','ðŸ“¦ Incoming POST: '.print_r($post,true));$start=$post['start']?? 0;$length=$post['length']?? 10;$search=$post['search']['value']?? '';$records=$this->userModel->getUsersByStatus(1,$search);$totalRecords=count($records);$records=array_slice($records,$start,$length);$data=[];foreach($records as $user){try{$actionView=view('ManagementModule\Views\Users\partials\action_buttons',['user'=>$user]);}catch(\Throwable $e){log_message('error','âŒ Error rendering action_buttons view for user ID '.$user['id'].': '.$e->getMessage());$actionView='<span class="text-danger">View Error</span>';}$data[]=['id'=>'<a href="'.site_url('Management/Users/Profile/'.$user['username']).'">'.$user['id'].'</a>','type'=>$user['type'],'name'=>$user['first_name'].' '.$user['last_name'].' '.$user['name_suffix'],'email'=>'<a href="mailto:'.$user['email'].'">'.$user['email'].'</a>','location'=>$user['city'].', '.$user['state'],'referral_code'=>$user['referral_code'],'actions'=>$actionView,];}return $this->response->setJSON(['draw'=>intval($post['draw']?? 1),'recordsTotal'=>$totalRecords,'recordsFiltered'=>$totalRecords,'data'=>$data,]);}public function ajaxGetInactiveUsers(){log_message('debug','ðŸ“¥ ajaxGetInactiveUsers() called.');$request=service('request');$post=$request->getPost();log_message('debug','ðŸ“¦ Incoming POST: '.print_r($post,true));$start=$post['start']?? 0;$length=$post['length']?? 10;$search=$post['search']['value']?? '';$records=$this->userModel->getUsersByStatus(0,$search);$totalRecords=count($records);$records=array_slice($records,$start,$length);$data=[];foreach($records as $user){try{$actionView=view('ManagementModule\Views\Users\partials\action_buttons',['user'=>$user]);}catch(\Throwable $e){log_message('error','âŒ Error rendering action_buttons view for user ID '.$user['id'].': '.$e->getMessage());$actionView='<span class="text-danger">View Error</span>';}$data[]=['id'=>'<a href="'.site_url('Management/Users/Profile/'.$user['username']).'">'.$user['id'].'</a>','type'=>$user['type'],'name'=>$user['first_name'].' '.$user['last_name'].' '.$user['name_suffix'],'email'=>'<a href="mailto:'.$user['email'].'">'.$user['email'].'</a>','location'=>$user['city'].', '.$user['state'],'referral_code'=>$user['referral_code'],'actions'=>$actionView,];}return $this->response->setJSON(['draw'=>intval($post['draw']?? 1),'recordsTotal'=>$totalRecords,'recordsFiltered'=>$totalRecords,'data'=>$data,]);}protected function arrayToXml(array $data,\SimpleXMLElement $xml){foreach($data as $key=>$value){is_array($value)?$this->arrayToXml($value,$xml->addChild($key)):$xml->addChild($key,htmlspecialchars($value));}return $xml;}public function checkForSpamUsers(){try{$MyMIUser=new \App\Libraries\MyMIUser();$spamAccounts=$MyMIUser->findPotentialSpamUsers();return $this->response->setJSON(['status'=>'success','message'=>count($spamAccounts).' spam accounts detected.','data'=>$spamAccounts]);}catch(\Throwable $e){log_message('error','âŒ Error checking spam users: '.$e->getMessage());return $this->failServerError('Failed to check for spam accounts.');}}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);log_message('debug','âœ… Content digest completed.');}public function cronFetchAndGenerateNews(){try{$this->getMyMIMarketing()->cronFetchAndGenerateNews();return $this->response->setJSON(['status'=>'success','message'=>'MarketAux news pulled, ranked, and content generated.']);}catch(\Throwable $e){return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();log_message('debug','âœ… Inbox scrape completed.');}public function cronFetchMarketingEmails(){log_message('info','CRON: Starting Marketing Email Fetch');$service=new MarketingService();$emailsFetched=$service->fetchAndStoreMarketingEmails();log_message('info','CRON: Fetched '.$emailsFetched.' marketing emails');return $this->respond(['status'=>'success','fetched'=>$emailsFetched]);}public function cronFetchAndStoreEmails(){try{$this->logMessage('ðŸ“¥ [CRON] Started cronFetchAndStoreEmails');$marketingService=$this->getMarketingService();$fetched=$marketingService->scrapeInboxAndStore();$this->logMessage("ðŸ“© [CRON] Fetched and stored {$fetched} emails into bf_marketing_temp_scraper");return $this->respond(['status'=>'success','stored'=>$fetched]);}catch(\Throwable $e){log_message('error','[CRON] Error in cronFetchAndStoreEmails: '.$e->getMessage());return $this->failServerError('Failed to fetch emails');}}public function distributeTodaysNewsContent(){$generated=$this->generateTodaysNewsSummary();$result=$this->getMyMIMarketing()->sendToZapier($generated['content']);return $this->response->setJSON(['status'=>'success','message'=>'Content distributed via Zapier.','zapier_result'=>$result]);}public function exportPostJson($id){$post=$this->marketingModel->getGeneratedPostById($id);if(!$post||empty($post['posts'])){return $this->failNotFound('Post not found.');}$posts=json_decode($post['posts'],true);$export=['title'=>$post['title'],'summary'=>$post['summary'],'cta'=>'Check it out at https://mymiwallet.com','keywords'=>explode(',',$post['keywords']?? ''),'platform_captions'=>$posts,];return $this->response->setHeader('Content-Type','application/json')->setHeader('Content-Disposition','attachment; filename="canva_post_'.$id.'.json"')->setJSON($export);}public function fetchAlphaVantageNewsForTradeAlerts(){$alerts=$this->alertsModel->getTradeAlertsWithCreatedFlag();log_message('info','ðŸ“ˆ Processing '.count($alerts).' trade alerts.');foreach($alerts as $alert){try{log_message('info','ðŸ” Fetching AlphaVantage news for: '.$alert['ticker']);$newsItems=$this->alertManager->fetchAlphaVantageNews($alert['ticker']);log_message('info','ðŸ“° '.count($newsItems).' news items fetched for '.$alert['ticker']);foreach($newsItems as $news){$this->marketingModel->insertNewsContent($news,$alert['ticker']);}}catch(\Throwable $e){log_message('error','âŒ AlphaVantage fetch failed for '.$alert['ticker'].': '.$e->getMessage());}}return $this->response->setJSON(['status'=>'success','message'=>'Financial news processed for alerts.']);}public function fetchEmailsToTempScraper(){try{log_message('info','ðŸ“¥ Starting email scrape to bf_marketing_temp_scraper...');$this->getMyMIMarketing()->fetchAndStoreEmails('news');log_message('info','ðŸ“¬ Number of emails fetched: '.count($emails));return $this->response->setJSON(['status'=>'success','message'=>'Emails stored successfully.']);}catch(\Throwable $e){log_message('error','âŒ fetchEmailsToTempScraper error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function fetchNewsEmails(){log_message('info','ðŸ“¥ fetchNewsEmails - Started.');try{$this->getMyMIMarketing()->fetchAndStoreEmails('news');return $this->response->setJSON(['status'=>'success','message'=>'News emails fetched successfully.']);}catch(\Exception $e){log_message('error','âŒ fetchNewsEmails - Error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function forceFetchEmails(){try{$result=$this->alertManager->fetchAndStoreEmails();return $this->response->setJSON(['status'=>'success','message'=>'Emails fetched and processed successfully.']);}catch(\Exception $e){return $this->response->setJSON(['status'=>'error','message'=>'Error fetching emails: '.$e->getMessage()],500);}}public function generateContentDigestFromStored(){log_message('info','Marketing: Starting summary generation from stored marketing emails.');$model=new MarketingModel();$records=$model->getRecentUnprocessedTempEmails(5);$results=[];foreach($records as $record){if(empty($record['title'])||empty($record['content'])){log_message('debug','Skipped record due to missing title/content ID: '.$record['id']);continue;}try{$summary=$this->getMarketingService()->generateContentFromRaw($record['title'],$record['content']);$model->storeFinalMarketingContent(['source_id'=>$record['id'],'title'=>$record['title'],'summary'=>$summary,'created_at'=>date('Y-m-d H:i:s')]);$model->markTempRecordAsProcessed($record['id']);$results[]=$record['title'];}catch(\Throwable $e){log_message('error','Failed to process record ID '.$record['id'].': '.$e->getMessage());}}return $this->respond(['status'=>'complete','processed_titles'=>$results]);}public function generateContentFromScraper(){log_message('debug','ðŸ” API::MarketingController::generateContentFromScraper called');try{$limit=$this->request->getGet('limit')?? 5;$records=[];$allRecords=$this->marketingModel->getValidUnprocessedEmails($limit);if(!is_array($allRecords)){log_message('error','âŒ $allRecords is not an array or null. Cannot proceed.');return $this->respond(['status'=>'error','message'=>'Failed to fetch records.']);}foreach($allRecords as $record){$titleOk=!empty($record['title']);$contentOk=strlen(strip_tags($record['content']?? ''))>1000;if($titleOk&&$contentOk){$records[]=$record;if(count($records)>=$limit)break;}else{log_message('debug',"âš ï¸ Skipping invalid record ID {$record['id']} during prefilter (Title or content missing/too short).");$this->marketingModel->markEmailsAsProcessed([$record['id']]);}}if(empty($records)){return $this->respond(['status'=>'no_data','message'=>'No unprocessed records found.']);}$processedSummaries=[];foreach($records as $record){$content=$record['content']?? '';$title=$record['title']?? '';$recordId=$record['id']?? 0;if(empty(trim($content))||strlen($content)<1000){log_message('debug',"â­ï¸ Skipping record ID {$recordId} - content too short or empty.");continue;}if(empty(trim($title))){log_message('debug',"â­ï¸ Skipping record ID {$recordId} - missing title.");continue;}if(stripos($content,'<html')!==false&&substr_count($content,'<')>50){log_message('debug',"â­ï¸ Skipping record ID {$recordId} - content likely raw HTML.");continue;}try{$processed=$this->getMarketingService()->generateContentFromRaw($record);if(!is_array($processed)){log_message('debug',"âš ï¸ Skipped record ID {$recordId} - generateContentFromRaw() returned invalid structure.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$this->marketingModel->markEmailsAsProcessed([$recordId]);$processedSummaries[]=['id'=>$recordId,'title'=>$processed['headline']?? $title,'summary'=>$processed['summary']?? '','keywords'=>$processed['keywords']??[],];}catch(\Throwable $e){log_message('error',"âŒ Failed to process record ID {$recordId}: {$e->getMessage()}");}}return $this->respond(['status'=>'success','message'=>count($processedSummaries).' records processed successfully.','data'=>$processedSummaries]);}catch(\Throwable $e){log_message('error','âŒ API::generateContentFromScraper error - '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function generateDailyContentDigest(){log_message('debug','ðŸ§  Start Memory Usage: '.memory_get_usage(true));@ini_set('memory_limit','768M');$limit=5;$summary=[];try{$records=$this->marketingModel->getValidUnprocessedEmails($limit);if(!is_array($records)||empty($records)){log_message('info','ðŸš« No valid records returned from getValidUnprocessedEmails().');return $this->response->setJSON(['status'=>'no_data','message'=>'No valid records to process.']);}foreach($records as $record){$recordId=$record['id']?? 0;$title=$record['title']?? '';$content=$record['content']?? '';$contentSize=strlen(strip_tags($content));if(empty(trim($title))||$contentSize<1000){log_message('debug',"âš ï¸ Skipping record ID {$recordId} â€” title missing or content too short ({$contentSize} chars).");$this->marketingModel->markEmailsAsProcessed([$recordId]);continue;}if(stripos($content,'<html')!==false&&substr_count($content,'<')>50){log_message('debug',"â­ï¸ Skipping record ID {$recordId} â€” likely raw HTML content.");$this->marketingModel->markEmailsAsProcessed([$recordId]);continue;}try{gc_collect_cycles();$processed=$this->getMarketingService()->generateContentFromRaw($record);if(!is_array($processed)){log_message('warning',"âš ï¸ Skipped record ID {$recordId} â€” generateContentFromRaw() returned invalid result.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$this->marketingModel->markEmailsAsProcessed([$recordId]);$summary[]=['title'=>$processed['headline']?? 'Untitled','summary'=>$processed['summary']?? '','subtopics'=>$processed['subtopics']??[],'platform_posts'=>$processed['posts']??[],];}catch(\Throwable $e){log_message('error',"âŒ Error processing record ID {$recordId}: {$e->getMessage()}");}}log_message('debug','ðŸ Peak Memory Usage: '.memory_get_peak_usage(true));return $this->response->setJSON(['status'=>'success','digest'=>$summary]);}catch(\Throwable $e){log_message('error','âŒ generateDailyContentDigest fatal error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function generateRankedMarketingContent(){$this->getMyMIMarketing()->generateRankedMarketingContent();return $this->response->setJSON(['status'=>'success','message'=>'Ranked content generated.']);}public function getBalanceSheet($symbol,$apikey){$url="https://www.alphavantage.co/query?function=BALANCE_SHEET&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getCashFlowStatement($symbol,$apikey){$url="https://www.alphavantage.co/query?function=CASH_FLOW&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getCompanyOverview($symbol,$apikey){$url="https://www.alphavantage.co/query?function=OVERVIEW&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getEarningsCalendar($apikey,$horizon='3month'){$url="https://www.alphavantage.co/query?function=EARNINGS_CALENDAR&horizon=".$horizon."&apikey=".$apikey;$csv=file_get_contents($url);$lines=explode("\n",trim($csv));$data=array_map('str_getcsv',$lines);return $data;}public function getFixedWindowAnalytics($symbols,$rangeStart,$rangeEnd,$calculations,$apikey){$url="https://alphavantageapi.co/timeseries/analytics?SYMBOLS=".urlencode($symbols);$url.="&RANGE=".$rangeStart."&RANGE=".$rangeEnd;$url.="&INTERVAL=DAILY&OHLC=close";$url.="&CALCULATIONS=".urlencode($calculations)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getIncomeStatement($symbol,$apikey){$url="https://www.alphavantage.co/query?function=INCOME_STATEMENT&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getInsiderTransactions($symbol,$apikey){$url="https://www.alphavantage.co/query?function=INSIDER_TRANSACTIONS&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getNewsSentiment($apikey,$tickers='',$topics='',$time_from='',$time_to='',$sort='LATEST',$limit=50){$url="https://www.alphavantage.co/query?function=NEWS_SENTIMENT";$url.="&tickers=".urlencode($tickers);$url.="&topics=".urlencode($topics);if($time_from)$url.="&time_from=".$time_from;if($time_to)$url.="&time_to=".$time_to;$url.="&sort=".$sort."&limit=".$limit."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getSlidingWindowAnalytics($symbols,$range,$windowSize,$calculations,$apikey){$url="https://alphavantageapi.co/timeseries/running_analytics?SYMBOLS=".urlencode($symbols);$url.="&RANGE=".$range."&INTERVAL=DAILY&OHLC=close";$url.="&WINDOW_SIZE=".$windowSize;$url.="&CALCULATIONS=".urlencode($calculations)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function generatePostsFromSummary($summaryId=null){try{$summary=$this->marketingModel->find($summaryId);if(!$summary){return $this->failNotFound('Summary not found.');}$decodedTitleRaw=$summary['title']?? '';$decodedSummaryRaw=$summary['summary']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$decodedSummary=quoted_printable_decode($decodedSummaryRaw);$cleanedSummary=html_entity_decode(strip_tags($decodedSummary));$keywords=$this->MyMIMarketing->extractKeywords($cleanedSummary);$posts=$this->MyMIMarketing->generateSocialPosts($cleanedSummary,$keywords);$this->marketingModel->update($summaryId,['keywords'=>json_encode($keywords),'posts'=>json_encode($posts),]);return $this->respond(['status'=>'success','message'=>'Content generated and stored successfully.','original'=>$summary,'cleaned'=>['title'=>$decodedTitle,'summary'=>$cleanedSummary,'keywords'=>$keywords,'posts'=>$posts,],]);}catch(\Throwable $e){log_message('error','âŒ generatePostsFromSummary() failed: '.$e->getMessage());return $this->failServerError('Error generating posts.');}}public function testTfIdfPipeline(){$samples=['Short unstructured','This is a valid test document with enough content and structure to process correctly.','     ','<html><body>Broken HTML without substance</body></html>','Here is another test input to validate TF-IDF scoring logic.',];foreach($samples as $i=>$text){$summary=$this->MyMIMarketing->summarizeText($text);$keywords=$this->MyMIMarketing->extractKeywords($text);$scorePreview=$this->MyMIMarketing->getTopKeywordScores($text,5);log_message('debug',"ðŸ§ª Test #{$i} | Summary: {$summary}");log_message('debug',"ðŸ§ª Test #{$i} | Keywords: ".implode(',',$keywords));log_message('debug',"ðŸ“Š Test #{$i} | TF-IDF Scores: ".print_r($scorePreview,true));}return $this->respond(['status'=>'ok','message'=>'TF-IDF test pipeline ran successfully.']);}public function generateTodaysNewsSummary(){$todayNews=$this->marketingModel->getTodaysNewsContent();$summary=$this->getMyMIMarketing()->summarizeMultipleArticles($todayNews);$content=$this->getMyMIMarketing()->generateMarketingContent($summary);return $this->response->setJSON(['status'=>'success','summary'=>$summary,'content'=>$content]);}public function generateTodaysStory(){ini_set('memory_limit','1024M');try{log_message('info','ðŸ” Starting email scrape for news@mymiwallet.com...');$this->getMyMIMarketing()->fetchAndStoreEmails('news');$today=date('Y-m-d');$scrapes=$this->marketingModel->getScrapesByDate($today,10);if(empty($scrapes)){log_message('info','No scraped emails found for today.');return $this->response->setJSON(['status'=>'error','message'=>'No emails found for today.'],404);}$summaries=[];foreach(array_chunk($scrapes,10)as $scrapeChunk){foreach($scrapeChunk as $scrape){$content=$scrape['email_body']?? $scrape['content']?? '';log_message('info','Content size: '.strlen($content));$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($content);$summary=$this->getMyMIMarketing()->summarizeContent($cleanedBody);log_message('debug','Memory after summary: '.memory_get_usage(true));if(is_array($summary)){$summary=$summary['summary']?? implode('. ',array_map('strval',$summary));}$summaries[]=$summary;}}$combinedSummary=implode("\n\n",$summaries);if(strlen($combinedSummary)>500000){log_message('warning','Combined summary too long. Truncating...');$combinedSummary=substr($combinedSummary,0,500000);}$todayTitle="Today's Top Stories - ".date('F j, Y');$data=['title'=>$todayTitle,'content'=>$combinedSummary,'links'=>json_encode([]),'url'=>'','type'=>'todays_story','scraped_at'=>date('Y-m-d H:i:s'),'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeTempScrapedData($data);log_message('info','âœ… Todayâ€™s story generated and stored.');return $this->response->setJSON(['status'=>'success','message'=>'Todayâ€™s story generated and stored successfully!','title'=>$todayTitle,'summary'=>$combinedSummary]);}catch(\Throwable $e){log_message('error','âŒ generateTodaysStory error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function generateVoiceScriptManually(){try{log_message('info','ðŸŽ¤ generateVoiceScriptManually() triggered.');$script=$this->getMyMIMarketing()->generateVoiceoverScript();return $this->response->setJSON(['status'=>'success','script'=>$script]);}catch(\Throwable $e){log_message('error','âŒ Error in generateVoiceScriptManually: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()]);}}public function getAlerts(){log_message('debug','ðŸ” getAlerts called');try{$alerts=$this->alertsModel->getAllTradeAlerts();log_message('debug','âœ… getAlerts retrieved '.count($alerts).' alerts.');return $this->response->setJSON($alerts);}catch(\Throwable $e){log_message('error','âŒ getAlerts error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getAssets(){log_message('debug','ðŸ“Š getAssets called');try{$assets=$this->exchangeModel->getManagementAssets();log_message('debug','âœ… getAssets retrieved '.count($assets).' assets.');return $this->response->setJSON($assets);}catch(\Throwable $e){log_message('error','âŒ getAssets error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getNews(){log_message('debug','ðŸ“° getNews called');try{$news=$this->marketingModel->getNewsAlerts();log_message('debug','âœ… getNews retrieved '.count($news).' news records.');return $this->response->setJSON($news);}catch(\Throwable $e){log_message('error','âŒ getNews error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getReferrals(){log_message('debug','ðŸ” getReferrals called');try{$referrals=$this->referralModel->getAllReferrals();log_message('debug','âœ… getReferrals retrieved '.count($referrals).' referrals.');return $this->response->setJSON($referrals);}catch(\Throwable $e){log_message('error','âŒ getReferrals error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getSupport(){log_message('debug','ðŸ§¾ getSupport called');try{$support=$this->supportModel->getManagementSupport();log_message('debug','âœ… getSupport retrieved '.count($support).' support records.');return $this->response->setJSON($support);}catch(\Throwable $e){log_message('error','âŒ getSupport error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getTopMovers($apikey){$url="https://www.alphavantage.co/query?function=TOP_GAINERS_LOSERS&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getUpcomingIPOs($apikey){$url="https://www.alphavantage.co/query?function=IPO_CALENDAR&apikey=".$apikey;$csv=file_get_contents($url);$lines=explode("\n",trim($csv));$data=array_map('str_getcsv',$lines);return $data;}public function getUsers(){log_message('debug','ðŸ” getUsers called');}public function massResendActivationEmails(){$users=$this->userModel->getPendingActivationUsers();$activator=service('activator');$emailer=\Config\Services::email();$successCount=0;$failureCount=0;foreach($users as $user){$sent=$activator->send($user);if($sent){$successCount++;log_message('info',"Activation email sent to: {$user->email}");}else{$failureCount++;log_message('error',"Failed to send activation email to: {$user->email}");}}$summary="{$successCount} emails sent successfully, {$failureCount} failed.";return redirect()->to('/Management/Users')->with('message',$summary);}public function processAllTradeAlerts(){try{log_message('info','âš¡ Management API - processAllTradeAlerts triggered.');$this->alertManager->fetchAndStoreAlertsEmails();$this->alertManager->processTradeAlertsInBatches(50);$this->alertManager->updateAlerts();return $this->response->setJSON(['status'=>'success','message'=>'All trade alerts processed successfully.']);}catch(\Exception $e){log_message('error','âŒ Management API - Error processing trade alerts: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function processAndGenerateMarketingContent(){$emails=$this->getMarketingService()->fetchUnprocessedEmailSummaries();if(!empty($emails)&&is_array($emails)){foreach($emails as $email){$cleanContent=$this->getMarketingService()->sanitizeAndSummarize($email['email_body']);$keywords=$this->getMyMIMarketing()->extractTopKeywords($cleanContent);$externalContent=$this->getMarketingService()->gatherKeywordBasedContent($keywords);$this->getMarketingService()->storeScrapedContent($externalContent);$generatedPosts=$this->getMarketingService()->generatePlatformPosts($externalContent);$this->getMarketingService()->storeGeneratedPostsForDashboard($generatedPosts);}}return redirect()->to('/Management/Marketing')->with('message','Content generation completed.');}public function processTempEmailsToScraper(){try{log_message('info','âš™ï¸ Starting content generation from bf_marketing_temp_scraper...');$tempEmails=$this->marketingModel->getRecentScrapes();foreach($tempEmails as $email){$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($email->email_body);$summary=$this->getMyMIMarketing()->summarizeContent($cleanedBody);$keywords=$this->marketingModel->extractKeywords($email->email_body);$hashtags=$this->marketingModel->mapToContextualHashtags($keywords);$data=['title'=>$email->email_subject ?? 'Generated Content','summary'=>is_array($summary)?implode("\n",$summary):$summary,'content'=>$email->email_body,'tags'=>implode(',',$keywords),'type'=>'Email/Newsletters','status'=>'pending','created_on'=>date('Y-m-d H:i:s'),'author_information'=>$email->email_sender,];$this->marketingModel->saveDailyLog($data);}log_message('info','âœ… Finished processing and saving to bf_marketing_scraper.');return $this->response->setJSON(['status'=>'success','message'=>'Content generated and saved to bf_marketing_scraper.',]);}catch(\Throwable $e){log_message('error','âŒ processTempEmailsToScraper error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function reprocessIncompleteEmails(){try{$this->getMyMIMarketing()->reprocessIncompleteEmails();return $this->response->setJSON(['status'=>'success','message'=>'Backfilled incomplete emails.']);}catch(\Throwable $e){log_message('error','âŒ reprocessIncompleteEmails error: '.$e->getMessage());return $this->failServerError('Failed to reprocess incomplete emails.');}}public function runCronManually(){$this->runCRONTasks();return $this->response->setJSON(['status'=>'success','message'=>'Manual CRON execution complete.']);}public function runDailyAlphaVantageDataPipeline(){$symbols=$this->alertsModel->getTopWatchlistSymbols();$apikey=getenv('ALPHA_VANTAGE_KEY');foreach($symbols as $symbol){$this->fetchAlphaVantageNewsForTradeAlerts($symbol['symbol'],$apikey);$this->getCompanyOverview($symbol['symbol'],$apikey);$this->getIncomeStatement($symbol['symbol'],$apikey);}return $this->response->setJSON(['status'=>'success','message'=>'Daily Alpha Vantage data pipeline completed.']);}public function sendToZapierManually(){$summary=$this->generateTodaysNewsSummary();$result=$this->getMyMIMarketing()->sendToZapier($summary['content']);return $this->response->setJSON(['status'=>'success','message'=>'Sent manually to Zapier.','result'=>$result]);}public function scrapeAndGenerateTodaysStoryFromInbox(){try{log_message('info','ðŸ“¥ Starting inbox scrape for news@mymiwallet.com...');$this->getMyMIMarketing()->fetchAndStoreEmails('news');$today=date('Y-m-d');$scrapes=$this->marketingModel->getScrapesByDate($today);if(empty($scrapes)){log_message('info','ðŸ“­ No emails found for today.');return $this->response->setJSON(['status'=>'error','message'=>'No emails found for today.'],404);}$summaries=[];foreach($scrapes as $scrape){$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($scrape['content']);$summary=$this->getMyMIMarketing()->summarizeContent($cleanedBody);if(is_array($summary)){$summary=$summary['summary']?? implode('. ',array_map('strval',$summary));}$summaries[]=$summary;}$combinedSummary=implode("\n\n",$summaries);if(strlen($combinedSummary)>500000){log_message('warning','Combined summary too long. Truncating...');$combinedSummary=substr($combinedSummary,0,500000);}$todayTitle="Today's News Highlights - ".date('F j, Y');$data=['title'=>$todayTitle,'content'=>$combinedSummary,'links'=>json_encode([]),'url'=>'','type'=>'todays_story','scraped_at'=>date('Y-m-d H:i:s'),'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeTempScrapedData($data);log_message('info','âœ… Todayâ€™s story generated and stored.');return $this->response->setJSON(['status'=>'success','message'=>'Todayâ€™s story generated and stored successfully!','title'=>$todayTitle,'summary'=>$combinedSummary]);}catch(\Throwable $e){log_message('error','âŒ scrapeAndGenerateTodaysStoryFromInbox error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function sharePost($id,$platform){try{$post=$this->marketingModel->getGeneratedPostById($id);if(!$post||empty($post['posts'])){return $this->failNotFound('Post not found or invalid.');}$posts=json_decode($post['posts'],true);$message=$posts[$platform]?? null;if(!$message){return $this->failValidationError("No formatted message found for platform: $platform");}$success=$this->getMarketingService()->distributeContent($platform,$message);if($success){return $this->respond(['status'=>'success','message'=>'Post shared.']);}else{return $this->failServerError('Failed to dispatch post.');}}catch(\Throwable $e){log_message('error',"[PostShare] Error: ".$e->getMessage());return $this->failServerError('An unexpected error occurred.');}}public function sendAllDiscordAlerts(){$alerts=$this->alertsModel->getAlertsWithNewTVChart();if(empty($alerts)){return $this->response->setJSON(['status'=>'error','message'=>'No new alerts to send.'],404);}foreach($alerts as $alert){$this->alertManager->sendDiscordNotification($alert);}return $this->response->setJSON(['status'=>'success','message'=>'All Discord notifications sent.']);}public function updateMarketDataForAlerts(){try{$this->alertManager->updateAlerts();return $this->response->setJSON(['status'=>'success','message'=>'Trade alerts updated with market data.']);}catch(\Exception $e){return $this->response->setJSON(['status'=>'error','message'=>'Failed to update market data: '.$e->getMessage()],500);}}} ?><?php $managementActionItems=$siteSettings->managementActionItems;$department=$uri->getSegment(2);$viewFileData=['managementActionItems'=>$managementActionItems,'targetUsers'=>$targetUsers ?? 0,'totalActiveUsers'=>$totalActiveUsers ?? 0,'totalActivePartners'=>$totalActivePartners ?? 0,'totalActiveCampaigns'=>$totalActiveCampaigns ??[],'getTasksByDepartment'=>$getTasksByDepartment ??[],'totalDepartmentTasks'=>$totalDepartmentTasks ??[],'totalPageSEOTasks'=>$totalPageSEOTasks ??[],'totalTransFees'=>$totalTransFees ?? 0,'totalLastTransFees'=>$totalLastTransFees ?? 0,'usersPercentage'=>$usersPercentage ?? 0,'getActiveCampaigns'=>$getActiveCampaigns ??[],'totalApprovedAssets'=>$totalApprovedAssets ?? 0,'totalPendingAssets'=>$totalPendingAssets ?? 0,'userGoals'=>$userGoals ??[],'newsUpdates'=>$newsUpdates ??[],'getBlogPosts'=>$getBlogPosts ??[],'recentMarketingPosts'=>$recentMarketingPosts ??[],'todaysStory'=>$todaysStory ??[],]; ?><div class="nk-block"><div class="row gy-gs"><div class="col-lg-12"><div class="nk-block-head-xs"><div class="nk-block-head-content"><h1 class="title nk-block-title">MyMI Management -<?=esc($department)?></h1><a href="<?=site_url('/Management')?>">â† Back to Management Dashboard</a></div></div></div><div class="col-12 col-xxl-4"><?=view('ManagementModule\Views\Marketing\index\action_center_new',$viewFileData)?></div><div class="col-12 col-xxl-8"><?=view('ManagementModule\Views\Marketing\index\most_recent_content',$viewFileData)?></div><div class="col-12"><?php  ?></div><div class="col-12"><?php  ?></div><div class="col-12 col-xxl-6"><?=view('ManagementModule\Views\Marketing\resources\controlPanelBlock',$viewFileData)?><?php  ?></div><div class="col-12 col-xxl-6"><?=view('ManagementModule\Views\Marketing\resources\ctaRecommenderModule',$viewFileData)?></div><div class="col-12 col-xxl-12 px-2"><div class="generated-summaries"id="generatedSummariesBlock"><?=view('ManagementModule\Views\Marketing\resources\generatedSummaries',$viewFileData)?></div></div><div class="col-12 mt-3 col-xxl-12"><div class="card card-bordered"><div class="card-inner"><h5 class="title">ðŸ“° Recent Marketing Posts</h5><?php $validPosts=array_filter($recentMarketingPosts,fn($p)=>!empty($p->title));if(!empty($validPosts)): ?><ul class="list-group"><?php foreach($validPosts as $post): ?><li class="d-flex justify-content-between align-items-start flex-column list-group-item"><div class="w-100"><strong><?=esc($post->title?:'(Untitled Post)')?></strong><br><small class="text-muted"><?=date('M d, Y h:i A',strtotime($post->created_at))?></small><br><?php if(!empty($post->short_description)): ?><small class="text-secondary"><?=esc($post->short_description)?>...</small><?php else: ?><small class="text-secondary">No description available.</small><?php endif; ?></div><div class="mt-2"><button class="btn btn-primary btn-sm"onclick='dynamicModalLoader("Marketing","PreviewGeneratedPost","<?=$post->id?>")'>Preview</button></div></li><?php endforeach; ?></ul><?php else: ?><p>No posts with valid titles available yet. Click 'Generate' to create one!</p><?php endif; ?></div></div></div><div class="col-12 mt-3 col-xxl-4"><?=view('ManagementModule\Views\Marketing\index\exchange_action_center',$viewFileData)?></div><div class="col-12 mt-3 col-xxl-8"><?=view('ManagementModule\Views\Marketing\index\target_users',$viewFileData)?></div></div></div><script <?= $nonce['script'] ?? '' ?>></script><div class="nk-block"><div class="nk-block-head"><div class="d-flex justify-content-between align-items-center nk-block-head-content"><h4 class="nk-block-title">ðŸ“¢ Generated Marketing Summaries</h4><div><div class="d-flex justify-content-end mt-3"><label class="form-check form-switch ml-2"><input class="btn btn-lg form-check-input"id="liveModeToggle"type="checkbox"> <span class="form-check-label">Live Mode</span></label></div></div></div><p class="text-soft">This section shows finalized summaries ready for distribution across platforms.</p></div><div class="row"id="generatedSummariesBlock"><?php if(!empty($todaysStory)): ?><?php foreach($todaysStory as $summary): ?><div class="mb-4 col-lg-4 col-md-6"><div class="card h-100 shadow-sm"><div class="d-flex flex-column card-body"><h6 class="title mb-1"><?=esc($summary['title'])?></h6><p class="small mb-2 text-soft"><?=date('F j, Y g:i A',strtotime($summary['created_at']))?></p><div class="small mb-2"><?=esc($summary['summary'])?></div><?php if(!empty($summary['keywords'])): ?><div class="small mb-2 text-muted"><strong>#Tags:</strong><?php foreach(explode(',',$summary['keywords'])as $tag): ?><span class="badge bg-light me-1 text-dark">#<?=trim($tag)?></span><?php endforeach; ?></div><?php endif; ?><?php if(!empty($summary['cta'])): ?><div class="small mb-2 text-primary"><strong>ðŸ“£ CTA:</strong><?=esc($summary['cta'])?></div><?php endif; ?><a href="javascript:void(0);"class="btn btn-primary btn-sm mt-auto"onclick='dynamicModalLoader("/API/Management/PreviewGeneratedPost/<?=$summary['id']?>")'>ðŸ” Preview Post</a></div></div></div><?php endforeach; ?><?php else: ?><div class="col-12"><div class="alert alert-warning">âš ï¸ No summaries available. Click "Generate Todayâ€™s Content" to begin.</div></div><?php endif; ?></div></div><script <?= $nonce['script'] ?? '' ?>>const liveToggle = document.getElementById('liveModeToggle');
app/Modules/Support/Controllers/Support.php:192:                'page_sitemap_url' => base_url('/sitemap.xml'),
app/Modules/Support/Controllers/Support.php:193:                'page_image' => base_url('/assets/images/default-seo-image.png'),
app/Modules/User/Views/Wallets/Purchase/Memberships.php:4:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Modules/User/Views/Wallets/Purchase/Memberships.php:36:                                    <img class="gold-image" src="<?php echo base_url('assets/images/icons/plan-s1.svg'); ?>" alt="">
app/Modules/User/Views/Wallets/Purchase/Memberships.php:54:                                    <img src="<?php echo base_url('assets/images/icons/plan-s1.svg'); ?>" alt="">
app/Modules/User/Views/Wallets/Purchase/Memberships.php:80:                                    <img src="<?php echo base_url('assets/images/icons/plan-s2.svg'); ?>" alt="">
app/Modules/User/Views/Wallets/Purchase/Memberships.php:109:                                    <img src="<?php echo base_url('assets/images/icons/plan-s3.svg'); ?>" alt="">
app/Modules/User/Views/Wallets/Purchase/Memberships.php:139:                                    <img src="<?php echo base_url('assets/images/icons/plan-s1.svg'); ?>" alt="">
app/Modules/User/Views/Wallets/Purchase/Memberships/Advertisements/CustomizeYourMembership.php:5:        <img class="img img-responsive rounded" src="' . base_url('assets/images/Marketing/Services/MyMIWallet-Customize-Your-Membership-Landing.png') . '" alt="MyMI Wallet - Customize Your Membership" />
app/Modules/User/Views/Wallets/Purchase/Memberships/Advertisements/CustomizeYourMembership.php:10:            echo '<img class="img img-responsive rounded" src="' . base_url('assets/images/Marketing/Services/MyMIWallet-Customize-Your-Membership-Landing.png') . '" alt="MyMI Wallet - Customize Your Membership" />'; 
app/Modules/User/Views/Wallets/Purchase/Memberships/Advertisements/CustomizeYourMembership.php:14:                <img class="img img-responsive rounded" src="' . base_url('assets/images/Marketing/Services/MyMIWallet-Customize-Your-Membership-Landing.png') . '" alt="MyMI Wallet - Customize Your Membership" />
app/Modules/User/Views/Wallets/Purchase/Memberships/Advertisements/CustomizeYourMembership.php:20:            <img class="img img-responsive rounded" src="' . base_url('assets/images/Marketing/Services/MyMIWallet-Customize-Your-Membership-Landing.png') . '" alt="MyMI Wallet - Customize Your Membership" />
app/Modules/User/Views/Wallets/Purchase/Memberships/Promotions.php:4:        background-image: url('<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>');
app/Modules/User/Views/Wallets/Purchase/Memberships/Promotions.php:36:                                    <img class="gold-image" src="<?php echo base_url('assets/images/icons/plan-s1.svg'); ?>" alt="">
app/Modules/User/Views/Wallets/Purchase/Memberships/Promotions.php:54:                                    <img src="<?php echo base_url('assets/images/icons/plan-s1.svg'); ?>" alt="">
app/Modules/User/Views/Wallets/Purchase/Memberships/Promotions.php:81:                                    <img src="<?php echo base_url('assets/images/icons/plan-s2.svg'); ?>" alt="">
app/Modules/User/Views/Wallets/Purchase/Memberships/Promotions.php:111:                                    <img src="<?php echo base_url('assets/images/icons/plan-s3.svg'); ?>" alt="">
app/Modules/User/Views/Wallets/Purchase/Memberships/Promotions.php:142:                                    <img src="<?php echo base_url('assets/images/icons/plan-s1.svg'); ?>" alt="">
app/Modules/User/Views/Wallets/Link_Account/Brokerage.php:13:            <img class="full-width" src="' . base_url('assets/images/Brokerages/' . $brokerage['logo']) . '"/>
app/Modules/User/Views/Wallets/Link_Account (Original)/Brokerage.php:13:            <img class="full-width" src="' . base_url('assets/images/Brokerages/' . $brokerage['logo']) . '"/>
app/Modules/User/Views/Wallets/orig_Wallet_Selection.php:31:                <img class="full-width" src="' . base_url('assets/images/Brokerages/TD-Ameritrade.png') . '"/>
app/Modules/User/Views/Budget/Edit.php:6:$basePath = parse_url(base_url(), PHP_URL_PATH) ?? '';
app/Modules/User/Views/Investments/tradeTracker.php:14:<!-- <link rel="stylesheet" href="<?= base_url('assets/vendor/datatables/1.11.5/css/jquery.dataTables.min.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Modules/User/Views/Investments/tradeTracker.php:15:<link rel="stylesheet" href="<?= base_url('assets/vendor/datatables/1.11.5/css/dataTables.bootstrap5.min.css'); ?>" <?= $nonce['style'] ?? '' ?>>
app/Modules/User/Views/Investments/tradeTracker.php:16:<script src="<?= base_url('assets/vendor/jquery/jquery-3.6.0.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Modules/User/Views/Investments/tradeTracker.php:17:<script src="<?= base_url('assets/vendor/datatables/1.11.5/js/jquery.dataTables.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Modules/User/Views/Investments/tradeTracker.php:18:<script src="<?= base_url('assets/vendor/datatables/1.11.5/js/dataTables.bootstrap5.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script> -->
app/Modules/User/Controllers/KnowledgebaseController.php:479:                'page_sitemap_url' => base_url('/sitemap.xml'),
app/Modules/User/Controllers/KnowledgebaseController.php:480:                'page_image' => base_url('/assets/images/default-seo-image.png'),
app/Modules/User/Controllers/ReferralController.php:167:        $referralLink = base_url('/referral/' . $this->cuID);
app/Modules/Exchange/Views/Solana/create.php:614:                                            <li class="p-1"><a class="" href="<?= base_url('/Exchange/Solana/Wallet/New') ?>"><em class="icon ni ni-plus"></em> New Wallet</a></li>
app/Modules/Exchange/Views/Solana/create.php:616:                                            <li class="p-1"><a class="" href="<?= base_url('/Exchange/Solana/Wallet/MetaMask') ?>">MetaMask</a></li>
app/Modules/Exchange/Views/Solana/create.php:617:                                            <li class="p-1"><a class="" href="<?= base_url('/Exchange/Solana/Wallet/Phantom') ?>">Phantom</a></li>
app/Modules/Exchange/Views/Solana/create.php:618:                                            <li class="p-1"><a class="" href="<?= base_url('/Exchange/Solana/Wallet/Solflare') ?>">Solflare</a></li>
app/Modules/Exchange/Views/Solana/create.php:619:                                            <li class="p-1"><a class="" href="<?= base_url('/Exchange/Solana/Wallet/TrustWallet') ?>">Trust Wallet</a></li>
app/Modules/Exchange/Views/Solana/create.php:632:                                    <a class="btn btn-primary card-link" href="<?= base_url('Exchange/Solana/Wallet/Create') ?>">Create Wallet</a>
app/Modules/Exchange/Views/Solana/create.php:641:                                    <a class="btn btn-primary card-link" href="<?= base_url('Exchange/Solana/Wallet/Import') ?>">Import Wallet</a>
app/Modules/Exchange/Views/Solana/create.php:650:                                    <a class="btn btn-primary card-link" href="<?= base_url('Exchange/Solana/Wallet/Verify-Ownership') ?>">Verify Wallet</a>
app/Modules/Exchange/Views/Solana/create.php:659:                                    <a class="btn btn-primary card-link" href="<?= base_url('Exchange/Solana/Wallet/Execute-Swap') ?>">Execute Swap</a>
app/Modules/Exchange/Views/Solana/create.php:684:                                                        <a class="btn btn-sm btn-info" href="<?php // echo base_url('Exchange/Solana/Wallet/ViewAssets?public_key=' . $wallet['public_token']) ?>">View Assets</a>
app/Modules/Exchange/Views/Solana/create.php:685:                                                        <a class="btn btn-sm btn-warning" href="<?php // echo base_url('Exchange/Solana/Wallet/Disconnect?wallet_id=' . $wallet['id']) ?>">Disconnect</a>
app/Modules/Exchange/Views/Solana/assets.php:83:                                            <li class="p-1"><a href="<?= base_url('/Exchange/Solana/Wallet/New') ?>"><em class="icon ni ni-plus"></em> New Wallet</a></li>
app/Modules/Exchange/Views/Solana/assets.php:85:                                            <li class="p-1"><a href="<?= base_url('/Exchange/Solana/Wallet/MetaMask') ?>">MetaMask</a></li>
app/Modules/Exchange/Views/Solana/assets.php:86:                                            <li class="p-1"><a href="<?= base_url('/Exchange/Solana/Wallet/Phantom') ?>">Phantom</a></li>
app/Modules/Exchange/Views/Solana/assets.php:87:                                            <li class="p-1"><a href="<?= base_url('/Exchange/Solana/Wallet/Solflare') ?>">Solflare</a></li>
app/Modules/Exchange/Views/Solana/assets.php:88:                                            <li class="p-1"><a href="<?= base_url('/Exchange/Solana/Wallet/TrustWallet') ?>">Trust Wallet</a></li>
app/Modules/Exchange/Views/Solana/assets.php:101:                                    <a class="btn btn-primary card-link" href="<?= base_url('Exchange/Solana/Wallet/Create') ?>">Create Wallet</a>
app/Modules/Exchange/Views/Solana/assets.php:205:                                                            <img class="solanaTickerLogo" src="<?= $solanaTP['coin_logo']; ?>" onerror="this.onerror=null;this.src='<?php echo base_url('assets/images/MyMI-Wallet.png'); ?>" alt="<?= $solanaTP['coin_name'] . ' (' . $solanaTP['symbol'] . ')'; ?>"/>
app/Modules/Exchange/Views/Solana/swap-working.php:56:                                <form class="form-horizontal gy-3" id="solanaCoinSwapForm" action="<?= base_url('Exchange/SolanaController/executeSwap') ?>" method="post">
app/Modules/Exchange/Views/Solana/swap-working.php:273:        fetch(`<?= base_url('API/Solana/getExchangePrice') ?>/SOL`)
app/Modules/Exchange/Views/Solana/swap-working.php:288:        fetch(`<?= base_url('API/Solana/getTokenPrice') ?>/${selectedToken}`)
app/Modules/Exchange/Views/Solana/executeSwap.php:32:            <form action="<?= base_url('Exchange/SolanaController/importWallet') ?>" method="post">
app/Modules/Exchange/Views/Solana/createToken.php:26:                <form action="<?= base_url('Exchange/SolanaController/createToken') ?>" class="form-horizontal gy-3" id="createTokenForm" method="post">
app/Modules/Exchange/Views/Solana/connectWallet.php:16:                    <li class="p-1"><a class="btn btn-outline-default" href="<?= base_url('/Exchange/Solana/Wallet/MetaMask') ?>">MetaMask</a></li>
app/Modules/Exchange/Views/Solana/connectWallet.php:17:                    <li class="p-1"><a class="btn btn-outline-default" href="<?= base_url('/Exchange/Solana/Wallet/Phantom') ?>">Phantom</a></li>
app/Modules/Exchange/Views/Solana/connectWallet.php:18:                    <li class="p-1"><a class="btn btn-outline-default" href="<?= base_url('/Exchange/Solana/Wallet/Solflare') ?>">Solflare</a></li>
app/Modules/Exchange/Views/Solana/connectWallet.php:19:                    <li class="p-1"><a class="btn btn-outline-default" href="<?= base_url('/Exchange/Solana/Wallet/TrustWallet') ?>">Trust Wallet</a></li>
app/Modules/Exchange/Views/Solana/index.php:522:    const defaultLogo = base_url('assets/images/MyMI-Wallet.png');
app/Modules/Exchange/Views/Solana/index.php:558:  function base_url(path) {
app/Modules/Exchange/Views/Solana/importWallet.php:32:            <form action="<?= base_url('Exchange/SolanaController/importWallet') ?>" method="post">
app/Modules/Exchange/Views/Solana/createWallet.php:32:            <form action="<?= base_url('Exchange/SolanaController/createWallet') ?>" method="post">
app/Modules/Exchange/Views/Solana/verifyWalletOwnership.php:32:            <form action="<?= base_url('Exchange/SolanaController/importWallet') ?>" method="post">
app/Modules/Exchange/Views/Solana/swap.php:52:                            <form id="solanaCoinSwapForm" action="<?= base_url('Exchange/Solana/Wallet/Execute-Swap') ?>" class="form-horizontal gy-3" method="post">
app/Modules/Exchange/Views/Solana/swap.php:235:        fetch(`<?= base_url('index.php/API/Solana/getCoinAmount') ?>/${selectedToken}`)
app/Modules/Exchange/Views/Solana/swap.php:447://         fetch(`<?=base_url('index.php/API/Solana/getCoinAmount')?>/${selectedToken}`)
app/Modules/Exchange/Views/Solana/coinSwap.php:22:                            <form id="solanaCoinSwapForm" action="<?= base_url('Exchange/SolanaController/executeSwap') ?>" method="post">                                
app/Modules/Exchange/Views/index.php:167:							<div class="nk-wgw-icon text-green"><img class="icon ni" src="' . base_url('assets/images/Exchanges/Icons/' . $exchange['image_icon']) . '" /></div>
app/Modules/Exchange/Views/index.php:301:					// 				<span class="d-none d-md-block col-2 col-md-2 px-0" style="max-width: 50px;"><img src="' . base_url('assets/images/Exchanges/Icons/' . $icon) . '" alt="" /><br> </span> 
app/Modules/Exchange/Controllers/SolanaController.php:594:        return base_url("metadata/$filename");
app/Modules/Management/Views/Marketing/resources/generatedSummaries.php:214:<script src="<?= base_url('assets/vendor/chart.js/2.1.2/Chart.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Modules/Management/Views/Marketing/resources/standaloneEmailScheduleForm.php:5:    <form action="<?= base_url('newsletter/schedule/' . $emailId) ?>" method="post" class="p-4 bg-light rounded shadow-sm">
app/Modules/Management/Views/Marketing/resources/standaloneEmailScheduleForm.php:14:            <a href="<?= base_url('newsletter/preview/' . $emailId) ?>" class="btn btn-secondary">Back to Preview</a>
app/Modules/Management/Views/Marketing/resources/standaloneCreateEmailForm.php:5:    <form action="<?= base_url('newsletter/store') ?>" method="post" class="p-4 bg-light rounded shadow-sm">
app/Modules/Management/Views/Marketing/resources/timelineGroupedView.php:70:<script src="<?= base_url('assets/vendor/chart.js/2.1.2/Chart.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Modules/Management/Views/Marketing/dashboard.txt:1464:            return redirect()->to(base_url('Management/Marketing/Schedule'))->with('success', 'New schedule added successfully.');
app/Modules/Management/Views/Marketing/dashboard.txt:1858:            $fileUrl = base_url('uploads/' . basename($outputFile));
app/Modules/Management/Views/Marketing/dashboard.txt:2820:                        $filePaths[] = base_url('assets/images/Marketing/Ideas/' . $newName);
app/Modules/Management/Views/Marketing/dashboard.txt:4748:                'image' => base_url('/assets/images/Company/MyMI-Wallet-White.png'),
app/Modules/Management/Views/Marketing/dashboard.txt:5340:                'voiceover' => base_url('uploads/voiceover.mp3')
app/Modules/Management/Views/Marketing/dashboard.txt:5516:        return base_url('uploads/voiceover.mp3');
app/Modules/Management/Views/Marketing/Schedule.php:76:                                                                    echo '<a href="' . base_url('Management/Marketing/Generate/' . $platform . '/Content/' . $post['id']) . '">' . (isset($platformIcons[$platform]) ? $platformIcons[$platform] : htmlspecialchars($platform)) . '</a>';
app/Modules/Management/Views/Marketing/Email_Templates/dailyLogSummary.php:38:                                $generated['url'] = $blog ? base_url('Blog/Post/' . $blog->slug) : null;
app/Modules/Management/Views/Marketing/Blogger/index.php:17:<link rel="stylesheet" href="<?= base_url('assets/mymiblogger/mymiblogger.css') ?>">
app/Modules/Management/Views/Marketing/Blogger/index.php:18:<script src="<?= base_url('assets/mymiblogger/mymiblogger.js') ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Modules/Management/Views/Email/campaign_dashboard.php:54:<script src="<?= base_url('assets/vendor/chart.js/2.1.2/Chart.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Modules/Management/Views/Email/modals/viewCampaignStats.php:27:<script src="<?= base_url('assets/vendor/chart.js/2.1.2/Chart.min.js'); ?>" <?= $nonce['script'] ?? '' ?>></script>
app/Modules/Management/Views/Web_Design/Content_Creator/Sophtron_Widget.php:2:    <script type="text/javascript" src="<?php echo base_url('assets/js/Sophtron_Widget/server.js'); ?>" ></script>
app/Modules/Management/Views/Web_Design/Content_Creator/Sophtron_API_Setup.php:17:        <script type="text/javascript" src="<?php echo base_url('assets/js/Sophtron_Widget/script.js'); ?>" ></script>
app/Modules/Management/Views/Web_Design/Content_Creator/Sophtron/Sophtron_Widget.php:4:<!-- <script type="text/javascript" src="<?php // echo base_url('assets/js/sophtron_widget_loader.js'); ?>"></script> -->
app/Modules/Management/Views/Web_Design/Content_Creator/Sophtron/Sophtron_Widget.php:5:<!-- <script type="text/javascript" src="<?php //echo base_url('assets/js/Sophtron_Widget/server.js'); ?>"></script> -->
app/Modules/Management/Views/Web_Design/Webbanners/Company_Logo.php:1:<img class="full-width" src="<?php echo base_url('assets/images/Millennial-Investments-The-Best-In-Investments-Logo.png'); ?>" alt="Millennial Investments - The Best in Investments">
app/Modules/Management/Views/API/Sophtron.php:5:  <script src="<?php echo base_url('assets/js/Sophtron_Integration/js/full_example.js'); ?>"></script>
app/Modules/Management/Controllers/MarketingController.php:392:            return redirect()->to(base_url('Management/Marketing/Schedule'))->with('success', 'New schedule added successfully.');
app/Modules/Management/Controllers/MarketingController.php:961:            $fileUrl = base_url('uploads/' . basename($outputFile));
app/Modules/Management/Controllers/MarketingController.php:2055:                        $filePaths[] = base_url('assets/images/Marketing/Ideas/' . $newName);
app/Modules/Management/Controllers/UsersController.php:349:        $src       = base_url("assets/modules/{$module}/js/{$file}");
app/Modules/Management/Controllers/APIController.php:149:        $this->data['sophtronJSLink'] = base_url('assets/js/Sophtron_Widget/script.js');
app/Modules/Management/Controllers/MarketingController.11202024.php:496:                        $filePaths[] = base_url('assets/images/Marketing/Ideas/' . $newName);
app/Modules/Management/Controllers/MarketingController.11202024.php:609:            $fileUrl = base_url('uploads/' . basename($outputFile));
app/Modules/Management/Controllers/MarketingController.11202024.php:1033:            return redirect()->to(base_url('Management/Marketing/Schedule'))->with('success', 'New schedule added successfully.');
app/Modules/Management/Controllers/SitemapController.php:20:                'loc' => base_url('articles/lorem-ipsum-dolor-sit-amet'),
app/Modules/Management/Controllers/SitemapController.php:26:                'loc' => base_url('articles/consectetur-adipiscing-elit'),
app/Modules/Management/Controllers/SitemapController.php:32:                'loc' => base_url('articles/nullam-nec-magna-eu-tellus-placerat-tempus'),
app/Modules/Management/Controllers/SitemapController.php:42:        $this->sitemapModel->add(base_url('sitemap/general'), date('Y-m-d', time()));
app/Modules/Management/Controllers/SitemapController.php:43:        $this->sitemapModel->add(base_url('sitemap/articles'), date('Y-m-d', time()));
app/Modules/Management/Controllers/SitemapController.php:49:        $this->sitemapModel->add(base_url(), null, 'monthly', 1);
app/Modules/Management/Controllers/SitemapController.php:50:        $this->sitemapModel->add(base_url('contact'), null, 'monthly', 0.9);
app/Modules/Blog/Views/PersonalBudgeting/Importance_Of_Personal_Financial_Budgeting.php:31:        background: url(<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed; 
app/Modules/Blog/Views/PersonalBudgeting/Importance_Of_Personal_Financial_Budgeting.php:80:                            <img class="img-fluid rounded" src="<?php echo base_url('assets/images/How_It_Works/Personal_Budgeting.jpg'); ?>" />
app/Modules/Blog/Views/PersonalBudgeting/Importance_Of_Personal_Financial_Budgeting.php:136:                                <img class="img-fluid" src="<?php echo base_url('assets/images/Marketing/Promotional-Infographic-1.png'); ?>" alt="MyMI Wallet - Personal Budgeting & Investment Portfolio Management" />
app/Modules/Blog/Views/IRS/IRS_Expanded_Home_Energy_Tax_Credits.php:65:                            <img class="img-fluid rounded" src="<?php echo base_url('assets/images/How_It_Works/Personal_Budgeting.jpg'); ?>" />
app/Modules/Blog/Views/IRS/IRS_Expanded_Home_Energy_Tax_Credits.php:113:                                <img class="img-fluid" src="<?php echo base_url('assets/images/Marketing/Promotional-Infographic-1.png'); ?>" alt="MyMI Wallet - Personal Budgeting & Investment Portfolio Management" />
app/Modules/Blog/Views/Investing/Tips_For_Effective_Investment_Portfolio_Management.php:31:        background: url(<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed; 
app/Modules/Blog/Views/Investing/Tips_For_Effective_Investment_Portfolio_Management.php:81:                            <img class="img-fluid rounded" src="<?php echo base_url('assets/images/How_It_Works/Personal_Budgeting.jpg'); ?>" />
app/Modules/Blog/Views/Investing/Tips_For_Effective_Investment_Portfolio_Management.php:152:                                <img class="img-fluid" src="<?php echo base_url('assets/images/Marketing/Promotional-Infographic-1.png'); ?>" alt="MyMI Wallet - Personal Budgeting & Investment Portfolio Management" />
app/Modules/Blog/Views/Investing/The_Fundamentals_Of_Investing.php:31:        background: url(<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed; 
app/Modules/Blog/Views/Investing/The_Fundamentals_Of_Investing.php:76:                            <img class="img-fluid rounded" src="<?php echo base_url('assets/images/How_It_Works/Personal_Budgeting.jpg'); ?>" />
app/Modules/Blog/Views/Investing/The_Fundamentals_Of_Investing.php:141:                                <img class="img-fluid" src="<?php echo base_url('assets/images/Marketing/Promotional-Infographic-1.png'); ?>" alt="MyMI Wallet - Personal Budgeting & Investment Portfolio Management" />
app/Modules/Blog/Views/Investing/The_Beginners_Guide_To_Option_Trading.php:31:        background: url(<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed; 
app/Modules/Blog/Views/Investing/The_Beginners_Guide_To_Option_Trading.php:77:                            <img class="img-fluid rounded" src="<?php echo base_url('assets/images/How_It_Works/Personal_Budgeting.jpg'); ?>" />
app/Modules/Blog/Views/Investing/The_Beginners_Guide_To_Option_Trading.php:130:                                <img class="img-fluid" src="<?php echo base_url('assets/images/Marketing/Promotional-Infographic-1.png'); ?>" alt="MyMI Wallet - Personal Budgeting & Investment Portfolio Management" />
app/Modules/Blog/Views/HowItWorks/Daily_Financial_News.php:9:    background: url(<?= base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed;
app/Modules/Blog/Views/HowItWorks/Personal_Budgeting.php:32:        background: url(<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed; 
app/Modules/Blog/Views/HowItWorks/index.php:48:        background: url(<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed; 
app/Modules/Blog/Views/HowItWorks/index.php:98:                            <img class="img-fluid rounded" src="<?php echo base_url('assets/images/How_It_Works/Personal_Budgeting.jpg'); ?>" />
app/Modules/Blog/Views/HowItWorks/index.php:151:                                <img class="img-fluid" src="<?php echo base_url('assets/images/Marketing/Promotional-Infographic-1.png'); ?>" alt="MyMI Wallet - Personal Budgeting & Investment Portfolio Management" />
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:21:    background: url(<?= base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed;
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:208:            <img src="<?= base_url('assets/images/icons/emergency-fund.svg'); ?>" alt="Emergency Fund Icon" width="64" height="64" />
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:223:            <img src="<?= base_url('assets/images/icons/debt-reduction.svg'); ?>" alt="Debt Reduction Icon" width="64" height="64" />
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:240:              echo file_exists($svgPath) ? file_get_contents($svgPath) : '<img src="' . base_url('assets/images/fallback-wealth.png') . '" alt="Build Wealth Icon" width="64" height="64" />';
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:345:    background: url(<?= base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed;
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:532:            <img src="<?= base_url('assets/images/icons/emergency-fund.svg'); ?>" alt="Emergency Fund Icon" width="64" height="64" />
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:547:            <img src="<?= base_url('assets/images/icons/debt-reduction.svg'); ?>" alt="Debt Reduction Icon" width="64" height="64" />
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals copy.php:564:              echo file_exists($svgPath) ? file_get_contents($svgPath) : '<img src="' . base_url('assets/images/fallback-wealth.png') . '" alt="Build Wealth Icon" width="64" height="64" />';
app/Modules/Blog/Views/HowItWorks/Determining_Your_Financial_Goals.php:22:    background: url(<?= base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed;
app/Modules/Blog/Views/HowItWorks/Investment_Portfolio_Management.php:9:        background: url(<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed;
app/Modules/Blog/Views/HowItWorks/Registering_An_Account.php:31:        background: url(<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed; 
app/Modules/Blog/Views/HowItWorks/Registering_An_Account.php:75:                            <img class="img-fluid rounded" src="<?php echo base_url('assets/images/How_It_Works/Personal_Budgeting.jpg'); ?>" />
app/Modules/Blog/Views/Blog/view.php:14:                    <a href="<?= base_url('Blog') ?>" class="btn btn-secondary">Back to Blogs</a>
app/Modules/Blog/Views/Blog/index.php:31:                                            <a href="<?= base_url('Blog/Post/' . $blog->slug) ?>" class="btn btn-primary">Read More</a>
app/Modules/Blog/Views/Blog/index.php:32:                                            <a href="<?= base_url('Management/Marketing/PublishBlog/' . $blog->id) ?>" class="btn btn-success">Publish</a>
app/Modules/Blog/Views/index.php:46:        background: url(<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed; 
app/Modules/Blog/Views/index.php:96:                            <img class="img-fluid rounded" src="<?php echo base_url('assets/images/How_It_Works/Personal_Budgeting.jpg'); ?>" />
app/Modules/Blog/Views/index.php:149:                                <img class="img-fluid" src="<?php echo base_url('assets/images/Marketing/Promotional-Infographic-1.png'); ?>" alt="MyMI Wallet - Personal Budgeting & Investment Portfolio Management" />
app/Modules/Blog/Views/NewsAndUpdates/Integrating_With_Plaid.php:82:                            <img class="img-fluid rounded" src="<?php echo base_url('assets/images/How_It_Works/Personal_Budgeting.jpg'); ?>" />
app/Modules/Blog/Views/NewsAndUpdates/Integrating_With_Plaid.php:130:                                <img class="img-fluid" src="<?php echo base_url('assets/images/Marketing/Promotional-Infographic-1.png'); ?>" alt="MyMI Wallet - Personal Budgeting & Investment Portfolio Management" />
app/Modules/Blog/Views/NewsAndUpdates/The_Roadmap_To_The_Future_Of_Finance.php:80:                            <img class="img-fluid rounded" src="<?php echo base_url('assets/images/How_It_Works/Personal_Budgeting.jpg'); ?>" />
app/Modules/Blog/Views/NewsAndUpdates/The_Roadmap_To_The_Future_Of_Finance.php:128:                                <img class="img-fluid" src="<?php echo base_url('assets/images/Marketing/Promotional-Infographic-1.png'); ?>" alt="MyMI Wallet - Personal Budgeting & Investment Portfolio Management" />
app/Modules/Blog/Views/Earnings/TSLA/10192023.php:88:        background: url(<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed; 
app/Modules/Blog/Views/Earnings/TSLA/10192023.php:132:                            <img class="img-fluid rounded" src="<?php echo base_url('assets/images/Marketing/Blog/Earnings/' . $symbol . '/' . $earningsDate . '.jpg'); ?>" alt="<?php echo $symbol . ' Quarterly Earnings Report ' . $earningsDate; ?>" />
app/Modules/Blog/Views/Earnings/TSLA/10192023.php:189:                                <img class="full-width" src="<?php echo base_url('assets/images/Marketing/Promotional-Infographic-1.png'); ?>" alt="MyMI Wallet - Personal Budgeting & Investment Portfolio Management" />
app/Modules/Blog/Views/Earnings/2024/10/21.php:7:        background: url(<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed; 
app/Modules/Blog/Views/Earnings/2024/10/21.php:134:                            <img class="img-responsive" src="<?php echo base_url('assets/images/Earnings/' . $earningsDate . '/Earnings.jpg'); ?>" alt="Corporate Earnings Calendar <?= $earningsDate; ?>" class="object-fit-contain">
app/Modules/Blog/Views/Earnings/2024/10/21.php:211:                                                    <img class="img-fluid" src="<?php echo base_url('assets/images/Earnings/' . $earningsDate . '/' . $company['image']); ?>" alt="<?php echo $company['name']; ?>" class="w-100 h-auto">
app/Modules/Blog/Views/Earnings/2024/10/21.php:220:                                                <img id="chartImage<?php echo $index; ?>" class="img img-responsive" src="<?php echo base_url($company['chart_image']); ?>" alt="<?php echo $company['name']; ?> Chart" class="w-100 h-auto">
app/Modules/Blog/Views/Earnings/2024/10/28.php:7:        background: url(<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed; 
app/Modules/Blog/Views/Earnings/2024/10/28.php:134:                            <img class="img-responsive" src="<?php echo base_url('assets/images/Earnings/' . $earningsDate . '/Earnings.jpg'); ?>" alt="Corporate Earnings Calendar <?= $earningsDate; ?>" class="object-fit-contain">
app/Modules/Blog/Views/Earnings/2024/10/28.php:211:                                                    <img class="img-fluid" src="<?php echo base_url('assets/images/Earnings/' . $earningsDate . '/' . $company['image']); ?>" alt="<?php echo $company['name']; ?>" class="w-100 h-auto">
app/Modules/Blog/Views/Earnings/2024/10/28.php:220:                                                <img id="chartImage<?php echo $index; ?>" class="img img-responsive" src="<?php echo base_url($company['chart_image']); ?>" alt="<?php echo $company['name']; ?> Chart" class="w-100 h-auto">
app/Modules/Blog/Views/Earnings/2024/10/14.php:8:        background: url(<?php echo base_url('assets/images/MyMI-Walllet-Background.jpeg'); ?>) no-repeat center center fixed; 
app/Modules/Blog/Views/Earnings/2024/10/14.php:135:                            <img class="img-responsive" src="<?php echo base_url('assets/images/Earnings/' . $earningsDate . '/Earnings.jpeg'); ?>" alt="Corporate Earnings Calendar <?= $earningsDate; ?>" class="object-fit-contain">
app/Modules/Blog/Views/Earnings/2024/10/14.php:212:                                                    <img class="img-fluid" src="<?php echo base_url('assets/images/Earnings/' . $earningsDate . '/' . $company['image']); ?>" alt="<?php echo $company['name']; ?>" class="w-100 h-auto">
app/Modules/Blog/Views/Earnings/2024/10/14.php:221:                                                <img id="chartImage<?php echo $index; ?>" class="img img-responsive" src="<?php echo base_url($company['chart_image']); ?>" alt="<?php echo $company['name']; ?> Chart" class="w-100 h-auto">
app/Modules/Blog/Controllers/HowItWorks.php:168:                'page_sitemap_url' => base_url('/sitemap.xml'),
app/Modules/Blog/Controllers/HowItWorks.php:169:                'page_image' => base_url('/assets/images/default-seo-image.png'),
app/Modules/Blog/Controllers/EarningsController.php:459:                'page_sitemap_url' => base_url('/sitemap.xml'),
app/Modules/Blog/Controllers/EarningsController.php:460:                'page_image' => base_url('/assets/images/default-seo-image.png'),
app/Modules/Blog/Controllers/Subscribe.php:127:                'page_sitemap_url' => base_url('/sitemap.xml'),
app/Modules/Blog/Controllers/Subscribe.php:128:                'page_image' => base_url('/assets/images/default-seo-image.png'),
app/Modules/Blog/Controllers/NewsAndUpdates.php:129:                'page_sitemap_url' => base_url('/sitemap.xml'),
app/Modules/Blog/Controllers/NewsAndUpdates.php:130:                'page_image' => base_url('/assets/images/default-seo-image.png'),
app/Modules/Blog/Controllers/BlogController.php:205:                'page_sitemap_url' => base_url('/sitemap.xml'),
app/Modules/Blog/Controllers/BlogController.php:206:                'page_image' => base_url('/assets/images/default-seo-image.png'),
app/Modules/Blog/Controllers/UpdatesController.php:189:                'page_sitemap_url' => base_url('/sitemap.xml'),
app/Modules/Blog/Controllers/UpdatesController.php:190:                'page_image' => base_url('/assets/images/default-seo-image.png'),
app/Modules/Blog/Controllers/PersonalBudgetingController.php:190:                'page_sitemap_url' => base_url('/sitemap.xml'),
app/Modules/Blog/Controllers/PersonalBudgetingController.php:191:                'page_image' => base_url('/assets/images/default-seo-image.png'),
app/Modules/Blog/Controllers/IRSController.php:183:                'page_sitemap_url' => base_url('/sitemap.xml'),
app/Modules/Blog/Controllers/IRSController.php:184:                'page_image' => base_url('/assets/images/default-seo-image.png'),
app/Modules/Blog/Controllers/HowItWorksController.php:246:                'page_sitemap_url' => base_url('/sitemap.xml'),
app/Modules/Blog/Controllers/HowItWorksController.php:247:                'page_image' => base_url('/assets/images/default-seo-image.png'),

### anchor
app/Helpers/url_safe_helper.php:23:        return anchor($uri ?? '', $title, $attributes);
app/Modules/Exchange/Views/Account_Information.php:59:													<?php echo anchor(LOGIN_URL, lang('bf_action_login')); ?>

### route_to
app/Controllers/AuthControllerCustom.php:167:            return redirect()->to(route_to('reset-password') . '?token=' . $this->auth->user()->reset_hash)->withCookies();
app/Filters/RoleFilter.php:42:            $fallback = route_to($this->landingRoute) ?: '/';

## Nullable Path Variables

### $slug
app/Commands/SupportInventory.php:137:                $slug       = strtolower(preg_replace('/\.(php|md)$/', '', str_replace('Views/', '', $relative)));
app/Commands/SupportInventory.php:138:                $title      = $this->extractTitle($pathName) ?: $slug;
app/Commands/SupportInventory.php:142:                    'slug'         => $slug,
app/Models/PermissionModel.php:12:    public function bySlug(string $slug): ?array
app/Models/PermissionModel.php:14:        return $this->where('slug',$slug)->first();
app/Models/MarketingModel.php:212:        $slug = url_title($title, '-', true);
app/Models/MarketingModel.php:213:        $existing = $this->db->table('bf_marketing_blog_posts')->where('slug', $slug)->countAllResults();
app/Models/MarketingModel.php:215:        return $existing ? $slug . '-' . uniqid() : $slug;
app/Models/MarketingModel.php:598:    public function getBlogPostBySlug($slug) {
app/Models/MarketingModel.php:600:            ->where('slug', $slug)
app/Models/RoleModel.php:12:    public function bySlug(string $slug): ?array
app/Models/RoleModel.php:14:        return $this->where('slug',$slug)->first();
app/Models/SupportModel.php:85:    public function findBySlug(string $slug): ?array
app/Models/SupportModel.php:87:        return $this->MyMISupport->getArticle($slug);
app/Models/SupportModel.php:102:            $slug = basename($file, '.php');
app/Models/SupportModel.php:103:            $articles[$slug] = $this->MyMISupport->getArticle($slug);
app/Models/SupportModel.php:200:    public function getArticleBySlug(string $slug): ?array
app/Models/SupportModel.php:210:            ->where('slug', $slug)
app/Models/AuctionItemModel.php:34:        $slug  = trim($payload['slug'] ?? '');
app/Models/AuctionItemModel.php:36:        if ($slug === '' && $title !== '') {
app/Models/AuctionItemModel.php:37:            $slug = url_title($title, '-', true) . '-' . Time::now()->getTimestamp();
app/Models/AuctionItemModel.php:51:            'slug'            => $slug ?: null,
app/Models/PageSEOModel.php:17:    public function getByInternalUrl(string $slug): ?array
app/Models/PageSEOModel.php:19:        return $this->where('page_internal_url', $slug)
app/Models/BlogModel.php:15:    public function getPostBySlug(string $slug): ?object
app/Models/BlogModel.php:18:            ->where('slug', $slug)
app/Services/SupportService.php:144:    public function recordFeedback(string $slug, bool $helpful, ?string $note = null): bool
app/Services/SupportService.php:148:            'slug'    => $slug,
app/Services/MetaService.php:32:        $slug = implode('/', array_filter($uri->getSegments()));
app/Services/MetaService.php:33:        $slug = $this->normalizeSlug($slug);
app/Services/MetaService.php:35:        $cacheKey = 'seo_' . md5(($pageName ?? '') . '|' . $slug);
app/Services/MetaService.php:38:                'slug'     => $slug,
app/Services/MetaService.php:53:                    'slug'     => $slug,
app/Services/MetaService.php:63:        if (!empty($slug)) {
app/Services/MetaService.php:64:            $row = $this->model->getByInternalUrl($slug);
app/Services/MetaService.php:69:                    'slug'     => $slug,
app/Services/MetaService.php:79:        $altSlug = $this->relaxedSlug($slug);
app/Services/MetaService.php:80:        if ($altSlug !== $slug) {
app/Services/MetaService.php:86:                    'slug'     => $slug,
app/Services/MetaService.php:96:        $this->logMissingPage($slug);
app/Services/MetaService.php:99:            'page_title'       => $this->humanizeSlug($slug),
app/Services/MetaService.php:101:            'page_url'         => base_url($slug),
app/Services/MetaService.php:107:            'slug'     => $slug,
app/Services/MetaService.php:126:    public function getBySlugOrFallback(string $slug): array
app/Services/MetaService.php:129:        $norm    = $this->normalizeSlug($slug);
app/Services/MetaService.php:155:    private function fallbackTitleFromSlug(string $slug): string
app/Services/MetaService.php:158:        $parts = array_map('ucfirst', explode('/', $slug));
app/Services/MetaService.php:162:    protected function humanizeSlug(string $slug): string
app/Services/MetaService.php:164:        $slug = trim($slug, '/');
app/Services/MetaService.php:165:        if ($slug === '') return 'MyMI Wallet';
app/Services/MetaService.php:166:        return ucwords(str_replace(['-', '/'], [' ', ' | '], $slug)) . ' | MyMI Wallet';
app/Services/MetaService.php:169:    protected function normalizeSlug(string $slug): string
app/Services/MetaService.php:171:        $slug = strtolower(trim($slug, '/'));
app/Services/MetaService.php:172:        $slug = preg_replace('#/+#', '/', $slug);
app/Services/MetaService.php:173:        return $slug;
app/Services/MetaService.php:176:    protected function relaxedSlug(string $slug): string
app/Services/MetaService.php:178:        return rtrim($slug, '/');
app/Services/MetaService.php:181:    protected function logMissingPage(string $slug): void
app/Services/MetaService.php:183:        if ($slug === '') return;
app/Services/MetaService.php:186:            ->where('page_internal_url', $slug)
app/Services/MetaService.php:191:                'page_name'         => $this->humanizeSlug($slug),
app/Services/MetaService.php:192:                'page_title'        => $this->humanizeSlug($slug),
app/Services/MetaService.php:194:                'page_url'          => base_url($slug),
app/Services/MetaService.php:195:                'page_internal_url' => $slug,
app/Database/Seeds/RbacSeeder.php:30:        foreach ($cfg->capabilities as $slug => $label) {
app/Database/Seeds/RbacSeeder.php:31:            $row = $pm->bySlug($slug);
app/Database/Seeds/RbacSeeder.php:33:                $pm->insert(['slug' => $slug, 'label' => $label]);
app/Database/Seeds/RbacSeeder.php:34:                $row = $pm->bySlug($slug);
app/Database/Seeds/RbacSeeder.php:36:            $permIdBySlug[$slug] = $row['id'];
app/Libraries/MyMISupport.php:22:    public function getArticle(string $slug): ?array
app/Libraries/MyMISupport.php:24:        $slug = trim($slug, '/');
app/Libraries/MyMISupport.php:25:        $file = $this->articlePath . $slug . '.php';
app/Libraries/MyMISupport.php:37:            $title = ucfirst(str_replace('-', ' ', $slug));
app/Libraries/MyMISupport.php:43:            'slug'         => $slug,
app/Libraries/Introspection/SupportScanner.php:138:                $slug       = strtolower(preg_replace('/\.(php|md)$/', '', str_replace('Views/', '', $relative)));
app/Libraries/Introspection/SupportScanner.php:139:                $title      = $this->extractTitle($pathName) ?: $slug;
app/Libraries/Introspection/SupportScanner.php:143:                    'slug'         => $slug,
app/Libraries/test.txt:2974:            $slug = $this->marketingModel->createSlug($content['title']);
app/Libraries/test.txt:2979:                'slug'        => $slug,
app/Libraries/test.txt:4118:    public function viewBlog($slug)
app/Libraries/test.txt:4120:        $blogPost = $this->marketingModel->getBlogPostBySlug($slug);
app/Libraries/test.txt:7945:        $slug = url_title($title, '-', true);
app/Libraries/test.txt:7946:        $existing = $this->db->table('bf_marketing_blog_posts')->where('slug', $slug)->countAllResults();
app/Libraries/test.txt:7948:        return $existing ? $slug . '-' . uniqid() : $slug;
app/Libraries/test.txt:8231:    public function getBlogPostBySlug($slug) {
app/Libraries/test.txt:8233:            ->where('slug', $slug)
app/Modules/APIs/Controllers/SupportController.php:67:    public function kbArticle(string $slug)
app/Modules/APIs/Controllers/SupportController.php:70:            $row = $this->supportModel->getArticleBySlug($slug);
app/Modules/chatgpt.txt:1:<?php namespace App\Modules\Management\Controllers;use CodeIgniter\Controller;use Config\Services;use App\Config\{APIs,Auth,SiteSettings,SocialMedia};use App\Controllers\UserController;use App\Libraries\{BaseLoader,HtmlFormatter,MyMIAnalytics,MyMIAlerts,MyMIBudget,MyMIDashboard,MyMIExchange,MyMIMarketing,MyMIUser};use App\Models\{AlertsModel,AnnouncementModel,InvestmentModel,ManagementModel,MarketingModel,MyMIGoldModel,SolanaModel,UserModel};use App\Services\{DashboardService,GoalTrackingService,MarketingService,SolanaService,UserService};use CodeIgniter\API\ResponseTrait;use GuzzleHttp\Client;use GuzzleHttp\Exception\RequestException;use voku\helper\HtmlDomParser;class MarketingController extends UserController{use ResponseTrait;use BaseLoader;protected $API;protected $auth;protected $cuID;protected $data;protected $debug;protected $helpers=['auth','form','url'];protected $logger;protected $request;protected $session;protected $uri;protected $siteSettings;protected $NewsEmail;protected $HtmlFormatter;protected $MyMIAnalytics;protected $MyMIAlerts;protected $MyMIBudget;protected $MyMIDashboard;protected $MyMIExchange;protected $MyMIMarketing;protected $MyMIUser;protected $dashboardService;protected $goalTrackingService;protected $marketingService;protected $solanaService;protected $userService;protected $alertsModel;protected $investmentModel;protected $marketingModel;protected $userModel;protected $userAccount;protected $userDashboard;protected $getBlogPosts;protected $departmentTasks;protected $marketing;protected $reporting;public function __construct(){$this->API=config('APIs');$this->auth=service('authentication');$this->logger=service('logger');$this->NewsEmail=config('NewsEmailServer');$this->request=service('request');$this->session=Services::session();$this->siteSettings=config('SiteSettings');$this->debug=$this->siteSettings->debug;$this->uri=$this->request->getUri();$this->alertsModel=new AlertsModel();$this->investmentModel=new InvestmentModel();$this->marketingModel=new MarketingModel();$this->userDashboard=$this->getMyMIDashboard()->dashboardInfo($this->cuID);$this->departmentTasks=$this->getMyMIAnalytics()->get_department_tasks($this->uri->getSegment(2),['Page SEO Edit']);$this->getBlogPosts=$this->getMyMIMarketing()->getBlogPosts();$this->cuID=$this->session->get('user_id')?? $this->auth->id();if(!$this->cuID){log_message('error','Investments ControllerFailed to retrieve valid User ID in MyMIInvestments');throw new \RuntimeException('User ID could not be retrieved.');}log_message('debug',"InvestmentsController: cuID initialized as {$this->cuID}");$this->userAccount=$this->getMyMIUser()->getUserInformation($this->cuID);$userBudget=$this->getMyMIBudget()->getUserBudget($this->cuID);log_message('info','DashboardController L72 - $checkingSummary: '.$userBudget['checkingSummary']);$this->data['checkingSummary']=$userBudget['checkingSummary'];}public function commonData(): array{$this->data=$this->data ??[];$userData=$this->getuserService()->commonData();$this->data=array_merge($this->data,$userData);$this->data['siteSettings']=$this->siteSettings;$this->data['beta']=(string)$this->siteSettings->beta;$this->data['uri']=$this->request->getUri();$this->data['date']=$this->siteSettings->date;$this->data['time']=$this->siteSettings->time;$this->data['hostTime']=$this->siteSettings->hostTime;$dashboardInfo=$this->getDashboardService()->getDashboardInfo($this->cuID);$this->data['completedGoals']=$this->getGoalTrackingService()->getCompletedGoals($this->cuID);$this->data['pendingGoals']=$this->getGoalTrackingService()->getPendingGoals($this->cuID);$this->data['promotionalBanners']=$dashboardInfo['promotionalBanners'];$userBudget=$this->getBudgetService()->getUserBudget($this->cuID);$this->data['totalAccountBalance']=$userBudget['totalAccountBalance']?? 0;$this->data['totalAccountBalanceFMT']=$userBudget['totalAccountBalanceFMT']?? '0.00';$userSolanaData=$this->getSolanaService()->getSolanaData($this->cuID);$this->data['cuSolanaDW']=$userSolanaData['userSolanaWallets']['cuSolanaDW']?? null;$this->data['solanaNetworkStatus']=$userSolanaData['solanaNetworkStatus'];$this->data['cuSolanaTotal']=$userSolanaData['userSolanaWallets']['cuSolanaTotal']?? 0;$this->data['cuSolanaValue']=$userSolanaData['userSolanaWallets']['cuSolanaValue']?? 0;$this->data=array_merge($this->data,$userData);if($this->debug===1){}}public function index(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['recentMarketingPosts']=$this->getMyMIMarketing()->getRecentPosts(5);if(empty($this->data['recentMarketingPosts'])){log_message('info','ðŸ“­ No recent posts found. Running fallback generation...');$this->getMyMIMarketing()->generateFromTempScraper(5);$this->data['recentMarketingPosts']=$this->getMyMIMarketing()->getRecentPosts(25);}$this->data['todaysStory']=$this->marketingModel->getTodaysStory();$this->data['generatedSummaries']=$this->marketingModel->getLatestGeneratedSummaries(25);$this->data['marketingBuffer']=$this->marketingModel->getMarketingBuffer();if(empty($this->data['todaysStory'])){log_message('info','ðŸ“… No content generated today. Triggering summary fallback...');$this->getMyMIMarketing()->generateFromTempScraper(5);$this->data['todaysStory']=$this->marketingModel->where('DATE(created_at)',date('Y-m-d'))->orderBy('created_at','DESC')->findAll();}$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\index',$this->data);}public function add($type=null){log_message('debug','MarketingController L183 - add() method called with type: '.(is_null($type)?'null':$type));if(!empty($type)){if($this->request->getMethod()==='POST'){log_message('debug','Handling POST request for type: '.$type);if($type==='Schedule'){log_message('info','Processing Schedule submission');try{$this->marketingModel->addMarketingSchedule($this->request->getPost());log_message('info','Schedule data saved successfully');if($this->request->isAJAX()){return $this->response->setJSON(['success'=>true,'message'=>'Schedule added successfully']);}else{return redirect()->to('/Management/Marketing/Schedule')->with('success','Schedule added successfully');}}catch(\Exception $e){log_message('error','Error saving schedule: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to save schedule.']);}}elseif($type==='Campaign'){log_message('info','Processing Campaign submission');try{$campaignData=['beta'=>$this->request->getPost('beta'),'config_mode'=>$this->request->getPost('config_mode'),'form_mode'=>$this->request->getPost('form_mode'),'escalated'=>$this->request->getPost('escalated'),'user_id'=>$this->request->getPost('user_id'),'user_email'=>$this->request->getPost('user_email'),'username'=>$this->request->getPost('username'),'assigned_to'=>$this->request->getPost('assigned_to'),'date'=>$this->siteSettings->date,'time'=>$this->siteSettings->time,'campaign_name'=>$this->request->getPost('campaign_name'),'promotionalLinks'=>json_encode($this->request->getPost('promotionalLinks')),'overall_campaign_description'=>$this->request->getPost('overall_campaign_description'),'voice_script'=>$this->request->getPost('voice_script'),'facebookMessage'=>$this->request->getPost('facebookMessage'),'linkedinMessage'=>$this->request->getPost('linkedinMessage'),'discordMessage'=>$this->request->getPost('discordMessage'),'stocktwitsMessage'=>$this->request->getPost('stocktwitsMessage'),'tiktokMessage'=>$this->request->getPost('tiktokMessage'),'youtubeMessage'=>$this->request->getPost('youtubeMessage'),'emailMessage'=>$this->request->getPost('emailMessage'),'additionalInfo'=>$this->request->getPost('additionalInfo'),'hashtags'=>$this->request->getPost('hashtags'),];$this->marketingModel->addMarketingCampaign($campaignData);log_message('info','Campaign data saved successfully');if($this->request->isAJAX()){log_message('info','MarketingController L251 - This is using the $this->request->isAJAX() Form Submission');return $this->response->setJSON(['success'=>true,'message'=>'Campaign added successfully']);}else{log_message('info','MarketingController L251 - This is NOT using the $this->request->isAJAX() Form Submission');return redirect()->to('/Management/Marketing/Campaigns')->with('success','Campaign added successfully');}}catch(\Exception $e){log_message('error','Error saving campaign: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to save campaign.']);}}else{log_message('error','Unrecognized type in POST request: '.$type);return $this->response->setJSON(['error'=>'Unrecognized type in POST request']);}}if($this->request->getMethod()==='get'){log_message('debug','Handling GET request for type: '.$type);if($type==='Schedule'){log_message('debug','Loading view for Schedule');try{$response=$this->renderTheme('ManagementModule\Views\Marketing\Schedule\Add',$this->data);log_message('debug','View for Schedule loaded successfully');return $response;}catch(\Exception $e){log_message('error','Failed to load view for Schedule: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to load view for Schedule']);}}elseif($type==='Campaign'){log_message('debug','Loading view for Campaign');try{$response=$this->renderTheme('ManagementModule\Views\Marketing\Campaign\Add',$this->data);log_message('debug','View for Campaign loaded successfully');return $response;}catch(\Exception $e){log_message('error','Failed to load view for Campaign: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to load view for Campaign']);}}else{log_message('error','Unrecognized type in GET request: '.$type);return $this->response->setJSON(['error'=>'Unrecognized type in GET request']);}}}else{log_message('warning','No type provided; redirecting to /Management/Marketing');return redirect()->to('/Management/Marketing')->with('error','No type provided');}}public function addSchedule(){if($this->request->getMethod()==='post'){$additionalInfo=$this->request->getPost('additional_info');$jsonData=null;if(!empty($additionalInfo)){$jsonData=json_decode($additionalInfo,true);if(json_last_error()!==JSON_ERROR_NONE){return redirect()->back()->withInput()->with('error','Invalid JSON format in Additional Information.');}}$scheduleData=['day'=>$this->request->getPost('day'),'time'=>$this->request->getPost('time'),'activity'=>$this->request->getPost('activity'),'link'=>$this->request->getPost('link'),'additional_info'=>json_encode($jsonData)];$this->marketingModel->addMarketingSchedule($scheduleData);return redirect()->to(base_url('Management/Marketing/Schedule'))->with('success','New schedule added successfully.');}$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Schedule\Add');}public function addSubscriber(){helper('email');$rawRequestBody=$this->request->getBody();$jsonData=json_decode($rawRequestBody,true);$marketingModel=new MarketingModel();$subscriberData=['email'=>$jsonData['email'],'category'=>$jsonData['category'],'referral'=>$jsonData['referral'],'beta'=>$this->siteSettings->beta,'date'=>date('Y-m-d H:i:s'),'hostTime'=>date('Y-m-d H:i:s'),'time'=>date('H:i:s'),'user_id'=>session('user_id'),'user_ip'=>$this->request->getIPAddress()];if($marketingModel->addSubscriber($subscriberData)){$emailService=\Config\Services::email();$emailService->setTo($subscriberData['email']);$emailService->setSubject('ðŸŽ‰ Welcome to Investorâ€™s Talk | MyMI Wallet');$emailService->setMessage(view('emails/welcomeInvestor',['siteSettings'=>$this->siteSettings,'socialMedia'=>config('SocialMedia'),]));if($emailService->send()){log_message('info','Management/MarketingController L346 - $emailService: '.print_r($emailService,true));return $this->response->setJSON(['success'=>true,'message'=>'Subscriber email sent successfully']);}else{log_message('error','Management/MarketingController L346 - Error Submitting: $emailService: '.print_r($emailService,true));return $this->response->setJSON(['success'=>false,'message'=>'Failed to send Welcome Email']);}}else{return $this->response->setJSON(['success'=>false,'message'=>'Failed to add subscriber']);}}public function approveBufferItem($id){$this->marketingModel->updateBufferStatus($id,'approved');return $this->respond(['status'=>'success','message'=>'Approved']);}public function approveLogo(){$symbol=$this->request->getPost('symbol');$imageUrl=$this->request->getPost('imageUrl');try{$this->marketingModel->saveApprovedLogo($symbol,$imageUrl);return $this->response->setJSON(['success'=>true,'message'=>'Logo approved successfully.',]);}catch(\Exception $e){log_message('error','Failed to approve logo: '.$e->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to approve logo.',]);}}public function approveAndDownloadLogo(){$imageUrl=$this->request->getPost('selectedImage');$symbol=$this->request->getPost('symbol');try{$imageContent=file_get_contents($imageUrl);$imagePath=WRITEPATH.'uploads/Company-Logos/'.$symbol.'.png';file_put_contents($imagePath,$imageContent);$publicPath=FCPATH.'assets/images/Company-Logos/'.$symbol.'.png';rename($imagePath,$publicPath);return redirect()->to('/Management/Marketing/upcomingEarnings')->with('success','Logo approved and saved successfully.');}catch(\Exception $e){log_message('error','Failed to download or save logo: '.$e->getMessage());return redirect()->back()->with('error','Failed to save the logo.');}}public function approveContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['status'=>'approved']);return redirect()->back()->with('success','Content approved successfully.');}public function blogs(){$this->data['pageTitle']='MyMI Blogs | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['blogs']=$this->marketingModel->getBlogs();$this->data['totalBlogs']=$this->marketingModel->countBlogs();$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Blogs',$this->data);}public function campaigns(){$this->data['pageTitle']='Marketing Campaigns | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['getActiveCampaigns']=$this->marketing['department']['getActiveCampaigns'];$this->data['getActivePriorityCampaigns']=$this->marketing['department']['getActivePriorityCampaigns'];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\campaigns',$this->data);}public function contentGenerator(){try{$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\contentGenerator',$this->data);}catch(\Throwable $th){log_message('error','MarketingController contentGenerator error: '.$th->getMessage());}}public function contentReview(){$generatedContent=$this->session->get('generatedContent');if(empty($generatedContent)){return redirect()->to('/Management/Marketing')->with('error','No generated content available for review.');}return $this->renderTheme('ManagementModule\Views\Marketing\Content_Review',['generatedContent'=>$generatedContent]);}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);log_message('debug','âœ… Content digest completed.');}public function cronFetchAndStoreEmails(){try{log_message('debug','Starting cronFetchAndStoreEmails');$this->marketingService->scrapeAndStoreEmailsToTemp();log_message('debug','Finished cronFetchAndStoreEmails');return $this->respond(['status'=>'success']);}catch(\Throwable $e){log_message('error','cronFetchAndStoreEmails Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();log_message('debug','âœ… Inbox scrape completed.');}public function cronFetchMarketingEmails(){log_message('info','CRON: Starting Marketing Email Fetch');$service=new MarketingService();$emailsFetched=$this->getMyMIMarketing()->fetchAndStoreEmails('newsletters');log_message('info','CRON: Fetched '.$emailsFetched.' marketing emails');return $this->respond(['status'=>'success','fetched'=>$emailsFetched]);}public function cronGenerateContentFromTemp(){try{log_message('debug','Starting cronGenerateContentFromTemp');$this->marketingService->generateFinalContentFromTemp();log_message('debug','Finished cronGenerateContentFromTemp');return $this->respond(['status'=>'success']);}catch(\Throwable $e){log_message('error','cronGenerateContentFromTemp Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function cronSendDailyLog(){date_default_timezone_set('America/Chicago');$contentData=$this->getLogsOrFallback();$emailView=view('emails/daily_log_summary',['contentData'=>$contentData['data'],'contentType'=>$contentData['type'],]);$subject=($contentData['type']==='logs')?'Daily Log Summary for '.date('F j, Y'):'Fallback Content - Daily Summary '.date('F j, Y');$this->email->setTo('community@mymiwallet.com')->setSubject($subject)->setMessage($emailView)->send();$this->email->setTo('team@mymiwallet.com')->setSubject('Reminder: Daily Log Email Pending Confirmation')->setMessage('The daily log email is scheduled to be sent at 3 PM CST. Please review the content to ensure everything is accurate.')->send();}public function edit($id=null){if($id===null){throw new \CodeIgniter\Exceptions\PageNotFoundException('Exchange ID not provided');}$tokenData=$this->marketingModel->getExchangeTokenById($id);if(!$tokenData){throw new \CodeIgniter\Exceptions\PageNotFoundException('Token not found');}if($this->request->getMethod()==='post'){$validation=\Config\Services::validation();$validation->setRules(['coin_name'=>'required','market_cap'=>'required|numeric','website'=>'required|valid_url','discord'=>'permit_empty|valid_url','facebook'=>'permit_empty|valid_url','telegram'=>'permit_empty|valid_url','twitter'=>'permit_empty|valid_url',]);if($validation->withRequest($this->request)->run()){$updatedData=['coin_name'=>$this->request->getPost('coin_name'),'market_cap'=>$this->request->getPost('market_cap'),'website'=>$this->request->getPost('website'),'discord'=>$this->request->getPost('discord'),'facebook'=>$this->request->getPost('facebook'),'telegram'=>$this->request->getPost('telegram'),'twitter'=>$this->request->getPost('twitter'),];if($this->marketingModel->updateExchangeToken($id,$updatedData)){$this->session->setFlashdata('success','Exchange token updated successfully');}else{$this->session->setFlashdata('error','Failed to update the exchange token');}return redirect()->to(site_url('Management/Marketing/Exchanges/Edit/'.$id));}else{$this->session->setFlashdata('validation_errors',$validation->getErrors());}}return $this->renderTheme('ManagementModule\Views\Marketing\Exchanges\edit',['token'=>$tokenData,'validation'=>$this->session->getFlashdata('validation_errors'),'redirectURL'=>site_url('Management/Marketing/Exchanges'),]);}public function editContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}return $this->renderTheme('ManagementModule\Views\Marketing\Content_Edit',['content'=>$content]);}public function fetchBufferPaginated(){$page=(int) $this->request->getGet('page')?:1;$limit=(int) $this->request->getGet('limit')?:20;$data=$this->marketingModel->fetchBufferPaginated($page,$limit);return $this->respond($data);}public function fetchLatestSummaries(){$generatedSummaries=$this->marketingModel->getLatestGeneratedSummaries(25);return $this->renderTheme('ManagementModule\Views\Marketing\resources\generatedSummaries',['generatedSummaries'=>$generatedSummaries]);}public function fetchMissingLogos(){$postData=$this->request->getJSON(true);$csrfName=csrf_token();$csrfHash=csrf_hash();if(!isset($postData[$csrfName])||$postData[$csrfName]!==$csrfHash){log_message('error','fetchMissingLogos: CSRF validation failed');return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['error'=>'Invalid CSRF token.']);}$symbols=$postData['symbols']?? null;if(empty($symbols)||!is_array($symbols)){log_message('error','fetchMissingLogos: Invalid symbols input');return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['error'=>'Invalid symbols input.']);}$results=[];foreach($symbols as $symbol){$results[]=['symbol'=>$symbol,'status'=>'not_found',];}return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['results'=>$results]);}public function financialNews(){$symbols=$this->investmentModel->getAllSymbolsByEarnings();$approvedLogos=$this->marketingModel->getApprovedLogos();$existingSymbols=array_column($approvedLogos,'symbol');$missingSymbols=array_filter($symbols,function($symbol)use($existingSymbols){return!in_array($symbol['symbol'],$existingSymbols);});$this->data['approvedLogos']=$approvedLogos ??[];$this->data['missingSymbols']=$missingSymbols ??[];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\financialNews',$this->data);}public function generateAudio(){$text=$this->request->getPost('text');$fileName=$this->request->getPost('fileName')?:uniqid('tts_',true);$directory=WRITEPATH.'uploads/';$outputFile=$directory.$fileName.'.mp3';if(empty($text)){return $this->response->setJSON(['status'=>'error','message'=>'Text cannot be empty.',]);}if(!is_dir($directory)){mkdir($directory,0777,true);}$command=sprintf('python3 gtts_script.py %s %s',escapeshellarg($text),escapeshellarg($outputFile));exec($command,$output,$status);if($status===0&&file_exists($outputFile)){$fileUrl=base_url('uploads/'.basename($outputFile));return $this->response->setJSON(['status'=>'success','message'=>'Audio file generated successfully.','file_url'=>$fileUrl,]);}else{return $this->response->setJSON(['status'=>'error','message'=>'Failed to generate audio.',]);}}private function generateAutomatedContent(){$scraperContent=$this->marketingModel->getRecentScrapes();$tempContent=$this->marketingModel->getRecentTempScrapes();$campaigns=$this->marketingModel->getActiveCampaignsLimited(50);$allContent=array_merge($scraperContent,$tempContent,$campaigns);$generatedContent=[];foreach($allContent as $content){$generatedContent[]=$this->getMarketingService()->generateContentFromPost($content->title ?? 'Untitled',$content->content ?? '',$content->tags?explode(',',$content->tags):[]);}foreach($generatedContent as $content){$slug=$this->marketingModel->createSlug($content['title']);$this->db->table('bf_marketing_blog_posts')->insert(['title'=>$content['title']?? 'Generated Content','content'=>$content['summary']?? '','slug'=>$slug,'tags'=>implode(',',$content['keywords']??[]),'created_on'=>date('Y-m-d H:i:s'),]);$this->marketingModel->saveDailyLog(['title'=>$content['title'],'content'=>$content['summary'],'type'=>'Automated','tags'=>implode(',',$content['keywords']),'date_time'=>date('Y-m-d H:i:s'),'author_information'=>'MyMI Automated System','created_on'=>date('Y-m-d H:i:s'),]);}return $generatedContent;}public function generateContent($platform,$postId){$post=$this->marketingModel->getSchedulePostById($postId);if(!$post){return redirect()->back()->with('error','Post not found.');}$content=$this->getMyMIMarketing()->generateContentFromGPT($post['subjects'],$post['descriptions'],$platform);$contentData=['post_id'=>$postId,'platform'=>$platform,'generated_content'=>$content,];$this->marketingModel->storeGeneratedContent($contentData);return redirect()->to("\Management\Marketing\Schedule")->with('success','Content generated successfully.');}public function generateContentDigestFromStored(){log_message('info','Marketing: Starting summary generation from stored marketing emails.');$model=new MarketingModel();$records=$model->getRecentUnprocessedTempEmails(5);$results=[];foreach($records as $record){if(empty($record['content'])||strlen($record['content'])<1000){log_message('debug',"âš ï¸ Skipping record ID {$record['id']} due to insufficient content length.");continue;}if(empty($record['title'])||empty($record['content'])){log_message('debug','Skipped record due to missing title/content ID: '.$record['id']);continue;}try{$summary=$this->getMarketingService()->generateContentFromRaw($record['title'],$record['content']);$model->storeFinalMarketingContent(['source_id'=>$record['id'],'title'=>$record['title'],'summary'=>$summary,'created_at'=>date('Y-m-d H:i:s')]);$model->markTempRecordAsProcessed($record['id']);$results[]=$record['title'];}catch(\Throwable $e){log_message('error','Failed to process record ID '.$record['id'].': '.$e->getMessage());}}return $this->respond(['status'=>'complete','processed_titles'=>$results]);}public function generateContentFromTweet($tweetId){$tweet=$this->marketingModel->getTweetById($tweetId);if(!$tweet){return $this->failNotFound('Tweet not found');}$generatedContent=$this->getMyMIMarketing()->generateContentFromTweets([$tweet]);$this->marketingModel->storeGeneratedContent(['tweet_id'=>$tweetId,'content'=>json_encode($generatedContent),'created_at'=>date('Y-m-d H:i:s')]);$this->getMyMIMarketing()->postToTwitter($generatedContent['platform_content']['Twitter']);return $this->respond(['message'=>'Content generated and posted successfully']);}public function generateDailyContentDigest(){log_message('debug','ðŸ§  Start Memory Usage: '.memory_get_usage(true));@ini_set('memory_limit','768M');$limit=5;$summary=[];$rawRecords=$this->marketingModel->getLatestUnprocessedEmails($limit);foreach($rawRecords as $record){$content=$record['content']?? '';if(empty($content)||strlen($content)<500){log_message('debug',"â­ï¸ Skipped record ID {$record['id']} - insufficient content.");continue;}$contentSize=strlen($content);log_message('debug','ðŸ“Œ Processing record ID '.$record['id'].' with content size: '.$contentSize);log_message('debug','Management/MarketingController L770 - $record Array: '.print_r($record,true));if($contentSize===0){log_message('debug',"â­ï¸ Skipped record ID {$record['id']} - empty content.");continue;}try{gc_collect_cycles();$processed=$this->getMarketingService()->generateContentFromRaw($record);if($processed===null){log_message('debug',"âš ï¸ Skipped record ID {$record['id']} - generateContentFromRaw() returned null.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$summary[]=['title'=>$processed['headline'],'summary'=>$processed['summary'],'subtopics'=>$processed['subtopics'],'platform_posts'=>$processed['posts'],];}catch(\Throwable $e){log_message('error',"âŒ generateDailyContentDigest failed on record ID {$record['id']}: {$e->getMessage()}");}}$this->marketingModel->markEmailsAsProcessed(array_column($rawRecords,'id'));log_message('debug','ðŸ Peak Memory Usage: '.memory_get_peak_usage(true));return $this->response->setJSON(['digest'=>$summary]);}public function generateNewsletterContent(){$emailContents=$this->marketingModel->getEmailContentsForNewsletter();$content=$this->getMyMIMarketing()->generateNewsletterContent($emailContents);$newsletterData=['title'=>'Monthly Financial Newsletter - '.date('F Y'),'content'=>$content,'status'=>'draft','created_at'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeNewsletterDraft($newsletterData);return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Newsletter content generated successfully');}private function generateSummarizedFallbackContent($contentArray){$summarizedContent=[];$summarizer=new \App\Libraries\ContentSummarizer();foreach($contentArray as $content){$summarizedContent[]=['title'=>$content->title ?? 'Untitled','summary'=>$summarizer->summarize($content->content ?? '',200),'url'=>$content->url ?? null,];}return $summarizer->combineSummaries($summarizedContent);}private function getLogsOrFallback(){$logs=$this->marketingModel->getDailyLogsByDate(date('Y-m-d'));if(!empty($logs)){return['type'=>'logs','data'=>$logs];}$scrapedContent=$this->marketingModel->getRecentScrapes();$campaigns=$this->marketingModel->getActiveCampaignsLimited(50);$combinedContent=array_merge($scrapedContent,$campaigns['result']);$fallbackContent=$this->generateSummarizedFallbackContent($combinedContent);foreach($fallbackContent as $content){$this->marketingModel->saveDailyLog(['title'=>$content['title']?? 'Automated Content','content'=>$content['summary']?? '','type'=>'Automated','tags'=>implode(',',$content['keywords']??[]),'date_time'=>date('Y-m-d H:i:s'),'author_information'=>'MyMI Automated System','created_on'=>date('Y-m-d H:i:s'),]);}return['type'=>'fallback','data'=>$fallbackContent];}public function getRecentScrapes(){try{$scrapes=$this->marketingModel->getRecentScrapes();return $this->response->setJSON(['success'=>true,'scrapes'=>$scrapes]);}catch(\Throwable $th){log_message('error','getRecentScrapes: Exception - '.$th->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to fetch recent scrapes.']);}}private function handleMediaUpload($mediaFiles){$uploadedMedia=[];foreach($mediaFiles as $file){if($file->isValid()&&!$file->hasMoved()){$newFileName=$file->getRandomName();$file->move(WRITEPATH.'uploads/media/',$newFileName);$uploadedMedia[]=['file_name'=>$file->getClientName(),'file_path'=>WRITEPATH.'uploads/media/'.$newFileName,'file_size'=>$file->getSize(),'file_type'=>$file->getMimeType(),];}}return $uploadedMedia;}public function ideas(){$this->data['pageTitle']='Marketing Campaigns | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['getActiveIdeas']=$this->marketingModel->getActiveIdeas();$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\ideas',$this->data);}public function importScheduleCSV(){if($this->request->getMethod()==='post'){$file=$this->request->getFile('csv_file');if($file->isValid()&&!$file->hasMoved()){$filePath=WRITEPATH.'uploads/'.$file->store();$csvData=array_map('str_getcsv',file($filePath));foreach($csvData as $row){$scheduleData=['day'=>$row[0],'time'=>$row[1],'activity'=>$row[2],];$scheduleId=$this->marketingModel->addMarketingSchedule($scheduleData);$campaignData=['sched_id'=>$scheduleId,'title'=>$row[3],'platform'=>$row[4],'content'=>$row[5],];$this->marketingModel->addMarketingCampaign($campaignData);}return redirect()->back()->with('success','Schedule and campaigns imported successfully.');}return redirect()->back()->with('error','Invalid CSV file.');}return $this->renderTheme('ManagementModule\Views\Marketing\importCSV');}public function previewBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Item not found.");return $this->renderTheme('ManagementModule\Views\Marketing\modals\bufferPreview',['item'=>$record]);}public function previewGeneratedPost($id){try{$post=$this->marketingModel->find($id);if(!$post){return $this->failNotFound('Post not found.');}return $this->renderTheme('App\Modules\Management\Views\Marketing\modals/previewGeneratedPost',['post'=>$post]);}catch(\Throwable $e){log_message('error','âŒ Failed to load post preview: '.$e->getMessage());return $this->failServerError('Unable to preview post.');}}public function previewPendingSummaries(){try{$pendingSummaries=$this->marketingModel->getPendingScraperSummaries(10);return $this->renderTheme('App\Modules\Management\Views\Marketing\partials\previewPendingSummaries',['pendingSummaries'=>$pendingSummaries]);}catch(\Throwable $e){log_message('error','âŒ previewPendingSummaries failed: '.$e->getMessage());return $this->failServerError('Could not load summaries.');}}public function previewVideoScript($id){$post=$this->marketingModel->getGeneratedPostById($id);if(!$post)return $this->failNotFound('Post not found.');$posts=json_decode($post['posts'],true);$videoScript=$posts['video']?? 'No video script generated yet.';return $this->renderTheme('MarketingModule\Views\Marketing\modals\video_preview_modal',['title'=>$post['title'],'videoScript'=>$videoScript,]);}public function processScheduledPosts(){$currentTimestamp=date('Y-m-d H:i:s');$scheduledPosts=$this->marketingModel->getPendingScheduledPosts($currentTimestamp);foreach($scheduledPosts as $post){$payload=['platform'=>$post->platform,'content'=>$post->content,'media_url'=>$post->media_url,];try{$response=$this->sendToZapier($post->zapier_webhook_url,$payload);if($response->getStatusCode()===200){$this->marketingModel->updatePostStatus($post->id,'posted');}else{throw new Exception("Zapier response error: {$response->getBody()}");}}catch(Exception $e){$this->handlePostFailure($post,$e->getMessage());}}}private function sendToZapier($webhookUrl,$payload){$client=new \GuzzleHttp\Client();return $client->post($webhookUrl,['headers'=>['Content-Type'=>'application/json'],'json'=>$payload,]);}private function handlePostFailure($post,$error){$this->marketingModel->incrementRetryCount($post->id);log_message('error',"Failed to post to Zapier for Post ID {$post->id}: {$error}");if($post->retry_count>=3){$this->marketingModel->updatePostStatus($post->id,'failed');}}public function postCreator(){try{$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\index',$this->data);}catch(\Throwable $th){log_message('error','MarketingController postCreator error: '.$th->getMessage());}}public function promote(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['exchangeAssets']=[];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Promote',$this->data);}public function publishBlog($blogId){$blog=$this->marketingModel->getBlogPostDetails($blogId);if(!$blog){return redirect()->back()->with('error','Blog post not found.');}$this->marketingModel->update($blogId,['status'=>'published']);return redirect()->to('/Management/Marketing/Blogs')->with('success','Blog published successfully.');}public function rejectBufferItem($id){$this->marketingModel->updateBufferStatus($id,'rejected');return $this->respond(['status'=>'success','message'=>'Rejected']);}public function rejectContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['status'=>'rejected']);return redirect()->back()->with('success','Content rejected successfully.');}public function reviewBuffer(){$buffer=$this->marketingModel->getBufferItems();$this->data['pageTitle']='Marketing Buffer Dashboard';$this->data['buffer']=$buffer;return $this->renderTheme('ManagementModule\Views\Marketing\BufferDashboard',$this->data);}public function runContentGeneration(){$generatedContent=$this->generateAutomatedContent();$this->session->set('generatedContent',$generatedContent);return redirect()->to('/Management/Marketing/ContentReview')->with('success',count($generatedContent).' content items generated successfully. Please review and approve.');}private function sanitizeContent($content){$content=preg_replace('#<script(.*?)>(.*?)</script>#is','',$content);$content=preg_replace('#<style(.*?)>(.*?)</style>#is','',$content);$content=strip_tags($content);$content=preg_replace('/\s+/',' ',$content);return trim($content);}private function saveCampaign($formData){$data=['title'=>$formData['title'],'description'=>$formData['description'],];$this->marketingModel->addMarketingCampaign($data);}public function saveContentEdit($id){$postData=$this->request->getPost();$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['content'=>$postData['content'],'status'=>'pending',]);return redirect()->to('/Management/Marketing/ContentReview')->with('success','Content updated successfully.');}private function saveSchedule($formData){$scheduleModel=new \App\Models\ScheduleModel();$data=['title'=>$formData['title'],'description'=>$formData['description'],];$scheduleModel->insert($data);}public function schedule($day=null){if(!empty($day)){$this->data['marketingSchedule']=$this->marketingModel->getScheduleByDay($day);foreach($this->data['marketingSchedule']as&$schedule){$schedule['campaigns']=$this->marketingModel->getCampaignsBySchedId($schedule['id']);}$this->data['scheduleByDay']='Yes';}else{$this->data['marketingSchedule']=$this->marketingModel->getUpcomingSchedule();foreach($this->data['marketingSchedule']as&$schedule){$schedule['campaigns']=$this->marketingModel->getCampaignsBySchedId($schedule['id']);}$this->data['scheduleByDay']='No';}$this->commonData();$this->data['pageTitle']='Daily Schedule | Management | MyMI Wallet';return $this->renderTheme('ManagementModule\Views\Marketing\Schedule',$this->data);}public function scheduleNewsletterCampaign(){$newsletterDraft=$this->marketingModel->getLatestNewsletterDraft();if(!$newsletterDraft){return $this->response->setJSON(['success'=>false,'message'=>'No newsletter draft found']);}$campaignData=['title'=>$newsletterDraft['title'],'content'=>$newsletterDraft['content'],'status'=>'scheduled','send_date'=>$this->request->getPost('send_date'),'target_audience'=>'all_users','created_at'=>date('Y-m-d H:i:s'),];if($this->marketingModel->scheduleNewsletterCampaign($campaignData)){return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Newsletter campaign scheduled successfully');}else{return redirect()->back()->with('error','Failed to schedule newsletter campaign');}}private function scrapeGoogleSearch($query){$searchUrl='https://www.google.com/search?q='.urlencode($query);$client=new Client();try{$response=$client->get($searchUrl);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$dom=new \DOMDocument();libxml_use_internal_errors(true);$dom->loadHTML($html);libxml_clear_errors();$xpath=new \DOMXPath($dom);$results=[];foreach($xpath->query('//a[@href]')as $link){$href=$link->getAttribute('href');if(strpos($href,'/url?q=')===0){$href=substr($href,7,strpos($href,'&')-7);$text=$link->nodeValue;$results[]=['href'=>$href,'text'=>$text];}}return $results;}else{log_message('error','scrapeGoogleSearch: Could not retrieve content, HTTP status code - '.$response->getStatusCode());return['error'=>'Could not retrieve content, HTTP status code - '.$response->getStatusCode()];}}catch(RequestException $e){log_message('error','scrapeGoogleSearch: RequestException - '.$e->getMessage());return['error'=>'RequestException error: '.$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeGoogleSearch: General error - '.$e->getMessage());return['error'=>'General error: '.$e->getMessage()];}return[];}public function scrapeLink(){$rawRequestBody=$this->request->getBody();$jsonData=json_decode($rawRequestBody,true);$url=$jsonData['url']?? null;if(!$url){log_message('error','scrapeLink: URL is missing');return $this->response->setJSON(['success'=>false,'message'=>'URL is required.']);}try{log_message('debug','scrapeLink: Scraping URL - '.$url);$scrapedData=$this->scrapeWebsiteWithFallback($url);if(isset($scrapedData['error'])){log_message('error','scrapeLink: '.$scrapedData['error']);return $this->response->setJSON(['success'=>true,'message'=>'Partially scraped data, proceeding with available data.']);}if(!empty($scrapedData['content'])){$this->marketingModel->storeTempScrapedData(['title'=>$scrapedData['title'],'content'=>$scrapedData['content'],'links'=>json_encode($scrapedData['links']),'url'=>$scrapedData['url'],'scraped_at'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),]);return $this->response->setJSON(['success'=>true,'message'=>'Scraped data stored successfully.','data'=>$scrapedData]);}else{log_message('error','scrapeLink: Scraped data is empty');return $this->response->setJSON(['success'=>false,'message'=>'Scraping failed. Please check the URL and try again.']);}}catch(\Throwable $th){log_message('error','scrapeLink: Exception - '.$th->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'An error occurred during scraping.']);}}private function scrapeLinks($links){$scrapedLinksData=[];foreach($links as $link){$url=filter_var($link['href'],FILTER_SANITIZE_URL);if(filter_var($url,FILTER_VALIDATE_URL)){$scrapedData=$this->scrapeWebsite($url);if(!empty($scrapedData['content'])){$scrapedLinksData[]=$scrapedData;}}}return $scrapedLinksData;}private function scrapeWebsite($url){$client=new Client();try{$response=$client->get($url,['stream'=>true,'headers'=>['User-Agent'=>'MyMI Wallet Bot'],'timeout'=>10,'http_errors'=>false ]);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$dom=HtmlDomParser::str_get_html($html);if($dom instanceof \voku\helper\HtmlDomParser){$title=$dom->find('title',0)->text ?? 'No title found';$bodyNode=$dom->find('body',0);$bodyContent=$bodyNode?$this->sanitizeContent($bodyNode->innerHtml()):'No body content found';$links=[];foreach($dom->find('a')as $link){$href=$link->getAttribute('href');$text=$link->text;$links[]=['href'=>$href,'text'=>$text];}log_message('debug','scrapeWebsite: Scraping successful for URL - '.$url);return['title'=>$title,'content'=>$bodyContent,'links'=>$links,'url'=>$url];}else{log_message('error','scrapeWebsite: DOM parsing failed for URL - '.$url);return['error'=>'DOM parsing failed.'];}}else{log_message('error','scrapeWebsite: Could not retrieve content, HTTP status code - '.$response->getStatusCode());return['error'=>'Could not retrieve content, HTTP status code - '.$response->getStatusCode()];}}catch(RequestException $e){if($e->hasResponse()&&$e->getResponse()->getStatusCode()==401){log_message('error','scrapeWebsite: Unauthorized access for URL - '.$url);return['error'=>'Unauthorized access. Skipping URL.'];}log_message('error','scrapeWebsite: RequestException - '.$e->getMessage());return['error'=>'RequestException error: '.$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeWebsite: General error - '.$e->getMessage());return['error'=>'General error: '.$e->getMessage()];}}private function scrapeWebsiteWithFallback($url){try{log_message('debug','scrapeWebsiteWithFallback: Scraping URL - '.$url);$scrapedData=$this->scrapeWebsite($url);if(empty($scrapedData['content'])){log_message('debug','scrapeWebsiteWithFallback: Scraped data is empty, performing Google search fallback');$googleSearchResults=$this->scrapeGoogleSearch($url);$scrapedLinksData=$this->scrapeLinks($googleSearchResults);$scrapedData['google_search_results']=$scrapedLinksData;}return $scrapedData;}catch(RequestException $e){log_message('error','scrapeWebsiteWithFallback: RequestException - '.$e->getMessage());return['error'=>$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeWebsiteWithFallback: General error - '.$e->getMessage());return['error'=>$e->getMessage()];}}public function searchAndApproveLogo($symbol){$query=$symbol.' logo png transparent';$searchUrl='https://www.google.com/search?q='.urlencode($query).'&tbm=isch';try{$response=$this->client->request('GET',$searchUrl);$htmlContent=$response->getBody()->getContents();$dom=new \DOMDocument();@$dom->loadHTML($htmlContent);$xpath=new \DOMXPath($dom);$imageNodes=$xpath->query('//img');$imageUrls=[];foreach($imageNodes as $imageNode){$src=$imageNode->getAttribute('src');if($src){$imageUrls[]=$src;}}return $this->renderTheme('ManagementModule\Views\Marketing\approve_logo',['symbol'=>$symbol,'imageUrls'=>$imageUrls,]);}catch(RequestException $e){log_message('error','Google Search Request Failed: '.$e->getMessage());return redirect()->back()->with('error','Failed to fetch logo suggestions.');}}public function sendScheduledNewsletter(){$campaigns=$this->marketingModel->getScheduledCampaigns();foreach($campaigns as $campaign){$this->getMyMIMarketing()->sendNewsletter($campaign['content'],$campaign['target_audience']);$this->marketingModel->updateCampaignStatus($campaign['id'],'sent');}return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Scheduled newsletters sent successfully');}public function standaloneAddSubscriber(){$this->data['pageTitle']='Add Subscriber | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneAddSubscriber',$this->data);}public function standaloneScrape(){$this->data['pageTitle']='Quick Scraper | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneScraper',$this->data);}private function storeScrapedData($scrapedData){$db=\Config\Database::connect();$builder=$db->table('bf_marketing_temp_scraper');$data=['title'=>$scrapedData['title'],'content'=>$scrapedData['content'],'links'=>json_encode($scrapedData['links']),'url'=>$scrapedData['url'],'created_at'=>date('Y-m-d H:i:s'),'updated_at'=>date('Y-m-d H:i:s'),];$builder->insert($data);}public function submitContent(){$request=service('request');$validationRules=['campaignName'=>'required|min_length[3]','promotionalLinks'=>'required','facebookMessage'=>'required','linkedinMessage'=>'required','discordMessage'=>'required','stockTwitsMessage'=>'required','tiktokMessage'=>'required','youtubeMessage'=>'required','emailMessage'=>'required',];if(!$this->validate($validationRules)){return redirect()->back()->with('errors',$this->validator->getErrors())->withInput();}$campaignData=['name'=>$request->getPost('campaignName'),'promotional_links'=>json_encode($request->getPost('promotionalLinks')),'facebook_message'=>$request->getPost('facebookMessage'),'linkedin_message'=>$request->getPost('linkedinMessage'),'discord_message'=>$request->getPost('discordMessage'),'stocktwits_message'=>$request->getPost('stockTwitsMessage'),'tiktok_message'=>$request->getPost('tiktokMessage'),'youtube_message'=>$request->getPost('youtubeMessage'),'email_message'=>$request->getPost('emailMessage'),'additional_info'=>$request->getPost('additionalInfo'),'created_on'=>date('Y-m-d H:i:s'),'status'=>1,'stage'=>'draft',];$marketingModel=new MarketingModel();if($marketingModel->insert($campaignData)){return redirect()->to('/Marketing/Success')->with('success','Marketing content submitted successfully.');}else{return redirect()->back()->with('error','Failed to submit marketing content.')->withInput();}}public function submitDailyLog(){$data=['title'=>$this->request->getPost('subject'),'content'=>$this->request->getPost('log_content'),'subcontent'=>json_encode($this->request->getPost('subcontent')),'tags'=>$this->request->getPost('tags'),'type'=>$this->request->getPost('content_type'),'url'=>$this->request->getPost('url'),'author_information'=>$this->request->getPost('author_information'),'date_time'=>$this->request->getPost('date_time'),'trade_alert_subcategory'=>$this->request->getPost('trade_alert_subcategory'),'created_on'=>date('Y-m-d H:i:s'),];if($this->marketingModel->saveDailyLog($data)){return $this->response->setJSON(['success'=>true,'message'=>'Daily log submitted successfully!']);}else{return $this->response->setJSON(['success'=>false,'message'=>'Failed to submit daily log.']);}}public function submitLargeContent(){log_message('debug','submitLargeContent method called');try{$subject=$this->request->getPost('subject');$url=$this->request->getPost('url');$content=$this->request->getPost('large_content');$tags=$this->request->getPost('tags');$uploadedFiles=$this->request->getFiles();$contentType=$this->request->getPost('content_type');$mediaAssets=$this->handleMediaUpload($uploadedFiles['media_assets']);if(empty($content)||strlen($content)<50){throw new \Exception('Content too short or empty');}$generatedContent=$this->getMyMIMarketing()->generateContentFromLargeText($content,$tags);$keywords=is_array($generatedContent['keywords'])?$generatedContent['keywords']:[];$this->marketingModel->storeScrapedContent(['status'=>'pending','type'=>$contentType,'url'=>$url,'title'=>$subject,'summary'=>$generatedContent['summary'],'content'=>$content,'keywords'=>implode(', ',$keywords),'created_on'=>date('Y-m-d H:i:s'),]);return $this->response->setJSON(['success'=>true]);}catch(\Exception $e){log_message('error','submitLargeContent error: '.$e->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to submit content.']);}}public function submitLargeContentForm(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();$this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneLargeContentForm',$this->data);}public function submitMarketingCampaign(){helper(['form','url']);$data=['name'=>$this->request->getPost('campaignName'),'assigned_to'=>$this->request->getPost('assigned_to'),'promotional_links'=>json_encode($this->request->getPost('promotionalLinks')),'facebook_message'=>htmlentities($this->request->getPost('facebookMessage'),ENT_QUOTES,'UTF-8'),'linkedin_message'=>htmlentities($this->request->getPost('linkedinMessage'),ENT_QUOTES,'UTF-8'),'discord_message'=>htmlentities($this->request->getPost('discordMessage'),ENT_QUOTES,'UTF-8'),'stocktwits_message'=>htmlentities($this->request->getPost('stocktwitsMessage'),ENT_QUOTES,'UTF-8'),'tiktok_message'=>htmlentities($this->request->getPost('tiktokMessage'),ENT_QUOTES,'UTF-8'),'youtube_message'=>htmlentities($this->request->getPost('youtubeMessage'),ENT_QUOTES,'UTF-8'),'email_message'=>htmlentities($this->request->getPost('emailMessage'),ENT_QUOTES,'UTF-8'),'additional_info'=>htmlentities($this->request->getPost('additionalInfo'),ENT_QUOTES,'UTF-8'),'overall_campaign_description'=>htmlentities($this->request->getPost('overall_campaign_description'),ENT_QUOTES,'UTF-8'),'voice_script'=>htmlentities($this->request->getPost('voice_script'),ENT_QUOTES,'UTF-8')];if($this->validate(['name'=>'required','facebook_message'=>'required',])){$this->marketingModel->submitCampaignContent($data);return redirect()->to('/dashboard')->with('success','Campaign submitted successfully.');}else{return redirect()->back()->withInput()->with('errors',$this->validator->getErrors());}}public function submitMarketIdeas(){if($this->request->getMethod()==='post'){$data=['title'=>$this->request->getPost('title'),'description'=>htmlentities($this->request->getPost('description'),ENT_QUOTES,'UTF-8'),'created_by'=>session()->get('user_id'),'assigned_to'=>$this->request->getPost('assigned_to'),'priority'=>$this->request->getPost('priority'),'status'=>'draft','platforms'=>json_encode($this->request->getPost('platforms')),'additional_info'=>htmlentities($this->request->getPost('additional_info'),ENT_QUOTES,'UTF-8'),];$uploadedFiles=$this->request->getFiles();$filePaths=[];if($uploadedFiles&&isset($uploadedFiles['imageFiles'])){foreach($uploadedFiles['imageFiles']as $file){if($file->isValid()&&!$file->hasMoved()){$newName=$file->getRandomName();$file->move(FCPATH.'public/assets/images/Marketing/Ideas',$newName);$filePaths[]=base_url('assets/images/Marketing/Ideas/'.$newName);}}}if(!empty($filePaths)){$data['image_paths']=json_encode($filePaths);}if($this->validate(['title'=>'required','description'=>'required'])){$this->marketingModel->submitIdea($data);return redirect()->back()->with('success','Idea submitted successfully.');}else{return redirect()->back()->withInput()->with('errors',$this->validator->getErrors());}}}public function topCommunities($channel=null){$this->commonData();$MyMIExchange=new MyMIExchange();$exchangeTokens=$MyMIExchange->getSolanaTokens();if(!empty($channel)){if($channel==='Discord'){$this->data['tokens']=$exchangeTokens['discord'];$this->data['pageTitle']='Discord Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\discord',$this->data);}elseif($channel==='Facebook'){$this->data['tokens']=$exchangeTokens['facebook'];$this->data['pageTitle']='Facebook Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\facebook',$this->data);}elseif($channel==='Twitter'){$this->data['tokens']=$exchangeTokens['x_twitter'];$this->data['pageTitle']='Twitter Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\twitter',$this->data);}elseif($channel==='Website'){$this->data['tokens']=$exchangeTokens['website'];$this->data['pageTitle']='Website Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\website',$this->data);}else{$this->data['tokens']=$exchangeTokens['all'];$this->data['pageTitle']='All Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\all_tokens',$this->data);}}else{$this->data['tokens']=$exchangeTokens['all'];$this->data['pageTitle']='All Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\all_tokens',$this->data);}}public function triggerPostAutogenOnEmpty(){$today=date('Y-m-d');$existing=$this->marketingModel->getLatestGeneratedSummaries(5,$today);if(!empty($existing)){return $this->response->setJSON(['status'=>'skipped','message'=>'Summaries already exist for today.']);}try{$this->getMyMIMarketing()->generateFromTempScraper(5);return $this->response->setJSON(['status'=>'generated','message'=>'Generated new summaries.']);}catch(\Throwable $e){log_message('error','triggerPostAutogenOnEmpty error: '.$e->getMessage());return $this->failServerError('Failed to generate summaries.');}}public function twitterDashboard(){$data=['pageTitle'=>'Twitter Dashboard','hashtags'=>$this->request->getPost('hashtags')?? '','tweets'=>[]];if($this->request->getMethod()==='post'){$hashtags=$this->request->getPost('hashtags');$tweets=$this->getMyMIMarketing()->fetchTweets($hashtags);$data['tweets']=$tweets;}return $this->renderTheme('Management/Marketing/Twitter',$data);}public function upcomingEarnings(){$model=new \App\Models\EarningsModel();$upcomingEarnings=$model->getUpcomingEarnings();$this->data['upcomingEarnings']=$upcomingEarnings;return $this->renderTheme('ManagementModule\Views\Marketing\upcoming_earnings',$this->data);}public function updatePlatformToggle($id){$post=$this->request->getJSON(true);$platform=$post['platform'];$enabled=(bool) $post['enabled'];$record=$this->marketingModel->getBufferItem($id);$platforms=json_decode($record['platforms']?? '{}',true);$platforms[$platform]=$enabled;$this->marketingModel->updateBufferItem($id,['platforms'=>json_encode($platforms)]);return $this->respond(['status'=>'success']);}public function viewBlog($slug){$blogPost=$this->marketingModel->getBlogPostBySlug($slug);if(!$blogPost){throw new \CodeIgniter\Exceptions\PageNotFoundException('Blog post not found');}return $this->renderTheme('blog/view',['blogPost'=>$blogPost]);}public function viewCampaign($campaign_id){$campaignModel=new CampaignModel();$campaign=$this->marketingModel->getCampaignsById($campaign_id);if(!$campaign){throw new \CodeIgniter\Exceptions\PageNotFoundException("Campaign not found");}return $this->renderTheme('ManagementModule\Views\Marketing\Campaigns\View',['campaign'=>$campaign]);}public function viewDailyLogs($date=null){$date=$this->siteSettings->date ?? date('Y-m-d');$this->data['pageTitle']='Marketing Daily Log | '.$date.' | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['logs']=$this->marketingModel->getDailyLogsByDate($date);$this->commonData();return $this->renderTheme('ManagementModul\Views\Marketing\Daily_Logs',['logs'=>$logs,'date'=>$date]);}public function viewEmail($titleEncoded=null,$messageId=null){log_message('debug','ðŸ“§ ManagementController::viewEmail called');try{if(empty($messageId)){return redirect()->back()->with('error','Invalid email identifier.');}$emailRecord=$this->marketingModel->getEmailByMessageId($messageId);if(!$emailRecord){return redirect()->back()->with('error','Email not found.');}$socialMediaPosts=$this->getMarketingService()->generateContentFromRaw($emailRecord);$emailRecord['social_media']=$socialMediaPosts['posts']??[];return $this->renderTheme('Management/Marketing/EmailDetail',['email'=>$emailRecord]);}catch(\Throwable $e){log_message('error','âŒ viewEmail() failed: '.$e->getMessage());return $this->failServerError('Unable to load email.');}}public function viewGeneratedContent(){$contentData=$this->marketingModel->getLastGeneratedContent();$platformsContent=json_decode($contentData['platforms_content'],true);$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['platforms_content']=$platformsContent;$this->commonData();$this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneGeneratedContent',$this->data);}public function viewGeneratedSummaries(){$this->data['pageTitle']='Generated Summaries';$this->data['generatedSummaries']=$this->marketingModel->getLatestGeneratedSummaries(25);$this->renderTheme('ManagementModule\Views\Marketing\resources\generatedSummaries',$this->data);}} ?><?php namespace App\Modules\APIs\Controllers;use CodeIgniter\API\ResponseTrait;use CodeIgniter\Controller;use App\Libraries\{BaseLoader,MyMIMarketing};use App\Services\MarketingService;use App\Models\MarketingModel;class MarketingController extends Controller{use ResponseTrait;use BaseLoader;protected $MyMIMarketing;protected $marketingService;protected $marketingModel;public function __construct(){$this->MyMIMarketing=new MyMIMarketing();$this->marketingModel=new MarketingModel();}public function approveBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Record not found.");$this->marketingModel->updateBufferItem($id,['status'=>'approved']);$posts=$this->MyMIMarketing->generateSocialPost($record);$this->MyMIMarketing->distributeContent('discord',$posts['discord']);$this->MyMIMarketing->distributeContent('linkedin',$posts['linkedin']);return $this->respond(['status'=>'success','message'=>'Content approved & promoted!']);}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);return $this->respond(['status'=>'success','message'=>'Content analysis completed.']);}public function cronFetchAndGenerateNews(){try{$this->MyMIMarketing->cronFetchAndGenerateNews();return $this->respond(['status'=>'success','message'=>'News fetched and generated.']);}catch(\Throwable $e){return $this->failServerError($e->getMessage());}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();return $this->respond(['status'=>'success','message'=>'Inbox scraped.']);}public function cronFetchMarketingEmails(){log_message('info','ðŸ“¬ CRON: Fetching marketing emails via inbox scrape');try{$result=$this->getMyMIMarketing()->scrapeInboxAndStore();return $this->respond(['status'=>'success','message'=>'Marketing inbox scrape completed.','result'=>$result]);}catch(\Throwable $e){log_message('error','âŒ cronFetchMarketingEmails() failed: '.$e->getMessage());return $this->failServerError('Inbox fetch failed: '.$e->getMessage());}}public function distributeHighScoreContent(){try{$this->getMyMIMarketing()->autoSendToZapier(80);return $this->respond(['status'=>'success','message'=>'Top scoring posts sent to Zapier']);}catch(\Throwable $e){return $this->failServerError($e->getMessage());}}public function exportBufferPosts(){helper('text');$model=new \App\Models\MarketingModel();$bufferPosts=$model->fetchBufferPostsForScoring();$filename='buffer-posts-'.date('Ymd_His').'.csv';$csvHeader=['ID','Keyword','Summary','Score','Tag Score','Category','Status','Created At'];$csvData=[$csvHeader];foreach($bufferPosts as $post){$csvData[]=[$post['id'],$post['keyword'],word_limiter(strip_tags($post['summary']),10),$post['score'],$post['tag_score'],$post['category'],$post['status'],$post['created_at']?? '',];}header('Content-Type: text/csv');header("Content-Disposition: attachment; filename=\"$filename\"");$f=fopen('php://output','w');foreach($csvData as $row){fputcsv($f,$row);}fclose($f);exit;}public function fetchBufferPaginated(){$request=service('request');$page=(int) $request->getGet('page')?? 1;$limit=(int) $request->getGet('limit')?? 20;$keyword=$request->getGet('keyword');$category=$request->getGet('category');$minTagScore=$request->getGet('min_tag_score')?? 0;$onlySuggested=(bool) $request->getGet('only_suggested');$result=$this->marketingModel->fetchBufferPaginatedWithFilters(['page'=>$page,'limit'=>$limit,'keyword'=>$keyword,'category'=>$category,'min_tag_score'=>$minTagScore,'only_suggested'=>$onlySuggested]);return $this->respond(['status'=>'success','data'=>$result['data'],'pagination'=>$result['pagination']]);}public function fetchGeneratedSummaries(){try{$summaries=$this->marketingModel->getRecentPosts(5);return $this->respond(['status'=>'success','summaries'=>$summaries,]);}catch(\Throwable $e){log_message('error','âŒ fetchGeneratedSummaries Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function fetchGeneratedSummariesBlock(){try{helper('text');$todaysStory=$this->marketingModel->where('DATE(created_at)',date('Y-m-d'))->orderBy('created_at','desc')->findAll();return $this->renderTheme('App\Modules\Management\Views\Marketing\index/generatedSummariesBlock',['todaysStory'=>$todaysStory]);}catch(\Throwable $e){log_message('error','âŒ Failed to fetch summaries block: '.$e->getMessage());return $this->failServerError('Unable to refresh summaries.');}}public function generateContentFromScraper(){try{$this->getMyMIMarketing()->generateFromTempScraper(25);return $this->respond(['status'=>'success','message'=>'Content generated from scraper.']);}catch(\Throwable $e){log_message('error','âŒ generateContentFromScraper Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function generateContentDigestFromStored(){$records=$this->marketingModel->getRecentUnprocessedTempEmails(5);$processedTitles=[];foreach($records as $record){$recordId=$record['id']?? 0;try{if(empty($record['title'])){$record['title']='Fallback Title - ID '.$recordId;}$insertResult=$this->getMyMIMarketing()->generateContentAndInsert($record);if($insertResult){$this->marketingModel->markTempScraperProcessed($recordId);$processedTitles[]=$insertResult['title'];log_message('info',"âœ… Inserted content for ID {$recordId}");}else{log_message('warning',"âš ï¸ Skipped record ID {$recordId} â€” summary not stored");}}catch(\Throwable $e){log_message('error',"âŒ Exception on record ID {$recordId}: {$e->getMessage()}");}}return $this->respond(['status'=>'complete','processed_titles'=>$processedTitles]);}public function generateDailyContentDigest(){@ini_set('memory_limit','768M');$records=$this->marketingModel->getValidUnprocessedEmails(5);$insertedSummaries=[];foreach($records as $record){if(!is_array($record)){log_message('error','âŒ Invalid record structure: Expected array, got '.gettype($record));continue;}try{log_message('debug','ðŸ” Processing record ID '.$record['id']);$result=$this->getMyMIMarketing()->generateContentAndInsert($record);if($result){$this->marketingModel->markTempScraperProcessed($record['id']);$insertedSummaries[]=$result['title']?? '(no title)';log_message('info',"âœ… Successfully processed and inserted record ID {$record['id']}");}else{log_message('warning',"âš ï¸ Skipped or failed to insert record ID {$record['id']}");}}catch(\Throwable $e){log_message('error',"âŒ Exception on record ID {$record['id']}: ".$e->getMessage());}}return $this->respond(['status'=>'success','inserted'=>$insertedSummaries]);}public function generatePostsFromSummary($summaryId=null){try{$summary=$this->marketingModel->find($summaryId);if(!$summary){return $this->failNotFound('Summary not found.');}$decodedTitleRaw=$summary['title']?? '';$decodedSummaryRaw=$summary['summary']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$decodedSummary=quoted_printable_decode($decodedSummaryRaw);$decodedSummary=preg_replace('/=\r?\n/','',$decodedSummary);$decodedSummary=html_entity_decode($decodedSummary,ENT_QUOTES|ENT_HTML5,'UTF-8');$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$decodedTitle);$cleanedSummary=html_entity_decode(strip_tags($decodedSummary));$keywords=$this->MyMIMarketing->extractKeywords($cleanedSummary);$posts=$this->MyMIMarketing->generateSocialPosts($cleanedSummary,$keywords);$this->marketingModel->update($summaryId,['keywords'=>json_encode($keywords),'posts'=>json_encode($posts),]);return $this->respond(['status'=>'success','message'=>'Content generated and stored successfully.','original'=>$summary,'cleaned'=>['title'=>$cleanTitle,'summary'=>$cleanedSummary,'keywords'=>$keywords,'posts'=>$posts,],]);}catch(\Throwable $e){log_message('error','âŒ generatePostsFromSummary() failed: '.$e->getMessage());return $this->failServerError('Error generating posts.');}}public function generateScheduledPosts(){helper('text');$marketingModel=new MarketingModel();$marketing=new MyMIMarketing();$buffer=$marketingModel->getTopBufferPosts(3,6.5);if(empty($buffer)){return $this->respond(['status'=>'empty','message'=>'No queued posts available.']);}foreach($buffer as $post){$marketingModel->updateBufferItem($post['id'],['status'=>'promoted']);$generated=$marketing->generateSocialPost($post);if(json_decode($post['platforms'])->discord ?? false){$marketing->distributeContent('discord',$generated['discord']);}if(json_decode($post['platforms'])->linkedin ?? false){$marketing->distributeContent('linkedin',$generated['linkedin']);}$marketing->notifyModerators($post);}return $this->respond(['status'=>'success','message'=>'Posts published!']);}public function generateVoiceScriptManually(){try{log_message('info','ðŸŽ¤ generateVoiceScriptManually() triggered.');$script=$this->getMyMIMarketing()->generateVoiceoverScript();return $this->response->setJSON(['status'=>'success','script'=>$script]);}catch(\Throwable $e){log_message('error','âŒ Error in generateVoiceScriptManually: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()]);}}public function massResendActivationEmails(){$userModel=new \App\Models\UserModel();$users=$userModel->getPendingActivationUsers();$activator=service('activator');$success=0;$failure=0;foreach($users as $user){if($activator->send($user)){$success++;}else{$failure++;}}return $this->respond(['status'=>'success','message'=>"$success emails sent, $failure failed."]);}public function monitorKeywordsAndScrape(){log_message('info','ðŸ§  Keyword Monitor Started');$keywords=$this->getMyMIMarketing()->getKeywordCandidates();if(empty($keywords)){return $this->respond(['status'=>'no_keywords']);}$results=[];foreach($keywords as $keyword){try{$scrapedData=$this->getMyMIMarketing()->scrapeGoogleSearch($keyword);if(!empty($scrapedData)){$summary=$this->getMyMIMarketing()->generateContentFromScrapedData($scrapedData,'generic');if($summary){$score=$this->getMyMIMarketing()->scoreKeywordRelevance($keyword,$summary);$results[]=['keyword'=>$keyword,'summary'=>$summary,'score'=>$score];$this->marketingModel->storeFinalMarketingContent(['source_id'=>null,'title'=>"Keyword: $keyword",'summary'=>$summary,'keywords'=>$keyword,'score'=>$score,'created_at'=>date('Y-m-d H:i:s')]);}}}catch(\Throwable $e){log_message('error',"âŒ Failed keyword scrape for {$keyword}: ".$e->getMessage());}}return $this->respond(['status'=>'complete','processed'=>$results]);}public function processMarketingTempEmails($limit=5,$mode='daily',$id=null){try{log_message('debug',"ðŸ§  Running unified email processor with mode={$mode}, limit={$limit}, id={$id}");if($id){$record=$this->marketingModel->getEmailRecordById($id);if(!$record||empty($record['content'])){return $this->failNotFound("No valid temp email record found for ID {$id}");}$cleanText=strip_tags($record['content']);$summary=$this->getMyMIMarketing()->summarizeText($cleanText);$keywords=$this->getMyMIMarketing()->extractKeywords($cleanText);if(empty($summary)||empty($keywords)){return $this->fail("Failed to generate summary or keywords for record ID {$id}");}$testPosts=['discord'=>"ðŸ’¬ *{$record['title']}*: {$summary} #".implode(' #',$keywords),'linkedin'=>"ðŸ“¢ {$record['title']} â€” {$summary}",'email'=>"Subject: {$record['title']}\n\n{$summary}",'x'=>substr($summary,0,250).'...'];$generated=['summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts];$this->marketingModel->insertFinalScraper($record,$generated);$this->marketingModel->markTempScraperProcessed($id);return $this->respond(['status'=>'success','message'=>"âœ… Test record stored for ID {$id}",'summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts]);}$records=($mode==='backfill')?$this->marketingModel->getOlderUnprocessedEmails($limit):$this->marketingModel->getValidUnprocessedEmails($limit);$results=[];foreach($records as $record){$recordId=$record['id']?? 0;if(empty($record['title'])){$record['title']="Fallback Title - ID {$recordId}";}try{$insert=$this->getMyMIMarketing()->generateContentAndInsert($record);if($insert){$this->marketingModel->markTempScraperProcessed($recordId);log_message('info',"âœ… Inserted record ID {$recordId}");$results[]=$insert['title'];}else{log_message('warning',"âš ï¸ Skipped ID {$recordId} â€” No summary generated.");}}catch(\Throwable $e){log_message('error',"âŒ Exception on ID {$recordId}: ".$e->getMessage());}}return $this->respond(['status'=>'success','mode'=>$mode,'inserted'=>$results]);}catch(\Throwable $e){return $this->failServerError("ðŸ”¥ Unified content processor failed: ".$e->getMessage());}}public function rankBufferPostsDaily(){$marketingModel=new MarketingModel();$marketing=new MyMIMarketing();$threshold=getenv('MARKETING_TFIDF_THRESHOLD')?:7.5;$pendingPosts=$marketingModel->getPendingBufferItems();foreach($pendingPosts as $post){$scoreData=$marketing->getTopKeywordScores(['summary'=>$post['summary'],]);$update=['score'=>$scoreData['score']?? 0,'tag_score'=>$scoreData['tag_score']?? 0,'tfidf_score'=>$scoreData['tfidf_score']?? 0,'auto_suggest'=>($scoreData['tfidf_score']?? 0)>=$threshold?1:0,];$marketingModel->updateBufferItem($post['id'],$update);}return $this->respond(['status'=>'success','message'=>'Buffer ranks updated.']);}public function rejectBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Record not found.");$this->marketingModel->updateBufferItem($id,['status'=>'rejected']);return $this->respond(['status'=>'success','message'=>'Content rejected.']);}public function runBackfillForTempEmails(){try{log_message('info','[ðŸ”„ Backfill] Starting backfill for unprocessed temp emails...');$unprocessedRecords=$this->marketingModel->where('status',null)->orWhere('status','')->findAll(25);if(empty($unprocessedRecords)){return $this->respond(['status'=>'complete','message'=>'No unprocessed records found.']);}$processedTitles=[];foreach($unprocessedRecords as $record){try{$result=$this->MyMIMarketing->generateContentAndInsert($record);if($result){$this->marketingModel->markTempScraperProcessed($record['id']);$processedTitles[]=$result['title'];}}catch(\Throwable $e){log_message('error','[âŒ Backfill Error] ID '.$record['id'].' â€” '.$e->getMessage());}}return $this->respond(['status'=>'success','processed'=>$processedTitles]);}catch(\Throwable $e){return $this->failServerError('[ðŸ”¥ Backfill Failure] '.$e->getMessage());}}public function testGenerateFromTempEmail($id){try{helper('text');$record=$this->marketingModel->getEmailRecordById($id);if(!$record||empty($record['content'])){return $this->failNotFound("No valid temp email record found for ID {$id}");}log_message('info',"ðŸ§ª Starting test content generation for temp record ID: {$id}");$cleanText=strip_tags($record['content']);$summary=$this->getMyMIMarketing()->summarizeText($cleanText);$summary=quoted_printable_decode($summary);$summary=mb_convert_encoding($summary,'UTF-8','UTF-8');$keywords=$this->getMyMIMarketing()->extractKeywords($cleanText);if(empty($summary)||empty($keywords)){return $this->fail("Failed to generate summary or keywords for record ID {$id}");}$decodedTitleRaw=$record['title']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$decodedTitle);$testPosts=['discord'=>"ðŸ’¬ *{$cleanTitle}*: {$summary} #".implode(' #',$keywords),'linkedin'=>"ðŸ“¢ {$cleanTitle} â€” {$summary}",'email'=>"Subject: {$cleanTitle}\n\n{$summary}",'x'=>substr($summary,0,250).'...',];$generated=['summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts];$this->marketingModel->insertFinalScraper($record,$generated);$this->marketingModel->markTempScraperProcessed($id);log_message('info',"âœ… Test record stored in bf_marketing_scraper for temp ID {$id}");return $this->respond(['status'=>'success','message'=>"Content generated and stored successfully.",'summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts]);}catch(\Throwable $e){log_message('critical',"âŒ testGenerateFromTempEmail({$id}) failed: ".$e->getMessage());return $this->failServerError("An error occurred: ".$e->getMessage());}}public function testTfIdfEdgeCases(){$cases=['Empty String'=>'','Whitespace Only'=>'     ','Single Word'=>'Bitcoin','HTML Only'=>'<div><p></p></div>','Malformed UTF-8'=>"\xB1\x31",'Link-Only Spam'=>'http://marketwatch.com https://example.com','Token Noise'=>str_repeat('$$$!!!@@@###',10),];$results=[];foreach($cases as $label=>$input){try{log_message('info',"ðŸ§ª Running TF-IDF Test Case: $label");$cleanInput=is_string($input)?strip_tags(trim($input)):'';if(strlen($cleanInput)<10||substr_count($cleanInput,' ')<2){log_message('debug',"âš ï¸ Skipping test: $label â€” input too short or lacks structure.");$results[$label]='[Skipped â€” Too short or unstructured]';continue;}$summary=$this->MyMIMarketing->summarizeText($cleanInput);log_message('debug',"Result - Summary: $summary");$results[$label]=$summary;}catch(\Throwable $e){log_message('error',"âŒ $label threw error: ".$e->getMessage());$results[$label]='[Error: '.$e->getMessage().']';}}return $this->renderTheme('App\Modules\Management\Views\Marketing\debugTfIdfResults',['results'=>$results,]);}public function triggerPostAutogenOnEmpty(){try{$existingPosts=$this->marketingModel->where('DATE(scraped_at)',date('Y-m-d'))->countAllResults();if($existingPosts===0){log_message('debug','[ðŸª„ AutoGen Trigger] No posts found for today. Running fallback generatorâ€¦');$this->marketingService->generatePostsFromTodaysSummaries();return $this->respond(['status'=>'success','message'=>'No posts found. Generated fresh content.']);}else{return $this->respond(['status'=>'success','message'=>'Posts already exist for today. No action taken.']);}}catch(\Throwable $e){log_message('error','[âŒ AutoGen Trigger Error] '.$e->getMessage());return $this->respond(['status'=>'error','message'=>'Failed to trigger autogen.','error'=>$e->getMessage()]);}}public function updateBufferScheduleInterval($id){$data=$this->request->getJSON(true);$interval=(int)($data['interval']?? 0);$updated=$this->marketingModel->updateBufferItem($id,['schedule_interval'=>$interval,'scheduled_at'=>null ]);if($updated){return $this->respond(['status'=>'success']);}else{return $this->fail('Failed to update interval.');}}public function updatePlatformToggle($id){$data=$this->request->getJSON(true);$platform=$data['platform'];$enabled=$data['enabled'];$record=$this->marketingModel->find($id);if(!$record){return $this->failNotFound("Record not found.");}$platforms=json_decode($record['platforms']?? '{}',true);$platforms[$platform]=$enabled;$this->marketingModel->update($id,['platforms'=>json_encode($platforms)]);return $this->respond(['status'=>'success']);}} ?><?php namespace App\Libraries;use App\Config\{SiteSettings,SocialMedia};use App\Libraries\{BaseLoader,MyMIInvestments};use App\Libraries\Traits\TextProcessor;use App\Models\{AnalyticalModel,MarketingModel};use App\Services\{EmailService,MarketingService,SolanaService};use CodeIgniter\HTTP\RequestInterface;use CodeIgniter\Session\Session;use Myth\Auth\Authorization\GroupModel;use Exception;use HTMLPurifier;use HTMLPurifier_Config;use Phpml\FeatureExtraction\TokenCountVectorizer;use Phpml\Tokenization\WhitespaceTokenizer;use Phpml\FeatureExtraction\TfIdfTransformer;use NlpTools\Tokenizers\WhitespaceTokenizer as NlpWhitespaceTokenizer;use NlpTools\Similarity\CosineSimilarity;use Facebook\Facebook;use Abraham\TwitterOAuth\TwitterOAuth;use Happyr\LinkedIn\LinkedIn;use Discord\Discord;use Discord\Parts\Channel\Message;use GuzzleHttp\Client;use Scrapemax\ScrapemaxClient;use Pscrape\Pscrape\Scrape as PscrapeScraper;use Symfony\Component\DomCrawler\Crawler;use Google\Cloud\TextToSpeech\V1\TextToSpeechClient;use Google\Cloud\TextToSpeech\V1\SynthesisInput;use Google\Cloud\TextToSpeech\V1\VoiceSelectionParams;use Google\Cloud\TextToSpeech\V1\AudioConfig;use Google\Cloud\TextToSpeech\V1\AudioEncoding;class MyMIMarketing{use BaseLoader;use TextProcessor;protected $auth;protected $cuID;protected $data;protected $debug;protected $logger;protected $request;protected $session;protected $uri;protected $APIs;protected $emailService;protected $solanaService;protected $siteSettings;protected $marketingModel;protected $analyticalModel;protected $socialMedia;protected $facebook;protected $twitter;protected $linkedin;protected $discord;protected $scrapemax;protected $pscrape;public function __construct(){$this->auth=service('authentication');$this->logger=service('logger');$this->request=service('request');$this->session=service('session');$this->uri=$this->request->getUri();$this->APIs=config('APIs');$this->socialMedia=config('SocialMedia');$this->siteSettings=config('SiteSettings');$this->debug=$this->siteSettings->debug;$this->socialMedia=config('SocialMedia');$this->marketingModel=new MarketingModel();$this->analyticalModel=new AnalyticalModel();$this->emailService=service('email');$this->solanaService=new SolanaService();$this->scrapemax=new ScrapemaxClient('https://api.scrapemax.com',$this->APIs->scrapemax_api_key);$this->pscrape=new PscrapeScraper();}public function marketing(){$department=$this->department();$links=$this->social_media();return['links'=>$links,'department'=>$department];}public function distributeTradeAlert($alert,$action='BUY'){$message=$this->generateTradeAlertMessage($alert,$action);$this->postToDiscord($message);$this->postToTwitter($message);$this->postToFacebook($message);$this->postToLinkedIn($message);}public function generateRandomMarketingContent(array $tradeAlert):array{$intros=["ðŸš¨ Breaking Market Update!","ðŸ“¢ Urgent Trade Alert!","ðŸ”¥ High-Momentum Stock Pick!","ðŸš€ Skyrocketing Stocks!","ðŸ’° Smart Money Moves!","âš¡ Quick Market Insight!","ðŸ“ˆ Bullish Breakout Alert!","ðŸ“Š Technical Setup Unfolding!","ðŸ§ Deep Market Analysis!","ðŸ’¡ Pro-Level Trading Insight!"];$emoticons=['ðŸš€','ðŸ”¥','ðŸ’°','ðŸ“ˆ','ðŸ“Š','âš¡','âœ…','ðŸ¤–','ðŸŽ¯','ðŸ”'];$outros=["ðŸ“Š Stay ahead of the markets!","â³ Don't miss this setup!","ðŸ’° Trade smart & maximize gains!","ðŸš€ Follow for more trade alerts!","ðŸ“ˆ Watch this ticker closely!","ðŸ”¥ This could be the next big mover!","ðŸ’¡ Insights that matter. Stay tuned!","ðŸ’Ž Precision trading at its best!","âš¡ More insights coming soon!","ðŸ“¢ Tap in for more premium setups!"];$intro=$intros[array_rand($intros)];$outro=$outros[array_rand($outros)];$emote1=$emoticons[array_rand($emoticons)];$emote2=$emoticons[array_rand($emoticons)];$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$tradeDesc=trim($tradeAlert['trade_description']?? '');$news=trim($tradeAlert['financial_news']?? '');$details=trim($tradeAlert['details']?? '');$price=number_format($tradeAlert['price']?? 0,2);$link=trim($tradeAlert['tv_chart']?? $tradeAlert['tv_chart_link']?? '');$chartText=(!empty($link))?"ðŸ“‰ Chart: [View Here]({$link})\n":'';$fixedLength=strlen($intro)+strlen($outro)+strlen($emote1)+strlen($emote2)+strlen($chartText)+12;$maxMessageLength=2000-$fixedLength;$coreMessage="Trade Alert for **{$ticker}** ({$company}):\n"."Price: \${$price}\n"."Signal: {$tradeDesc}\n"."News: {$news}\n"."Details: {$details}\n".$chartText;if(strlen($coreMessage)>$maxMessageLength){$coreMessage=substr($coreMessage,0,$maxMessageLength-3)."...";}$finalMessage="{$emote1} {$intro}\n{$coreMessage}\n{$outro} {$emote2}";return['twitter'=>substr($finalMessage,0,280),'facebook'=>substr($finalMessage,0,2000),'linkedin'=>substr($finalMessage,0,2000),'discord'=>substr($finalMessage,0,2000)];}public function generateEmailContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$news=$tradeAlert['financial_news']?? '';$details=$tradeAlert['details']?? '';$content="Email Alert for {$ticker} ({$company}):\n"."Current Price: \${$price}\n"."Trade Signal: {$tradeDesc}\n"."Latest News: {$news}\n"."Analysis Details: {$details}\n"."For more information, visit our website.";return $content;}public function generateBlogContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$news=$tradeAlert['financial_news']?? '';$details=$tradeAlert['details']?? '';$content="Blog Post: In-depth Market Analysis on {$ticker} ({$company})\n\n"."Current Price: \${$price}\n\n"."Trade Analysis: {$tradeDesc}\n\n"."Financial News: {$news}\n\n"."Detailed Analysis: {$details}\n\n"."Stay tuned for more insights!";return $content;}public function generateVoiceoverScriptContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$script="Voiceover Script:\n"."Welcome to today's market update. Our focus is on {$ticker} from {$company}.\n"."The current trading price is \${$price}.\n"."Trade insight: {$tradeDesc}.\n"."Thank you for watching. Stay tuned for more updates.";return $script;}public function generateTradeAlertEmailContent(array $tradeAlert):string{$defaultTemplate=<<<S
app/Modules/chatgpt.txt:44:S;}public function formatSocialPost(string $headline,string $summary,string $platform='generic'):string{$hashtags='#MyMIWallet #InvestSmarter #FinancialFreedom';switch($platform){case 'facebook':case 'linkedin':return"{$headline}\n\n{$summary}\n\nStart your journey: https://www.mymiwallet.com\n\n{$hashtags}";case 'twitter':case 'x':$shortSummary=substr($summary,0,180);return"{$headline} â€” {$shortSummary}...\nhttps://www.mymiwallet.com\n{$hashtags}";default:return"{$headline}\n\n{$summary}\nhttps://www.mymiwallet.com";}}public function formatDiscordPost(string $headline,string $summary):string{return"**{$headline}**\n\n{$summary}\n\nðŸ‘‰ <https://www.mymiwallet.com>";}private function normalizeUtf8($text){return mb_convert_encoding($text,'UTF-8',mb_detect_encoding($text,'UTF-8, ISO-8859-1',true));}private function notifyAdminOnError($subject,$message){$this->emailService->setFrom('no-reply@mymiwallet.com','MyMI Wallet');$this->emailService->setTo('team@mymiwallet.com');$this->emailService->setSubject($subject);$this->emailService->setMessage($message);if(!$this->emailService->send()){$this->logger->error('Failed to send error notification email: '.print_r($this->emailService->printDebugger(),true));}}public function notifyModerators(array $post){$platforms=json_decode($post['platforms']?? '{}',true);$used=implode(', ',array_keys(array_filter($platforms)));$subject="ðŸ“¢ Buffer Post Promoted: {$post['keyword']}";$message="âœ… Post ID: {$post['id']}\n\n"."Summary: ".wordwrap($post['summary'],80)."\n\n"."Promoted Platforms: {$used}\n\n".site_url('Marketing/PreviewGeneratedPost/'.$post['id']);$email=\Config\Services::email();$email->setTo('moderators@mymiwallet.com');$email->setSubject($subject);$email->setMessage($message);$email->send();log_message('info',"ðŸ“¬ Sent moderator alert for Buffer ID {$post['id']}");}public function reprocessIncompleteEmails(){$incompleteRecords=$this->marketingModel->getEmailsMissingTitleOrUrl(20);log_message('debug','ðŸ“‹ MyMIMarketing L986 - Incomplete records fetched: '.count($incompleteRecords));foreach($incompleteRecords as $record){try{$emailId=$record['message_id']?? null;$content=$record['content']?? '';$title=$record['title']?? '';$url=$record['url']?? '';if(!$emailId)continue;$email=$this->fetchEmailByMessageId($emailId);if($email){$content=$email['body']?? $content;$title=$email['subject']?? $title;$url=$email['link']?? $url;}$title=$title?:'Untitled Email - '.date('Y-m-d H:i');$url=$url?:'https://mymiwallet.com/news/fallback';$this->marketingModel->updateEmailFields($record['id'],$title,$url,$content);}catch(\Throwable $e){log_message('error','âŒ Error backfilling email ID '.$record['id'].': '.$e->getMessage());}}}private function retry($function,$attempts=3,$delay=2000){$attempt=0;while($attempt<$attempts){try{return $function();}catch(Exception $e){$attempt++;if($attempt>=$attempts){throw $e;}sleep($delay/1000);}}}private function sanitizeContent($content){$content=preg_replace('#<script(.*?)>(.*?)</script>#is','',$content);$content=preg_replace('#<noscript(.*?)>(.*?)</noscript>#is','',$content);$content=strip_tags($content)?? '';$content=preg_replace('/\.\s*/','. ',$content);return $content;}public function sanitizeRawEmailContent(string $rawContent):string{log_message('debug','ðŸ§ª MyMIMarketing L1140 - Raw Email Before Cleaning: {raw}',['raw'=>$rawContent]);$clean=preg_replace("/=\r\n|\=\n/",'',$rawContent);$clean=quoted_printable_decode($clean);$clean=html_entity_decode($clean,ENT_QUOTES|ENT_HTML5,'UTF-8');$clean=strip_tags($clean);$clean=preg_replace('/\s+/',' ',$clean);$clean=mb_convert_encoding($clean,'UTF-8','UTF-8');log_message('debug','âœ… MyMIMarketing L1159 - Cleaned Email Output: {clean}',['clean'=>$clean]);return trim($clean);}private function sanitizeText(string $text):string{return strip_tags(html_entity_decode($text));}public function saveTradingViewChart($chartUrl,$ticker){$saveDir=FCPATH.'assets/images/Alerts/Charts/';if(!is_dir($saveDir)){mkdir($saveDir,0777,true);}$timestamp=time();$filename="{$ticker}_chart_{$timestamp}.jpg";$savePath=$saveDir.$filename;$ch=curl_init($chartUrl);$fp=fopen($savePath,'wb');curl_setopt($ch,CURLOPT_FILE,$fp);curl_setopt($ch,CURLOPT_HEADER,0);curl_exec($ch);curl_close($ch);fclose($fp);if(file_exists($savePath)){return $filename;}else{return null;}}public function scoreKeywordRelevance(string $keyword,string $summary):int{$keyword=strtolower($keyword);$summaryText=strtolower(strip_tags($summary));$totalWords=str_word_count($summaryText);if($totalWords===0)return 0;$matches=substr_count($summaryText,$keyword);$score=min(100,round(($matches/$totalWords)*500));return $score;}public function scrapeTokenContent($tokenInfo){$scrapedData=[];foreach($tokenInfo as $token){if(!empty($token['website'])){log_message('debug','MyMIMarketing L101 - $token[website]: '.$token['website']);$websiteData=$this->scrapeWebsite($token['website']);log_message('debug','MyMIMarketing L103 - $websiteData: '.print_r($websiteData,true));$this->storeTemporaryData($websiteData);$scrapedData[]=$websiteData;}if(!empty($token['facebook'])){log_message('debug','MyMIMarketing L109 - $token[facebook]: '.$token['facebook']);$facebookData=$this->scrapeFacebook($token['facebook']);log_message('debug','MyMIMarketing L111 - $facebookData: '.print_r($facebookData,true));$this->storeTemporaryData($facebookData);$scrapedData[]=$facebookData;}if(!empty($token['twitter'])){log_message('debug','MyMIMarketing L117 - $token[twitter]: '.$token['twitter']);$twitterData=$this->scrapeTwitter($token['twitter']);log_message('debug','MyMIMarketing L119 - $twitterData: '.print_r($twitterData,true));$this->storeTemporaryData($twitterData);$scrapedData[]=$twitterData;}log_message('debug','MyMIMarketing L117 - $token[symbol] $token[name]: '.$token['symbol'].' '.$token['coin_name']);$googleData=$this->scrapeGoogleSearch($token['symbol'].' '.$token['coin_name']);$this->storeTemporaryData($googleData);$scrapedData[]=$googleData;}return $scrapedData;}public function scrapeAndGenerateContent($accountid,$category,$platform=null){$generatedData=[];if($category==='Solana'){$this->solanaModel=new SolanaModel();$tokenInfo=$this->solanaModel->getTokenInfoByID($accountid);}else{$tokenInfo=[];}if(!empty($tokenInfo)){$scrapedData=[];try{log_message('debug','Attempting to scrape token content.');$scrapedData=$this->scrapeTokenContent($tokenInfo);log_message('debug','Scraped Data: '.print_r($scrapedData,true));}catch(\GuzzleHttp\Exception\ClientException $e){if($e->getResponse()->getStatusCode()==403){log_message('critical','403 Forbidden encountered while scraping website: '.$e->getMessage());}else{log_message('critical','ClientException: '.$e->getMessage());}}catch(\Exception $e){log_message('critical','An error occurred while scraping token content: '.$e->getMessage());}try{if(!empty($scrapedData)){log_message('debug','Attempting to generate content from scraped data.');$generatedData=$this->generateContentFromScrapedData($scrapedData,$platform);log_message('debug','Generated Data: '.print_r($generatedData,true));}else{log_message('debug','Scraped data is empty.');}}catch(\Exception $e){log_message('critical','An error occurred while generating content: '.$e->getMessage());}}else{log_message('debug','Token information is empty.');}return $generatedData;}private function scrapeWebsite($url){try{$client=new Client();$response=$client->get($url);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$crawler=new \Symfony\Component\DomCrawler\Crawler($html);return['title'=>$crawler->filter('title')->text(),'content'=>$this->sanitizeContent($crawler->filter('body')->html()),];}}catch(RequestException $e){$this->logger->error('Error scraping website: '.$e->getMessage());}return[];}private function scrapeFacebook($url){return $this->scrapeWithRetries('facebook',$url,function($content){return['title'=>$content['page_title']?? 'No title','content'=>$this->sanitizeContent($content['posts']?? 'No posts'),];});}private function scrapeTwitter($url){return $this->scrapeWithRetries('twitter',$url,function($content){return['title'=>$content['profile']?? 'No title','content'=>$this->sanitizeContent($content['tweets']?? 'No tweets'),];});}private function scrapeWithRetries($type,$url,$transform,$retries=3){$backoff=1;for($i=0;$i<$retries;$i++){try{$response=$this->scrapemax->scrape(['target_url'=>$url,'type'=>'data','js_enabled'=>1,'base64_encoded'=>0]);$content=json_decode($response->getBody()->getContents(),true);if(empty($content)){throw new \Exception("No content returned");}return $transform($content);}catch(ServerException $e){if($i<$retries-1){sleep($backoff);$backoff*=2;continue;}$this->logger->error("Error scraping $type: ".$e->getMessage());}catch(RequestException $e){$this->logger->error("Error scraping $type: ".$e->getMessage());break;}catch(\Exception $e){$this->logger->error("General error scraping $type: ".$e->getMessage());break;}}return['title'=>'No title','content'=>'No content'];}private function scrapeGoogleSearch($query){try{$results=$this->pscrape->rollingCurl('rollingCurl');$results->request('https://www.google.com/search?q='.urlencode($query));$content='';$resultsData=$results->execute();if(!is_array($resultsData)){throw new \Exception("Google search did not return an array");}foreach($resultsData as $result){$content.=$result['title'].' '.$result['link'].' ';}return['title'=>'Google Search Results for '.$query,'content'=>$this->sanitizeContent($content),];}catch(\Exception $e){$this->logger->error('Error scraping Google Search: '.$e->getMessage());}return[];}public function sendZapierTradeAlert($tradeAlert){$zapierWebhookUrl="YOUR_ZAPIER_WEBHOOK_URL";$payload=json_encode(['ticker'=>$tradeAlert['ticker'],'price'=>$tradeAlert['price'],'sentiment'=>$tradeAlert['market_sentiment'],'chart_link'=>$tradeAlert['link'],'created_on'=>$tradeAlert['created_on']]);$ch=curl_init($zapierWebhookUrl);curl_setopt($ch,CURLOPT_HTTPHEADER,['Content-Type: application/json']);curl_setopt($ch,CURLOPT_POST,1);curl_setopt($ch,CURLOPT_POSTFIELDS,$payload);curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);$response=curl_exec($ch);curl_close($ch);return $response;}public function standaloneScrapeWebsite($url){try{$client=new Client();$response=$client->get($url);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$crawler=new Crawler($html);$content=$crawler->filter('body')->each(function($node){return $node->text();});$content=array_filter($content,function($text){return!str_contains($text,'footer')&&!str_contains($text,'head');});$data=['url'=>$url,'content'=>implode(' ',$content),'scraped_at'=>date('Y-m-d H:i:s')];$this->saveTemporaryScrapedData($data);return $data;}else{log_message('error','Failed to scrape website. HTTP status code: '.$response->getStatusCode());}}catch(RequestException $e){log_message('error','RequestException while scraping website: '.$e->getMessage());}catch(\Throwable $th){log_message('error','Throwable error while scraping website: '.$th->getMessage());}return false;}public function saveTemporaryScrapedData($data){$marketingModel=new \App\Models\MarketingModel();return $this->marketingModel->insertTemporaryData($data);}private function storeTemporaryData($data){if(!empty($data)){$this->marketingModel->insertTemporaryData($data);}else{$this->logger->warning('Attempted to store empty data.');}}private function selectSummarySentences($sentences,$scores,$topN=5){arsort($scores,SORT_NUMERIC);$topSentenceIndexes=array_keys(array_slice($scores,0,$topN,true));$summary=array_intersect_key($sentences,array_flip($topSentenceIndexes));usort($summary,function($a,$b)use($sentences){return array_search($a,$sentences)-array_search($b,$sentences);});return $summary;}private function splitIntoSentences($content){$content=preg_replace('/\s+/',' ',trim($content));$sentences=preg_split('/(?<=[.!?])\s+/',$content,-1,PREG_SPLIT_NO_EMPTY);return array_filter($sentences,function($sentence){return strlen(trim($sentence))>0;});}public function summarize($text,$method='textrank',$charLimit=500){$text=$this->cleanText($text);if($method==='tfidf'){return $this->summarizeText($text);}else{return $this->summarizeContent($text,$charLimit);}}public function summarizeContent($content,$charLimit=500){if(empty(trim($content))){$this->logger->error('$content is Empty for summarizeContent() function');return[];}$sentences=$this->splitIntoSentences($content);if(empty($sentences)){log_message('warning','âš ï¸ MyMIMarketing L1306 - summarizeContent(): No valid sentences found in content.');return null;}if(empty($sentences)){$this->logger->error('No sentences found for summarization');return[];}$tokens=$this->tokenizeWithNlpTools($content);$features=$this->extractFeaturesWithPhpMl($content);$wordFrequencies=$this->calculateWordFrequencies($content,$this->getStopWords());$similarityMatrix=$this->buildSimilarityMatrix($sentences,$wordFrequencies);$scores=$this->pageRank($similarityMatrix);$summary=$this->buildSummaryToCharLimit($sentences,$scores,$charLimit);$finalSummary=$this->convertUrlsToLinks($summary);return!empty($finalSummary)?['sentences'=>$sentences,'tokens'=>$tokens,'features'=>$features,'wordFrequencies'=>$wordFrequencies,'similarityMatrix'=>$similarityMatrix,'scores'=>$scores,'summary'=>$finalSummary,]:$summary;}public function summarizeContentFromHtml(string $html,$recordId=null):array{$html=quoted_printable_decode($html);$html=html_entity_decode($html,ENT_QUOTES|ENT_HTML5,'UTF-8');$html=preg_replace('/=\r?\n/','',$html);$plainText=strip_tags(html_entity_decode($html));$cleaned=$this->sanitizeRawEmailContent($plainText);if(strlen($cleaned)<300||substr_count($cleaned,' ')<20){$logSuffix=$recordId?" (ID: $recordId)":'';log_message('info',"[MyMIMarketing] summarizeContentFromHtml(): Skipping â€” content too short or lacks structure{$logSuffix}");return['summary'=>'','keywords'=>[]];}$cleaned=preg_replace('/\s{2,}/',' ',$cleaned);$summaryData=$this->summarizeContent($cleaned);if(!is_array($summaryData)||empty($summaryData['summary'])){return['summary'=>'','keywords'=>[]];}$keywords=$this->marketingModel->extractKeywords($cleaned);return['summary'=>$summaryData['summary'],'keywords'=>$keywords ??[],'featureScore'=>$summaryData['featureScore']?? null,'keywordScore'=>$summaryData['keywordScore']?? null,'pageRankScore'=>$summaryData['pageRankScore']?? null,'semanticDiversityScore'=>$summaryData['semanticDiversityScore']?? null,];}public function summarizeContentTextRank($content){$sentences=$this->splitIntoSentences($content);$similarityMatrix=$this->buildSimilarityMatrix($sentences);$scores=$this->pageRank($similarityMatrix);return $this->extractTopSentences($sentences,$scores);}public function summarizeText($text,$maxSentences=5){if(!is_string($text)||empty(trim($text))){log_message('error','summarizeText(): Empty or invalid input text provided.');return 'Summary not available.';}$sentences=$this->splitIntoSentences($text);if(empty($sentences)||count($sentences)<2){log_message('warning','summarizeText(): Not enough content to summarize.');return implode(' ',$sentences);}$vectorizer=new TokenCountVectorizer(new WhitespaceTokenizer());$vectorizer->fit($sentences);$vectorizer->transform($sentences);$tfidf=new TfIdfTransformer();try{$tfidf->fit($sentences);$tfidf->transform($sentences);}catch(\Throwable $e){log_message('error','summarizeText(): TF-IDF transform failed â€” '.$e->getMessage());return 'Summary unavailable due to processing error.';}$scores=[];foreach($sentences as $i=>$vector){$score=0;foreach($vector as $value){$score+=(float)$value;}$scores[$i]=$score;}arsort($scores);$topIndexes=array_slice(array_keys($scores),0,$maxSentences);sort($topIndexes);$originalSentences=$this->splitIntoSentences($text);$summary=implode(' ',array_map(fn($i)=>$originalSentences[$i],$topIndexes));return $summary;}private function tokenizeSmart($text,$method='nlp'){return $method==='nlp'?$this->tokenizeWithNlpTools($text):$this->tokenizeText($text);}private function tokenizeText($text){$text=strtolower(strip_tags($text));return preg_split('/\W+/',$text,-1,PREG_SPLIT_NO_EMPTY);}public function tokenizeWithNlpTools($content){$tokenizer=new NlpWhitespaceTokenizer();$tokens=$tokenizer->tokenize($content);$this->logger->debug('Tokens: '.print_r($tokens,true));return $tokens;}public function insertFinalScraper($record,$summary){$model=new MarketingModel();if(!isset($record['id'])||!$summary){log_message('error','âŒ Missing record ID or summary when calling insertFinalScraper()');return false;}$existing=$model->where('source_id',$record['id'])->first();if($existing){log_message('info',"âš ï¸ Final scrape already exists for source_id: {$record['id']}");return false;}$cleanSummary=mb_convert_encoding($summary['summary'],'UTF-8','UTF-8');$cleanTitle=isset($record['title'])?$record['title']:word_limiter($cleanSummary,12);$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$cleanTitle);$data=['source_id'=>$record['id'],'title'=>trim($cleanTitle),'summary'=>trim($cleanSummary),'keywords'=>isset($summary['keywords'])?implode(',',$summary['keywords']):'','date_created'=>date('Y-m-d H:i:s'),];$result=$model->insert($data);if($result){log_message('info',"âœ… Final scraped content inserted for source_id: {$record['id']}");}else{log_message('error',"âŒ Failed to insert final scrape for source_id: {$record['id']}");}return $result;}private function cleanText($text){$text=$this->decodeSpecialCharacters($text);$text=$this->sanitizeRawEmailContent($text);return $this->normalizeUtf8(strip_tags($text));}private function combineScores($featureScore,$keywordScore,$pageRankScore,$semanticDiversityScore){$featureScore=is_numeric($featureScore)?(float)$featureScore:0.0;$keywordScore=is_numeric($keywordScore)?(float)$keywordScore:0.0;$pageRankScore=is_numeric($pageRankScore)?(float)$pageRankScore:0.0;$semanticDiversityScore=is_numeric($semanticDiversityScore)?(float)$semanticDiversityScore:0.0;$combinedScore=0.4*$featureScore+0.2*$keywordScore+0.3*$pageRankScore+0.1*$semanticDiversityScore;$this->logger->debug('âœ… Combined Score for sentence: '.$combinedScore);return $combinedScore;}private function buildSimilarityMatrix($sentences,$wordFrequencies){$matrix=[];$sentenceLength=count($sentences);for($i=0;$i<$sentenceLength;$i++){for($j=0;$j<$sentenceLength;$j++){if($i!=$j){$matrix[$i][$j]=$this->calculateSimilarity($sentences[$i],$sentences[$j],$wordFrequencies);}}}return $matrix;}private function calculateSimilarity($sentence1,$sentence2,$wordFrequencies){$sentence1=is_string($sentence1)?strtolower($sentence1):'';$sentence2=is_string($sentence2)?strtolower($sentence2):'';$words1=array_unique(str_word_count($sentence1,1));$words2=array_unique(str_word_count($sentence2,1));$commonWords=array_intersect($words1,$words2);$score=0;foreach($commonWords as $word){$score+=(float)($wordFrequencies[$word]?? 0);}$logWordCount1=count($words1)>0?log(count($words1)):0;$logWordCount2=count($words2)>0?log(count($words2)):0;if($logWordCount1+$logWordCount2==0){return 0;}return $score/($logWordCount1+$logWordCount2);}private function calculateWordFrequencies($content,$stopWords){$frequencies=[];$words=preg_split('/\s+/',strtolower($content));foreach($words as $word){if(!in_array($word,$stopWords)&&strlen($word)>1){$frequencies[$word]=($frequencies[$word]?? 0)+1;}}arsort($frequencies);return $frequencies;}public function decodeMimeHeaderSafe($string){try{return mb_decode_mimeheader($string);}catch(\Throwable $e){log_message('error','decodeMimeHeaderSafe() failed: '.$e->getMessage());return $string;}}private function decodeSpecialCharacters($text){return html_entity_decode($text,ENT_QUOTES|ENT_HTML5,'UTF-8');}public function getScrapesByKeyword($keyword){return $this->marketingModel->getScrapesByKeyword($keyword);}private function getStopWords(){return["a","the","and","of","in","to","is","you","that","it","he","was","for","on","are","as","with","his","they","I","at","be","this","have","from","or","one","had","by","word","but","not","what","all","were","we","when","your","can","said","there","use","an","each","which","she","do","how","their","if","will","up","other","about","out","many","then","them","these","so","some","her","would","make","like","him","into","time","has","look","two","more","write","go","see","number","no","way","could","people","my","than","first","water","been","call","who","oil","its","now","find","long","down","day","did","get","come","made","may","part"];}public function getTopKeywordScores($content,$max=10){if(!is_string($content)){log_message('error','MyMIMarketing L1706 - getTopKeywordScores(): Content must be a string');return[];}$content=$this->normalizeUtf8($content);$sentences=$this->splitIntoSentences($content);if(empty($sentences)){log_message('error','MyMIMarketing L1713 - getTopKeywordScores(): No valid sentences to process');return[];}$tfIdf=new TfIdfTransformer();$tokenized=array_values(array_filter(array_map(function($sentence){$cleaned=strtolower($this->normalizeUtf8(trim($sentence)));$tokens=array_filter(explode(' ',$cleaned),fn($w)=>strlen($w)>1);return count($tokens)>0?$tokens:null;},$sentences)));if(empty($tokenized)||!isset($tokenized[0])||!is_array($tokenized[0])||empty($tokenized[0])){log_message('error','âŒ MyMIMarketing L1725 - Tokenized input invalid for TF-IDF. Tokenized: '.json_encode($tokenized));return[];}try{$tfIdf->fit($tokenized);log_message('debug','ðŸ“Š MyMIMarketing L1731 - TF-IDF Document Preview: '.json_encode(array_slice($tokenized,0,1)));$tfIdf->transform($tokenized);}catch(\Throwable $e){log_message('error','âŒ MyMIMarketing L1734 - TF-IDF error: '.$e->getMessage());return[];}$scores=[];foreach($tokenized as $docIndex=>$tokens){foreach($tokens as $token){if(!is_string($token))continue;if(!isset($scores[$token])){$scores[$token]=0.0;}$scores[$token]+=1.0;}}if(empty($scores)){log_message('error','âŒ MyMIMarketing L1752 - No TF-IDF scores generated');return[];}arsort($scores);return array_keys(array_slice($scores,0,$max,true));}private function isSemanticallyDifferent($sentence1,$sentence2,$tokens){$tokens1=array_intersect($tokens,str_word_count(strtolower($sentence1),1));$tokens2=array_intersect($tokens,str_word_count(strtolower($sentence2),1));$overlap=count(array_intersect($tokens1,$tokens2));$threshold=2;return $overlap<$threshold;}private function pageRank($matrix,$dampingFactor=0.85,$maxIterations=100,$tolerance=1e-6){$numSentences=count($matrix);if($numSentences==0){return[];}$pagerank=array_fill(0,$numSentences,1/$numSentences);$tempRank=array_fill(0,$numSentences,0);for($iter=0;$iter<$maxIterations;$iter++){for($i=0;$i<$numSentences;$i++){$tempRank[$i]=(1-$dampingFactor)/$numSentences;for($j=0;$j<$numSentences;$j++){if($i!=$j&&isset($matrix[$j][$i])){$matrixRowSum=array_sum($matrix[$j]);if($matrixRowSum!=0){$tempRank[$i]+=$dampingFactor*($matrix[$j][$i]*$pagerank[$j]/$matrixRowSum);}}}}$diff=0;for($i=0;$i<$numSentences;$i++){$diff+=abs($tempRank[$i]-$pagerank[$i]);}if($diff<$tolerance){break;}$pagerank=$tempRank;}return $pagerank;}private function extractTopSentences($sentences,$scores,$topN=5){asort($scores,SORT_NUMERIC);$topSentenceIndexes=array_keys(array_slice($scores,-$topN,$topN,true));$summary=[];foreach($topSentenceIndexes as $index){$summary[]=trim($sentences[$index]);}return $summary;}public function enqueueEmailJob($emailData){$data=['type'=>'email_processing','data'=>json_encode($emailData)];$this->marketingModel->insertJobQueue($data);}private function stripHtmlTags($htmlContent){return strip_tags($htmlContent);}public function social_media(){return['discord'=>$this->socialMedia->discord,'facebook_page'=>$this->socialMedia->facebook_page,'facebook_group'=>$this->socialMedia->facebook_group,'linkedin'=>$this->socialMedia->linkedin,'twitter'=>$this->socialMedia->twitter,'youtube'=>$this->socialMedia->youtube,];}public function department(){$activeCampaigns=$this->marketingModel->getActiveCampaigns();$totalActiveCampaigns=$activeCampaigns['num_rows'];$activePriorityCampaigns=$this->marketingModel->getActivePriorityCampaigns();$totalActivePriorityCampaigns=$activePriorityCampaigns['num_rows'];return['getActiveCampaigns'=>$activeCampaigns['result'],'totalActiveCampaigns'=>$totalActiveCampaigns,'getActivePriorityCampaigns'=>$activePriorityCampaigns['result'],'totalActivePriorityCampaigns'=>$totalActivePriorityCampaigns,];}public function seoCheck(){$uri_string=$this->request->getUri()->getPath();$query=$this->marketingModel->where('url',$uri_string)->first();if(!$query){$data=['url'=>$uri_string,'title'=>str_replace(['_','/'],[' ',' - '],$uri_string),'description'=>"Experience the future of personal finance with MyMI Wallet. We provide advanced budgeting and investment portfolio management solutions, empowering individuals to better manage their finances. Streamline your financial journey with our intuitive online fintech application and service.",'image'=>base_url('/assets/images/Company/MyMI-Wallet-White.png'),];$this->marketingModel->insert($data);$insert_id=$this->marketingModel->getInsertID();$task_info=['task'=>'Page SEO Edit','title'=>str_replace(['_','/'],[' ',' - '],$uri_string),'seo_id'=>$insert_id,'url'=>$uri_string,];$this->assignMarketingTask($task_info);}}public function assignMarketingTask($task_info){$data=['status'=>'Pending','group'=>'Marketing','task'=>$task_info['task'],'title'=>$task_info['title'],'description'=>'Complete SEO for '.$task_info['url'],'url'=>site_url('/Management/Marketing/Page-SEO/'.$task_info['seo_id']),];$this->marketingModel->insertManagementTask($data);}public function autoDistributeHighRelevanceSummaries($minScore=75){$posts=$this->marketingModel->getRecentPosts(10);foreach($posts as $post){if(($post['score']?? 0)>=$minScore){$message="**{$post['title']}**\n\n".word_limiter(strip_tags($post['summary']),60);$this->sendToDiscordNotification($message);}}}public function autoSendToZapier($minScore=75){$posts=$this->marketingModel->getRecentPosts(10);foreach($posts as $post){if(($post['score']?? 0)>=$minScore){$this->sendToZapier('facebook',$post['summary']);}}}public function getPageHeaders(){$getPageSEO=$this->marketingModel->getMarketingPageSeo();$pageSEOData=[];foreach($getPageSEO as $pageSEO){$pageSEOData[]=['page_id'=>$pageSEO['id'],'page_name'=>$pageSEO['page_name'],'page_title'=>$pageSEO['page_title'],'page_url'=>$pageSEO['page_url'],'page_sitemap_url'=>$pageSEO['page_sitemap_url'],'page_internal_url'=>$pageSEO['page_internal_url'],'page_controller'=>$pageSEO['page_controller'],'page_controller_url'=>$pageSEO['page_controller_url'],'page_controller_directory'=>$pageSEO['page_controller_directory'],'page_file_directory'=>$pageSEO['page_file_directory'],'page_image'=>$pageSEO['page_image'],'page_description'=>$pageSEO['page_description'],'page_address'=>$pageSEO['page_address'],'page_city'=>$pageSEO['page_city'],'page_state'=>$pageSEO['page_state'],'page_country'=>$pageSEO['page_country'],'page_zipcode'=>$pageSEO['page_zipcode'],'page_facebook'=>$pageSEO['page_facebook'],'linked'=>$pageSEO['linked'],'functionality'=>$pageSEO['functionality'],'design'=>$pageSEO['design'],'seo'=>$pageSEO['seo'],'ext_links'=>$pageSEO['ext_links'],'grammar'=>$pageSEO['grammar'],'d_optimize'=>$pageSEO['d_optimize'],'load_perf'=>$pageSEO['load_perf'],'additional_notes'=>$pageSEO['additional_notes'],];}return $pageSEOData;}public function getPageHeadersByName($pageName){$getPageSEO=$this->marketingModel->getMarketingPageSeoByName($pageName);$pageSEOData=[];foreach($getPageSEO as $pageSEO){$pageSEOData[]=['page_id'=>$pageSEO['id'],'page_name'=>$pageSEO['page_name'],'page_title'=>$pageSEO['page_title'],'page_url'=>$pageSEO['page_url'],'page_sitemap_url'=>$pageSEO['page_sitemap_url'],'page_internal_url'=>$pageSEO['page_internal_url'],'page_controller'=>$pageSEO['page_controller'],'page_controller_url'=>$pageSEO['page_controller_url'],'page_controller_directory'=>$pageSEO['page_controller_directory'],'page_file_directory'=>$pageSEO['page_file_directory'],'page_image'=>$pageSEO['page_image'],'page_description'=>$pageSEO['page_description'],'page_address'=>$pageSEO['page_address'],'page_city'=>$pageSEO['page_city'],'page_state'=>$pageSEO['page_state'],'page_country'=>$pageSEO['page_country'],'page_zipcode'=>$pageSEO['page_zipcode'],'page_facebook'=>$pageSEO['page_facebook'],'linked'=>$pageSEO['linked'],'functionality'=>$pageSEO['functionality'],'design'=>$pageSEO['design'],'seo'=>$pageSEO['seo'],'ext_links'=>$pageSEO['ext_links'],'grammar'=>$pageSEO['grammar'],'d_optimize'=>$pageSEO['d_optimize'],'load_perf'=>$pageSEO['load_perf'],'additional_notes'=>$pageSEO['additional_notes'],];}return $pageSEOData;}public function postToDiscord($message){$discordWebhookUrl=getenv('DISCORD_WEBHOOK_URL');if(strlen($message)>2000){$message=substr($message,0,1997)."...";}$payload=json_encode(["content"=>$message]);$ch=curl_init($discordWebhookUrl);curl_setopt($ch,CURLOPT_HTTPHEADER,['Content-Type: application/json']);curl_setopt($ch,CURLOPT_POST,1);curl_setopt($ch,CURLOPT_POSTFIELDS,$payload);curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);$response=curl_exec($ch);curl_close($ch);return $response;}public function postToFacebookPage($pageId,$message){try{$response=$this->facebook->post("/{$pageId}/feed",['message'=>$message,],$this->facebook->getAccessToken());return $response->getGraphNode();}catch(Facebook\Exceptions\FacebookResponseException $e){log_message('error','Graph returned an error: '.$e->getMessage());return false;}catch(Facebook\Exceptions\FacebookSDKException $e){log_message('error','Facebook SDK returned an error: '.$e->getMessage());return false;}}public function postToFacebookGroup($groupId,$message){try{$response=$this->facebook->post("/{$groupId}/feed",['message'=>$message,],$this->facebook->getAccessToken());return $response->getGraphNode();}catch(Facebook\Exceptions\FacebookResponseException $e){log_message('error','Graph returned an error: '.$e->getMessage());return false;}catch(Facebook\Exceptions\FacebookSDKException $e){log_message('error','Facebook SDK returned an error: '.$e->getMessage());return false;}}public function sendNotification($type,$viewPath,$data,$targetGroup=null,$socialMedia=[]){$userModel=new UserModel();if($targetGroup){$users=$userModel->where('group',$targetGroup)->findAll();}else{$users=$userModel->findAll();}$viewContent=view($viewPath,$data);$notoCount=0;$emailNotoCount=0;if(in_array('in-app',$type)){foreach($users as $user){$this->sendInAppNotification($user,$viewContent);$notoCount++;}}if(in_array('email',$type)){foreach($users as $user){$this->sendEmailNotification($user,$viewContent);$emailNotoCount++;}}foreach($socialMedia as $platform){switch($platform){case 'facebook':$this->postToFacebook($data['message']);break;case 'twitter':$this->postToTwitter($data['message']);break;case 'linkedin':$this->postToLinkedIn($data['message']);break;case 'discord':$this->postToDiscord($data['message']);break;}}$notificationData=['active'=>1,'message'=>$viewContent,'created_at'=>date('Y-m-d H:i:s'),'created_by'=>session('user_id'),'noto_count'=>$notoCount,'email_noto_count'=>$emailNotoCount,];$this->marketingModel->storeNotification($notificationData);}private function sendInAppNotification($user,$content){$db=\Config\Database::connect();$db->table('user_notifications')->insert(['user_id'=>$user->id,'content'=>$content,'created_at'=>date('Y-m-d H:i:s')]);}private function sendEmailNotification($user,$content){$email=\Config\Services::email();$email->setTo($user->email);$email->setSubject('Notification');$email->setMessage($content);$email->send();}public function postToSocialMedia($content){try{$this->postToFacebook($content);$this->postToTwitter($content);$this->postToLinkedIn($content);}catch(\Throwable $e){$this->logger->error('âŒ postToSocialMedia() failed: '.$e->getMessage());}}private function postToFacebook($message){try{$response=$this->facebook->post('/me/feed',['message'=>$message],$this->socialMedia->facebook_access_token);return $response->getGraphNode();}catch(Facebook\Exceptions\FacebookResponseException $e){$this->logger->error('Facebook Graph returned an error: '.$e->getMessage());return false;}catch(Facebook\Exceptions\FacebookSDKException $e){$this->logger->error('Facebook SDK returned an error: '.$e->getMessage());return false;}}public function fetchTweets($query,$count=100){try{$tweets=$this->twitter->get('search/tweets',['q'=>$query,'count'=>$count]);if($this->twitter->getLastHttpCode()===200){$processedTweets=[];foreach($tweets->statuses as $tweet){$processedTweets[]=['tweet_id'=>$tweet->id_str,'content'=>$tweet->text,'author'=>$tweet->user->screen_name,'created_at'=>$tweet->created_at,'url'=>"https://twitter.com/{$tweet->user->screen_name}/status/{$tweet->id_str}"];}foreach($processedTweets as $tweetData){$this->marketingModel->storeScrapedContent(['title'=>$tweetData['content'],'url'=>$tweetData['url'],'content'=>$tweetData['content'],'keywords'=>json_encode([$tweetData['author']]),'scraped_at'=>date('Y-m-d H:i:s')]);}return $processedTweets;}else{throw new \Exception('Failed to fetch tweets: '.$this->twitter->getLastBody());}}catch(\Throwable $th){log_message('error','Error fetching tweets: '.$th->getMessage());return[];}}public function generateContentFromTweets($tweets){$summary=$this->summarizeText(implode(' ',array_column($tweets,'content')));$keywords=$this->extractKeywords($summary);return['summary'=>$summary,'keywords'=>$keywords,'platform_content'=>$this->generatePlatformContent($summary,$keywords)];}public function generateFromTempScraper($limit=5){$records=$this->marketingModel->getLatestTempRecords($limit);if(empty($records)){log_message('info','No temp scraper records found to process.');return;}foreach($records as $record){try{log_message('debug','ðŸ§ª Processing record ID '.$record['id']);$summary=$this->generateContentFromRaw($record);if($summary){$this->marketingModel->markTempScraperProcessed($record['id']);log_message('info','âœ… Processed and stored content for record ID '.$record['id']);}else{log_message('warning','âš ï¸ Summary was null/empty for record ID '.$record['id']);}}catch(\Throwable $e){log_message('error','âŒ Error generating content for record ID '.$record['id'].': '.$e->getMessage());}}}public function postToTwitter($content){try{$response=$this->twitter->post('statuses/update',['status'=>$content]);if($this->twitter->getLastHttpCode()===200){log_message('info','Successfully posted to Twitter: '.$content);return $response;}else{throw new \Exception('Failed to post to Twitter: '.json_encode($response));}}catch(\Throwable $th){log_message('error','Error posting to Twitter: '.$th->getMessage());return false;}}private function postToLinkedIn($message){try{$response=$this->linkedin->post('/people/~/shares',['comment'=>$message,'visibility'=>['code'=>'anyone']],$this->socialMedia->linkedin_access_token);return $response;}catch(Exception $e){$this->logger->error('LinkedIn API returned an error: '.$e->getMessage());return false;}}private function postToBlog($content){$client=new Client(['base_uri'=>$this->siteSettings->wordpress_site_url,]);try{$response=$client->post('/wp-json/wp/v2/posts',['auth'=>[$this->siteSettings->wordpress_username,$this->siteSettings->wordpress_password],'json'=>['title'=>substr($content,0,50),'content'=>$content,'status'=>'publish',],]);if($response->getStatusCode()==201){$this->logger->info('Posted to blog: '.$content);return json_decode($response->getBody(),true);}else{$this->logger->error('Failed to post to blog: '.$response->getBody());return false;}}catch(RequestException $e){$this->logger->error('Blog post request error: '.$e->getMessage());return false;}}public function distributeContentToSocialMedia($content){$twitterPost="ï¿½ **Stock Market Highlights** ï¿½\n";$facebookPost="ï¿½ **Market Movers Update** ï¿½\n";$linkedinPost="ï¿½ **Today's Market Summary** ï¿½\n";$discordPost="ï¿½ **TRADE ALERTS UPDATE!** ï¿½\n";foreach($content['expandedContent']as $post){$twitterPost.=$post."\n";$facebookPost.=$post."\n";$linkedinPost.=$post."\n";$discordPost.=$post."\n";}$this->postToTwitter($twitterPost);$this->postToFacebook($facebookPost);$this->postToLinkedIn($linkedinPost);$this->postToDiscord($discordPost);return['twitter'=>$twitterPost,'facebook'=>$facebookPost,'linkedin'=>$linkedinPost,'discord'=>$discordPost];}public function generateAndPostContent(){$emailSummaries=$this->marketingModel->getEmailSummariesForReview();foreach($emailSummaries as $summary){log_message('info','Generating content for email summary: '.$summary['email_subject']);$content=$this->generateMarketingContent($summary['summary']);log_message('debug','Generated content: '.print_r($content,true));$this->postToSocialMedia($content);$this->postToBlog($content);$this->marketingModel->updateEmailStatus($summary['email_identifier'],'Posted');log_message('info','Updated email status to Posted for: '.$summary['email_subject']);}}public function generateMarketingContent():void{$topStories=$this->marketingModel->getTopStories(10);$count=0;foreach($topStories as $story){if(empty(trim($story['title']?? ''))){log_message('debug','â­ Skipped record ID '.$story['id'].' - no title provided.');continue;}if($count>=5){break;}$headline=$story['title'];$url=$story['source_url']?? '#';$summary=$this->generateSummary($story);$hashtags=$this->extractHashtags($story['title'].' '.$story['email_body']);$platformPosts=['discord'=>"**{$headline}**\n{$summary}\nðŸ”— {$url}\n{$hashtags}",'twitter'=>"{$headline} {$url} {$hashtags}",'linkedin'=>"{$headline}\n{$summary}\nRead more: {$url} {$hashtags}",'facebook'=>"{$headline}\n{$summary}\n{$url} {$hashtags}",'email'=>['subject'=>$headline,'body'=>"{$summary}\n\nRead More: {$url}\n{$hashtags}",],];$this->marketingModel->storeGeneratedContent($story['id'],$platformPosts);$count++;}}private function logScrapeError($url,$error){log_message('error',"Scraping failed for URL: $url, Error: $error");}public function generateContentFromData($title,$content,$tags){$summary=$this->summarizeContent($content);return $title." - ".$summary." Tags: ".implode(', ',$tags);}public function generateContentFromScrapedData($scrapedData,$platform=null){if(empty($scrapedData)||!is_array($scrapedData)){log_message('error','âŒ generateContentFromScrapedData() called with empty or invalid $scrapedData');return[];}$cleanedSummaries=[];foreach($scrapedData as $record){$rawContent=$record['content']?? '';$cleaned=$this->sanitizeRawEmailContent($rawContent);if(strlen($cleaned)<300||substr_count($cleaned,' ')<20){log_message('warning','[MyMIMarketing] Skipped record due to short or unstructured content (Title: '.($record['title']?? 'Untitled').')');continue;}try{$summaryData=$this->summarizeContent($cleaned);if(!is_array($summaryData)||empty($summaryData['summary'])){log_message('warning','âš ï¸ generateContentFromScrapedData(): Summary was null/empty for record title: '.($record['title']?? 'Untitled'));continue;}$headline=$this->generateHeadline($summaryData['summary']);$platformPosts=$this->generatePlatformContent($summaryData['summary'],$summaryData['tokens']??[]);$payload=['title'=>$record['title']?? $headline,'source'=>$record['url']?? 'unknown','summary'=>$summaryData['summary'],'keywords'=>$summaryData['tokens']??[],'headline'=>$headline,'platform_content'=>$platformPosts,'platform'=>$platform,'created_on'=>date("Y-m-d H:i:s"),];$this->marketingModel->storeGeneratedContent($record['id']?? null,$platformPosts);$cleanedSummaries[]=$payload;}catch(\Throwable $e){log_message('error','âŒ Exception in generateContentFromScrapedData(): '.$e->getMessage());}}return $cleanedSummaries;}public function generateContentFromLargeText($content,$tags){if(empty($content)){log_message('error','Content is empty in generateContentFromLargeText.');return['summary'=>'','keywords'=>[],'platforms_content'=>[],];}$tokenizer=new WhitespaceTokenizer();$samples=[$tokenizer->tokenize($content)];log_message('debug','Tokenized samples: '.print_r($samples,true));if(empty($samples)||!isset($samples[0])||!is_array($samples[0])||empty($samples[0])){log_message('error','ðŸš« Empty or malformed document array before TF-IDF.');return['summary'=>'','keywords'=>[],'platforms_content'=>[],];}try{$tfidf=new TfIdfTransformer();$tfidf->fit($samples);$tfidf->transform($samples);log_message('debug','TfIdf transformation successful.');}catch(\Exception $e){log_message('error','TfIdfTransformer failed: '.$e->getMessage());return['summary'=>'','keywords'=>[],'platforms_content'=>[],];}$summary=$this->summarizeText($content);$keywords=$this->extractKeywords($content);$platforms_content=$this->generatePlatformContent($summary,$keywords);return['summary'=>$summary,'keywords'=>$keywords,'platforms_content'=>$platforms_content,];}public function generateCanvaVideo(){$scriptResponse=$this->generateVoiceoverScript();if(!$scriptResponse['status']==='success'){return $this->respond(['status'=>'error','message'=>'Voiceover script not found'],404);}$scriptText=$scriptResponse['script'];$canvaApiUrl="https://api.canva.com/v1/projects";$headers=['Authorization: Bearer YOUR_CANVA_API_KEY','Content-Type: application/json'];$payload=['title'=>'MyMI Trade Alerts Video','template'=>'YOUR_CANVA_TEMPLATE_ID','elements'=>['text'=>$scriptText,'voiceover'=>base_url('uploads/voiceover.mp3')]];$ch=curl_init($canvaApiUrl);curl_setopt($ch,CURLOPT_HTTPHEADER,$headers);curl_setopt($ch,CURLOPT_POST,true);curl_setopt($ch,CURLOPT_POSTFIELDS,json_encode($payload));curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);$response=curl_exec($ch);curl_close($ch);return $this->respond(['status'=>'success','message'=>'Video generated','video_url'=>json_decode($response)->video_url]);}public function generateEnhancedContent($voiceScript){$summary=$this->summarizeContent($voiceScript);$checkedContent=$this->spellCheckAndRefine($summary);$expandedContent=$this->contentGenerator($checkedContent);return['summary'=>$summary,'checkedContent'=>$checkedContent,'expandedContent'=>$expandedContent];}private function generatePrimaryContent($scrapedData){$content="";foreach($scrapedData as $data){$content.="Source: {$data['source']}\n";$content.="Title: {$data['title']}\n";$content.="Content: ".substr($data['content'],0,200)."...\n";$content.="Link: ".($data['url']?? 'N/A')."\n\n";}return $content;}public function generatePlatformContent($summary,$keywords,$mediaAssets=[]){$facebookContent="Facebook Post: ".$summary."\n\n"."Related: #".implode(' #',$keywords);$twitterContent="Twitter: ".substr($summary,0,280)."\n\n#".implode(' #',$keywords);$stocktwitsContent="StockTwits: ".substr($summary,0,250)."\n\n".implode(' ',$keywords);$discordContent="Discord: ".$summary."\n\nJoin the discussion! #".implode(' #',$keywords);$blogContent="Blog Post\n\n".$summary."\n\nKeywords: ".implode(', ',$keywords);$emailContent="Email Notification: ".$summary."\n\nRead more on our blog.";$browserNotificationContent="New Update: ".substr($summary,0,100)."... Click to learn more.";$tiktokScript=$this->generateTikTokScript($summary,$keywords,$mediaAssets);$youtubeScript=$this->generateYouTubeScript($summary,$keywords,$mediaAssets);return['Facebook'=>$facebookContent,'Twitter'=>$twitterContent,'StockTwits'=>$stocktwitsContent,'Discord'=>$discordContent,'Blog'=>$blogContent,'Email'=>$emailContent,'BrowserNotification'=>$browserNotificationContent,'TikTok'=>$tiktokScript,'YouTube'=>$youtubeScript];}public function generateSocialPost(array $summary):array{$text=$summary['summary']?? '';$keywords=$summary['keywords']??[];$hashtags=implode(' ',array_map(function($word){return '#'.ucfirst(trim($word));},array_slice($keywords,0,5)));return['twitter'=>substr("{$text} {$hashtags}",0,280),'facebook'=>"{$text}\n\n{$hashtags}",'linkedin'=>"{$text}\n\n#StayInformed {$hashtags}",'discord'=>"**News Summary:**\n{$text}\n\n{$hashtags}",];}private function generateSocialMediaContent($scrapedData){$facebookContent="Facebook: ";$twitterContent="Twitter: ";$linkedinContent="LinkedIn: ";foreach($scrapedData as $data){$facebookContent.=$data['title']." ".($data['url']?? '')."\n";$twitterContent.=$data['title']." ".($data['url']?? '')."\n";$linkedinContent.=$data['title']." ".($data['url']?? '')."\n";}return['Facebook'=>$facebookContent,'Twitter'=>$twitterContent,'LinkedIn'=>$linkedinContent,];}protected function generateSummary(array $story):string{return substr(strip_tags($story['email_body']?? ''),0,250).'...';}public function generateTikTokScript($summary,$keywords,$mediaAssets=[]){$hook="Did you know?";$cta="Follow us for more updates!";$mediaInclusion=!empty($mediaAssets)?"Include these images/videos: ".implode(", ",$mediaAssets):"";return"TikTok Video Script:\n1. Hook: \"{$hook}\"\n2. Summary: {$summary}\n3. Media: {$mediaInclusion}\n4. CTA: {$cta}";}public function generateYouTubeScript($summary,$keywords,$mediaAssets=[]){$hook="Breaking news in the world of finance...";$cta="Like, subscribe, and share for more updates!";$mediaInclusion=!empty($mediaAssets)?"Include these images/videos: ".implode(", ",$mediaAssets):"";return"YouTube Video Script:\n1. Hook: \"{$hook}\"\n2. Detailed Summary: {$summary}\n3. Media: {$mediaInclusion}\n4. CTA: {$cta}";}public function generateVoiceoverAudio($text){$client=new TextToSpeechClient();$input=new SynthesisInput();$input->setText($text);$voice=new VoiceSelectionParams();$voice->setLanguageCode('en-US');$voice->setSsmlGender('MALE');$audioConfig=new AudioConfig();$audioConfig->setAudioEncoding(AudioEncoding::MP3);$response=$client->synthesizeSpeech($input,$voice,$audioConfig);$audioContent=$response->getAudioContent();$filePath=WRITEPATH.'uploads/voiceover.mp3';file_put_contents($filePath,$audioContent);return base_url('uploads/voiceover.mp3');}public function generateVoiceoverScript(){$tradeAlerts=$this->alertsModel->getFilteredTradeAlerts(['start'=>date('Y-m-d 00:00:00'),'end'=>date('Y-m-d 23:59:59')])->get()->getResultArray();if(empty($tradeAlerts)){return $this->respond(['status'=>'error','message'=>'No trade alerts found for today.'],404);}$script="**Voiceover Script: MyMI Trade Alerts - Top Stock Movers**\n\n[INTRO]\n";$script.="Welcome to todayâ€™s MyMI Trade Alerts! Weâ€™re breaking down the hottest stocks in the market based on momentum, volume, and breakout potential. Letâ€™s jump right in!\n\n";foreach($tradeAlerts as $alert){$script.="**[{$alert['ticker']} - {$alert['company']}]**\n";$script.="**Price:** \${$alert['price']}  |  **% Change:** {$alert['change']}%  |  **Volume:** {$alert['volume']}M\n";$script.="ï¿½ 52-Week High: \${$alert['high']}  |  ï¿½ 52-Week Low: \${$alert['low']}\n";$script.="Market Cap: {$alert['market_cap']}\n\n";}$script.="[OUTRO]\nThatâ€™s it for todayâ€™s MyMI Trade Alerts! Donâ€™t forget to like, subscribe, and stay tuned for more market insights. Drop your thoughts in the commentsâ€”whatâ€™s your top stock pick today? See you in the next update!\n";return $this->respond(['status'=>'success','script'=>$script]);}public function generateStockInformation($cuID){$MyMIInvestments=new MyMIInvestments();$investmentData=$MyMIInvestments->getInvestmentDashboard($cuID);$symbols=$this->getSymbolsByAssetType($investmentData['getSymbols']);$forecastData=[];$riskData=[];foreach($symbols as $type=>$symbolList){switch($type){case 'stocks':$forecastData['stocks']=$MyMIInvestments->performARIMAForecast($symbolList);$riskData['stocks']=$MyMIInvestments->generateRiskManagementTools($cuID,'stocks');break;case 'etfs':$forecastData['etfs']=$MyMIInvestments->performARIMAForecast($symbolList);$riskData['etfs']=$MyMIInvestments->generateRiskManagementTools($cuID,'etfs');break;case 'crypto':$forecastData['crypto']=$MyMIInvestments->performARIMAForecast($symbolList);$riskData['crypto']=$MyMIInvestments->generateRiskManagementTools($cuID,'crypto');break;}}$content=$this->generateContent($forecastData,$riskData);return $content;}private function getSymbolsByAssetType($symbols){$result=['stocks'=>[],'etfs'=>[],'crypto'=>[]];foreach($symbols as $symbol){if(preg_match('/^[A-Z]{1,5}$/',$symbol)){$result['stocks'][]=$symbol;}elseif(preg_match('/^[A-Z]{1,5}$/',$symbol)){$result['etfs'][]=$symbol;}else{$result['crypto'][]=$symbol;}}return $result;}private function generateContent($forecastData,$riskData){$content="";if(!empty($forecastData['stocks'])){$content.="### Stock Investment Forecast\n";foreach($forecastData['stocks']as $symbol=>$forecast){$content.="- **{$symbol}**: ".json_encode($forecast)."\n";}}if(!empty($forecastData['etfs'])){$content.="### ETF Investment Forecast\n";foreach($forecastData['etfs']as $symbol=>$forecast){$content.="- **{$symbol}**: ".json_encode($forecast)."\n";}}if(!empty($forecastData['crypto'])){$content.="### Crypto Investment Forecast\n";foreach($forecastData['crypto']as $symbol=>$forecast){$content.="- **{$symbol}**: ".json_encode($forecast)."\n";}}$content.="\n### Risk Management Insights\n";foreach($riskData as $type=>$riskMetrics){$content.="#### ".ucfirst($type)." Risks\n";foreach($riskMetrics as $riskMetric=>$details){$content.="- **{$riskMetric}**: ".json_encode($details)."\n";}}return $content;}public function getRecentPosts($limit=5){return $this->marketingModel->getRecentPosts($limit);}public function pullFinancialNews():void{$response=$this->client->get('https://www.marketaux.com/api/v1/news/all',['query'=>['api_token'=>getenv('marketaux.apiKey'),'language'=>'en','country'=>'us','published_after'=>date('Y-m-d\TH:i:s\Z',strtotime('-1 hour')),'limit'=>50,],]);$data=json_decode($response->getBody(),true);if(isset($data['data'])){foreach($data['data']as $story){$this->marketingModel->saveNews($story);}}}public function rankBufferCandidates(){$buffer=$this->marketingModel->fetchBufferPostsForScoring();foreach($buffer as $post){$keywords=$this->extractKeywords($post['summary']);$score=array_sum(array_column($keywords,'score'));$tagScore=min($score/10,10);$this->marketingModel->updateBufferItem($post['id'],['tag_score'=>$tagScore]);}}public function rankNewsArticles():void{$unrankedNews=$this->marketingModel->getUnrankedNews();foreach($unrankedNews as $news){$content=strtolower(($news['title']?? '').' '.($news['email_subject']?? '').' '.($news['email_body']?? ''));$words=str_word_count(strip_tags($content),1);$wordFreq=array_count_values($words);$filtered=array_filter($wordFreq,fn($freq,$word)=>strlen($word)>3&&$freq>1,ARRAY_FILTER_USE_BOTH);arsort($filtered);$score=array_sum(array_values($filtered));$topKeywords=array_slice(array_keys($filtered),0,5);$this->marketingModel->updateRankedNews($news['id'],$score,implode(',',$topKeywords));}}public function summarizeMultipleArticles(array $articles):string{$allContent='';foreach($articles as $article){$content=$article['content']?? '';$allContent.=strip_tags($content).' ';}if(empty(trim($allContent))){log_message('error','summarizeMultipleArticles() received empty content.');return 'No content available to summarize.';}$summaryData=$this->summarizeContent($allContent);return is_array($summaryData)&&isset($summaryData['summary'])?$summaryData['summary']:substr($allContent,0,300).'...';}} ?><?php namespace App\Models;use CodeIgniter\Model;use Phpml\FeatureExtraction\TfIdfTransformer;use Phpml\Tokenization\WhitespaceTokenizer;class MarketingModel extends Model{protected $table='bf_marketing_scraper';protected $primaryKey='id';protected $useAutoIncrement=true;protected $returnType='object';protected $useSoftDeletes=false;protected $allowedFields=['title','description','created_on','modified_on','status','type','day','time','activity','link','url','summary','content','email_identifier','email_date','email_sender','email_subject','email_body','email_attachments','keywords','scraped_at','links','images','videos','metadata','structured_data','sched_id','escalated','audience_type','stage','name','assigned_on','assigned_to','completed_on','scheduled_at','primary_content','secondary_content','html_content','voice_script','shared','shared_users','blog','in_app','email','discord','facebook','linkedin','telegram','twitter','website','promotional_links','facebook_message','linkedin_message','discord_message','stocktwits_message','tiktok_message','youtube_message','email_message','additional_info','image_paths'];protected $useTimestamps=true;protected $createdField='created_on';protected $updatedField='modified_on';public function addMarketingCampaign($campaignData){log_message('debug','MarketingModel L206 - $marketingData: '.(print_r($campaignData,true)));$dbData=['beta'=>$campaignData['beta'],'config_mode'=>$campaignData['config_mode'],'form_mode'=>$campaignData['form_mode'],'escalated'=>$campaignData['escalated'],'created_by'=>$campaignData['user_id'],'user_id'=>$campaignData['user_id'],'user_email'=>$campaignData['user_email'],'username'=>$campaignData['username'],'assigned_to'=>$campaignData['assigned_to'],'assigned_on'=>$campaignData['date'].' - '.$campaignData['time'],'name'=>$campaignData['campaign_name'],'promotional_links'=>$campaignData['promotionalLinks'],'overall_campaign_description'=>$campaignData['overall_campaign_description'],'voice_script'=>$campaignData['voice_script'],'facebook_message'=>$campaignData['facebookMessage'],'linkedin_message'=>$campaignData['linkedinMessage'],'discord_message'=>$campaignData['discordMessage'],'stocktwits_message'=>$campaignData['stocktwitsMessage'],'tiktok_message'=>$campaignData['tiktokMessage'],'youtube_message'=>$campaignData['youtubeMessage'],'email_message'=>$campaignData['emailMessage'],'additional_info'=>$campaignData['additionalInfo'],'hashtags'=>$campaignData['hashtags'],];log_message('debug','MarketingModel L206 - $marketingData: '.(print_r($dbData,true)));if($this->db->table('bf_marketing_campaigns')->insert($dbData)){log_message('info','Campaign created successfully.');return $this->getInsertID();}else{log_message('error','DB Insert Error: '.json_encode($this->errors()));return false;}}public function addMarketingSchedule($data){$data['zapier_webhook_url']=$data['zapier_webhook_url']?? null;$data['post_status']='pending';$this->db->table('bf_marketing_schedule')->insert($data);return $this->db->insertID();}public function addSubscriber($subscriberData){if($this->db->table('bf_users_subscribers')->insert($subscriberData)){log_message('info','Subscriber added successfully.');return true;}else{log_message('error','DB Insert Error: '.json_encode($this->errors()));return false;}}public function cleanHtmlEmailContent($raw):string{$raw=is_string($raw)?$raw:'';$decoded=quoted_printable_decode($raw);$decoded=is_string($decoded)?$decoded:'';$text=strip_tags($decoded);$text=preg_replace('/\s+/',' ',str_replace(["\r","\n","\t",'&nbsp;'],' ',$text));return trim(substr($text,0,5000));}public function copyMarketingCampaign($marketingData){unset($marketingData['id']);if($this->insert($marketingData)){log_message('info','Campaign copied successfully.');return $this->getInsertID();}else{log_message('error','DB Insert Error: '.json_encode($this->errors()));return false;}}public function countBlogs(){return $this->db->table('bf_marketing_blog_posts')->countAllResults();}public function countNewlyInsertedToday():int{return $this->where('DATE(scraped_at)',date('Y-m-d'))->countAllResults();}public function createSlug($title){$slug=url_title($title,'-',true);$existing=$this->db->table('bf_marketing_blog_posts')->where('slug',$slug)->countAllResults();return $existing?$slug.'-'.uniqid():$slug;}public function deleteMarketingCampaign($id){if($this->delete($id)){log_message('info','Campaign deleted successfully.');return true;}else{log_message('error','DB Delete Error: '.json_encode($this->errors()));return false;}}public function deleteSchedule($id){return $this->db->table('bf_marketing_schedule')->where('id',$id)->delete();}public function editMarketingCampaign($marketingData){if($this->update($marketingData['id'],$marketingData)){log_message('info','Campaign updated successfully.');return true;}else{log_message('error','DB Update Error: '.json_encode($this->errors()));return false;}}public function extractKeywords($text){if(empty($text)||strlen(trim($text))<50){return[];}$tokenizer=new WhitespaceTokenizer();$tokens=array_filter($tokenizer->tokenize($text));if(empty($tokens)){return[];}$documents=[$tokens];$tfidf=new TfIdfTransformer();try{$tfidf->transform($documents);}catch(\Exception $e){log_message('error','TfIdfTransformer failed: '.$e->getMessage());return[];}$keywordScores=[];foreach($documents[0]as $word=>$score){$keywordScores[$word]=$score;}arsort($keywordScores);return array_slice(array_keys($keywordScores),0,10);}public function fetchBufferPaginated($page=1,$limit=20){$offset=($page-1)*$limit;$builder=$this->db->table('bf_marketing_buffer')->where('status !=','promoted')->orderBy('tag_score','DESC')->limit($limit,$offset);$results=$builder->get()->getResultArray();$total=$this->db->table('bf_marketing_buffer')->where('status !=','promoted')->countAllResults();return['data'=>$results,'pagination'=>['page'=>$page,'pages'=>ceil($total/$limit),]];}public function fetchBufferPaginatedWithFilters(array $params=[]){$page=$params['page']?? 1;$limit=$params['limit']?? 20;$offset=($page-1)*$limit;$keyword=$params['keyword']?? null;$category=$params['category']?? null;$minTagScore=$params['min_tag_score']?? 0;$onlySuggested=$params['only_suggested']?? false;$builder=$this->db->table('bf_marketing_buffer')->where('status !=','promoted');if(!empty($keyword)){$builder->like('keyword',$keyword);}if(!empty($category)){$builder->where('category',$category);}if(!empty($minTagScore)){$builder->where('tag_score >=',$minTagScore);}if($onlySuggested){$builder->where('auto_suggest',1);}$totalQuery=clone $builder;$total=$totalQuery->countAllResults(false);$results=$builder->orderBy('tag_score','DESC')->limit($limit,$offset)->get()->getResultArray();return['data'=>$results,'pagination'=>['page'=>$page,'limit'=>$limit,'pages'=>ceil($total/$limit),'total'=>$total,],];}public function fetchBufferPostsForReview($limit=25){return $this->db->table('bf_marketing_buffer')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getBufferItem($id){return $this->db->table('bf_marketing_buffer')->where('id',$id)->get()->getRowArray();}public function getPendingAutoSuggested($limit=5){return $this->db->table('bf_marketing_buffer')->where('status','pending')->where('auto_suggest',1)->orderBy('tfidf_score','DESC')->limit($limit)->get()->getResultArray();}public function getPendingScheduledPosts($currentTimestamp){return $this->db->table('bf_marketing_schedule')->where('post_time <=',$currentTimestamp)->where('post_status','pending')->get()->getResult();}public function getPendingScraperSummaries($limit=10){return $this->db->table('bf_marketing_scraper')->where('status',null)->orWhere('status','')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getProcessedEmails($date=null){$builder=$this->select('email_identifier');if($date){$builder->where('DATE(email_date)',$date);}$results=$builder->get()->getResultArray();$identifiers=[];foreach($results as $row){if(!empty($row->email_identifier)){$identifiers[]=$row->email_identifier;}}return $identifiers;}public function findBufferItem($id){return $this->db->table('bf_marketing_buffer')->where('id',$id)->get()->getRowArray();}public function findFinalizedById($id){return $this->db->table('bf_marketing_scraper')->where('id',$id)->get()->getRowArray();}public function getActiveCampaigns(){$builder=$this->db->table('bf_marketing_campaigns');$num_rows=$builder->where('status',1)->countAllResults(false);$result=$builder->where('status',1)->get()->getResultArray();return['result'=>$result,'num_rows'=>$num_rows];}public function getActiveIdeas(){return $this->db->table('bf_marketing_ideas')->where('status !=','approved')->get()->getResultArray();}public function getActivePriorityCampaigns(){$builder=$this->db->table('bf_marketing_campaigns');$num_rows=$builder->where('status',1)->where('escalated',1)->countAllResults(false);$result=$builder->where('status',1)->where('escalated',1)->get()->getResultArray();return['result'=>$result,'num_rows'=>$num_rows];}public function getApprovedBufferWithoutSchedule(){return $this->db->table('bf_marketing_buffer')->where('status','approved')->where('scheduled_at IS NULL',null,false)->where('schedule_interval >',0)->orderBy('tag_score','DESC')->limit(10)->get()->getResultArray();}public function getApprovedLogos(){return $this->db->table('bf_company_logos')->get()->getResultArray();}public function getBlogPostBySlug($slug){return $this->db->table('bf_marketing_blog_posts')->where('slug',$slug)->get()->getRow();}public function getBlogPostDetails($id){return $this->find($id);}public function getBlogPosts(){return $this->where('type','Email/Newsletters')->limit(50)->get()->getResultArray();}public function getBlogs(){return $this->db->table('bf_marketing_blog_posts')->orderBy('created_on','DESC')->get()->getResult();}public function getBufferItems($limit=50){return $this->builder()->where('status','pending')->orderBy('score','DESC')->limit($limit)->get()->getResultArray();}public function getCampaignById($campaign_id){return $this->db->table('bf_marketing_campaigns')->where('id',$campaign_id)->get()->getResultArray();}public function getCampaignsBySchedId($accountid){return $this->db->table('bf_marketing_campaigns')->where('sched_id',$accountid)->get()->getResultArray();}public function getDailyLogsByDate($date){return $this->db->table('bf_marketing_scraper')->where('DATE(created_on)',$date)->get()->getResult();}public function getEmailRecordById($id){return $this->db->table('bf_marketing_temp_scraper')->where('id',$id)->get()->getRowArray();}public function getEmailByMessageId($messageId){return $this->db->table('bf_marketing_temp_scraper')->where('email_identifier',$messageId)->get()->getRowArray();}public function getEmailContentsForNewsletter(){return $this->where('include_newsletter',false)->limit(50)->get()->getResultArray();}public function getEmailsMissingTitleOrUrl($limit=20){return $this->db->table('bf_marketing_temp_scraper')->where('(title IS NULL OR title = "" OR url IS NULL OR url = "")',null,false)->orderBy('date_scraped','DESC')->limit($limit)->get()->getResultArray();}public function getEmailSummariesForReview(){return $this->where('status','In Review')->limit(50)->get()->getResultArray();}public function getExchangeTokenById($id){return $this->db->table('bf_exchanges_assets')->where('id',$id)->get()->getRowArray();}public function getExistingLogoBySymbol($symbol){return $this->db->table('bf_company_logos')->where('symbol',$symbol)->get()->getRow();}public function getFeatures(){return $this->db->table('bf_users_memberships')->where('active',1)->orderBy('feature_level','ASC')->orderBy('feature_name','ASC')->get()->getResultArray();}public function getGeneratedContent($postId){return $this->db->table('bf_marketing_campaigns')->where('sched_id',$postId)->get()->getRowArray();}public function getGeneratedPostsBySourceId($id){$row=$this->db->table('bf_marketing_scraper')->where('source_id',$id)->get()->getRowArray();if(!$row||empty($row['platforms']))return[];$decoded=json_decode($row['platforms'],true);if(!is_array($decoded))return[];return $decoded;}public function getLatestGeneratedSummaries($limit=25){return $this->db->table('bf_marketing_scraper')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getLatestNewsletterDraft(){return $this->db->table('bf_marketing_newsletters')->orderBy('created_at','DESC')->first();}public function getLatestTempRecords($limit=5){return $this->db->table('bf_marketing_temp_scraper')->where('status','In Review')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getLatestUnprocessedEmails($limit=10){return $this->db->table('bf_marketing_temp_scraper')->where('status','In Review')->orderBy('scraped_at','DESC')->limit($limit)->get()->getResultArray();}public function getMarketingBuffer($status='Pending'){return $this->builder()->where('status',$status)->orderBy('created_at','DESC')->get()->getResultArray();}public function getMarketingPageSeoByName($pageTitle){return $this->where('page_name',$pageTitle)->get()->getResultArray();}public function getMarketingTeam(){$result=$this->db->table('bf_management_positions')->where('department','Marketing')->get()->getResultArray();return $result;}public function getNewsArticles(){$result=$this->select('articles_json')->first();return json_decode($result->articles_json ?? '[]',true);}public function getNewEmails(){return $this->db->table('bf_marketing_raw_emails')->where('status','unprocessed')->get()->getResultArray();}public function getNewsPosts(){return $this->where('type','news_post')->limit(50)->get()->getResultArray();}public function getNextScheduledPost(){return $this->db->table('bf_marketing_buffer')->where('status','approved')->where('tag_score >=',7.0)->orderBy('tag_score','DESC')->limit(1)->get()->getRowArray();}public function getRecentPosts($limit=5){$results=$this->asObject()->select("id, title, category, created_at, blog_content")->orderBy('created_at','DESC')->limit($limit)->findAll();log_message('info','MarketingModel L437 - $result Array: '.(print_r($results,true)));foreach($results as $r){$r->short_description=substr(strip_tags($r->blog_content ?? 0),0,150);}return $results;}public function getRecentScrapes(){return $this->db->table('bf_marketing_temp_scraper')->orderBy('scraped_at','DESC')->limit(5)->get()->getResult();}public function getRecentSummaries($limit=5){return $this->db->table('bf_marketing_scraper')->select('id, title, summary, keywords, scraped_at')->where("CHAR_LENGTH(summary) >=",100)->where("summary LIKE",'% % % % % % % % % %')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getRecentUnprocessedTempEmails($limit=5){return $this->db->table('bf_marketing_temp_scraper')->where('status','In Review')->orderBy('id','DESC')->limit($limit)->get()->getResultArray();}public function getScheduledBufferPosts($timestamp){return $this->db->table('bf_marketing_buffer')->where('status','approved')->where('scheduled_at <=',$timestamp)->orderBy('scheduled_at','ASC')->limit(3)->get()->getResultArray();}public function getScheduledCampaigns(){return $this->db->table('bf_marketing_newsletters')->where('status','scheduled')->where('scheduled_date <=',date('Y-m-d H:i:s'))->get()->getResultArray();}public function getScheduleByDay($day){return $this->db->table('bf_marketing_calendar')->where('day',ucfirst($day))->get()->getResultArray();}public function getScheduleById($id){return $this->db->table('bf_marketing_schedule')->where('id',$id)->get()->getRow();}public function getScrapesByDate($date){return $this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',$date)->orderBy('scraped_at','DESC');if($limit){$builder->limit($limit);}return $builder->get()->getResultArray();}public function getScrapesByKeyword($keyword){return $this->db->table('bf_marketing_scraper')->like('summary',$keyword)->orLike('keywords',$keyword)->orderBy('created_on','DESC')->limit(10)->get()->getResultArray();}public function getTodaysNewsContent($limit=10){$builder=$this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',date('Y-m-d'))->where('type !=','todays_story')->orderBy('scraped_at','DESC')->limit($limit);$query=$builder->get();$results=$query->getResultArray();if(empty($results)){log_message('info','No scraped content found for today.');}return $results;}public function getTodaysScrapedContent(){return $this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',date('Y-m-d'))->orderBy('feature_score','DESC')->get()->getResultArray();}public function getTodaysStory(){return $this->db->table('bf_marketing_temp_scraper')->where('type','todays_story')->where('DATE(scraped_at)',date('Y-m-d'))->orderBy('scraped_at','DESC')->get()->getRowArray();}public function getTopBufferPosts($limit=5,$minTagScore=7.5){return $this->builder('bf_marketing_buffer')->where('status','approved')->where('tag_score >=',$minTagScore)->orderBy('tag_score','DESC')->limit($limit)->get()->getResultArray();}public function getTopStories($limit=10){return $this->db->table('bf_marketing_scraper')->where('status','pending')->where('title IS NOT NULL')->where('title !=','')->orderBy('feature_score','DESC')->limit($limit)->get()->getResultArray();}public function getTopTempRecords($limit=5){return $this->db->table('bf_marketing_temp_scraper')->where('title IS NOT NULL')->orderBy('created_at','desc')->limit($limit)->get()->getResultArray();}public function getUpcomingSchedule(){return $this->db->table('bf_marketing_schedule')->select('id, post_date, completed, GROUP_CONCAT(DISTINCT platform ORDER BY platform ASC SEPARATOR ", ") as platforms, MIN(content_subject) as subjects, MIN(content_description) as descriptions')->where('post_date >=',date('Y-m-d'))->groupBy('post_date')->orderBy('post_date','ASC')->get()->getResultArray();}public function getUpcomingEarnings(){$builder=$this->db->where('bf_investment_calendar')->where('date >=',date('Y-m-d'))->where('event_type','Earnings')->orderBy('date','ASC')->get()->getResultArray();log_message('debug','MarketingModel L211 - getUpcomingEvents $builder Array: '.(print_r($builder,true)));return $builder;}public function getValidUnprocessedEmails($limit=10){$builder=$this->db->table('bf_marketing_temp_scraper');$builder->where('processed',0);$builder->limit($limit*2);$query=$builder->get();$results=$query->getResultArray();$valid=[];foreach($results as $row){$id=$row['id'];if(empty($row['title'])){log_message('debug',"ðŸª“ Skipping record ID {$id} â€” Missing title.");continue;}if(empty($row['content'])||strlen(strip_tags($row['content']))<100){log_message('debug',"ðŸª“ Skipping record ID {$id} â€” Content empty or too short.");continue;}$textContent=strip_tags($row['content']);$htmlRatio=strlen($textContent)/strlen($row['content']?? '');if($htmlRatio<0.3){log_message('debug',"ðŸª“ Skipping record ID {$id} â€” HTML-dominant content ({$htmlRatio}).");continue;}$valid[]=$row;if(count($valid)>=$limit){break;}}return $valid;}public function getValidUnprocessedEmailsFromToday($limit=10){return $this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',date('Y-m-d'))->where('content IS NOT NULL',null,false)->where('title IS NOT NULL',null,false)->where('CHAR_LENGTH(content) >',250)->orderBy('id','DESC')->limit($limit)->get()->getResultArray();}public function incrementRetryCount($id){return $this->db->table('bf_marketing_schedule')->where('id',$id)->set('retry_count','retry_count + 1',false)->update(['last_attempt_at'=>date('Y-m-d H:i:s')]);}public function insertBufferItem(array $summary){$MyMIMarketing=new \App\Libraries\MyMIMarketing();$scoreData=$MyMIMarketing->getTopKeywordScores($summary['summary']);$threshold=getenv('MARKETING_TFIDF_THRESHOLD')?:7.5;$bufferRecord=['keyword'=>$scoreData['top_keyword']?? 'general','summary'=>$summary['summary'],'score'=>$scoreData['score']?? 0,'tag_score'=>$scoreData['tag_score']?? 0,'category'=>$scoreData['category']?? 'Uncategorized','status'=>'pending','tfidf_score'=>$scoreData['tfidf_score']?? 0,'auto_suggest'=>($scoreData['tfidf_score']?? 0)>=$threshold?1:0,'platforms'=>json_encode(['discord'=>true,'linkedin'=>true,'x'=>false,'email'=>false,]),'created_at'=>date('Y-m-d H:i:s'),];return $this->insert($bufferRecord);}public function insertFinalScraper(array $record,array $summary){$data=['source_id'=>$record['id'],'title'=>$record['title']?? '(No Title)','summary'=>$summary['summary']?? '','keywords'=>json_encode($summary['keywords']??[]),'platforms'=>json_encode($summary['posts']??[]),'status'=>'ready','created_on'=>date('Y-m-d H:i:s'),];return $this->db->table('bf_marketing_scraper')->insert($data);}public function insertNewsContent(array $newsItem,string $ticker){$data=['title'=>$newsItem['title']?? '','summary'=>$newsItem['summary']?? '','content'=>$newsItem['content']?? '','type'=>'financial_news','status'=>'Published','created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),'scraped_at'=>date('Y-m-d H:i:s'),'keywords'=>json_encode($newsItem['keywords']??[]),'links'=>json_encode($newsItem['links']??[]),'audience_type'=>'investor','activity'=>$ticker,];return $this->db->table('bf_marketing_scraper')->insert($data);}public function insertTempScraper($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function idleFetchEmails(){$config=config('NewsEmailServer');$connectionString="{$config->host}:{$config->port}/imap/{$config->encryption}";$inbox=@imap_open($connectionString,$config->username,$config->password);if(!$inbox){log_message('error','Cannot connect to email server: '.imap_last_error());return;}try{while(true){if(function_exists('imap_idle')){$status=imap_idle($inbox);}else{log_message('warning','ðŸ“­ imap_idle not supported on this server. Falling back to polling.');sleep(30);continue;}$status=imap_idle($inbox);if($status){$emails=imap_search($inbox,'ALL');if($emails){foreach($emails as $email_number){$overview=imap_fetch_overview($inbox,$email_number,0)[0];$sender=$overview->from;$subject=$overview->subject;$body=imap_fetchbody($inbox,$email_number,1);$data=['status'=>'In Review','type'=>'Email/Newsletters','email_identifier'=>md5($subject.$sender.$overview->date),'email_date'=>date('Y-m-d H:i:s',strtotime($overview->date)),'email_sender'=>$sender,'email_subject'=>$subject,'email_body'=>$body,'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];if($this->isEmailProcessed($data['email_identifier'])){log_message('debug','Email already processed: '.$data['email_identifier']);}else{$this->storeEmailContent($data);}}}else{log_message('debug','No new emails found or imap_search returned false');}}sleep(30);}}catch(\Exception $e){log_message('error','An exception occurred during email fetching: '.$e->getMessage());}finally{imap_close($inbox);}}public function isEmailProcessed($emailIdentifier){return $this->where('email_identifier',$emailIdentifier)->countAllResults()>0;}private function mapToContextualHashtags($keywords){return array_map(fn($keyword)=>'#'.preg_replace('/\s+/','',ucfirst($keyword)),$keywords);}public function markEmailsAsProcessed($ids=[]){if(!empty($ids)){return $this->db->table('bf_marketing_temp_scraper')->whereIn('id',$ids)->update(['status'=>'Processed']);}return false;}public function markTempRecordAsProcessed($id){return $this->db->table('bf_marketing_temp_scraper')->where('id',$id)->update(['status'=>'Processed','updated_at'=>date('Y-m-d H:i:s')]);}public function markTempScraperProcessed($id){$this->db->table('bf_marketing_temp_scraper')->where('id',$id)->update(['status'=>'Processed']);}public function processText($emailBody){$summary=$this->summarizeText($emailBody);$keywords=$this->extractKeywords($emailBody);$hashtags=$this->mapToContextualHashtags($keywords);if(empty($summary)||empty($hashtags)){log_message('error','Text processing failed');return false;}return $summary.' '.implode(' ',$hashtags);}public function saveApprovedLogo($symbol,$imageUrl){$symbol=strtoupper(trim($symbol));$data=['symbol'=>$symbol,'image_url'=>$imageUrl,'approved_at'=>date('Y-m-d H:i:s'),'updated_at'=>date('Y-m-d H:i:s'),];try{$existingLogo=$this->db->table('bf_company_logos')->where('symbol',$symbol)->get()->getRow();if($existingLogo){if($existingLogo->image_url!==$imageUrl){$this->db->table('bf_company_logos')->where('symbol',$symbol)->update($data);log_message('info',"Logo for symbol {$symbol} updated in bf_company_logos.");}else{log_message('info',"Logo for symbol {$symbol} already exists and is up to date.");}}else{$this->db->table('bf_company_logos')->insert($data);log_message('info',"Logo for symbol {$symbol} added to bf_company_logos.");}}catch(\Exception $e){log_message('error',"Failed to save or update logo for symbol {$symbol}: ".$e->getMessage());}}public function saveDailyLog($data){return $this->db->table('bf_marketing_scraper')->insert($data);}public function saveLogo($data){$symbol=strtoupper(trim($data['symbol']));$existing=$this->db->table('bf_company_logos')->where('symbol',$symbol)->get()->getRow();$data['symbol']=$symbol;$data['updated_at']=date('Y-m-d H:i:s');if($existing){$this->db->table('bf_company_logos')->where('symbol',$symbol)->update($data);log_message('info',"Logo for symbol {$symbol} updated in bf_company_logos.");}else{$data['created_at']=date('Y-m-d H:i:s');$this->db->table('bf_company_logos')->insert($data);log_message('info',"Logo for symbol {$symbol} added to bf_company_logos.");}}public function scheduleNewsletterCampaign($data){return $this->db->table('bf_marketing_newsletters')->insert($data);}public function storeContentAnalytics(array $data){return $this->db->table('bf_marketing_analysis')->insert($data);}public function storeEmail($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function storeEmailContent($data){return $this->insert($data);}public function storeFinalMarketingContent($data){return $this->db->table('bf_marketing_scraper')->insert($data);}public function storeTodaysStory($title,$content){$data=['title'=>$title,'content'=>$content,'links'=>json_encode([]),'url'=>'','type'=>'todays_story','scraped_at'=>date('Y-m-d H:i:s'),'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function submitCampaignContent($data){if(isset($data['promotional_links'])&&is_array($data['promotional_links'])){$data['promotional_links']=json_encode($data['promotional_links']);}$data['status']=$data['status']?? 1;$data['stage']=$data['stage']?? 'draft';$data['created_on']=date('Y-m-d H:i:s');return $this->save($data);}public function storeNewsletterDraft($data){return $this->db->table('bf_marketing_newsletters')->insert($data);}public function storeNotification($data){return $this->db->table('bf_users_promotional_messages')->insert($data);}public function storeScrapedContent($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function storeTempScrapedData($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function summarizeText($text){if(empty($text)){return '';}$sentences=explode('.',$text);if(count($sentences)<=1){return substr($text,0,200);}$tokenizer=new WhitespaceTokenizer();$documents=array_map([$tokenizer,'tokenize'],$sentences);$documents=array_filter($documents);if(empty($documents)){return '';}$tfidf=new TfIdfTransformer();try{$tfidf->transform($documents);}catch(\Exception $e){log_message('error','TfIdfTransformer failed: '.$e->getMessage());return '';}$sentenceScores=[];foreach($documents as $index=>$document){$sentenceScores[$index]=array_sum($document);}arsort($sentenceScores);$numSentences=min(5,count($sentenceScores));$summarySentences=array_slice(array_keys($sentenceScores),0,$numSentences);return implode('. ',array_intersect_key($sentences,array_flip($summarySentences)));}public function updateBufferItem($id,$data){return $this->db->table('bf_marketing_buffer')->where('id',$id)->update($data);}public function updateBufferStatus($id,$status){return $this->db->table('bf_marketing_buffer')->where('id',$id)->update(['status'=>$status]);}public function updateCampaignStatus($id,$status){return $this->db->table('bf_marketing_newsletters')->where('id',$id)->update(['status'=>$status]);}public function updateEmailFields($id,$title,$url,$content=null){$data=['title'=>$title,'url'=>$url];if(!empty($content)){$data['content']=$content;}return $this->db->table('bf_marketing_temp_scraper')->where('id',$id)->update($data);}public function updateExchangeToken($id,$data){return $this->update($id,$data);}public function updateNotification($data){return $this->db->table('bf_users_promotional_messages')->update($data);}public function updateSchedule($id,$data){return $this->db->table('bf_marketing_schedule')->where('id',$id)->update($data);}public function updatePostStatus($id,$status){return $this->db->table('bf_marketing_schedule')->where('id',$id)->update(['post_status'=>$status,'last_attempt_at'=>date('Y-m-d H:i:s')]);}} ?><?php namespace App\Services;use App\Libraries\{BaseLoader,MyMIMarketing};use App\Models\{MarketingModel};use GuzzleHttp\Client;class MarketingService{use BaseLoader;protected $MyMIMarketing;protected $marketingModel;protected $httpClient;public function __construct(){$this->MyMIMarketing=new MyMIMarketing();$this->marketingModel=new MarketingModel();$this->httpClient=new Client(['timeout'=>5,'stream'=>true,'http_errors'=>false,'headers'=>['User-Agent'=>'MyMI Content Bot','Accept-Encoding'=>'gzip, deflate, br',]]);}public function distributeContent($platform,$message){switch($platform){case 'discord':return $this->sendToDiscordWebhook($message);case 'facebook':return $this->sendToZapier('facebook',$message);case 'linkedin':return $this->sendToZapier('linkedin',$message);default:return false;}}public function extractTopKeywords($summary){return $this->getMyMIMarketing()->extractKeywords($summary['summary']);}public function fetchUnprocessedEmailSummaries(){return $this->getMyMIMarketing()->getEmailSummariesForReview();}public function getEmailRecordById($id){return $this->marketingModel->getEmailRecordById($id);}public function getFeatures(){$getFeatures=$this->getMyMIMarketing()->getFeatures();return $getFeatures;}public function gatherKeywordBasedContent($keywords){$allContent=[];foreach($keywords as $keyword){$secData=$this->getMyMIMarketing()->scrapeGoogleSearch("SEC filings {$keyword}");$alphaVantageData=$this->getMyMIMarketing()->scrapeGoogleSearch("AlphaVantage {$keyword}");$googleData=$this->getMyMIMarketing()->scrapeGoogleSearch($keyword,$this->httpClient);$internalData=$this->getMyMIMarketing()->getScrapesByKeyword($keyword);$allContent[]=array_merge([$secData],[$alphaVantageData],[$googleData],$internalData);}return $allContent;}public function generateContentFromPost($title,$content,$tags){$summaryData=$this->getMyMIMarketing()->summarizeContent($content);if(empty($summaryData)||empty($summaryData['summary'])){log_message('error','generateContentFromPost() failed to generate summary.');return null;}return $this->getMyMIMarketing()->generatePlatformContent($summaryData['summary'],$tags);}public function generateFinalContentFromTemp(){$records=$this->marketingModel->getTopTempRecords(5);foreach($records as $record){if(empty($record['title'])||empty($record['content']))continue;$summary=$this->summarizeContent($record['content']);$socialMediaPost=$this->generateSocialPost($summary);$final=['title'=>$record['title'],'content'=>$summary,'post_text'=>$socialMediaPost,'source'=>'email','created_at'=>date('Y-m-d H:i:s'),];$this->marketingModel->insertFinalScraper($final);}}public function generatePlatformPosts($content){$summaryText=implode(" ",array_column($content,'content'));return $this->getMyMIMarketing()->generateContentFromLargeText($summaryText,[]);}public function getManagementTeam(){$getManagementTeam=$this->getMyMIMarketing()->getManagementTeam();return $getManagementTeam;}public function getMarketingData($accountid,$category,$platform){$data=[];if($category&&$accountid){$scrapedData=$this->getMyMIMarketing()->scrapeTokenContentByAccountId($accountid);if($scrapedData){$data['generatedData']=$this->getMyMIMarketing()->generateContentFromScrapedData($scrapedData,$platform);}else{$data['generatedData']=[];}}return $data;}public function getPromotionalBanners($userId){return $this->getMyMIMarketing()->fetchPromotionalBanners($userId);}public function getRecentGeneratedContent($limit=10){return $this->db->table('bf_marketing_scraper')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function regeneratePostsFromEmailId($id){$record=$this->getEmailRecordById($id);if(!$record||empty($record['content'])){log_message('error',"âŒ Email record not found or empty for ID: $id");return null;}$processed=$this->getMyMIMarketing()->generateContentFromRaw($record);if($processed){$this->marketingModel->insertFinalScraper($record,$processed);$this->marketingModel->markEmailsAsProcessed([$id]);return $processed;}return null;}public function sanitizeAndSummarize($content){$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($content);return $this->getMyMIMarketing()->summarizeContent($cleanedBody);}public function storeGeneratedPostsForDashboard($posts){$this->getMyMIMarketing()->storeGeneratedContent(['primary_content'=>$posts['summary'],'social_media_content'=>json_encode($posts['platforms_content']),'status'=>'Generated','created_on'=>date('Y-m-d H:i:s'),]);}protected function sendToDiscordWebhook($message){$webhook=getenv('DISCORD_WEBHOOK_URL');if(!$webhook)return false;$client=\Config\Services::curlrequest();$payload=['content'=>$message];$response=$client->post($webhook,['json'=>$payload]);return $response->getStatusCode()===204;}protected function sendToZapier($platform,$message){$zapierHooks=['facebook'=>getenv('ZAPIER_FACEBOOK_WEBHOOK'),'linkedin'=>getenv('ZAPIER_LINKEDIN_WEBHOOK'),];$hook=$zapierHooks[$platform]?? null;if(!$hook)return false;$client=\Config\Services::curlrequest();$payload=['message'=>$message,'platform'=>$platform];$response=$client->post($hook,['json'=>$payload]);return $response->getStatusCode()===200;}public function storeScrapedContent($content){foreach($content as $data){$this->getMyMIMarketing()->storeTempScrapedData(['title'=>$data['title'],'content'=>$data['content'],'scraped_at'=>date('Y-m-d H:i:s'),'type'=>'keyword_summary',]);}}} ?><?php namespace App\Modules\APIs\Controllers;use CodeIgniter\Controller;use App\Modules\APIs\Controllers\MarketingController;use App\Libraries\{BaseLoader,MyMIAlerts,MyMIMarketing};use App\Models\{AlertsModel,ExchangeModel,MarketingModel,ReferralModel,SupportModel,UserModel};use App\Services\{MarketingService};use CodeIgniter\API\ResponseTrait;class ManagementController extends UserController{use BaseLoader;use ResponseTrait;protected $alertManager;protected $MyMIMarketing;protected $marketingService;protected $alertsModel;protected $exchangeModel;protected $marketingModel;protected $userModel;protected $referralModel;protected $supportModel;public function __construct(){$this->alertManager=new MyMIAlerts();$this->MyMIMarketing=new MyMIMarketing();$this->alertsModel=new AlertsModel();$this->exchangeModel=new ExchangeModel();$this->marketingModel=new MarketingModel();$this->marketingService=new MarketingService();$this->referralModel=new ReferralModel();$this->supportModel=new SupportModel();$this->userModel=new UserModel();}public function runCRONTasks(){log_message('info','ðŸ› ï¸ ManagementController::runCRONTasks() initiated.');$marketingController=new MarketingController();log_message('info','ðŸ“Œ Step 1: cronFetchAndGenerateNews()');try{$marketingController->cronFetchAndGenerateNews();}catch(\Throwable $e){log_message('error','âŒ cronFetchAndGenerateNews failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 3: generateDailyContentDigest()');try{$todayNews=$this->marketingModel->getTodaysScrapedContent();if(!empty($todayNews)){$marketingController->generateDailyContentDigest();}else{log_message('info','ðŸ›‘ Skipping summary generation â€” no scraped news available today.');}}catch(\Throwable $e){log_message('error','âŒ generateDailyContentDigest() failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 4: cronFetchInbox()');try{$marketingController->cronFetchInbox();}catch(\Throwable $e){log_message('error','âŒ cronFetchInbox() failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 5: cronAnalyzeContent()');try{$marketingController->cronAnalyzeContent();}catch(\Throwable $e){log_message('error','âŒ cronAnalyzeContent() failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 6: reprocessIncompleteEmails()');try{$marketingController->runBackfillForTempEmails();}catch(\Throwable $e){log_message('error','âŒ reprocessIncompleteEmails() failed: '.$e->getMessage());}log_message('info','âœ… ManagementController::runCRONTasks() completed.');}public function ajaxGetActiveUsers(){log_message('debug','ðŸ“¥ ajaxGetActiveUsers() called.');$request=service('request');$post=$request->getPost();log_message('debug','ðŸ“¦ Incoming POST: '.print_r($post,true));$start=$post['start']?? 0;$length=$post['length']?? 10;$search=$post['search']['value']?? '';$records=$this->userModel->getUsersByStatus(1,$search);$totalRecords=count($records);$records=array_slice($records,$start,$length);$data=[];foreach($records as $user){try{$actionView=view('ManagementModule\Views\Users\partials\action_buttons',['user'=>$user]);}catch(\Throwable $e){log_message('error','âŒ Error rendering action_buttons view for user ID '.$user['id'].': '.$e->getMessage());$actionView='<span class="text-danger">View Error</span>';}$data[]=['id'=>'<a href="'.site_url('Management/Users/Profile/'.$user['username']).'">'.$user['id'].'</a>','type'=>$user['type'],'name'=>$user['first_name'].' '.$user['last_name'].' '.$user['name_suffix'],'email'=>'<a href="mailto:'.$user['email'].'">'.$user['email'].'</a>','location'=>$user['city'].', '.$user['state'],'referral_code'=>$user['referral_code'],'actions'=>$actionView,];}return $this->response->setJSON(['draw'=>intval($post['draw']?? 1),'recordsTotal'=>$totalRecords,'recordsFiltered'=>$totalRecords,'data'=>$data,]);}public function ajaxGetInactiveUsers(){log_message('debug','ðŸ“¥ ajaxGetInactiveUsers() called.');$request=service('request');$post=$request->getPost();log_message('debug','ðŸ“¦ Incoming POST: '.print_r($post,true));$start=$post['start']?? 0;$length=$post['length']?? 10;$search=$post['search']['value']?? '';$records=$this->userModel->getUsersByStatus(0,$search);$totalRecords=count($records);$records=array_slice($records,$start,$length);$data=[];foreach($records as $user){try{$actionView=view('ManagementModule\Views\Users\partials\action_buttons',['user'=>$user]);}catch(\Throwable $e){log_message('error','âŒ Error rendering action_buttons view for user ID '.$user['id'].': '.$e->getMessage());$actionView='<span class="text-danger">View Error</span>';}$data[]=['id'=>'<a href="'.site_url('Management/Users/Profile/'.$user['username']).'">'.$user['id'].'</a>','type'=>$user['type'],'name'=>$user['first_name'].' '.$user['last_name'].' '.$user['name_suffix'],'email'=>'<a href="mailto:'.$user['email'].'">'.$user['email'].'</a>','location'=>$user['city'].', '.$user['state'],'referral_code'=>$user['referral_code'],'actions'=>$actionView,];}return $this->response->setJSON(['draw'=>intval($post['draw']?? 1),'recordsTotal'=>$totalRecords,'recordsFiltered'=>$totalRecords,'data'=>$data,]);}protected function arrayToXml(array $data,\SimpleXMLElement $xml){foreach($data as $key=>$value){is_array($value)?$this->arrayToXml($value,$xml->addChild($key)):$xml->addChild($key,htmlspecialchars($value));}return $xml;}public function checkForSpamUsers(){try{$MyMIUser=new \App\Libraries\MyMIUser();$spamAccounts=$MyMIUser->findPotentialSpamUsers();return $this->response->setJSON(['status'=>'success','message'=>count($spamAccounts).' spam accounts detected.','data'=>$spamAccounts]);}catch(\Throwable $e){log_message('error','âŒ Error checking spam users: '.$e->getMessage());return $this->failServerError('Failed to check for spam accounts.');}}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);log_message('debug','âœ… Content digest completed.');}public function cronFetchAndGenerateNews(){try{$this->getMyMIMarketing()->cronFetchAndGenerateNews();return $this->response->setJSON(['status'=>'success','message'=>'MarketAux news pulled, ranked, and content generated.']);}catch(\Throwable $e){return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();log_message('debug','âœ… Inbox scrape completed.');}public function cronFetchMarketingEmails(){log_message('info','CRON: Starting Marketing Email Fetch');$service=new MarketingService();$emailsFetched=$service->fetchAndStoreMarketingEmails();log_message('info','CRON: Fetched '.$emailsFetched.' marketing emails');return $this->respond(['status'=>'success','fetched'=>$emailsFetched]);}public function cronFetchAndStoreEmails(){try{$this->logMessage('ðŸ“¥ [CRON] Started cronFetchAndStoreEmails');$marketingService=$this->getMarketingService();$fetched=$marketingService->scrapeInboxAndStore();$this->logMessage("ðŸ“© [CRON] Fetched and stored {$fetched} emails into bf_marketing_temp_scraper");return $this->respond(['status'=>'success','stored'=>$fetched]);}catch(\Throwable $e){log_message('error','[CRON] Error in cronFetchAndStoreEmails: '.$e->getMessage());return $this->failServerError('Failed to fetch emails');}}public function distributeTodaysNewsContent(){$generated=$this->generateTodaysNewsSummary();$result=$this->getMyMIMarketing()->sendToZapier($generated['content']);return $this->response->setJSON(['status'=>'success','message'=>'Content distributed via Zapier.','zapier_result'=>$result]);}public function exportPostJson($id){$post=$this->marketingModel->getGeneratedPostById($id);if(!$post||empty($post['posts'])){return $this->failNotFound('Post not found.');}$posts=json_decode($post['posts'],true);$export=['title'=>$post['title'],'summary'=>$post['summary'],'cta'=>'Check it out at https://mymiwallet.com','keywords'=>explode(',',$post['keywords']?? ''),'platform_captions'=>$posts,];return $this->response->setHeader('Content-Type','application/json')->setHeader('Content-Disposition','attachment; filename="canva_post_'.$id.'.json"')->setJSON($export);}public function fetchAlphaVantageNewsForTradeAlerts(){$alerts=$this->alertsModel->getTradeAlertsWithCreatedFlag();log_message('info','ðŸ“ˆ Processing '.count($alerts).' trade alerts.');foreach($alerts as $alert){try{log_message('info','ðŸ” Fetching AlphaVantage news for: '.$alert['ticker']);$newsItems=$this->alertManager->fetchAlphaVantageNews($alert['ticker']);log_message('info','ðŸ“° '.count($newsItems).' news items fetched for '.$alert['ticker']);foreach($newsItems as $news){$this->marketingModel->insertNewsContent($news,$alert['ticker']);}}catch(\Throwable $e){log_message('error','âŒ AlphaVantage fetch failed for '.$alert['ticker'].': '.$e->getMessage());}}return $this->response->setJSON(['status'=>'success','message'=>'Financial news processed for alerts.']);}public function fetchEmailsToTempScraper(){try{log_message('info','ðŸ“¥ Starting email scrape to bf_marketing_temp_scraper...');$this->getMyMIMarketing()->fetchAndStoreEmails('news');log_message('info','ðŸ“¬ Number of emails fetched: '.count($emails));return $this->response->setJSON(['status'=>'success','message'=>'Emails stored successfully.']);}catch(\Throwable $e){log_message('error','âŒ fetchEmailsToTempScraper error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function fetchNewsEmails(){log_message('info','ðŸ“¥ fetchNewsEmails - Started.');try{$this->getMyMIMarketing()->fetchAndStoreEmails('news');return $this->response->setJSON(['status'=>'success','message'=>'News emails fetched successfully.']);}catch(\Exception $e){log_message('error','âŒ fetchNewsEmails - Error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function forceFetchEmails(){try{$result=$this->alertManager->fetchAndStoreEmails();return $this->response->setJSON(['status'=>'success','message'=>'Emails fetched and processed successfully.']);}catch(\Exception $e){return $this->response->setJSON(['status'=>'error','message'=>'Error fetching emails: '.$e->getMessage()],500);}}public function generateContentDigestFromStored(){log_message('info','Marketing: Starting summary generation from stored marketing emails.');$model=new MarketingModel();$records=$model->getRecentUnprocessedTempEmails(5);$results=[];foreach($records as $record){if(empty($record['title'])||empty($record['content'])){log_message('debug','Skipped record due to missing title/content ID: '.$record['id']);continue;}try{$summary=$this->getMarketingService()->generateContentFromRaw($record['title'],$record['content']);$model->storeFinalMarketingContent(['source_id'=>$record['id'],'title'=>$record['title'],'summary'=>$summary,'created_at'=>date('Y-m-d H:i:s')]);$model->markTempRecordAsProcessed($record['id']);$results[]=$record['title'];}catch(\Throwable $e){log_message('error','Failed to process record ID '.$record['id'].': '.$e->getMessage());}}return $this->respond(['status'=>'complete','processed_titles'=>$results]);}public function generateContentFromScraper(){log_message('debug','ðŸ” API::MarketingController::generateContentFromScraper called');try{$limit=$this->request->getGet('limit')?? 5;$records=[];$allRecords=$this->marketingModel->getValidUnprocessedEmails($limit);if(!is_array($allRecords)){log_message('error','âŒ $allRecords is not an array or null. Cannot proceed.');return $this->respond(['status'=>'error','message'=>'Failed to fetch records.']);}foreach($allRecords as $record){$titleOk=!empty($record['title']);$contentOk=strlen(strip_tags($record['content']?? ''))>1000;if($titleOk&&$contentOk){$records[]=$record;if(count($records)>=$limit)break;}else{log_message('debug',"âš ï¸ Skipping invalid record ID {$record['id']} during prefilter (Title or content missing/too short).");$this->marketingModel->markEmailsAsProcessed([$record['id']]);}}if(empty($records)){return $this->respond(['status'=>'no_data','message'=>'No unprocessed records found.']);}$processedSummaries=[];foreach($records as $record){$content=$record['content']?? '';$title=$record['title']?? '';$recordId=$record['id']?? 0;if(empty(trim($content))||strlen($content)<1000){log_message('debug',"â­ï¸ Skipping record ID {$recordId} - content too short or empty.");continue;}if(empty(trim($title))){log_message('debug',"â­ï¸ Skipping record ID {$recordId} - missing title.");continue;}if(stripos($content,'<html')!==false&&substr_count($content,'<')>50){log_message('debug',"â­ï¸ Skipping record ID {$recordId} - content likely raw HTML.");continue;}try{$processed=$this->getMarketingService()->generateContentFromRaw($record);if(!is_array($processed)){log_message('debug',"âš ï¸ Skipped record ID {$recordId} - generateContentFromRaw() returned invalid structure.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$this->marketingModel->markEmailsAsProcessed([$recordId]);$processedSummaries[]=['id'=>$recordId,'title'=>$processed['headline']?? $title,'summary'=>$processed['summary']?? '','keywords'=>$processed['keywords']??[],];}catch(\Throwable $e){log_message('error',"âŒ Failed to process record ID {$recordId}: {$e->getMessage()}");}}return $this->respond(['status'=>'success','message'=>count($processedSummaries).' records processed successfully.','data'=>$processedSummaries]);}catch(\Throwable $e){log_message('error','âŒ API::generateContentFromScraper error - '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function generateDailyContentDigest(){log_message('debug','ðŸ§  Start Memory Usage: '.memory_get_usage(true));@ini_set('memory_limit','768M');$limit=5;$summary=[];try{$records=$this->marketingModel->getValidUnprocessedEmails($limit);if(!is_array($records)||empty($records)){log_message('info','ðŸš« No valid records returned from getValidUnprocessedEmails().');return $this->response->setJSON(['status'=>'no_data','message'=>'No valid records to process.']);}foreach($records as $record){$recordId=$record['id']?? 0;$title=$record['title']?? '';$content=$record['content']?? '';$contentSize=strlen(strip_tags($content));if(empty(trim($title))||$contentSize<1000){log_message('debug',"âš ï¸ Skipping record ID {$recordId} â€” title missing or content too short ({$contentSize} chars).");$this->marketingModel->markEmailsAsProcessed([$recordId]);continue;}if(stripos($content,'<html')!==false&&substr_count($content,'<')>50){log_message('debug',"â­ï¸ Skipping record ID {$recordId} â€” likely raw HTML content.");$this->marketingModel->markEmailsAsProcessed([$recordId]);continue;}try{gc_collect_cycles();$processed=$this->getMarketingService()->generateContentFromRaw($record);if(!is_array($processed)){log_message('warning',"âš ï¸ Skipped record ID {$recordId} â€” generateContentFromRaw() returned invalid result.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$this->marketingModel->markEmailsAsProcessed([$recordId]);$summary[]=['title'=>$processed['headline']?? 'Untitled','summary'=>$processed['summary']?? '','subtopics'=>$processed['subtopics']??[],'platform_posts'=>$processed['posts']??[],];}catch(\Throwable $e){log_message('error',"âŒ Error processing record ID {$recordId}: {$e->getMessage()}");}}log_message('debug','ðŸ Peak Memory Usage: '.memory_get_peak_usage(true));return $this->response->setJSON(['status'=>'success','digest'=>$summary]);}catch(\Throwable $e){log_message('error','âŒ generateDailyContentDigest fatal error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function generateRankedMarketingContent(){$this->getMyMIMarketing()->generateRankedMarketingContent();return $this->response->setJSON(['status'=>'success','message'=>'Ranked content generated.']);}public function getBalanceSheet($symbol,$apikey){$url="https://www.alphavantage.co/query?function=BALANCE_SHEET&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getCashFlowStatement($symbol,$apikey){$url="https://www.alphavantage.co/query?function=CASH_FLOW&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getCompanyOverview($symbol,$apikey){$url="https://www.alphavantage.co/query?function=OVERVIEW&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getEarningsCalendar($apikey,$horizon='3month'){$url="https://www.alphavantage.co/query?function=EARNINGS_CALENDAR&horizon=".$horizon."&apikey=".$apikey;$csv=file_get_contents($url);$lines=explode("\n",trim($csv));$data=array_map('str_getcsv',$lines);return $data;}public function getFixedWindowAnalytics($symbols,$rangeStart,$rangeEnd,$calculations,$apikey){$url="https://alphavantageapi.co/timeseries/analytics?SYMBOLS=".urlencode($symbols);$url.="&RANGE=".$rangeStart."&RANGE=".$rangeEnd;$url.="&INTERVAL=DAILY&OHLC=close";$url.="&CALCULATIONS=".urlencode($calculations)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getIncomeStatement($symbol,$apikey){$url="https://www.alphavantage.co/query?function=INCOME_STATEMENT&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getInsiderTransactions($symbol,$apikey){$url="https://www.alphavantage.co/query?function=INSIDER_TRANSACTIONS&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getNewsSentiment($apikey,$tickers='',$topics='',$time_from='',$time_to='',$sort='LATEST',$limit=50){$url="https://www.alphavantage.co/query?function=NEWS_SENTIMENT";$url.="&tickers=".urlencode($tickers);$url.="&topics=".urlencode($topics);if($time_from)$url.="&time_from=".$time_from;if($time_to)$url.="&time_to=".$time_to;$url.="&sort=".$sort."&limit=".$limit."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getSlidingWindowAnalytics($symbols,$range,$windowSize,$calculations,$apikey){$url="https://alphavantageapi.co/timeseries/running_analytics?SYMBOLS=".urlencode($symbols);$url.="&RANGE=".$range."&INTERVAL=DAILY&OHLC=close";$url.="&WINDOW_SIZE=".$windowSize;$url.="&CALCULATIONS=".urlencode($calculations)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function generatePostsFromSummary($summaryId=null){try{$summary=$this->marketingModel->find($summaryId);if(!$summary){return $this->failNotFound('Summary not found.');}$decodedTitleRaw=$summary['title']?? '';$decodedSummaryRaw=$summary['summary']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$decodedSummary=quoted_printable_decode($decodedSummaryRaw);$cleanedSummary=html_entity_decode(strip_tags($decodedSummary));$keywords=$this->MyMIMarketing->extractKeywords($cleanedSummary);$posts=$this->MyMIMarketing->generateSocialPosts($cleanedSummary,$keywords);$this->marketingModel->update($summaryId,['keywords'=>json_encode($keywords),'posts'=>json_encode($posts),]);return $this->respond(['status'=>'success','message'=>'Content generated and stored successfully.','original'=>$summary,'cleaned'=>['title'=>$decodedTitle,'summary'=>$cleanedSummary,'keywords'=>$keywords,'posts'=>$posts,],]);}catch(\Throwable $e){log_message('error','âŒ generatePostsFromSummary() failed: '.$e->getMessage());return $this->failServerError('Error generating posts.');}}public function testTfIdfPipeline(){$samples=['Short unstructured','This is a valid test document with enough content and structure to process correctly.','     ','<html><body>Broken HTML without substance</body></html>','Here is another test input to validate TF-IDF scoring logic.',];foreach($samples as $i=>$text){$summary=$this->MyMIMarketing->summarizeText($text);$keywords=$this->MyMIMarketing->extractKeywords($text);$scorePreview=$this->MyMIMarketing->getTopKeywordScores($text,5);log_message('debug',"ðŸ§ª Test #{$i} | Summary: {$summary}");log_message('debug',"ðŸ§ª Test #{$i} | Keywords: ".implode(',',$keywords));log_message('debug',"ðŸ“Š Test #{$i} | TF-IDF Scores: ".print_r($scorePreview,true));}return $this->respond(['status'=>'ok','message'=>'TF-IDF test pipeline ran successfully.']);}public function generateTodaysNewsSummary(){$todayNews=$this->marketingModel->getTodaysNewsContent();$summary=$this->getMyMIMarketing()->summarizeMultipleArticles($todayNews);$content=$this->getMyMIMarketing()->generateMarketingContent($summary);return $this->response->setJSON(['status'=>'success','summary'=>$summary,'content'=>$content]);}public function generateTodaysStory(){ini_set('memory_limit','1024M');try{log_message('info','ðŸ” Starting email scrape for news@mymiwallet.com...');$this->getMyMIMarketing()->fetchAndStoreEmails('news');$today=date('Y-m-d');$scrapes=$this->marketingModel->getScrapesByDate($today,10);if(empty($scrapes)){log_message('info','No scraped emails found for today.');return $this->response->setJSON(['status'=>'error','message'=>'No emails found for today.'],404);}$summaries=[];foreach(array_chunk($scrapes,10)as $scrapeChunk){foreach($scrapeChunk as $scrape){$content=$scrape['email_body']?? $scrape['content']?? '';log_message('info','Content size: '.strlen($content));$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($content);$summary=$this->getMyMIMarketing()->summarizeContent($cleanedBody);log_message('debug','Memory after summary: '.memory_get_usage(true));if(is_array($summary)){$summary=$summary['summary']?? implode('. ',array_map('strval',$summary));}$summaries[]=$summary;}}$combinedSummary=implode("\n\n",$summaries);if(strlen($combinedSummary)>500000){log_message('warning','Combined summary too long. Truncating...');$combinedSummary=substr($combinedSummary,0,500000);}$todayTitle="Today's Top Stories - ".date('F j, Y');$data=['title'=>$todayTitle,'content'=>$combinedSummary,'links'=>json_encode([]),'url'=>'','type'=>'todays_story','scraped_at'=>date('Y-m-d H:i:s'),'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeTempScrapedData($data);log_message('info','âœ… Todayâ€™s story generated and stored.');return $this->response->setJSON(['status'=>'success','message'=>'Todayâ€™s story generated and stored successfully!','title'=>$todayTitle,'summary'=>$combinedSummary]);}catch(\Throwable $e){log_message('error','âŒ generateTodaysStory error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function generateVoiceScriptManually(){try{log_message('info','ðŸŽ¤ generateVoiceScriptManually() triggered.');$script=$this->getMyMIMarketing()->generateVoiceoverScript();return $this->response->setJSON(['status'=>'success','script'=>$script]);}catch(\Throwable $e){log_message('error','âŒ Error in generateVoiceScriptManually: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()]);}}public function getAlerts(){log_message('debug','ðŸ” getAlerts called');try{$alerts=$this->alertsModel->getAllTradeAlerts();log_message('debug','âœ… getAlerts retrieved '.count($alerts).' alerts.');return $this->response->setJSON($alerts);}catch(\Throwable $e){log_message('error','âŒ getAlerts error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getAssets(){log_message('debug','ðŸ“Š getAssets called');try{$assets=$this->exchangeModel->getManagementAssets();log_message('debug','âœ… getAssets retrieved '.count($assets).' assets.');return $this->response->setJSON($assets);}catch(\Throwable $e){log_message('error','âŒ getAssets error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getNews(){log_message('debug','ðŸ“° getNews called');try{$news=$this->marketingModel->getNewsAlerts();log_message('debug','âœ… getNews retrieved '.count($news).' news records.');return $this->response->setJSON($news);}catch(\Throwable $e){log_message('error','âŒ getNews error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getReferrals(){log_message('debug','ðŸ” getReferrals called');try{$referrals=$this->referralModel->getAllReferrals();log_message('debug','âœ… getReferrals retrieved '.count($referrals).' referrals.');return $this->response->setJSON($referrals);}catch(\Throwable $e){log_message('error','âŒ getReferrals error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getSupport(){log_message('debug','ðŸ§¾ getSupport called');try{$support=$this->supportModel->getManagementSupport();log_message('debug','âœ… getSupport retrieved '.count($support).' support records.');return $this->response->setJSON($support);}catch(\Throwable $e){log_message('error','âŒ getSupport error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getTopMovers($apikey){$url="https://www.alphavantage.co/query?function=TOP_GAINERS_LOSERS&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getUpcomingIPOs($apikey){$url="https://www.alphavantage.co/query?function=IPO_CALENDAR&apikey=".$apikey;$csv=file_get_contents($url);$lines=explode("\n",trim($csv));$data=array_map('str_getcsv',$lines);return $data;}public function getUsers(){log_message('debug','ðŸ” getUsers called');}public function massResendActivationEmails(){$users=$this->userModel->getPendingActivationUsers();$activator=service('activator');$emailer=\Config\Services::email();$successCount=0;$failureCount=0;foreach($users as $user){$sent=$activator->send($user);if($sent){$successCount++;log_message('info',"Activation email sent to: {$user->email}");}else{$failureCount++;log_message('error',"Failed to send activation email to: {$user->email}");}}$summary="{$successCount} emails sent successfully, {$failureCount} failed.";return redirect()->to('/Management/Users')->with('message',$summary);}public function processAllTradeAlerts(){try{log_message('info','âš¡ Management API - processAllTradeAlerts triggered.');$this->alertManager->fetchAndStoreAlertsEmails();$this->alertManager->processTradeAlertsInBatches(50);$this->alertManager->updateAlerts();return $this->response->setJSON(['status'=>'success','message'=>'All trade alerts processed successfully.']);}catch(\Exception $e){log_message('error','âŒ Management API - Error processing trade alerts: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function processAndGenerateMarketingContent(){$emails=$this->getMarketingService()->fetchUnprocessedEmailSummaries();if(!empty($emails)&&is_array($emails)){foreach($emails as $email){$cleanContent=$this->getMarketingService()->sanitizeAndSummarize($email['email_body']);$keywords=$this->getMyMIMarketing()->extractTopKeywords($cleanContent);$externalContent=$this->getMarketingService()->gatherKeywordBasedContent($keywords);$this->getMarketingService()->storeScrapedContent($externalContent);$generatedPosts=$this->getMarketingService()->generatePlatformPosts($externalContent);$this->getMarketingService()->storeGeneratedPostsForDashboard($generatedPosts);}}return redirect()->to('/Management/Marketing')->with('message','Content generation completed.');}public function processTempEmailsToScraper(){try{log_message('info','âš™ï¸ Starting content generation from bf_marketing_temp_scraper...');$tempEmails=$this->marketingModel->getRecentScrapes();foreach($tempEmails as $email){$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($email->email_body);$summary=$this->getMyMIMarketing()->summarizeContent($cleanedBody);$keywords=$this->marketingModel->extractKeywords($email->email_body);$hashtags=$this->marketingModel->mapToContextualHashtags($keywords);$data=['title'=>$email->email_subject ?? 'Generated Content','summary'=>is_array($summary)?implode("\n",$summary):$summary,'content'=>$email->email_body,'tags'=>implode(',',$keywords),'type'=>'Email/Newsletters','status'=>'pending','created_on'=>date('Y-m-d H:i:s'),'author_information'=>$email->email_sender,];$this->marketingModel->saveDailyLog($data);}log_message('info','âœ… Finished processing and saving to bf_marketing_scraper.');return $this->response->setJSON(['status'=>'success','message'=>'Content generated and saved to bf_marketing_scraper.',]);}catch(\Throwable $e){log_message('error','âŒ processTempEmailsToScraper error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function reprocessIncompleteEmails(){try{$this->getMyMIMarketing()->reprocessIncompleteEmails();return $this->response->setJSON(['status'=>'success','message'=>'Backfilled incomplete emails.']);}catch(\Throwable $e){log_message('error','âŒ reprocessIncompleteEmails error: '.$e->getMessage());return $this->failServerError('Failed to reprocess incomplete emails.');}}public function runCronManually(){$this->runCRONTasks();return $this->response->setJSON(['status'=>'success','message'=>'Manual CRON execution complete.']);}public function runDailyAlphaVantageDataPipeline(){$symbols=$this->alertsModel->getTopWatchlistSymbols();$apikey=getenv('ALPHA_VANTAGE_KEY');foreach($symbols as $symbol){$this->fetchAlphaVantageNewsForTradeAlerts($symbol['symbol'],$apikey);$this->getCompanyOverview($symbol['symbol'],$apikey);$this->getIncomeStatement($symbol['symbol'],$apikey);}return $this->response->setJSON(['status'=>'success','message'=>'Daily Alpha Vantage data pipeline completed.']);}public function sendToZapierManually(){$summary=$this->generateTodaysNewsSummary();$result=$this->getMyMIMarketing()->sendToZapier($summary['content']);return $this->response->setJSON(['status'=>'success','message'=>'Sent manually to Zapier.','result'=>$result]);}public function scrapeAndGenerateTodaysStoryFromInbox(){try{log_message('info','ðŸ“¥ Starting inbox scrape for news@mymiwallet.com...');$this->getMyMIMarketing()->fetchAndStoreEmails('news');$today=date('Y-m-d');$scrapes=$this->marketingModel->getScrapesByDate($today);if(empty($scrapes)){log_message('info','ðŸ“­ No emails found for today.');return $this->response->setJSON(['status'=>'error','message'=>'No emails found for today.'],404);}$summaries=[];foreach($scrapes as $scrape){$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($scrape['content']);$summary=$this->getMyMIMarketing()->summarizeContent($cleanedBody);if(is_array($summary)){$summary=$summary['summary']?? implode('. ',array_map('strval',$summary));}$summaries[]=$summary;}$combinedSummary=implode("\n\n",$summaries);if(strlen($combinedSummary)>500000){log_message('warning','Combined summary too long. Truncating...');$combinedSummary=substr($combinedSummary,0,500000);}$todayTitle="Today's News Highlights - ".date('F j, Y');$data=['title'=>$todayTitle,'content'=>$combinedSummary,'links'=>json_encode([]),'url'=>'','type'=>'todays_story','scraped_at'=>date('Y-m-d H:i:s'),'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeTempScrapedData($data);log_message('info','âœ… Todayâ€™s story generated and stored.');return $this->response->setJSON(['status'=>'success','message'=>'Todayâ€™s story generated and stored successfully!','title'=>$todayTitle,'summary'=>$combinedSummary]);}catch(\Throwable $e){log_message('error','âŒ scrapeAndGenerateTodaysStoryFromInbox error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function sharePost($id,$platform){try{$post=$this->marketingModel->getGeneratedPostById($id);if(!$post||empty($post['posts'])){return $this->failNotFound('Post not found or invalid.');}$posts=json_decode($post['posts'],true);$message=$posts[$platform]?? null;if(!$message){return $this->failValidationError("No formatted message found for platform: $platform");}$success=$this->getMarketingService()->distributeContent($platform,$message);if($success){return $this->respond(['status'=>'success','message'=>'Post shared.']);}else{return $this->failServerError('Failed to dispatch post.');}}catch(\Throwable $e){log_message('error',"[PostShare] Error: ".$e->getMessage());return $this->failServerError('An unexpected error occurred.');}}public function sendAllDiscordAlerts(){$alerts=$this->alertsModel->getAlertsWithNewTVChart();if(empty($alerts)){return $this->response->setJSON(['status'=>'error','message'=>'No new alerts to send.'],404);}foreach($alerts as $alert){$this->alertManager->sendDiscordNotification($alert);}return $this->response->setJSON(['status'=>'success','message'=>'All Discord notifications sent.']);}public function updateMarketDataForAlerts(){try{$this->alertManager->updateAlerts();return $this->response->setJSON(['status'=>'success','message'=>'Trade alerts updated with market data.']);}catch(\Exception $e){return $this->response->setJSON(['status'=>'error','message'=>'Failed to update market data: '.$e->getMessage()],500);}}} ?><?php $managementActionItems=$siteSettings->managementActionItems;$department=$uri->getSegment(2);$viewFileData=['managementActionItems'=>$managementActionItems,'targetUsers'=>$targetUsers ?? 0,'totalActiveUsers'=>$totalActiveUsers ?? 0,'totalActivePartners'=>$totalActivePartners ?? 0,'totalActiveCampaigns'=>$totalActiveCampaigns ??[],'getTasksByDepartment'=>$getTasksByDepartment ??[],'totalDepartmentTasks'=>$totalDepartmentTasks ??[],'totalPageSEOTasks'=>$totalPageSEOTasks ??[],'totalTransFees'=>$totalTransFees ?? 0,'totalLastTransFees'=>$totalLastTransFees ?? 0,'usersPercentage'=>$usersPercentage ?? 0,'getActiveCampaigns'=>$getActiveCampaigns ??[],'totalApprovedAssets'=>$totalApprovedAssets ?? 0,'totalPendingAssets'=>$totalPendingAssets ?? 0,'userGoals'=>$userGoals ??[],'newsUpdates'=>$newsUpdates ??[],'getBlogPosts'=>$getBlogPosts ??[],'recentMarketingPosts'=>$recentMarketingPosts ??[],'todaysStory'=>$todaysStory ??[],]; ?><div class="nk-block"><div class="row gy-gs"><div class="col-lg-12"><div class="nk-block-head-xs"><div class="nk-block-head-content"><h1 class="title nk-block-title">MyMI Management -<?=esc($department)?></h1><a href="<?=site_url('/Management')?>">â† Back to Management Dashboard</a></div></div></div><div class="col-12 col-xxl-4"><?=view('ManagementModule\Views\Marketing\index\action_center_new',$viewFileData)?></div><div class="col-12 col-xxl-8"><?=view('ManagementModule\Views\Marketing\index\most_recent_content',$viewFileData)?></div><div class="col-12"><?php  ?></div><div class="col-12"><?php  ?></div><div class="col-12 col-xxl-6"><?=view('ManagementModule\Views\Marketing\resources\controlPanelBlock',$viewFileData)?><?php  ?></div><div class="col-12 col-xxl-6"><?=view('ManagementModule\Views\Marketing\resources\ctaRecommenderModule',$viewFileData)?></div><div class="col-12 col-xxl-12 px-2"><div class="generated-summaries"id="generatedSummariesBlock"><?=view('ManagementModule\Views\Marketing\resources\generatedSummaries',$viewFileData)?></div></div><div class="col-12 mt-3 col-xxl-12"><div class="card card-bordered"><div class="card-inner"><h5 class="title">ðŸ“° Recent Marketing Posts</h5><?php $validPosts=array_filter($recentMarketingPosts,fn($p)=>!empty($p->title));if(!empty($validPosts)): ?><ul class="list-group"><?php foreach($validPosts as $post): ?><li class="d-flex justify-content-between align-items-start flex-column list-group-item"><div class="w-100"><strong><?=esc($post->title?:'(Untitled Post)')?></strong><br><small class="text-muted"><?=date('M d, Y h:i A',strtotime($post->created_at))?></small><br><?php if(!empty($post->short_description)): ?><small class="text-secondary"><?=esc($post->short_description)?>...</small><?php else: ?><small class="text-secondary">No description available.</small><?php endif; ?></div><div class="mt-2"><button class="btn btn-primary btn-sm"onclick='dynamicModalLoader("Marketing","PreviewGeneratedPost","<?=$post->id?>")'>Preview</button></div></li><?php endforeach; ?></ul><?php else: ?><p>No posts with valid titles available yet. Click 'Generate' to create one!</p><?php endif; ?></div></div></div><div class="col-12 mt-3 col-xxl-4"><?=view('ManagementModule\Views\Marketing\index\exchange_action_center',$viewFileData)?></div><div class="col-12 mt-3 col-xxl-8"><?=view('ManagementModule\Views\Marketing\index\target_users',$viewFileData)?></div></div></div><script <?= $nonce['script'] ?? '' ?>></script><div class="nk-block"><div class="nk-block-head"><div class="d-flex justify-content-between align-items-center nk-block-head-content"><h4 class="nk-block-title">ðŸ“¢ Generated Marketing Summaries</h4><div><div class="d-flex justify-content-end mt-3"><label class="form-check form-switch ml-2"><input class="btn btn-lg form-check-input"id="liveModeToggle"type="checkbox"> <span class="form-check-label">Live Mode</span></label></div></div></div><p class="text-soft">This section shows finalized summaries ready for distribution across platforms.</p></div><div class="row"id="generatedSummariesBlock"><?php if(!empty($todaysStory)): ?><?php foreach($todaysStory as $summary): ?><div class="mb-4 col-lg-4 col-md-6"><div class="card h-100 shadow-sm"><div class="d-flex flex-column card-body"><h6 class="title mb-1"><?=esc($summary['title'])?></h6><p class="small mb-2 text-soft"><?=date('F j, Y g:i A',strtotime($summary['created_at']))?></p><div class="small mb-2"><?=esc($summary['summary'])?></div><?php if(!empty($summary['keywords'])): ?><div class="small mb-2 text-muted"><strong>#Tags:</strong><?php foreach(explode(',',$summary['keywords'])as $tag): ?><span class="badge bg-light me-1 text-dark">#<?=trim($tag)?></span><?php endforeach; ?></div><?php endif; ?><?php if(!empty($summary['cta'])): ?><div class="small mb-2 text-primary"><strong>ðŸ“£ CTA:</strong><?=esc($summary['cta'])?></div><?php endif; ?><a href="javascript:void(0);"class="btn btn-primary btn-sm mt-auto"onclick='dynamicModalLoader("/API/Management/PreviewGeneratedPost/<?=$summary['id']?>")'>ðŸ” Preview Post</a></div></div></div><?php endforeach; ?><?php else: ?><div class="col-12"><div class="alert alert-warning">âš ï¸ No summaries available. Click "Generate Todayâ€™s Content" to begin.</div></div><?php endif; ?></div></div><script <?= $nonce['script'] ?? '' ?>>const liveToggle = document.getElementById('liveModeToggle');
app/Modules/Support/Views/index.php:4:<?php foreach ($articles as $slug => $article): ?>
app/Modules/Support/Views/index.php:5:    <li><a href="<?= site_url('Support/Article/' . $slug) ?>"><?= esc($article['title']) ?></a></li>
app/Modules/Support/Controllers/SupportController.php:55:    public function article(string $slug = 'welcome')
app/Modules/Support/Controllers/SupportController.php:58:        $data['article'] = $this->supportModel->findBySlug($slug);
app/Modules/Docs/Controllers/DocsController.php:21:    public function view($slug='')
app/Modules/Docs/Controllers/DocsController.php:23:        $file = $this->resolvePath($slug ?: 'README');
app/Modules/Docs/Controllers/DocsController.php:27:        return view('App\Modules\Docs\Views\doc', ['html'=>$html,'slug'=>$slug]);
app/Modules/Docs/Controllers/DocsController.php:52:            $slug = str_replace(['.md',' '], ['', '-'], $rel);
app/Modules/Docs/Controllers/DocsController.php:53:            $out[] = ['title'=>basename($rel),'slug'=>$slug,'path'=>$f->getPathname()];
app/Modules/Docs/Controllers/DocsController.php:58:    private function resolvePath(string $slug): string
app/Modules/Docs/Controllers/DocsController.php:60:        $slug = trim($slug,'/');
app/Modules/Docs/Controllers/DocsController.php:61:        $p = str_replace('-', ' ', $slug);
app/Modules/ScriptStudio/Controllers/ScriptStudioController.php:191:        $slug = $base;
app/Modules/ScriptStudio/Controllers/ScriptStudioController.php:194:        while ($this->slugExists($slug, $ignoreId)) {
app/Modules/ScriptStudio/Controllers/ScriptStudioController.php:195:            $slug = $base . '-' . $counter;
app/Modules/ScriptStudio/Controllers/ScriptStudioController.php:199:        return $slug;
app/Modules/ScriptStudio/Controllers/ScriptStudioController.php:202:    protected function slugExists(string $slug, ?int $ignoreId = null): bool
app/Modules/ScriptStudio/Controllers/ScriptStudioController.php:205:        $builder->where('slug', $slug);
app/Modules/Management/Views/Marketing/dashboard.txt:1894:            $slug = $this->marketingModel->createSlug($content['title']);
app/Modules/Management/Views/Marketing/dashboard.txt:1899:                'slug'        => $slug,
app/Modules/Management/Views/Marketing/dashboard.txt:2908:    public function viewBlog($slug)
app/Modules/Management/Views/Marketing/dashboard.txt:2910:        $blogPost = $this->marketingModel->getBlogPostBySlug($slug);
app/Modules/Management/Controllers/MarketingController.php:997:            $slug = $this->marketingModel->createSlug($content['title']);
app/Modules/Management/Controllers/MarketingController.php:1002:                'slug'        => $slug,
app/Modules/Management/Controllers/MarketingController.php:2177:    public function viewBlog($slug)
app/Modules/Management/Controllers/MarketingController.php:2179:        $blogPost = $this->marketingModel->getBlogPostBySlug($slug);
app/Modules/Management/Controllers/EmailController.php:89:        $slug = url_title($post['name'], '-', true);
app/Modules/Management/Controllers/EmailController.php:92:            'slug' => $slug,
app/Modules/Blog/Controllers/BlogController.php:117:    public function viewBlog(string $slug)
app/Modules/Blog/Controllers/BlogController.php:119:        $blogPost = $this->blogModel->getPostBySlug($slug);
app/Modules/Blog/Controllers/BlogController.php:122:            log_message('error', 'BlogController::viewBlog - post not found for slug: ' . $slug);
app/Sitemap/Providers/BlogPages.php:23:            $slug = $p->slug ?? ($p['slug'] ?? null);
app/Sitemap/Providers/BlogPages.php:24:            if (! $slug) {
app/Sitemap/Providers/BlogPages.php:28:                'loc'       => '/blog/post/' . $slug,
app/Sitemap/Providers/PublicPages.php:16:            $slug = basename($file, '.php');
app/Sitemap/Providers/PublicPages.php:17:            if (! preg_match('/^[a-zA-Z0-9\-]+$/', $slug)) {
app/Sitemap/Providers/PublicPages.php:20:            $path   = $slug === 'home' ? '/' : '/' . strtolower($slug);

### $next
app/Commands/WebhooksDrain.php:33:                $next = date('Y-m-d H:i:s', time() + $delayMin * 60);
app/Commands/WebhooksDrain.php:38:                    'next_attempt_at'=>$next,
app/Libraries/MyMIAlphaVantage.php:903:                $next = [8, 13, 34, 48][$i];
app/Libraries/MyMIAlphaVantage.php:904:                return ($emaResults[$p] !== null && $emaResults[$next] !== null && $emaResults[$p] > $emaResults[$next]) ? $carry + 1 : $carry;

### $return / $returnTo

### $path / $pathvar

### $url
app/Views/errors/html/error_500.php:6:$url       = $request ? (string) $request->getUri() : ($_SERVER['REQUEST_URI'] ?? '');
app/Views/errors/html/error_500.php:14:// $currentUrl = esc($url);
app/Views/errors/html/error_500.php:25:        . "URL: " . esc($url) . "\nIP: $clientIP\nUser Agent: $userAgent\n"
app/Views/errors/html/error_500.php:37:            'full_url'   => esc($url),
app/Views/errors/html/error_500.php:80:            <pre><?= esc(print_r($url, true)) ?></pre>
app/Commands/EmailIntake.php:151:            $url = rtrim($m[0], '.,);!?"\'');
app/Commands/EmailIntake.php:152:            return ['type'=>'url', 'zillow_url'=>$url];
app/Models/PlaidModel.php:192:        $url = "https://sandbox.plaid.com/accounts/balance/get";
app/Models/PlaidModel.php:198:        $ch = curl_init($url);
app/Models/PlaidModel.php:216:        $url = "https://sandbox.plaid.com/transactions/get";
app/Models/PlaidModel.php:226:        $ch = curl_init($url);
app/Models/MarketingModel.php:139:    public function cacheScrapedLink(string $url, string $content): bool
app/Models/MarketingModel.php:142:            'url'              => $url,
app/Models/MarketingModel.php:150:    public function cacheScrapedLinkWithKeyword(string $url, string $content, string $keyword): void
app/Models/MarketingModel.php:155:                'url' => $url,
app/Models/MarketingModel.php:637:    public function getCachedLink(string $url): ?array
app/Models/MarketingModel.php:641:            ->where('url', $url)
app/Models/MarketingModel.php:1486:            $url     = trim($row['url'] ?? '');
app/Models/MarketingModel.php:1492:            $key = strtolower($title) . '|' . strtolower($url);
app/Models/MarketingModel.php:1502:                'url'      => $url,
app/Models/MarketingModel.php:2262:    public function updateEmailFields($id, $title, $url, $content = null)
app/Models/MarketingModel.php:2264:        $data = ['title' => $title, 'url' => $url];
app/Models/SolanaModel.php:256:        foreach ($urls as $url) {
app/Models/SolanaModel.php:258:                $response = $client->get($url, [
app/Models/SolanaModel.php:273:                    log_message('error', 'Price not found in API response from ' . $url);
app/Models/SolanaModel.php:276:                log_message('error', 'Error fetching token price from ' . $url . ': ' . $e->getMessage());
app/Models/InvestmentModel.php:890:        $url = "https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol={$symbol}&interval=5min&apikey={$apiKey}";
app/Models/InvestmentModel.php:892:        $response = $this->curlrequest->get($url);
app/Models/InvestmentModel.php:1132:        $url = "https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=$symbol&apikey=$apiKey";
app/Models/InvestmentModel.php:1133:        $response = file_get_contents($url);
app/Models/InvestmentModel.php:1409:        $url = "https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol={$symbol}&apikey={$apiKey}";
app/Models/InvestmentModel.php:1412:        $response = $client->get($url, ['timeout' => 30]);
app/Models/DripCampaignModel.php:124:    public function recordEmailClick($id, $url)
app/Models/DripCampaignModel.php:129:            ->set('last_click_url', $url)
app/Models/InvestmentModel-12032024.php:645:        $url = "https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol={$symbol}&interval=5min&apikey={$apiKey}";
app/Models/InvestmentModel-12032024.php:647:        $response = $this->curlrequest->get($url);
app/Models/InvestmentModel-12032024.php:856:        $url = "https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=$symbol&apikey=$apiKey";
app/Models/InvestmentModel-12032024.php:857:        $response = file_get_contents($url);
app/Models/InvestmentModel-12032024.php:1016:        $url = "https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol={$symbol}&apikey={$apiKey}";
app/Models/InvestmentModel-12032024.php:1019:        $response = $client->get($url, ['timeout' => 30]);
app/Models/AlertsModel.php:377:            $url    = 'https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=' . $symbol . '&apikey=' . $apiKey;
app/Models/AlertsModel.php:379:            $response = @file_get_contents($url);
app/Models/AlertsModel.php:641:        $url = "https://data.sec.gov/submissions/CIK{$cik}.json";
app/Models/AlertsModel.php:646:        curl_setopt($ch, CURLOPT_URL, $url);
app/Models/AlertsModel.php:664:        $url    = "https://www.alphavantage.co/query?function=OVERVIEW&symbol={$symbol}&apikey={$apiKey}";
app/Models/AlertsModel.php:665:        $response = file_get_contents($url);
app/Models/AlertsModel.php:734:        $url    = "https://api.twelvedata.com/time_series?symbol={$symbol}&interval=5min&apikey={$apiKey}";
app/Models/AlertsModel.php:735:        $response = file_get_contents($url);
app/Models/AlertsModel.php:757:        $url      = "https://api.polygon.io/v2/aggs/ticker/{$symbol}/range/1/minute/2021-10-14/2021-10-14?apiKey={$apiKey}";
app/Models/AlertsModel.php:758:        $response = file_get_contents($url);
app/Models/AlertsModel.php:785:        $url      = "http://api.marketstack.com/v1/intraday?access_key={$apiKey}&symbols={$symbol}";
app/Models/AlertsModel.php:787:        $response = @file_get_contents($url);
app/Models/AlertsModel.php:813:        $url      = "https://cloud.iexapis.com/stable/stock/{$symbol}/intraday-prices?token={$apiKey}";
app/Models/AlertsModel.php:814:        $response = @file_get_contents($url);
app/Models/AlertsModel.php:2782:    //         $url = "https://www.alphavantage.co/query?function=OVERVIEW&symbol=$symbol&apikey=$apiKey";
app/Models/AlertsModel.php:2784:    //         $response = file_get_contents($url);
app/Models/AlertsModel.php:2947:    //     $url = "https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol={$symbol}&interval=5min&apikey={$apiKey}";
app/Models/AlertsModel.php:2949:    //     $response = file_get_contents($url);
app/Models/AlertsModel.php:3031:    // //                 $url = "{$baseUrl}?{$queryParams}";
app/Models/AlertsModel.php:3034:    // //                 $response = file_get_contents($url);
app/Services/DigiByteService.php:19:    protected function request(string $method, string $url, array $options = [], int $attempts = 3)
app/Services/DigiByteService.php:22:            $resp = $this->http()->request($method, $url, $options + ['timeout' => $this->cfg->timeout]);
app/Services/DigiByteService.php:48:        $url = $this->base()."/get_address_balance/DGB/{$address}";
app/Services/DigiByteService.php:54:        $res = $this->request('get', $url);
app/Services/DigiByteService.php:61:        $url = $this->base()."/get_tx_unspent/DGB/{$address}";
app/Services/DigiByteService.php:62:        return $this->request('get', $url);
app/Services/DigiByteService.php:67:        $url = $this->base()."/send_tx/DGB";
app/Services/DigiByteService.php:68:        return $this->request('post', $url, ['json' => ['tx_hex' => $rawHex]]);
app/Services/APIs/AlphaVantageService.php:31:        $url = "https://www.alphavantage.co/query?{$params}&apikey={$this->alphavantageKey}";
app/Services/APIs/AlphaVantageService.php:32:        $cacheKey = md5($url); // Cache the results to avoid repeated API calls
app/Services/APIs/AlphaVantageService.php:42:            $response = $this->curlRequest->get($url);
app/Services/EtherscanService.php:21:        $url = rtrim($this->cfg->base, '/');
app/Services/EtherscanService.php:24:            $resp = $this->http()->get($url, [
app/Services/BitcoinService.php:21:        $url = rtrim($this->cfg->base, '/').$uri;
app/Services/BitcoinService.php:23:            $resp = $this->http()->request($method, $url, $options + ['timeout' => $this->cfg->timeout]);
app/Services/MarketingScraper.php:11:    public function queueLink(string $url, array $meta = []): bool
app/Services/MarketingScraper.php:17:            'links'       => json_encode([$url]),
app/Services/MarketingScraper.php:18:            'url'         => $url,
app/Services/RealEstateIngestService.php:33:  protected function ingestByUrl(string $url): ?array
app/Services/RealEstateIngestService.php:35:    if (!filter_var($url, FILTER_VALIDATE_URL)) return null;
app/Services/RealEstateIngestService.php:40:    try { $html = (string)$client->get($url)->getBody(); }
app/Services/RealEstateIngestService.php:69:    $host = parse_url($url, PHP_URL_HOST);
app/Services/RealEstateIngestService.php:74:          $ms = $scraper->extract($url);
app/Services/AlphaVantageService.php:15:        $url = "https://www.alphavantage.co/query?function=OVERVIEW&symbol={$symbol}&apikey={$this->apiKey}";
app/Services/AlphaVantageService.php:16:        return $this->call($url);
app/Services/AlphaVantageService.php:21:        $url = "https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol={$symbol}&apikey={$this->apiKey}";
app/Services/AlphaVantageService.php:22:        return $this->call($url);
app/Services/AlphaVantageService.php:27:        $url = "https://www.alphavantage.co/query?function=NEWS_SENTIMENT&tickers={$symbol}&apikey={$this->apiKey}";
app/Services/AlphaVantageService.php:28:        return $this->call($url);
app/Services/AlphaVantageService.php:31:    private function call($url)
app/Services/AlphaVantageService.php:34:        $response = $client->get($url);
app/Services/SolanaService.php:69:            $url = rtrim($base, '/');
app/Services/SolanaService.php:72:            if ($this->isCircuitOpen($url)) {
app/Services/SolanaService.php:73:                log_message('debug', "SolanaService RPC: skip {$url} (circuit open)");
app/Services/SolanaService.php:87:                    log_message('debug', 'HTTP POST '.$url.' | payload:'.json_encode($payload));
app/Services/SolanaService.php:88:                    $resp = $client->request('POST', $url, [
app/Services/SolanaService.php:111:                    $this->noteSuccess($url);
app/Services/SolanaService.php:117:                    log_message('error', "SolanaService RPC fail {$method} @ {$url} -> {$msg}");
app/Services/SolanaService.php:134:                    $this->noteFailure($url, $penalty);
app/Services/SolanaService.php:392:        $url = 'https://api.coingecko.com/api/v3/simple/price?ids=solana&vs_currencies=usd';
app/Services/SolanaService.php:398:                $resp = $client->request('GET', $url, [
app/Services/MailChimpService.php:26:        $url = "https://{$this->serverPrefix}.api.mailchimp.com/3.0/lists/{$this->listId}/members/";
app/Services/MailChimpService.php:28:        $response = $client->post($url, [
app/Services/MailChimpService.php:88:        $url = "https://{$this->serverPrefix}.api.mailchimp.com/3.0/campaigns/{$campaignId}/actions/send";
app/Services/MailChimpService.php:90:        $response = $client->post($url, [
app/Services/EthereumServices.php:42:        foreach ($this->rpcEndpoints as $url) {
app/Services/EthereumServices.php:45:                    $resp = $this->client->post($url, ['json' => $payload]);
app/Services/InfuraService.php:21:        $url = rtrim($this->cfg->base, '/').'/'.$this->cfg->projectId;
app/Services/InfuraService.php:23:            $resp = $this->http()->post($url, [
app/Services/IntakeRouter.php:56:        $url = $p['urls'][0] ?? null;
app/Services/IntakeRouter.php:61:        if ($url) {
app/Services/IntakeRouter.php:65:                'raw_input'  => $url,
app/Services/IntakeRouter.php:66:                'zillow_url' => $url,
app/Services/IntakeRouter.php:102:        $url   = $p['urls'][0] ?? '';
app/Services/IntakeRouter.php:107:        if (!$url) {
app/Services/IntakeRouter.php:114:            return (bool) $svc->queueLink($url, [
app/Services/IntakeRouter.php:123:        log_message('info','IntakeRouter: queued news link {url} with title "{t}"', ['url'=>$url,'t'=>$title]);
app/Services/CoinGeckoService.php:19:    protected function request(string $method, string $url, array $options = [], int $attempts = 3)
app/Services/CoinGeckoService.php:22:            $resp = $this->http()->request($method, $url, $options + ['timeout' => $this->cfg->timeout]);
app/Services/CoinGeckoService.php:38:        $url = rtrim($this->cfg->base, '/').'/simple/price';
app/Services/CoinGeckoService.php:44:        $res = $this->request('get', $url, [
app/Services/CoinGeckoService.php:57:        $url = rtrim($this->cfg->base, '/').'/coins/'.rawurlencode($id);
app/Services/CoinGeckoService.php:63:        $res = $this->request('get', $url, ['headers' => ['Accept' => 'application/json']]);
app/Services/BirdeyeService.php:19:    protected function request(string $method, string $url, array $options = [], int $attempts = 3)
app/Services/BirdeyeService.php:22:            $resp = $this->http()->request($method, $url, $options + ['timeout' => $this->cfg->timeout]);
app/Services/BirdeyeService.php:47:        $url = rtrim($this->cfg->base, '/').'/public/price';
app/Services/BirdeyeService.php:53:        $res = $this->request('get', $url, [
app/Services/BirdeyeService.php:63:        $url = rtrim($this->cfg->base, '/').'/public/token';
app/Services/BirdeyeService.php:64:        return $this->request('get', $url, [
app/Services/JupiterService.php:19:    protected function request(string $method, string $url, array $options = [], int $attempts = 3)
app/Services/JupiterService.php:22:            $resp = $this->http()->request($method, $url, $options + ['timeout' => $this->cfg->timeout]);
app/Services/JupiterService.php:47:        $url = rtrim($this->cfg->base, '/').'/v6/quote';
app/Services/JupiterService.php:53:        $res = $this->request('get', $url, [
app/Services/JupiterService.php:63:        $url = rtrim($this->cfg->base, '/').'/v6/swap';
app/Services/JupiterService.php:64:        return $this->request('post', $url, [
app/Services/JupiterService.php:72:        $url = rtrim($this->cfg->priceBase, '/').'/v3/price';
app/Services/JupiterService.php:78:        $res = $this->request('get', $url, [
app/Services/JupiterService.php:88:        $url = 'https://token.jup.ag/all';
app/Services/JupiterService.php:93:        $res = $this->request('get', $url, ['headers' => $this->headers()]);
app/Services/CryptoPanicService.php:19:    protected function request(string $url, array $params = [], int $attempts = 3)
app/Services/CryptoPanicService.php:22:            $resp = $this->http()->get($url, [
app/Services/CryptoPanicService.php:47:        $url = rtrim($this->cfg->base, '/').'/posts/';
app/Services/CryptoPanicService.php:56:        $res = $this->request($url, $params);
app/Entities/SearchResult.php:11:        public string $url,
app/Libraries/MyMITwitter.php:54:        $url = $this->apiBaseUrl . $endpoint;
app/Libraries/MyMITwitter.php:55:        $ch = curl_init($url);
app/Libraries/MyMIMarketing-06162025.php:551:        foreach ($topLinks as $url) {
app/Libraries/MyMIMarketing-06162025.php:552:            $cached = $model->getCachedLink($url);
app/Libraries/MyMIMarketing-06162025.php:558:            $scraped = $this->scrapeUrlContent($url);
app/Libraries/MyMIMarketing-06162025.php:561:                $model->cacheScrapedLink($url, $scraped);
app/Libraries/MyMIMarketing-06162025.php:938:        $url = "https://www.google.com/search?q={$encoded}";
app/Libraries/MyMIMarketing-06162025.php:948:            $response = $client->get($url);
app/Libraries/MyMIMarketing-06162025.php:1052:                $url = $record['url'] ?? $this->generateEmailFallbackUrl($subject, $emailIdentifier) ?? '';
app/Libraries/MyMIMarketing-06162025.php:1060:                    $url = $email['link'] ?? $url;
app/Libraries/MyMIMarketing-06162025.php:1065:                $url = $url ?: 'https://mymiwallet.com/news/fallback';
app/Libraries/MyMIMarketing-06162025.php:1067:                $this->marketingModel->updateEmailFields($record['id'], $title, $url, $content);
app/Libraries/MyMIMarketing-06162025.php:1288:    private function scrapeUrlContent(string $url): ?string
app/Libraries/MyMIMarketing-06162025.php:1299:            $response = $client->get($url);
app/Libraries/MyMIMarketing-06162025.php:1306:            log_message('error', 'âŒ Scrape error for ' . $url . ': ' . $e->getMessage());
app/Libraries/MyMIMarketing-06162025.php:1311:    private function scrapeWebsite($url)
app/Libraries/MyMIMarketing-06162025.php:1315:            $response = $client->get($url);
app/Libraries/MyMIMarketing-06162025.php:1330:    private function scrapeFacebook($url)
app/Libraries/MyMIMarketing-06162025.php:1332:        return $this->scrapeWithRetries('facebook', $url, function($content) {
app/Libraries/MyMIMarketing-06162025.php:1340:    private function scrapeTwitter($url)
app/Libraries/MyMIMarketing-06162025.php:1342:        return $this->scrapeWithRetries('twitter', $url, function($content) {
app/Libraries/MyMIMarketing-06162025.php:1350:    private function scrapeWithRetries($type, $url, $transform, $retries = 3) {
app/Libraries/MyMIMarketing-06162025.php:1354:                $response = $this->scrapemax->scrape(['target_url' => $url, 'type' => 'data', 'js_enabled' => 1, 'base64_encoded' => 0]);
app/Libraries/MyMIMarketing-06162025.php:1441:                $url = 'https://api.bing.microsoft.com/v7.0/search?q=' . urlencode($query);
app/Libraries/MyMIMarketing-06162025.php:1443:                $response = $client->get($url, [
app/Libraries/MyMIMarketing-06162025.php:1468:                $url = "https://www.googleapis.com/customsearch/v1?q=" . urlencode($query) . "&key={$apiKey}&cx={$cx}";
app/Libraries/MyMIMarketing-06162025.php:1470:                $response = $client->get($url);
app/Libraries/MyMIMarketing-06162025.php:1492:    public function standaloneScrapeWebsite($url) {
app/Libraries/MyMIMarketing-06162025.php:1495:            $response = $client->get($url);
app/Libraries/MyMIMarketing-06162025.php:1509:                    'url' => $url,
app/Libraries/MyMIMarketing-06162025.php:1892:    public function summarizeTradingViewFinancials($url)
app/Libraries/MyMIMarketing-06162025.php:1894:        $html = @file_get_contents($url);
app/Libraries/MyMIMarketing-06162025.php:3153:        $url = 'https://api.bing.microsoft.com/v7.0/search?q=' . urlencode($query);
app/Libraries/MyMIMarketing-06162025.php:3157:            $response = $client->get($url, [
app/Libraries/MyMIMarketing-06162025.php:3181:        $url = "https://www.googleapis.com/customsearch/v1?q=" . urlencode($query) . "&key={$apiKey}&cx={$cx}";
app/Libraries/MyMIMarketing-06162025.php:3185:            $response = $client->get($url);
app/Libraries/MyMIMarketing-06162025.php:3787:            $url = $story['source_url'] ?? '#';
app/Libraries/MyMIMarketing-06162025.php:3792:                'discord'  => "**{$headline}**\n{$summary}\nðŸ”— {$url}\n{$hashtags}",
app/Libraries/MyMIMarketing-06162025.php:3793:                'twitter'  => "{$headline} {$url} {$hashtags}",
app/Libraries/MyMIMarketing-06162025.php:3794:                'linkedin' => "{$headline}\n{$summary}\nRead more: {$url} {$hashtags}",
app/Libraries/MyMIMarketing-06162025.php:3795:                'facebook' => "{$headline}\n{$summary}\n{$url} {$hashtags}",
app/Libraries/MyMIMarketing-06162025.php:3798:                    'body'    => "{$summary}\n\nRead More: {$url}\n{$hashtags}",
app/Libraries/MyMIMarketing-06162025.php:3836:    private function logScrapeError($url, $error)
app/Libraries/MyMIMarketing-06162025.php:3838:        log_message('error', "Scraping failed for URL: $url, Error: $error");
app/Libraries/MyMIMarketing-06162025.php:4643:    private function shouldSkipScrape(string $url): bool
app/Libraries/MyMIMarketing-06162025.php:4647:        $builder->where('url', $url);
app/Libraries/MyMIInvestments.php:342:        $url = "https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol={$symbol}&apikey={$apiKey}";
app/Libraries/MyMIInvestments.php:345:            $response = @file_get_contents($url);
app/Libraries/MyMIInvestments.php:870:        $url = "https://www.alphavantage.co/query?{$params}&apikey={$this->alphavantageKey}";
app/Libraries/MyMIInvestments.php:871:        $response = $this->curlRequest->get($url);
app/Libraries/MyMIInvestments.php:959:        $url = "https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol={$symbol}&apikey={$this->alphavantageKey}";
app/Libraries/MyMIInvestments.php:960:        $response = $this->curlRequest->get($url);
app/Libraries/MyMIInvestments.php:1207:    private function makeAPICall($url, $apiKey) {
app/Libraries/MyMIInvestments.php:1210:        $url = $url . "&apikey=" . $apiKey;
app/Libraries/MyMIInvestments.php:1212:        $response = $client->request('GET', $url, [
app/Libraries/MyMIInvestments.php:1222:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=stock";
app/Libraries/MyMIInvestments.php:1223:        $makeAPICall = $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.php:1229:        $url = "https://morningstarapi.example.com/bonds";
app/Libraries/MyMIInvestments.php:1230:        return $this->makeAPICall($url, $this->morningstarKey);
app/Libraries/MyMIInvestments.php:1234:        $url = "https://www.quandl.com/api/v3/datatables/SHFE?api_key=" . $this->quandlKey;
app/Libraries/MyMIInvestments.php:1235:        return $this->makeAPICall($url, $this->quandlKey);
app/Libraries/MyMIInvestments.php:1239:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=crypto";
app/Libraries/MyMIInvestments.php:1240:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.php:1244:        $url = "https://api.coingecko.com/api/v3/coins/list";
app/Libraries/MyMIInvestments.php:1245:        return $this->makeAPICall($url, null);
app/Libraries/MyMIInvestments.php:1249:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=etf";
app/Libraries/MyMIInvestments.php:1250:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.php:1254:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=foreign_stock";
app/Libraries/MyMIInvestments.php:1255:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.php:1259:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=forex";
app/Libraries/MyMIInvestments.php:1260:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.php:1264:        $url = "https://bonddata.devapi.example.com/international-bonds";
app/Libraries/MyMIInvestments.php:1265:        return $this->makeAPICall($url, null);
app/Libraries/MyMIInvestments.php:1269:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=option";
app/Libraries/MyMIInvestments.php:1270:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.php:1274:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=mutual_fund";
app/Libraries/MyMIInvestments.php:1275:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.php:1279:        $url = "https://www.quandl.com/api/v3/datatables/LBMA?api_key=" . $this->quandlKey;
app/Libraries/MyMIInvestments.php:1280:        return $this->makeAPICall($url, $this->quandlKey);
app/Libraries/MyMIInvestments.php:1284:        $url = "https://www.quandl.com/api/v3/datatables/ZILLOW?api_key=" . $this->quandlKey;
app/Libraries/MyMIInvestments.php:1285:        return $this->makeAPICall($url, $this->quandlKey);
app/Libraries/MyMIInvestments.php:1785:        $url = "https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol={$symbol}&apikey={$this->alphavantageKey}";
app/Libraries/MyMIInvestments.php:1786:        $response = $this->curlRequest->get($url);
app/Libraries/MyMIBitcoin.php:134:        $url = $this->apiBase . '/addrs/' . $normalized . '/balance';
app/Libraries/MyMIBitcoin.php:136:            $response = file_get_contents($url);
app/Libraries/MyMIBitcoin.php:170:        $url = $this->apiBase . '/addrs/' . $normalized . '/full?limit=' . $limit;
app/Libraries/MyMIBitcoin.php:172:            $response = file_get_contents($url);
app/Libraries/MyMIAlerts.php:517:        $url = "https://www.alphavantage.co/query?function=NEWS_SENTIMENT"
app/Libraries/MyMIAlerts.php:522:        $json = file_get_contents($url);
app/Libraries/MyMIAlerts.php:1036:        $url = "https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol={$symbol}&apikey={$apiKey}";
app/Libraries/MyMIAlerts.php:1038:        $response = @file_get_contents($url);
app/Libraries/MyMIAlerts.php:1064:        $url = "https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol={$symbol}&apikey={$apiKey}";
app/Libraries/MyMIAlerts.php:1067:        $response = $client->get($url);
app/Libraries/MyMIAlerts.php:1393:        $url = $baseUrl . "&symbols=" . urlencode($tickerString);
app/Libraries/MyMIAlerts.php:1396:            $response = file_get_contents($url);
app/Libraries/MyMIDexScreener06132024.php:25:        $url = 'https://raw.githubusercontent.com/solana-labs/token-list/main/src/tokens/solana.tokenlist.json';
app/Libraries/MyMIDexScreener06132024.php:26:        $response = file_get_contents($url);
app/Libraries/MyMIDexScreener06132024.php:31:        $url = $this->apiBaseUrl . 'tokens/' . $tokenAddress;
app/Libraries/MyMIDexScreener06132024.php:32:        $response = $this->sendRequest($url);
app/Libraries/MyMIDexScreener06132024.php:131:        $url = $this->apiBaseUrl . $endpoint;
app/Libraries/MyMIDexScreener06132024.php:133:            log_message('debug', 'MyMIDexScreener L153 - Request URL: ' . $url); // Log the full request URL
app/Libraries/MyMIDexScreener06132024.php:136:        curl_setopt($ch, CURLOPT_URL, $url);
app/Libraries/SitemapGenerator.php:158:            $url = $dom->createElement('url');
app/Libraries/SitemapGenerator.php:159:            $url->appendChild($dom->createElement('loc', htmlspecialchars($item['loc'], ENT_XML1)));
app/Libraries/SitemapGenerator.php:161:                $url->appendChild($dom->createElement('lastmod', $item['lastmod']->format(DATE_RFC3339)));
app/Libraries/SitemapGenerator.php:164:                $url->appendChild($dom->createElement('changefreq', $item['changefreq']));
app/Libraries/SitemapGenerator.php:167:                $url->appendChild($dom->createElement('priority', number_format($item['priority'], 1)));
app/Libraries/SitemapGenerator.php:174:                    $url->appendChild($image);
app/Libraries/SitemapGenerator.php:177:            $urlset->appendChild($url);
app/Libraries/SitemapGenerator.php:228:        foreach ($urls as $url) {
app/Libraries/SitemapGenerator.php:230:                @file_get_contents($url, false, $context);
app/Libraries/MyMIMarketData.php:78:        $url = $this->cgBase . '/simple/price?ids=' . urlencode($symbol) . '&vs_currencies=usd';
app/Libraries/MyMIMarketData.php:80:            $json = json_decode(file_get_contents($url), true);
app/Libraries/MyMIMarketData.php:102:        $url = $this->cgBase . '/coins/' . urlencode($symbol);
app/Libraries/MyMIMarketData.php:104:            $json = json_decode(file_get_contents($url), true);
app/Libraries/MyMISEC.php:119:    private function makeRequestFromExternal($url) {
app/Libraries/MyMISEC.php:120:        log_message('info', "ðŸ“¡ External API Request: {$url}");
app/Libraries/MyMISEC.php:123:        curl_setopt($ch, CURLOPT_URL, $url);
app/Libraries/MyMISEC.php:138:            log_message('error', "âŒ Failed to fetch data from {$url}. HTTP Code: {$httpCode}. CURL Error: {$error}");
app/Libraries/MyMIMarketing-05122025.php:752:                $url = $record['url'] ?? $this->generateEmailFallbackUrl($subject, $emailIdentifier) ?? '';
app/Libraries/MyMIMarketing-05122025.php:760:                    $url = $email['link'] ?? $url;
app/Libraries/MyMIMarketing-05122025.php:765:                $url = $url ?: 'https://mymiwallet.com/news/fallback';
app/Libraries/MyMIMarketing-05122025.php:767:                $this->marketingModel->updateEmailFields($record['id'], $title, $url, $content);
app/Libraries/MyMIMarketing-05122025.php:988:    private function scrapeWebsite($url)
app/Libraries/MyMIMarketing-05122025.php:992:            $response = $client->get($url);
app/Libraries/MyMIMarketing-05122025.php:1007:    private function scrapeFacebook($url)
app/Libraries/MyMIMarketing-05122025.php:1009:        return $this->scrapeWithRetries('facebook', $url, function($content) {
app/Libraries/MyMIMarketing-05122025.php:1017:    private function scrapeTwitter($url)
app/Libraries/MyMIMarketing-05122025.php:1019:        return $this->scrapeWithRetries('twitter', $url, function($content) {
app/Libraries/MyMIMarketing-05122025.php:1027:    private function scrapeWithRetries($type, $url, $transform, $retries = 3) {
app/Libraries/MyMIMarketing-05122025.php:1031:                $response = $this->scrapemax->scrape(['target_url' => $url, 'type' => 'data', 'js_enabled' => 1, 'base64_encoded' => 0]);
app/Libraries/MyMIMarketing-05122025.php:1100:    public function standaloneScrapeWebsite($url) {
app/Libraries/MyMIMarketing-05122025.php:1103:            $response = $client->get($url);
app/Libraries/MyMIMarketing-05122025.php:1117:                    'url' => $url,
app/Libraries/MyMIMarketing-05122025.php:3047:            $url = $story['source_url'] ?? '#';
app/Libraries/MyMIMarketing-05122025.php:3052:                'discord'  => "**{$headline}**\n{$summary}\nðŸ”— {$url}\n{$hashtags}",
app/Libraries/MyMIMarketing-05122025.php:3053:                'twitter'  => "{$headline} {$url} {$hashtags}",
app/Libraries/MyMIMarketing-05122025.php:3054:                'linkedin' => "{$headline}\n{$summary}\nRead more: {$url} {$hashtags}",
app/Libraries/MyMIMarketing-05122025.php:3055:                'facebook' => "{$headline}\n{$summary}\n{$url} {$hashtags}",
app/Libraries/MyMIMarketing-05122025.php:3058:                    'body'    => "{$summary}\n\nRead More: {$url}\n{$hashtags}",
app/Libraries/MyMIMarketing-05122025.php:3096:    private function logScrapeError($url, $error)
app/Libraries/MyMIMarketing-05122025.php:3098:        log_message('error', "Scraping failed for URL: $url, Error: $error");
app/Libraries/MyMIInvestments.11112024.php:441:        $url = "https://www.alphavantage.co/query?{$params}&apikey={$this->alphavantageKey}";
app/Libraries/MyMIInvestments.11112024.php:442:        $response = $this->curlRequest->get($url);
app/Libraries/MyMIInvestments.11112024.php:530:        $url = "https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol={$symbol}&apikey={$this->alphavantageKey}";
app/Libraries/MyMIInvestments.11112024.php:531:        $response = $this->curlRequest->get($url);
app/Libraries/MyMIInvestments.11112024.php:755:    private function makeAPICall($url, $apiKey) {
app/Libraries/MyMIInvestments.11112024.php:758:        $url = $url . "&apikey=" . $apiKey;
app/Libraries/MyMIInvestments.11112024.php:760:        $response = $client->request('GET', $url, [
app/Libraries/MyMIInvestments.11112024.php:770:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=stock";
app/Libraries/MyMIInvestments.11112024.php:771:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.11112024.php:775:        $url = "https://morningstarapi.example.com/bonds";
app/Libraries/MyMIInvestments.11112024.php:776:        return $this->makeAPICall($url, $this->morningstarKey);
app/Libraries/MyMIInvestments.11112024.php:780:        $url = "https://www.quandl.com/api/v3/datatables/SHFE?api_key=" . $this->quandlKey;
app/Libraries/MyMIInvestments.11112024.php:781:        return $this->makeAPICall($url, $this->quandlKey);
app/Libraries/MyMIInvestments.11112024.php:785:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=crypto";
app/Libraries/MyMIInvestments.11112024.php:786:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.11112024.php:790:        $url = "https://api.coingecko.com/api/v3/coins/list";
app/Libraries/MyMIInvestments.11112024.php:791:        return $this->makeAPICall($url, null);
app/Libraries/MyMIInvestments.11112024.php:795:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=etf";
app/Libraries/MyMIInvestments.11112024.php:796:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.11112024.php:800:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=foreign_stock";
app/Libraries/MyMIInvestments.11112024.php:801:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.11112024.php:805:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=forex";
app/Libraries/MyMIInvestments.11112024.php:806:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.11112024.php:810:        $url = "https://bonddata.devapi.example.com/international-bonds";
app/Libraries/MyMIInvestments.11112024.php:811:        return $this->makeAPICall($url, null);
app/Libraries/MyMIInvestments.11112024.php:815:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=option";
app/Libraries/MyMIInvestments.11112024.php:816:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.11112024.php:820:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=mutual_fund";
app/Libraries/MyMIInvestments.11112024.php:821:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.11112024.php:825:        $url = "https://www.quandl.com/api/v3/datatables/LBMA?api_key=" . $this->quandlKey;
app/Libraries/MyMIInvestments.11112024.php:826:        return $this->makeAPICall($url, $this->quandlKey);
app/Libraries/MyMIInvestments.11112024.php:830:        $url = "https://www.quandl.com/api/v3/datatables/ZILLOW?api_key=" . $this->quandlKey;
app/Libraries/MyMIInvestments.11112024.php:831:        return $this->makeAPICall($url, $this->quandlKey);
app/Libraries/MyMIDiscord.php:77:        $url = $this->apiBaseUrl . $endpoint;
app/Libraries/MyMIDiscord.php:78:        $ch = curl_init($url);
app/Libraries/MyMISolana.php:86:        $url = 'https://api.metaplex.com/metadata'; // Replace with actual Metaplex endpoint
app/Libraries/MyMISolana.php:93:            $response = $client->post($url, [
app/Libraries/MyMISolana.php:491:        $url = 'https://api.coingecko.com/api/v3/simple/price?ids=solana&vs_currencies=usd';
app/Libraries/MyMISolana.php:498:            $response = @file_get_contents($url, false, $context);
app/Libraries/MyMISolana.php:520:        $url = 'https://api.coingecko.com/api/v3/simple/price?ids=solana&vs_currencies=usd';
app/Libraries/MyMISolana.php:529:            $response = @file_get_contents($url, false, $context);
app/Libraries/MyMISolana.php:811:            $url = $makeUrl($base);
app/Libraries/MyMISolana.php:821:                            $url .= (str_contains($url, '?') ? '&' : '?') . http_build_query($data);
app/Libraries/MyMISolana.php:825:                    log_message('debug', sprintf('HTTP %s %s | payload:%s', $method, $url, json_encode($data)));
app/Libraries/MyMISolana.php:827:                    $resp  = $client->request($method, $url, $options);
app/Libraries/MyMISolana.php:849:                    log_message('error', sprintf('sendRequest attempt %d failed for %s | %s', $i + 1, $url, $e->getMessage()));
app/Libraries/MyMISolana.php:860:        $url = $this->apiUrl . '/createToken';
app/Libraries/MyMISolana.php:868:            $response = $client->post($url, [
app/Libraries/MyMISolana.php:885:        $url = $this->apiUrl . '/mint';
app/Libraries/MyMISolana.php:894:            $response = $client->post($url, [
app/Libraries/MyMIMarketing.php:575:        foreach ($topLinks as $url) {
app/Libraries/MyMIMarketing.php:576:            $cached = $model->getCachedLink($url);
app/Libraries/MyMIMarketing.php:582:            $scraped = $this->scrapeUrlContent($url);
app/Libraries/MyMIMarketing.php:585:                $model->cacheScrapedLink($url, $scraped);
app/Libraries/MyMIMarketing.php:1018:        $url = "https://www.google.com/search?q={$encoded}";
app/Libraries/MyMIMarketing.php:1028:            $response = $client->get($url);
app/Libraries/MyMIMarketing.php:1176:                $url = $record['url'] ?? $this->generateEmailFallbackUrl($subject, $emailIdentifier) ?? '';
app/Libraries/MyMIMarketing.php:1184:                    $url = $email['link'] ?? $url;
app/Libraries/MyMIMarketing.php:1189:                $url = $url ?: 'https://mymiwallet.com/news/fallback';
app/Libraries/MyMIMarketing.php:1191:                $this->marketingModel->updateEmailFields($record['id'], $title, $url, $content);
app/Libraries/MyMIMarketing.php:1448:    private function scrapeUrlContent(string $url): ?string
app/Libraries/MyMIMarketing.php:1459:            $response = $client->get($url);
app/Libraries/MyMIMarketing.php:1466:            log_message('error', 'âŒ Scrape error for ' . $url . ': ' . $e->getMessage());
app/Libraries/MyMIMarketing.php:1471:    private function scrapeWebsite($url)
app/Libraries/MyMIMarketing.php:1475:            $response = $client->get($url);
app/Libraries/MyMIMarketing.php:1490:    private function scrapeFacebook($url)
app/Libraries/MyMIMarketing.php:1492:        return $this->scrapeWithRetries('facebook', $url, function($content) {
app/Libraries/MyMIMarketing.php:1500:    private function scrapeTwitter($url)
app/Libraries/MyMIMarketing.php:1502:        return $this->scrapeWithRetries('twitter', $url, function($content) {
app/Libraries/MyMIMarketing.php:1510:    private function scrapeWithRetries($type, $url, $transform, $retries = 3) {
app/Libraries/MyMIMarketing.php:1514:                $response = $this->scrapemax->scrape(['target_url' => $url, 'type' => 'data', 'js_enabled' => 1, 'base64_encoded' => 0]);
app/Libraries/MyMIMarketing.php:1652:                $url = 'https://api.bing.microsoft.com/v7.0/search?q=' . urlencode($query);
app/Libraries/MyMIMarketing.php:1654:                $response = $client->get($url, [
app/Libraries/MyMIMarketing.php:1679:                $url = "https://www.googleapis.com/customsearch/v1?q=" . urlencode($query) . "&key={$apiKey}&cx={$cx}";
app/Libraries/MyMIMarketing.php:1681:                $response = $client->get($url);
app/Libraries/MyMIMarketing.php:1703:    public function standaloneScrapeWebsite($url) {
app/Libraries/MyMIMarketing.php:1706:            $response = $client->get($url);
app/Libraries/MyMIMarketing.php:1720:                    'url' => $url,
app/Libraries/MyMIMarketing.php:2103:    public function summarizeTradingViewFinancials($url)
app/Libraries/MyMIMarketing.php:2105:        $html = @file_get_contents($url);
app/Libraries/MyMIMarketing.php:4033:        $url = 'https://api.bing.microsoft.com/v7.0/search?q=' . urlencode($query);
app/Libraries/MyMIMarketing.php:4037:            $response = $client->get($url, [
app/Libraries/MyMIMarketing.php:4061:        $url = "https://www.googleapis.com/customsearch/v1?q=" . urlencode($query) . "&key={$apiKey}&cx={$cx}";
app/Libraries/MyMIMarketing.php:4065:            $response = $client->get($url);
app/Libraries/MyMIMarketing.php:4728:            $url = $story['source_url'] ?? '#';
app/Libraries/MyMIMarketing.php:4733:                'discord'  => "**{$headline}**\n{$summary}\nðŸ”— {$url}\n{$hashtags}",
app/Libraries/MyMIMarketing.php:4734:                'twitter'  => "{$headline} {$url} {$hashtags}",
app/Libraries/MyMIMarketing.php:4735:                'linkedin' => "{$headline}\n{$summary}\nRead more: {$url} {$hashtags}",
app/Libraries/MyMIMarketing.php:4736:                'facebook' => "{$headline}\n{$summary}\n{$url} {$hashtags}",
app/Libraries/MyMIMarketing.php:4739:                    'body'    => "{$summary}\n\nRead More: {$url}\n{$hashtags}",
app/Libraries/MyMIMarketing.php:4777:    private function logScrapeError($url, $error)
app/Libraries/MyMIMarketing.php:4779:        log_message('error', "Scraping failed for URL: $url, Error: $error");
app/Libraries/MyMIMarketing.php:5594:    private function shouldSkipScrape(string $url): bool
app/Libraries/MyMIMarketing.php:5598:        $builder->where('url', $url);
app/Libraries/MyMISports.php:28:    private function performCurlRequest($url, $host) {
app/Libraries/MyMISports.php:30:        $response = $client->request('GET', $url, [
app/Libraries/MyMISports.php:50:            $url = "https://{$this->apiNFLHost}/players/statistics?season=2023&team={$teamId}";
app/Libraries/MyMISports.php:51:            $playerStats = $this->performCurlRequest($url, $this->apiNFLHost);
app/Libraries/MyMISports.php:138:            $url = "https://{$this->apiNBAHost}/players/statistics?season=2023&team={$teamId}";
app/Libraries/MyMISports.php:139:            return $this->performCurlRequest($url, $this->apiNBAHost);
app/Libraries/MyMILogger.php:22:    private $url = false;
app/Libraries/MyMILogger.php:44:    public function url($url) { $this->url = $url; return $this; }
app/Libraries/MyMIFacebook.php:152:        $url = $this->apiBaseUrl . $endpoint;
app/Libraries/MyMIFacebook.php:153:        $ch = curl_init($url);
app/Libraries/EmailManager.php:45:        $url = "https://api.dreamhost.com/?" . http_build_query($params);
app/Libraries/EmailManager.php:46:        return file_get_contents($url);
app/Libraries/MyMIGemini.php:51:        $url = $this->apiUrl . $endpoint;
app/Libraries/MyMIGemini.php:74:        curl_setopt($curl, CURLOPT_URL, $url);
app/Libraries/Resilience/HttpClient.php:6:    public static function postJson(string $breakerName, string $url, array $data, array $headers = [], int $timeout = 10): array
app/Libraries/Resilience/HttpClient.php:21:            $res = self::curl('POST', $url, $body, $hdrs, $timeout);
app/Libraries/Resilience/HttpClient.php:40:    private static function curl(string $method, string $url, ?string $body, array $headers, int $timeout): array
app/Libraries/Resilience/HttpClient.php:42:        $ch = curl_init($url);
app/Libraries/MyMIInvestments.09112024.php:279:        $url = "https://www.alphavantage.co/query?{$params}&apikey={$this->alphavantageKey}";
app/Libraries/MyMIInvestments.09112024.php:280:        $response = $this->curlrequest->get($url);
app/Libraries/MyMIInvestments.09112024.php:371:        $url = "https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol={$symbol}&apikey={$this->alphavantageKey}";
app/Libraries/MyMIInvestments.09112024.php:372:        $response = $this->curlrequest->get($url);
app/Libraries/MyMIInvestments.09112024.php:574:    private function makeAPICall($url, $apiKey)
app/Libraries/MyMIInvestments.09112024.php:577:        $url = $url . "&apikey=" . $apiKey;
app/Libraries/MyMIInvestments.09112024.php:578:        $response = $client->request('GET', $url, ['headers' => ['Accept' => 'application/json']]);
app/Libraries/MyMIInvestments.09112024.php:584:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=stock";
app/Libraries/MyMIInvestments.09112024.php:585:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.09112024.php:590:        $url = "https://morningstarapi.example.com/bonds";
app/Libraries/MyMIInvestments.09112024.php:591:        return $this->makeAPICall($url, $this->morningstarKey);
app/Libraries/MyMIInvestments.09112024.php:596:        $url = "https://www.quandl.com/api/v3/datatables/SHFE?api_key=" . $this->quandlKey;
app/Libraries/MyMIInvestments.09112024.php:597:        return $this->makeAPICall($url, $this->quandlKey);
app/Libraries/MyMIInvestments.09112024.php:602:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=crypto";
app/Libraries/MyMIInvestments.09112024.php:603:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.09112024.php:608:        $url = "https://api.coingecko.com/api/v3/coins/list";
app/Libraries/MyMIInvestments.09112024.php:609:        return $this->makeAPICall($url, null);
app/Libraries/MyMIInvestments.09112024.php:614:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=etf";
app/Libraries/MyMIInvestments.09112024.php:615:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.09112024.php:620:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=foreign_stock";
app/Libraries/MyMIInvestments.09112024.php:621:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.09112024.php:626:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=forex";
app/Libraries/MyMIInvestments.09112024.php:627:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.09112024.php:632:        $url = "https://bonddata.devapi.example.com/international-bonds";
app/Libraries/MyMIInvestments.09112024.php:633:        return $this->makeAPICall($url, null);
app/Libraries/MyMIInvestments.09112024.php:638:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=option";
app/Libraries/MyMIInvestments.09112024.php:639:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.09112024.php:644:        $url = "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=mutual_fund";
app/Libraries/MyMIInvestments.09112024.php:645:        return $this->makeAPICall($url, $this->alphavantageKey);
app/Libraries/MyMIInvestments.09112024.php:650:        $url = "https://www.quandl.com/api/v3/datatables/LBMA?api_key=" . $this->quandlKey;
app/Libraries/MyMIInvestments.09112024.php:651:        return $this->makeAPICall($url, $this->quandlKey);
app/Libraries/MyMIInvestments.09112024.php:656:        $url = "https://www.quandl.com/api/v3/datatables/ZILLOW?api_key=" . $this->quandlKey;
app/Libraries/MyMIInvestments.09112024.php:657:        return $this->makeAPICall($url, $this->quandlKey);
app/Libraries/MyMIAssets.php:60:            $url = "https://api.coingecko.com/api/v3/simple/price?ids={$symbol}&vs_currencies=usd";
app/Libraries/MyMIAssets.php:61:            $response = file_get_contents($url);
app/Libraries/MyMINews.php:53:        $url = "https://newsapi.org/v2/everything?q=corporate+finance+OR+corporate+news+OR+financial+stock+OR+crypto+OR+stock+market&from=$fromTime&to=$toTime&pageSize=100&apiKey={$this->newsApiKey}";
app/Libraries/MyMINews.php:56:        $response = $client->get($url)->getBody();
app/Libraries/MyMINews.php:81:        $url = "https://api.marketaux.com/v1/news/all?countries=us&limit={$limit}&api_token={$apiKey}";
app/Libraries/MyMINews.php:85:            $response = $client->get($url)->getBody();
app/Libraries/MyMISecurity.php:454:    public function detectPhishingAttempt($email, $url)
app/Libraries/MyMISecurity.php:457:        return $phishingDetector->check($email, $url);
app/Libraries/MyMIMarketAux.php:46:            $url = 'https://www.alphavantage.co/query';
app/Libraries/MyMIMarketAux.php:47:            $response = $this->client->get($url, [
app/Libraries/MyMIPump.php:93:        $url = $this->apiBaseUrl . 'top/' . $chain . '?limit=' . $limit;
app/Libraries/MyMIPump.php:95:            $resp = $this->sendRequest($url);
app/Libraries/MyMIPump.php:126:        $url = $this->apiBaseUrl . 'token/' . $idOrMint;
app/Libraries/MyMIPump.php:128:            $resp = $this->sendRequest($url);
app/Libraries/MyMIPump.php:150:    protected function sendRequest(string $url): array
app/Libraries/MyMIPump.php:154:            $ch = curl_init($url);
app/Libraries/MyMIRaydium.php:23:        $url = rtrim($this->apiBase, '/') . $endpoint;
app/Libraries/MyMIRaydium.php:25:            $url .= '?' . http_build_query($params);
app/Libraries/MyMIRaydium.php:31:        $response = $client->request($method, $url, $options);
app/Libraries/MyMIDexScreener.php:42:        $url = $this->apiBaseUrl . 'tokens/' . $chain . '?limit=' . $limit;
app/Libraries/MyMIDexScreener.php:44:            $resp = $this->sendRequest($url);
app/Libraries/MyMIDexScreener.php:75:        $url = $this->apiBaseUrl . 'tokens/' . $idOrMint;
app/Libraries/MyMIDexScreener.php:77:            $resp = $this->sendRequest($url);
app/Libraries/MyMIDexScreener.php:98:        $url = $this->apiBaseUrl . 'pairs';
app/Libraries/MyMIDexScreener.php:99:        $response = $this->sendRequest($url);
app/Libraries/MyMIDexScreener.php:104:        $url = $this->apiBaseUrl . 'tokens/' . $tokenAddress;
app/Libraries/MyMIDexScreener.php:105:        $response = $this->sendRequest($url);
app/Libraries/MyMIDexScreener.php:111:        $url = 'https://raw.githubusercontent.com/solana-labs/token-list/main/src/tokens/solana.tokenlist.json';
app/Libraries/MyMIDexScreener.php:112:        $response = file_get_contents($url);
app/Libraries/MyMIDexScreener.php:118:        $url = $this->apiBaseUrl . 'tokens/' . $tokenAddress;
app/Libraries/MyMIDexScreener.php:119:        $response = $this->sendRequest($url);
app/Libraries/MyMIDexScreener.php:142:            $url = $this->apiBaseUrl . 'tokens/' . $address;
app/Libraries/MyMIDexScreener.php:144:                log_message('debug', 'MyMIDexScreener - API Request URL: ' . $url);
app/Libraries/MyMIDexScreener.php:146:            $response = $this->sendRequest($url);
app/Libraries/MyMIDexScreener.php:205:        $url = $endpoint;
app/Libraries/MyMIDexScreener.php:207:            log_message('debug', 'MyMIDexScreener - Request URL: ' . $url);
app/Libraries/MyMIDexScreener.php:210:        curl_setopt($ch, CURLOPT_URL, $url);
app/Libraries/test.txt:3620:        $url = $jsonData['url'] ?? null;
app/Libraries/test.txt:3622:        if (!$url) {
app/Libraries/test.txt:3628:            log_message('debug', 'scrapeLink: Scraping URL - ' . $url);
app/Libraries/test.txt:3629:            $scrapedData = $this->scrapeWebsiteWithFallback($url);
app/Libraries/test.txt:3660:            $url = filter_var($link['href'], FILTER_SANITIZE_URL);
app/Libraries/test.txt:3661:            if (filter_var($url, FILTER_VALIDATE_URL)) {
app/Libraries/test.txt:3662:                $scrapedData = $this->scrapeWebsite($url);
app/Libraries/test.txt:3671:    private function scrapeWebsite($url) {
app/Libraries/test.txt:3674:            $response = $client->get($url, [
app/Libraries/test.txt:3696:                    log_message('debug', 'scrapeWebsite: Scraping successful for URL - ' . $url);
app/Libraries/test.txt:3704:                    log_message('error', 'scrapeWebsite: DOM parsing failed for URL - ' . $url);
app/Libraries/test.txt:3713:                log_message('error', 'scrapeWebsite: Unauthorized access for URL - ' . $url);
app/Libraries/test.txt:3724:    private function scrapeWebsiteWithFallback($url) {
app/Libraries/test.txt:3726:            log_message('debug', 'scrapeWebsiteWithFallback: Scraping URL - ' . $url);
app/Libraries/test.txt:3727:            $scrapedData = $this->scrapeWebsite($url);
app/Libraries/test.txt:3731:                $googleSearchResults = $this->scrapeGoogleSearch($url);
app/Libraries/test.txt:3894:            $url = $this->request->getPost('url');
app/Libraries/test.txt:3918:                'url' => $url,
app/Libraries/test.txt:4976:                $url = $record['url'] ?? $this->generateEmailFallbackUrl($subject, $emailIdentifier) ?? '';
app/Libraries/test.txt:4984:                    $url = $email['link'] ?? $url;
app/Libraries/test.txt:4989:                $url = $url ?: 'https://mymiwallet.com/news/fallback';
app/Libraries/test.txt:4991:                $this->marketingModel->updateEmailFields($record['id'], $title, $url, $content);
app/Libraries/test.txt:5208:    private function scrapeWebsite($url)
app/Libraries/test.txt:5212:            $response = $client->get($url);
app/Libraries/test.txt:5227:    private function scrapeFacebook($url)
app/Libraries/test.txt:5229:        return $this->scrapeWithRetries('facebook', $url, function($content) {
app/Libraries/test.txt:5237:    private function scrapeTwitter($url)
app/Libraries/test.txt:5239:        return $this->scrapeWithRetries('twitter', $url, function($content) {
app/Libraries/test.txt:5247:    private function scrapeWithRetries($type, $url, $transform, $retries = 3) {
app/Libraries/test.txt:5251:                $response = $this->scrapemax->scrape(['target_url' => $url, 'type' => 'data', 'js_enabled' => 1, 'base64_encoded' => 0]);
app/Libraries/test.txt:5320:    public function standaloneScrapeWebsite($url) {
app/Libraries/test.txt:5323:            $response = $client->get($url);
app/Libraries/test.txt:5337:                    'url' => $url,
app/Libraries/test.txt:7251:            $url = $story['source_url'] ?? '#';
app/Libraries/test.txt:7256:                'discord'  => "**{$headline}**\n{$summary}\nðŸ”— {$url}\n{$hashtags}",
app/Libraries/test.txt:7257:                'twitter'  => "{$headline} {$url} {$hashtags}",
app/Libraries/test.txt:7258:                'linkedin' => "{$headline}\n{$summary}\nRead more: {$url} {$hashtags}",
app/Libraries/test.txt:7259:                'facebook' => "{$headline}\n{$summary}\n{$url} {$hashtags}",
app/Libraries/test.txt:7262:                    'body'    => "{$summary}\n\nRead More: {$url}\n{$hashtags}",
app/Libraries/test.txt:7300:    private function logScrapeError($url, $error)
app/Libraries/test.txt:7302:        log_message('error', "Scraping failed for URL: $url, Error: $error");
app/Libraries/test.txt:9191:    public function updateEmailFields($id, $title, $url, $content = null)
app/Libraries/test.txt:9193:        $data = ['title' => $title, 'url' => $url];
app/Libraries/Webhooks/WebhookDispatcher.php:9:    public static function enqueue(string $url, array $payload, array $extraHeaders = []): int
app/Libraries/Webhooks/WebhookDispatcher.php:22:            'target_url'      => $url,
app/Modules/APIs/Controllers/DripCampaignController.php:30:        $url = $this->request->getGet('url') ?? '/';
app/Modules/APIs/Controllers/DripCampaignController.php:32:        $model->recordEmailClick($trackingId, $url);
app/Modules/APIs/Controllers/DripCampaignController.php:34:        return redirect()->to($url);
app/Modules/APIs/Controllers/AlertsController.php:356:        $url = "https://api.marketaux.com/v1/news/all?symbols={$symbol}&filter_entities=true&limit=5&language=en&api_token={$apiKey}";
app/Modules/APIs/Controllers/AlertsController.php:360:            $response = $client->get($url);
app/Modules/APIs/Controllers/AlertsController.php:391:        $url="https://www.sec.gov/Archives/edgar/data/{$cik}/index.json";
app/Modules/APIs/Controllers/AlertsController.php:395:        curl_setopt($ch, CURLOPT_URL, $url);
app/Modules/APIs/Controllers/AlertsController.php:1869:        foreach ($endpoints as $type => $url) {
app/Modules/APIs/Controllers/AlertsController.php:1871:                log_message('debug', "ðŸ” Scraping TradingView: {$url}");
app/Modules/APIs/Controllers/AlertsController.php:1872:                $html = @file_get_contents($url);
app/Modules/APIs/Controllers/AlertsController.php:1874:                    throw new \Exception("Unable to fetch URL: {$url}");
app/Modules/APIs/Controllers/MarketingController.php:353:    private function fetchAndCleanHtml($url)
app/Modules/APIs/Controllers/MarketingController.php:359:            $html = file_get_contents($url, false, $context);
app/Modules/APIs/Controllers/MarketingController.php:363:            log_message('error', "âŒ Failed to fetch {$url}: " . $e->getMessage());
app/Modules/APIs/Controllers/MarketingController.php:1328:    public function generateSummaryFromGoogleSearch($title, $url = '', $sourceId = null)
app/Modules/APIs/Controllers/MarketingController.php:2132:    private function scrapeWebsiteWithFallback($url) {
app/Modules/APIs/Controllers/MarketingController.php:2134:            log_message('debug', 'scrapeWebsiteWithFallback: Scraping URL - ' . $url);
app/Modules/APIs/Controllers/MarketingController.php:2135:            $scrapedData = $this->scrapeWebsite($url);
app/Modules/APIs/Controllers/MarketingController.php:2139:                $googleSearchResults = $this->scrapeGoogleSearch($url);
app/Modules/APIs/Controllers/MarketingController.php:2234:            $url           = $this->request->getPost('url');
app/Modules/APIs/Controllers/MarketingController.php:2260:                'url'           => $url,
app/Modules/APIs/Controllers/ManagementController.php:600:        $url = "https://www.alphavantage.co/query?function=BALANCE_SHEET&symbol=" . urlencode($symbol) . "&apikey=" . $apikey;
app/Modules/APIs/Controllers/ManagementController.php:601:        $json = file_get_contents($url);
app/Modules/APIs/Controllers/ManagementController.php:606:        $url = "https://www.alphavantage.co/query?function=CASH_FLOW&symbol=" . urlencode($symbol) . "&apikey=" . $apikey;
app/Modules/APIs/Controllers/ManagementController.php:607:        $json = file_get_contents($url);
app/Modules/APIs/Controllers/ManagementController.php:612:        $url = "https://www.alphavantage.co/query?function=OVERVIEW&symbol=" . urlencode($symbol) . "&apikey=" . $apikey;
app/Modules/APIs/Controllers/ManagementController.php:613:        $json = file_get_contents($url);
app/Modules/APIs/Controllers/ManagementController.php:618:        $url = "https://www.alphavantage.co/query?function=EARNINGS_CALENDAR&horizon=" . $horizon . "&apikey=" . $apikey;
app/Modules/APIs/Controllers/ManagementController.php:619:        $csv = file_get_contents($url);
app/Modules/APIs/Controllers/ManagementController.php:626:        $url = "https://alphavantageapi.co/timeseries/analytics?SYMBOLS=" . urlencode($symbols);
app/Modules/APIs/Controllers/ManagementController.php:627:        $url .= "&RANGE=" . $rangeStart . "&RANGE=" . $rangeEnd;
app/Modules/APIs/Controllers/ManagementController.php:628:        $url .= "&INTERVAL=DAILY&OHLC=close";
app/Modules/APIs/Controllers/ManagementController.php:629:        $url .= "&CALCULATIONS=" . urlencode($calculations) . "&apikey=" . $apikey;
app/Modules/APIs/Controllers/ManagementController.php:631:        $json = file_get_contents($url);
app/Modules/APIs/Controllers/ManagementController.php:636:        $url = "https://www.alphavantage.co/query?function=INCOME_STATEMENT&symbol=" . urlencode($symbol) . "&apikey=" . $apikey;
app/Modules/APIs/Controllers/ManagementController.php:637:        $json = file_get_contents($url);
app/Modules/APIs/Controllers/ManagementController.php:642:        $url = "https://www.alphavantage.co/query?function=INSIDER_TRANSACTIONS&symbol=" . urlencode($symbol) . "&apikey=" . $apikey;
app/Modules/APIs/Controllers/ManagementController.php:643:        $json = file_get_contents($url);
app/Modules/APIs/Controllers/ManagementController.php:648:        $url = "https://www.alphavantage.co/query?function=NEWS_SENTIMENT";
app/Modules/APIs/Controllers/ManagementController.php:649:        $url .= "&tickers=" . urlencode($tickers);
app/Modules/APIs/Controllers/ManagementController.php:650:        $url .= "&topics=" . urlencode($topics);
app/Modules/APIs/Controllers/ManagementController.php:651:        if ($time_from) $url .= "&time_from=" . $time_from;
app/Modules/APIs/Controllers/ManagementController.php:652:        if ($time_to) $url .= "&time_to=" . $time_to;
app/Modules/APIs/Controllers/ManagementController.php:653:        $url .= "&sort=" . $sort . "&limit=" . $limit . "&apikey=" . $apikey;
app/Modules/APIs/Controllers/ManagementController.php:655:        $json = file_get_contents($url);
app/Modules/APIs/Controllers/ManagementController.php:660:        $url = "https://alphavantageapi.co/timeseries/running_analytics?SYMBOLS=" . urlencode($symbols);
app/Modules/APIs/Controllers/ManagementController.php:661:        $url .= "&RANGE=" . $range . "&INTERVAL=DAILY&OHLC=close";
app/Modules/APIs/Controllers/ManagementController.php:662:        $url .= "&WINDOW_SIZE=" . $windowSize;
app/Modules/APIs/Controllers/ManagementController.php:663:        $url .= "&CALCULATIONS=" . urlencode($calculations) . "&apikey=" . $apikey;
app/Modules/APIs/Controllers/ManagementController.php:665:        $json = file_get_contents($url);
app/Modules/APIs/Controllers/ManagementController.php:940:        $url = "https://www.alphavantage.co/query?function=TOP_GAINERS_LOSERS&apikey=" . $apikey;
app/Modules/APIs/Controllers/ManagementController.php:941:        $json = file_get_contents($url);
app/Modules/APIs/Controllers/ManagementController.php:946:        $url = "https://www.alphavantage.co/query?function=IPO_CALENDAR&apikey=" . $apikey;
app/Modules/APIs/Controllers/ManagementController.php:947:        $csv = file_get_contents($url);
app/Modules/APIs/Controllers/AlertsController-06162025.php:275:        $url="https://www.sec.gov/Archives/edgar/data/{$cik}/index.json";
app/Modules/APIs/Controllers/AlertsController-06162025.php:279:        curl_setopt($ch, CURLOPT_URL, $url);
app/Modules/chatgpt.txt:1:<?php namespace App\Modules\Management\Controllers;use CodeIgniter\Controller;use Config\Services;use App\Config\{APIs,Auth,SiteSettings,SocialMedia};use App\Controllers\UserController;use App\Libraries\{BaseLoader,HtmlFormatter,MyMIAnalytics,MyMIAlerts,MyMIBudget,MyMIDashboard,MyMIExchange,MyMIMarketing,MyMIUser};use App\Models\{AlertsModel,AnnouncementModel,InvestmentModel,ManagementModel,MarketingModel,MyMIGoldModel,SolanaModel,UserModel};use App\Services\{DashboardService,GoalTrackingService,MarketingService,SolanaService,UserService};use CodeIgniter\API\ResponseTrait;use GuzzleHttp\Client;use GuzzleHttp\Exception\RequestException;use voku\helper\HtmlDomParser;class MarketingController extends UserController{use ResponseTrait;use BaseLoader;protected $API;protected $auth;protected $cuID;protected $data;protected $debug;protected $helpers=['auth','form','url'];protected $logger;protected $request;protected $session;protected $uri;protected $siteSettings;protected $NewsEmail;protected $HtmlFormatter;protected $MyMIAnalytics;protected $MyMIAlerts;protected $MyMIBudget;protected $MyMIDashboard;protected $MyMIExchange;protected $MyMIMarketing;protected $MyMIUser;protected $dashboardService;protected $goalTrackingService;protected $marketingService;protected $solanaService;protected $userService;protected $alertsModel;protected $investmentModel;protected $marketingModel;protected $userModel;protected $userAccount;protected $userDashboard;protected $getBlogPosts;protected $departmentTasks;protected $marketing;protected $reporting;public function __construct(){$this->API=config('APIs');$this->auth=service('authentication');$this->logger=service('logger');$this->NewsEmail=config('NewsEmailServer');$this->request=service('request');$this->session=Services::session();$this->siteSettings=config('SiteSettings');$this->debug=$this->siteSettings->debug;$this->uri=$this->request->getUri();$this->alertsModel=new AlertsModel();$this->investmentModel=new InvestmentModel();$this->marketingModel=new MarketingModel();$this->userDashboard=$this->getMyMIDashboard()->dashboardInfo($this->cuID);$this->departmentTasks=$this->getMyMIAnalytics()->get_department_tasks($this->uri->getSegment(2),['Page SEO Edit']);$this->getBlogPosts=$this->getMyMIMarketing()->getBlogPosts();$this->cuID=$this->session->get('user_id')?? $this->auth->id();if(!$this->cuID){log_message('error','Investments ControllerFailed to retrieve valid User ID in MyMIInvestments');throw new \RuntimeException('User ID could not be retrieved.');}log_message('debug',"InvestmentsController: cuID initialized as {$this->cuID}");$this->userAccount=$this->getMyMIUser()->getUserInformation($this->cuID);$userBudget=$this->getMyMIBudget()->getUserBudget($this->cuID);log_message('info','DashboardController L72 - $checkingSummary: '.$userBudget['checkingSummary']);$this->data['checkingSummary']=$userBudget['checkingSummary'];}public function commonData(): array{$this->data=$this->data ??[];$userData=$this->getuserService()->commonData();$this->data=array_merge($this->data,$userData);$this->data['siteSettings']=$this->siteSettings;$this->data['beta']=(string)$this->siteSettings->beta;$this->data['uri']=$this->request->getUri();$this->data['date']=$this->siteSettings->date;$this->data['time']=$this->siteSettings->time;$this->data['hostTime']=$this->siteSettings->hostTime;$dashboardInfo=$this->getDashboardService()->getDashboardInfo($this->cuID);$this->data['completedGoals']=$this->getGoalTrackingService()->getCompletedGoals($this->cuID);$this->data['pendingGoals']=$this->getGoalTrackingService()->getPendingGoals($this->cuID);$this->data['promotionalBanners']=$dashboardInfo['promotionalBanners'];$userBudget=$this->getBudgetService()->getUserBudget($this->cuID);$this->data['totalAccountBalance']=$userBudget['totalAccountBalance']?? 0;$this->data['totalAccountBalanceFMT']=$userBudget['totalAccountBalanceFMT']?? '0.00';$userSolanaData=$this->getSolanaService()->getSolanaData($this->cuID);$this->data['cuSolanaDW']=$userSolanaData['userSolanaWallets']['cuSolanaDW']?? null;$this->data['solanaNetworkStatus']=$userSolanaData['solanaNetworkStatus'];$this->data['cuSolanaTotal']=$userSolanaData['userSolanaWallets']['cuSolanaTotal']?? 0;$this->data['cuSolanaValue']=$userSolanaData['userSolanaWallets']['cuSolanaValue']?? 0;$this->data=array_merge($this->data,$userData);if($this->debug===1){}}public function index(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['recentMarketingPosts']=$this->getMyMIMarketing()->getRecentPosts(5);if(empty($this->data['recentMarketingPosts'])){log_message('info','ðŸ“­ No recent posts found. Running fallback generation...');$this->getMyMIMarketing()->generateFromTempScraper(5);$this->data['recentMarketingPosts']=$this->getMyMIMarketing()->getRecentPosts(25);}$this->data['todaysStory']=$this->marketingModel->getTodaysStory();$this->data['generatedSummaries']=$this->marketingModel->getLatestGeneratedSummaries(25);$this->data['marketingBuffer']=$this->marketingModel->getMarketingBuffer();if(empty($this->data['todaysStory'])){log_message('info','ðŸ“… No content generated today. Triggering summary fallback...');$this->getMyMIMarketing()->generateFromTempScraper(5);$this->data['todaysStory']=$this->marketingModel->where('DATE(created_at)',date('Y-m-d'))->orderBy('created_at','DESC')->findAll();}$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\index',$this->data);}public function add($type=null){log_message('debug','MarketingController L183 - add() method called with type: '.(is_null($type)?'null':$type));if(!empty($type)){if($this->request->getMethod()==='POST'){log_message('debug','Handling POST request for type: '.$type);if($type==='Schedule'){log_message('info','Processing Schedule submission');try{$this->marketingModel->addMarketingSchedule($this->request->getPost());log_message('info','Schedule data saved successfully');if($this->request->isAJAX()){return $this->response->setJSON(['success'=>true,'message'=>'Schedule added successfully']);}else{return redirect()->to('/Management/Marketing/Schedule')->with('success','Schedule added successfully');}}catch(\Exception $e){log_message('error','Error saving schedule: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to save schedule.']);}}elseif($type==='Campaign'){log_message('info','Processing Campaign submission');try{$campaignData=['beta'=>$this->request->getPost('beta'),'config_mode'=>$this->request->getPost('config_mode'),'form_mode'=>$this->request->getPost('form_mode'),'escalated'=>$this->request->getPost('escalated'),'user_id'=>$this->request->getPost('user_id'),'user_email'=>$this->request->getPost('user_email'),'username'=>$this->request->getPost('username'),'assigned_to'=>$this->request->getPost('assigned_to'),'date'=>$this->siteSettings->date,'time'=>$this->siteSettings->time,'campaign_name'=>$this->request->getPost('campaign_name'),'promotionalLinks'=>json_encode($this->request->getPost('promotionalLinks')),'overall_campaign_description'=>$this->request->getPost('overall_campaign_description'),'voice_script'=>$this->request->getPost('voice_script'),'facebookMessage'=>$this->request->getPost('facebookMessage'),'linkedinMessage'=>$this->request->getPost('linkedinMessage'),'discordMessage'=>$this->request->getPost('discordMessage'),'stocktwitsMessage'=>$this->request->getPost('stocktwitsMessage'),'tiktokMessage'=>$this->request->getPost('tiktokMessage'),'youtubeMessage'=>$this->request->getPost('youtubeMessage'),'emailMessage'=>$this->request->getPost('emailMessage'),'additionalInfo'=>$this->request->getPost('additionalInfo'),'hashtags'=>$this->request->getPost('hashtags'),];$this->marketingModel->addMarketingCampaign($campaignData);log_message('info','Campaign data saved successfully');if($this->request->isAJAX()){log_message('info','MarketingController L251 - This is using the $this->request->isAJAX() Form Submission');return $this->response->setJSON(['success'=>true,'message'=>'Campaign added successfully']);}else{log_message('info','MarketingController L251 - This is NOT using the $this->request->isAJAX() Form Submission');return redirect()->to('/Management/Marketing/Campaigns')->with('success','Campaign added successfully');}}catch(\Exception $e){log_message('error','Error saving campaign: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to save campaign.']);}}else{log_message('error','Unrecognized type in POST request: '.$type);return $this->response->setJSON(['error'=>'Unrecognized type in POST request']);}}if($this->request->getMethod()==='get'){log_message('debug','Handling GET request for type: '.$type);if($type==='Schedule'){log_message('debug','Loading view for Schedule');try{$response=$this->renderTheme('ManagementModule\Views\Marketing\Schedule\Add',$this->data);log_message('debug','View for Schedule loaded successfully');return $response;}catch(\Exception $e){log_message('error','Failed to load view for Schedule: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to load view for Schedule']);}}elseif($type==='Campaign'){log_message('debug','Loading view for Campaign');try{$response=$this->renderTheme('ManagementModule\Views\Marketing\Campaign\Add',$this->data);log_message('debug','View for Campaign loaded successfully');return $response;}catch(\Exception $e){log_message('error','Failed to load view for Campaign: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to load view for Campaign']);}}else{log_message('error','Unrecognized type in GET request: '.$type);return $this->response->setJSON(['error'=>'Unrecognized type in GET request']);}}}else{log_message('warning','No type provided; redirecting to /Management/Marketing');return redirect()->to('/Management/Marketing')->with('error','No type provided');}}public function addSchedule(){if($this->request->getMethod()==='post'){$additionalInfo=$this->request->getPost('additional_info');$jsonData=null;if(!empty($additionalInfo)){$jsonData=json_decode($additionalInfo,true);if(json_last_error()!==JSON_ERROR_NONE){return redirect()->back()->withInput()->with('error','Invalid JSON format in Additional Information.');}}$scheduleData=['day'=>$this->request->getPost('day'),'time'=>$this->request->getPost('time'),'activity'=>$this->request->getPost('activity'),'link'=>$this->request->getPost('link'),'additional_info'=>json_encode($jsonData)];$this->marketingModel->addMarketingSchedule($scheduleData);return redirect()->to(base_url('Management/Marketing/Schedule'))->with('success','New schedule added successfully.');}$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Schedule\Add');}public function addSubscriber(){helper('email');$rawRequestBody=$this->request->getBody();$jsonData=json_decode($rawRequestBody,true);$marketingModel=new MarketingModel();$subscriberData=['email'=>$jsonData['email'],'category'=>$jsonData['category'],'referral'=>$jsonData['referral'],'beta'=>$this->siteSettings->beta,'date'=>date('Y-m-d H:i:s'),'hostTime'=>date('Y-m-d H:i:s'),'time'=>date('H:i:s'),'user_id'=>session('user_id'),'user_ip'=>$this->request->getIPAddress()];if($marketingModel->addSubscriber($subscriberData)){$emailService=\Config\Services::email();$emailService->setTo($subscriberData['email']);$emailService->setSubject('ðŸŽ‰ Welcome to Investorâ€™s Talk | MyMI Wallet');$emailService->setMessage(view('emails/welcomeInvestor',['siteSettings'=>$this->siteSettings,'socialMedia'=>config('SocialMedia'),]));if($emailService->send()){log_message('info','Management/MarketingController L346 - $emailService: '.print_r($emailService,true));return $this->response->setJSON(['success'=>true,'message'=>'Subscriber email sent successfully']);}else{log_message('error','Management/MarketingController L346 - Error Submitting: $emailService: '.print_r($emailService,true));return $this->response->setJSON(['success'=>false,'message'=>'Failed to send Welcome Email']);}}else{return $this->response->setJSON(['success'=>false,'message'=>'Failed to add subscriber']);}}public function approveBufferItem($id){$this->marketingModel->updateBufferStatus($id,'approved');return $this->respond(['status'=>'success','message'=>'Approved']);}public function approveLogo(){$symbol=$this->request->getPost('symbol');$imageUrl=$this->request->getPost('imageUrl');try{$this->marketingModel->saveApprovedLogo($symbol,$imageUrl);return $this->response->setJSON(['success'=>true,'message'=>'Logo approved successfully.',]);}catch(\Exception $e){log_message('error','Failed to approve logo: '.$e->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to approve logo.',]);}}public function approveAndDownloadLogo(){$imageUrl=$this->request->getPost('selectedImage');$symbol=$this->request->getPost('symbol');try{$imageContent=file_get_contents($imageUrl);$imagePath=WRITEPATH.'uploads/Company-Logos/'.$symbol.'.png';file_put_contents($imagePath,$imageContent);$publicPath=FCPATH.'assets/images/Company-Logos/'.$symbol.'.png';rename($imagePath,$publicPath);return redirect()->to('/Management/Marketing/upcomingEarnings')->with('success','Logo approved and saved successfully.');}catch(\Exception $e){log_message('error','Failed to download or save logo: '.$e->getMessage());return redirect()->back()->with('error','Failed to save the logo.');}}public function approveContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['status'=>'approved']);return redirect()->back()->with('success','Content approved successfully.');}public function blogs(){$this->data['pageTitle']='MyMI Blogs | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['blogs']=$this->marketingModel->getBlogs();$this->data['totalBlogs']=$this->marketingModel->countBlogs();$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Blogs',$this->data);}public function campaigns(){$this->data['pageTitle']='Marketing Campaigns | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['getActiveCampaigns']=$this->marketing['department']['getActiveCampaigns'];$this->data['getActivePriorityCampaigns']=$this->marketing['department']['getActivePriorityCampaigns'];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\campaigns',$this->data);}public function contentGenerator(){try{$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\contentGenerator',$this->data);}catch(\Throwable $th){log_message('error','MarketingController contentGenerator error: '.$th->getMessage());}}public function contentReview(){$generatedContent=$this->session->get('generatedContent');if(empty($generatedContent)){return redirect()->to('/Management/Marketing')->with('error','No generated content available for review.');}return $this->renderTheme('ManagementModule\Views\Marketing\Content_Review',['generatedContent'=>$generatedContent]);}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);log_message('debug','âœ… Content digest completed.');}public function cronFetchAndStoreEmails(){try{log_message('debug','Starting cronFetchAndStoreEmails');$this->marketingService->scrapeAndStoreEmailsToTemp();log_message('debug','Finished cronFetchAndStoreEmails');return $this->respond(['status'=>'success']);}catch(\Throwable $e){log_message('error','cronFetchAndStoreEmails Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();log_message('debug','âœ… Inbox scrape completed.');}public function cronFetchMarketingEmails(){log_message('info','CRON: Starting Marketing Email Fetch');$service=new MarketingService();$emailsFetched=$this->getMyMIMarketing()->fetchAndStoreEmails('newsletters');log_message('info','CRON: Fetched '.$emailsFetched.' marketing emails');return $this->respond(['status'=>'success','fetched'=>$emailsFetched]);}public function cronGenerateContentFromTemp(){try{log_message('debug','Starting cronGenerateContentFromTemp');$this->marketingService->generateFinalContentFromTemp();log_message('debug','Finished cronGenerateContentFromTemp');return $this->respond(['status'=>'success']);}catch(\Throwable $e){log_message('error','cronGenerateContentFromTemp Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function cronSendDailyLog(){date_default_timezone_set('America/Chicago');$contentData=$this->getLogsOrFallback();$emailView=view('emails/daily_log_summary',['contentData'=>$contentData['data'],'contentType'=>$contentData['type'],]);$subject=($contentData['type']==='logs')?'Daily Log Summary for '.date('F j, Y'):'Fallback Content - Daily Summary '.date('F j, Y');$this->email->setTo('community@mymiwallet.com')->setSubject($subject)->setMessage($emailView)->send();$this->email->setTo('team@mymiwallet.com')->setSubject('Reminder: Daily Log Email Pending Confirmation')->setMessage('The daily log email is scheduled to be sent at 3 PM CST. Please review the content to ensure everything is accurate.')->send();}public function edit($id=null){if($id===null){throw new \CodeIgniter\Exceptions\PageNotFoundException('Exchange ID not provided');}$tokenData=$this->marketingModel->getExchangeTokenById($id);if(!$tokenData){throw new \CodeIgniter\Exceptions\PageNotFoundException('Token not found');}if($this->request->getMethod()==='post'){$validation=\Config\Services::validation();$validation->setRules(['coin_name'=>'required','market_cap'=>'required|numeric','website'=>'required|valid_url','discord'=>'permit_empty|valid_url','facebook'=>'permit_empty|valid_url','telegram'=>'permit_empty|valid_url','twitter'=>'permit_empty|valid_url',]);if($validation->withRequest($this->request)->run()){$updatedData=['coin_name'=>$this->request->getPost('coin_name'),'market_cap'=>$this->request->getPost('market_cap'),'website'=>$this->request->getPost('website'),'discord'=>$this->request->getPost('discord'),'facebook'=>$this->request->getPost('facebook'),'telegram'=>$this->request->getPost('telegram'),'twitter'=>$this->request->getPost('twitter'),];if($this->marketingModel->updateExchangeToken($id,$updatedData)){$this->session->setFlashdata('success','Exchange token updated successfully');}else{$this->session->setFlashdata('error','Failed to update the exchange token');}return redirect()->to(site_url('Management/Marketing/Exchanges/Edit/'.$id));}else{$this->session->setFlashdata('validation_errors',$validation->getErrors());}}return $this->renderTheme('ManagementModule\Views\Marketing\Exchanges\edit',['token'=>$tokenData,'validation'=>$this->session->getFlashdata('validation_errors'),'redirectURL'=>site_url('Management/Marketing/Exchanges'),]);}public function editContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}return $this->renderTheme('ManagementModule\Views\Marketing\Content_Edit',['content'=>$content]);}public function fetchBufferPaginated(){$page=(int) $this->request->getGet('page')?:1;$limit=(int) $this->request->getGet('limit')?:20;$data=$this->marketingModel->fetchBufferPaginated($page,$limit);return $this->respond($data);}public function fetchLatestSummaries(){$generatedSummaries=$this->marketingModel->getLatestGeneratedSummaries(25);return $this->renderTheme('ManagementModule\Views\Marketing\resources\generatedSummaries',['generatedSummaries'=>$generatedSummaries]);}public function fetchMissingLogos(){$postData=$this->request->getJSON(true);$csrfName=csrf_token();$csrfHash=csrf_hash();if(!isset($postData[$csrfName])||$postData[$csrfName]!==$csrfHash){log_message('error','fetchMissingLogos: CSRF validation failed');return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['error'=>'Invalid CSRF token.']);}$symbols=$postData['symbols']?? null;if(empty($symbols)||!is_array($symbols)){log_message('error','fetchMissingLogos: Invalid symbols input');return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['error'=>'Invalid symbols input.']);}$results=[];foreach($symbols as $symbol){$results[]=['symbol'=>$symbol,'status'=>'not_found',];}return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['results'=>$results]);}public function financialNews(){$symbols=$this->investmentModel->getAllSymbolsByEarnings();$approvedLogos=$this->marketingModel->getApprovedLogos();$existingSymbols=array_column($approvedLogos,'symbol');$missingSymbols=array_filter($symbols,function($symbol)use($existingSymbols){return!in_array($symbol['symbol'],$existingSymbols);});$this->data['approvedLogos']=$approvedLogos ??[];$this->data['missingSymbols']=$missingSymbols ??[];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\financialNews',$this->data);}public function generateAudio(){$text=$this->request->getPost('text');$fileName=$this->request->getPost('fileName')?:uniqid('tts_',true);$directory=WRITEPATH.'uploads/';$outputFile=$directory.$fileName.'.mp3';if(empty($text)){return $this->response->setJSON(['status'=>'error','message'=>'Text cannot be empty.',]);}if(!is_dir($directory)){mkdir($directory,0777,true);}$command=sprintf('python3 gtts_script.py %s %s',escapeshellarg($text),escapeshellarg($outputFile));exec($command,$output,$status);if($status===0&&file_exists($outputFile)){$fileUrl=base_url('uploads/'.basename($outputFile));return $this->response->setJSON(['status'=>'success','message'=>'Audio file generated successfully.','file_url'=>$fileUrl,]);}else{return $this->response->setJSON(['status'=>'error','message'=>'Failed to generate audio.',]);}}private function generateAutomatedContent(){$scraperContent=$this->marketingModel->getRecentScrapes();$tempContent=$this->marketingModel->getRecentTempScrapes();$campaigns=$this->marketingModel->getActiveCampaignsLimited(50);$allContent=array_merge($scraperContent,$tempContent,$campaigns);$generatedContent=[];foreach($allContent as $content){$generatedContent[]=$this->getMarketingService()->generateContentFromPost($content->title ?? 'Untitled',$content->content ?? '',$content->tags?explode(',',$content->tags):[]);}foreach($generatedContent as $content){$slug=$this->marketingModel->createSlug($content['title']);$this->db->table('bf_marketing_blog_posts')->insert(['title'=>$content['title']?? 'Generated Content','content'=>$content['summary']?? '','slug'=>$slug,'tags'=>implode(',',$content['keywords']??[]),'created_on'=>date('Y-m-d H:i:s'),]);$this->marketingModel->saveDailyLog(['title'=>$content['title'],'content'=>$content['summary'],'type'=>'Automated','tags'=>implode(',',$content['keywords']),'date_time'=>date('Y-m-d H:i:s'),'author_information'=>'MyMI Automated System','created_on'=>date('Y-m-d H:i:s'),]);}return $generatedContent;}public function generateContent($platform,$postId){$post=$this->marketingModel->getSchedulePostById($postId);if(!$post){return redirect()->back()->with('error','Post not found.');}$content=$this->getMyMIMarketing()->generateContentFromGPT($post['subjects'],$post['descriptions'],$platform);$contentData=['post_id'=>$postId,'platform'=>$platform,'generated_content'=>$content,];$this->marketingModel->storeGeneratedContent($contentData);return redirect()->to("\Management\Marketing\Schedule")->with('success','Content generated successfully.');}public function generateContentDigestFromStored(){log_message('info','Marketing: Starting summary generation from stored marketing emails.');$model=new MarketingModel();$records=$model->getRecentUnprocessedTempEmails(5);$results=[];foreach($records as $record){if(empty($record['content'])||strlen($record['content'])<1000){log_message('debug',"âš ï¸ Skipping record ID {$record['id']} due to insufficient content length.");continue;}if(empty($record['title'])||empty($record['content'])){log_message('debug','Skipped record due to missing title/content ID: '.$record['id']);continue;}try{$summary=$this->getMarketingService()->generateContentFromRaw($record['title'],$record['content']);$model->storeFinalMarketingContent(['source_id'=>$record['id'],'title'=>$record['title'],'summary'=>$summary,'created_at'=>date('Y-m-d H:i:s')]);$model->markTempRecordAsProcessed($record['id']);$results[]=$record['title'];}catch(\Throwable $e){log_message('error','Failed to process record ID '.$record['id'].': '.$e->getMessage());}}return $this->respond(['status'=>'complete','processed_titles'=>$results]);}public function generateContentFromTweet($tweetId){$tweet=$this->marketingModel->getTweetById($tweetId);if(!$tweet){return $this->failNotFound('Tweet not found');}$generatedContent=$this->getMyMIMarketing()->generateContentFromTweets([$tweet]);$this->marketingModel->storeGeneratedContent(['tweet_id'=>$tweetId,'content'=>json_encode($generatedContent),'created_at'=>date('Y-m-d H:i:s')]);$this->getMyMIMarketing()->postToTwitter($generatedContent['platform_content']['Twitter']);return $this->respond(['message'=>'Content generated and posted successfully']);}public function generateDailyContentDigest(){log_message('debug','ðŸ§  Start Memory Usage: '.memory_get_usage(true));@ini_set('memory_limit','768M');$limit=5;$summary=[];$rawRecords=$this->marketingModel->getLatestUnprocessedEmails($limit);foreach($rawRecords as $record){$content=$record['content']?? '';if(empty($content)||strlen($content)<500){log_message('debug',"â­ï¸ Skipped record ID {$record['id']} - insufficient content.");continue;}$contentSize=strlen($content);log_message('debug','ðŸ“Œ Processing record ID '.$record['id'].' with content size: '.$contentSize);log_message('debug','Management/MarketingController L770 - $record Array: '.print_r($record,true));if($contentSize===0){log_message('debug',"â­ï¸ Skipped record ID {$record['id']} - empty content.");continue;}try{gc_collect_cycles();$processed=$this->getMarketingService()->generateContentFromRaw($record);if($processed===null){log_message('debug',"âš ï¸ Skipped record ID {$record['id']} - generateContentFromRaw() returned null.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$summary[]=['title'=>$processed['headline'],'summary'=>$processed['summary'],'subtopics'=>$processed['subtopics'],'platform_posts'=>$processed['posts'],];}catch(\Throwable $e){log_message('error',"âŒ generateDailyContentDigest failed on record ID {$record['id']}: {$e->getMessage()}");}}$this->marketingModel->markEmailsAsProcessed(array_column($rawRecords,'id'));log_message('debug','ðŸ Peak Memory Usage: '.memory_get_peak_usage(true));return $this->response->setJSON(['digest'=>$summary]);}public function generateNewsletterContent(){$emailContents=$this->marketingModel->getEmailContentsForNewsletter();$content=$this->getMyMIMarketing()->generateNewsletterContent($emailContents);$newsletterData=['title'=>'Monthly Financial Newsletter - '.date('F Y'),'content'=>$content,'status'=>'draft','created_at'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeNewsletterDraft($newsletterData);return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Newsletter content generated successfully');}private function generateSummarizedFallbackContent($contentArray){$summarizedContent=[];$summarizer=new \App\Libraries\ContentSummarizer();foreach($contentArray as $content){$summarizedContent[]=['title'=>$content->title ?? 'Untitled','summary'=>$summarizer->summarize($content->content ?? '',200),'url'=>$content->url ?? null,];}return $summarizer->combineSummaries($summarizedContent);}private function getLogsOrFallback(){$logs=$this->marketingModel->getDailyLogsByDate(date('Y-m-d'));if(!empty($logs)){return['type'=>'logs','data'=>$logs];}$scrapedContent=$this->marketingModel->getRecentScrapes();$campaigns=$this->marketingModel->getActiveCampaignsLimited(50);$combinedContent=array_merge($scrapedContent,$campaigns['result']);$fallbackContent=$this->generateSummarizedFallbackContent($combinedContent);foreach($fallbackContent as $content){$this->marketingModel->saveDailyLog(['title'=>$content['title']?? 'Automated Content','content'=>$content['summary']?? '','type'=>'Automated','tags'=>implode(',',$content['keywords']??[]),'date_time'=>date('Y-m-d H:i:s'),'author_information'=>'MyMI Automated System','created_on'=>date('Y-m-d H:i:s'),]);}return['type'=>'fallback','data'=>$fallbackContent];}public function getRecentScrapes(){try{$scrapes=$this->marketingModel->getRecentScrapes();return $this->response->setJSON(['success'=>true,'scrapes'=>$scrapes]);}catch(\Throwable $th){log_message('error','getRecentScrapes: Exception - '.$th->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to fetch recent scrapes.']);}}private function handleMediaUpload($mediaFiles){$uploadedMedia=[];foreach($mediaFiles as $file){if($file->isValid()&&!$file->hasMoved()){$newFileName=$file->getRandomName();$file->move(WRITEPATH.'uploads/media/',$newFileName);$uploadedMedia[]=['file_name'=>$file->getClientName(),'file_path'=>WRITEPATH.'uploads/media/'.$newFileName,'file_size'=>$file->getSize(),'file_type'=>$file->getMimeType(),];}}return $uploadedMedia;}public function ideas(){$this->data['pageTitle']='Marketing Campaigns | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['getActiveIdeas']=$this->marketingModel->getActiveIdeas();$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\ideas',$this->data);}public function importScheduleCSV(){if($this->request->getMethod()==='post'){$file=$this->request->getFile('csv_file');if($file->isValid()&&!$file->hasMoved()){$filePath=WRITEPATH.'uploads/'.$file->store();$csvData=array_map('str_getcsv',file($filePath));foreach($csvData as $row){$scheduleData=['day'=>$row[0],'time'=>$row[1],'activity'=>$row[2],];$scheduleId=$this->marketingModel->addMarketingSchedule($scheduleData);$campaignData=['sched_id'=>$scheduleId,'title'=>$row[3],'platform'=>$row[4],'content'=>$row[5],];$this->marketingModel->addMarketingCampaign($campaignData);}return redirect()->back()->with('success','Schedule and campaigns imported successfully.');}return redirect()->back()->with('error','Invalid CSV file.');}return $this->renderTheme('ManagementModule\Views\Marketing\importCSV');}public function previewBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Item not found.");return $this->renderTheme('ManagementModule\Views\Marketing\modals\bufferPreview',['item'=>$record]);}public function previewGeneratedPost($id){try{$post=$this->marketingModel->find($id);if(!$post){return $this->failNotFound('Post not found.');}return $this->renderTheme('App\Modules\Management\Views\Marketing\modals/previewGeneratedPost',['post'=>$post]);}catch(\Throwable $e){log_message('error','âŒ Failed to load post preview: '.$e->getMessage());return $this->failServerError('Unable to preview post.');}}public function previewPendingSummaries(){try{$pendingSummaries=$this->marketingModel->getPendingScraperSummaries(10);return $this->renderTheme('App\Modules\Management\Views\Marketing\partials\previewPendingSummaries',['pendingSummaries'=>$pendingSummaries]);}catch(\Throwable $e){log_message('error','âŒ previewPendingSummaries failed: '.$e->getMessage());return $this->failServerError('Could not load summaries.');}}public function previewVideoScript($id){$post=$this->marketingModel->getGeneratedPostById($id);if(!$post)return $this->failNotFound('Post not found.');$posts=json_decode($post['posts'],true);$videoScript=$posts['video']?? 'No video script generated yet.';return $this->renderTheme('MarketingModule\Views\Marketing\modals\video_preview_modal',['title'=>$post['title'],'videoScript'=>$videoScript,]);}public function processScheduledPosts(){$currentTimestamp=date('Y-m-d H:i:s');$scheduledPosts=$this->marketingModel->getPendingScheduledPosts($currentTimestamp);foreach($scheduledPosts as $post){$payload=['platform'=>$post->platform,'content'=>$post->content,'media_url'=>$post->media_url,];try{$response=$this->sendToZapier($post->zapier_webhook_url,$payload);if($response->getStatusCode()===200){$this->marketingModel->updatePostStatus($post->id,'posted');}else{throw new Exception("Zapier response error: {$response->getBody()}");}}catch(Exception $e){$this->handlePostFailure($post,$e->getMessage());}}}private function sendToZapier($webhookUrl,$payload){$client=new \GuzzleHttp\Client();return $client->post($webhookUrl,['headers'=>['Content-Type'=>'application/json'],'json'=>$payload,]);}private function handlePostFailure($post,$error){$this->marketingModel->incrementRetryCount($post->id);log_message('error',"Failed to post to Zapier for Post ID {$post->id}: {$error}");if($post->retry_count>=3){$this->marketingModel->updatePostStatus($post->id,'failed');}}public function postCreator(){try{$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\index',$this->data);}catch(\Throwable $th){log_message('error','MarketingController postCreator error: '.$th->getMessage());}}public function promote(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['exchangeAssets']=[];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Promote',$this->data);}public function publishBlog($blogId){$blog=$this->marketingModel->getBlogPostDetails($blogId);if(!$blog){return redirect()->back()->with('error','Blog post not found.');}$this->marketingModel->update($blogId,['status'=>'published']);return redirect()->to('/Management/Marketing/Blogs')->with('success','Blog published successfully.');}public function rejectBufferItem($id){$this->marketingModel->updateBufferStatus($id,'rejected');return $this->respond(['status'=>'success','message'=>'Rejected']);}public function rejectContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['status'=>'rejected']);return redirect()->back()->with('success','Content rejected successfully.');}public function reviewBuffer(){$buffer=$this->marketingModel->getBufferItems();$this->data['pageTitle']='Marketing Buffer Dashboard';$this->data['buffer']=$buffer;return $this->renderTheme('ManagementModule\Views\Marketing\BufferDashboard',$this->data);}public function runContentGeneration(){$generatedContent=$this->generateAutomatedContent();$this->session->set('generatedContent',$generatedContent);return redirect()->to('/Management/Marketing/ContentReview')->with('success',count($generatedContent).' content items generated successfully. Please review and approve.');}private function sanitizeContent($content){$content=preg_replace('#<script(.*?)>(.*?)</script>#is','',$content);$content=preg_replace('#<style(.*?)>(.*?)</style>#is','',$content);$content=strip_tags($content);$content=preg_replace('/\s+/',' ',$content);return trim($content);}private function saveCampaign($formData){$data=['title'=>$formData['title'],'description'=>$formData['description'],];$this->marketingModel->addMarketingCampaign($data);}public function saveContentEdit($id){$postData=$this->request->getPost();$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['content'=>$postData['content'],'status'=>'pending',]);return redirect()->to('/Management/Marketing/ContentReview')->with('success','Content updated successfully.');}private function saveSchedule($formData){$scheduleModel=new \App\Models\ScheduleModel();$data=['title'=>$formData['title'],'description'=>$formData['description'],];$scheduleModel->insert($data);}public function schedule($day=null){if(!empty($day)){$this->data['marketingSchedule']=$this->marketingModel->getScheduleByDay($day);foreach($this->data['marketingSchedule']as&$schedule){$schedule['campaigns']=$this->marketingModel->getCampaignsBySchedId($schedule['id']);}$this->data['scheduleByDay']='Yes';}else{$this->data['marketingSchedule']=$this->marketingModel->getUpcomingSchedule();foreach($this->data['marketingSchedule']as&$schedule){$schedule['campaigns']=$this->marketingModel->getCampaignsBySchedId($schedule['id']);}$this->data['scheduleByDay']='No';}$this->commonData();$this->data['pageTitle']='Daily Schedule | Management | MyMI Wallet';return $this->renderTheme('ManagementModule\Views\Marketing\Schedule',$this->data);}public function scheduleNewsletterCampaign(){$newsletterDraft=$this->marketingModel->getLatestNewsletterDraft();if(!$newsletterDraft){return $this->response->setJSON(['success'=>false,'message'=>'No newsletter draft found']);}$campaignData=['title'=>$newsletterDraft['title'],'content'=>$newsletterDraft['content'],'status'=>'scheduled','send_date'=>$this->request->getPost('send_date'),'target_audience'=>'all_users','created_at'=>date('Y-m-d H:i:s'),];if($this->marketingModel->scheduleNewsletterCampaign($campaignData)){return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Newsletter campaign scheduled successfully');}else{return redirect()->back()->with('error','Failed to schedule newsletter campaign');}}private function scrapeGoogleSearch($query){$searchUrl='https://www.google.com/search?q='.urlencode($query);$client=new Client();try{$response=$client->get($searchUrl);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$dom=new \DOMDocument();libxml_use_internal_errors(true);$dom->loadHTML($html);libxml_clear_errors();$xpath=new \DOMXPath($dom);$results=[];foreach($xpath->query('//a[@href]')as $link){$href=$link->getAttribute('href');if(strpos($href,'/url?q=')===0){$href=substr($href,7,strpos($href,'&')-7);$text=$link->nodeValue;$results[]=['href'=>$href,'text'=>$text];}}return $results;}else{log_message('error','scrapeGoogleSearch: Could not retrieve content, HTTP status code - '.$response->getStatusCode());return['error'=>'Could not retrieve content, HTTP status code - '.$response->getStatusCode()];}}catch(RequestException $e){log_message('error','scrapeGoogleSearch: RequestException - '.$e->getMessage());return['error'=>'RequestException error: '.$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeGoogleSearch: General error - '.$e->getMessage());return['error'=>'General error: '.$e->getMessage()];}return[];}public function scrapeLink(){$rawRequestBody=$this->request->getBody();$jsonData=json_decode($rawRequestBody,true);$url=$jsonData['url']?? null;if(!$url){log_message('error','scrapeLink: URL is missing');return $this->response->setJSON(['success'=>false,'message'=>'URL is required.']);}try{log_message('debug','scrapeLink: Scraping URL - '.$url);$scrapedData=$this->scrapeWebsiteWithFallback($url);if(isset($scrapedData['error'])){log_message('error','scrapeLink: '.$scrapedData['error']);return $this->response->setJSON(['success'=>true,'message'=>'Partially scraped data, proceeding with available data.']);}if(!empty($scrapedData['content'])){$this->marketingModel->storeTempScrapedData(['title'=>$scrapedData['title'],'content'=>$scrapedData['content'],'links'=>json_encode($scrapedData['links']),'url'=>$scrapedData['url'],'scraped_at'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),]);return $this->response->setJSON(['success'=>true,'message'=>'Scraped data stored successfully.','data'=>$scrapedData]);}else{log_message('error','scrapeLink: Scraped data is empty');return $this->response->setJSON(['success'=>false,'message'=>'Scraping failed. Please check the URL and try again.']);}}catch(\Throwable $th){log_message('error','scrapeLink: Exception - '.$th->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'An error occurred during scraping.']);}}private function scrapeLinks($links){$scrapedLinksData=[];foreach($links as $link){$url=filter_var($link['href'],FILTER_SANITIZE_URL);if(filter_var($url,FILTER_VALIDATE_URL)){$scrapedData=$this->scrapeWebsite($url);if(!empty($scrapedData['content'])){$scrapedLinksData[]=$scrapedData;}}}return $scrapedLinksData;}private function scrapeWebsite($url){$client=new Client();try{$response=$client->get($url,['stream'=>true,'headers'=>['User-Agent'=>'MyMI Wallet Bot'],'timeout'=>10,'http_errors'=>false ]);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$dom=HtmlDomParser::str_get_html($html);if($dom instanceof \voku\helper\HtmlDomParser){$title=$dom->find('title',0)->text ?? 'No title found';$bodyNode=$dom->find('body',0);$bodyContent=$bodyNode?$this->sanitizeContent($bodyNode->innerHtml()):'No body content found';$links=[];foreach($dom->find('a')as $link){$href=$link->getAttribute('href');$text=$link->text;$links[]=['href'=>$href,'text'=>$text];}log_message('debug','scrapeWebsite: Scraping successful for URL - '.$url);return['title'=>$title,'content'=>$bodyContent,'links'=>$links,'url'=>$url];}else{log_message('error','scrapeWebsite: DOM parsing failed for URL - '.$url);return['error'=>'DOM parsing failed.'];}}else{log_message('error','scrapeWebsite: Could not retrieve content, HTTP status code - '.$response->getStatusCode());return['error'=>'Could not retrieve content, HTTP status code - '.$response->getStatusCode()];}}catch(RequestException $e){if($e->hasResponse()&&$e->getResponse()->getStatusCode()==401){log_message('error','scrapeWebsite: Unauthorized access for URL - '.$url);return['error'=>'Unauthorized access. Skipping URL.'];}log_message('error','scrapeWebsite: RequestException - '.$e->getMessage());return['error'=>'RequestException error: '.$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeWebsite: General error - '.$e->getMessage());return['error'=>'General error: '.$e->getMessage()];}}private function scrapeWebsiteWithFallback($url){try{log_message('debug','scrapeWebsiteWithFallback: Scraping URL - '.$url);$scrapedData=$this->scrapeWebsite($url);if(empty($scrapedData['content'])){log_message('debug','scrapeWebsiteWithFallback: Scraped data is empty, performing Google search fallback');$googleSearchResults=$this->scrapeGoogleSearch($url);$scrapedLinksData=$this->scrapeLinks($googleSearchResults);$scrapedData['google_search_results']=$scrapedLinksData;}return $scrapedData;}catch(RequestException $e){log_message('error','scrapeWebsiteWithFallback: RequestException - '.$e->getMessage());return['error'=>$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeWebsiteWithFallback: General error - '.$e->getMessage());return['error'=>$e->getMessage()];}}public function searchAndApproveLogo($symbol){$query=$symbol.' logo png transparent';$searchUrl='https://www.google.com/search?q='.urlencode($query).'&tbm=isch';try{$response=$this->client->request('GET',$searchUrl);$htmlContent=$response->getBody()->getContents();$dom=new \DOMDocument();@$dom->loadHTML($htmlContent);$xpath=new \DOMXPath($dom);$imageNodes=$xpath->query('//img');$imageUrls=[];foreach($imageNodes as $imageNode){$src=$imageNode->getAttribute('src');if($src){$imageUrls[]=$src;}}return $this->renderTheme('ManagementModule\Views\Marketing\approve_logo',['symbol'=>$symbol,'imageUrls'=>$imageUrls,]);}catch(RequestException $e){log_message('error','Google Search Request Failed: '.$e->getMessage());return redirect()->back()->with('error','Failed to fetch logo suggestions.');}}public function sendScheduledNewsletter(){$campaigns=$this->marketingModel->getScheduledCampaigns();foreach($campaigns as $campaign){$this->getMyMIMarketing()->sendNewsletter($campaign['content'],$campaign['target_audience']);$this->marketingModel->updateCampaignStatus($campaign['id'],'sent');}return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Scheduled newsletters sent successfully');}public function standaloneAddSubscriber(){$this->data['pageTitle']='Add Subscriber | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneAddSubscriber',$this->data);}public function standaloneScrape(){$this->data['pageTitle']='Quick Scraper | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneScraper',$this->data);}private function storeScrapedData($scrapedData){$db=\Config\Database::connect();$builder=$db->table('bf_marketing_temp_scraper');$data=['title'=>$scrapedData['title'],'content'=>$scrapedData['content'],'links'=>json_encode($scrapedData['links']),'url'=>$scrapedData['url'],'created_at'=>date('Y-m-d H:i:s'),'updated_at'=>date('Y-m-d H:i:s'),];$builder->insert($data);}public function submitContent(){$request=service('request');$validationRules=['campaignName'=>'required|min_length[3]','promotionalLinks'=>'required','facebookMessage'=>'required','linkedinMessage'=>'required','discordMessage'=>'required','stockTwitsMessage'=>'required','tiktokMessage'=>'required','youtubeMessage'=>'required','emailMessage'=>'required',];if(!$this->validate($validationRules)){return redirect()->back()->with('errors',$this->validator->getErrors())->withInput();}$campaignData=['name'=>$request->getPost('campaignName'),'promotional_links'=>json_encode($request->getPost('promotionalLinks')),'facebook_message'=>$request->getPost('facebookMessage'),'linkedin_message'=>$request->getPost('linkedinMessage'),'discord_message'=>$request->getPost('discordMessage'),'stocktwits_message'=>$request->getPost('stockTwitsMessage'),'tiktok_message'=>$request->getPost('tiktokMessage'),'youtube_message'=>$request->getPost('youtubeMessage'),'email_message'=>$request->getPost('emailMessage'),'additional_info'=>$request->getPost('additionalInfo'),'created_on'=>date('Y-m-d H:i:s'),'status'=>1,'stage'=>'draft',];$marketingModel=new MarketingModel();if($marketingModel->insert($campaignData)){return redirect()->to('/Marketing/Success')->with('success','Marketing content submitted successfully.');}else{return redirect()->back()->with('error','Failed to submit marketing content.')->withInput();}}public function submitDailyLog(){$data=['title'=>$this->request->getPost('subject'),'content'=>$this->request->getPost('log_content'),'subcontent'=>json_encode($this->request->getPost('subcontent')),'tags'=>$this->request->getPost('tags'),'type'=>$this->request->getPost('content_type'),'url'=>$this->request->getPost('url'),'author_information'=>$this->request->getPost('author_information'),'date_time'=>$this->request->getPost('date_time'),'trade_alert_subcategory'=>$this->request->getPost('trade_alert_subcategory'),'created_on'=>date('Y-m-d H:i:s'),];if($this->marketingModel->saveDailyLog($data)){return $this->response->setJSON(['success'=>true,'message'=>'Daily log submitted successfully!']);}else{return $this->response->setJSON(['success'=>false,'message'=>'Failed to submit daily log.']);}}public function submitLargeContent(){log_message('debug','submitLargeContent method called');try{$subject=$this->request->getPost('subject');$url=$this->request->getPost('url');$content=$this->request->getPost('large_content');$tags=$this->request->getPost('tags');$uploadedFiles=$this->request->getFiles();$contentType=$this->request->getPost('content_type');$mediaAssets=$this->handleMediaUpload($uploadedFiles['media_assets']);if(empty($content)||strlen($content)<50){throw new \Exception('Content too short or empty');}$generatedContent=$this->getMyMIMarketing()->generateContentFromLargeText($content,$tags);$keywords=is_array($generatedContent['keywords'])?$generatedContent['keywords']:[];$this->marketingModel->storeScrapedContent(['status'=>'pending','type'=>$contentType,'url'=>$url,'title'=>$subject,'summary'=>$generatedContent['summary'],'content'=>$content,'keywords'=>implode(', ',$keywords),'created_on'=>date('Y-m-d H:i:s'),]);return $this->response->setJSON(['success'=>true]);}catch(\Exception $e){log_message('error','submitLargeContent error: '.$e->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to submit content.']);}}public function submitLargeContentForm(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();$this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneLargeContentForm',$this->data);}public function submitMarketingCampaign(){helper(['form','url']);$data=['name'=>$this->request->getPost('campaignName'),'assigned_to'=>$this->request->getPost('assigned_to'),'promotional_links'=>json_encode($this->request->getPost('promotionalLinks')),'facebook_message'=>htmlentities($this->request->getPost('facebookMessage'),ENT_QUOTES,'UTF-8'),'linkedin_message'=>htmlentities($this->request->getPost('linkedinMessage'),ENT_QUOTES,'UTF-8'),'discord_message'=>htmlentities($this->request->getPost('discordMessage'),ENT_QUOTES,'UTF-8'),'stocktwits_message'=>htmlentities($this->request->getPost('stocktwitsMessage'),ENT_QUOTES,'UTF-8'),'tiktok_message'=>htmlentities($this->request->getPost('tiktokMessage'),ENT_QUOTES,'UTF-8'),'youtube_message'=>htmlentities($this->request->getPost('youtubeMessage'),ENT_QUOTES,'UTF-8'),'email_message'=>htmlentities($this->request->getPost('emailMessage'),ENT_QUOTES,'UTF-8'),'additional_info'=>htmlentities($this->request->getPost('additionalInfo'),ENT_QUOTES,'UTF-8'),'overall_campaign_description'=>htmlentities($this->request->getPost('overall_campaign_description'),ENT_QUOTES,'UTF-8'),'voice_script'=>htmlentities($this->request->getPost('voice_script'),ENT_QUOTES,'UTF-8')];if($this->validate(['name'=>'required','facebook_message'=>'required',])){$this->marketingModel->submitCampaignContent($data);return redirect()->to('/dashboard')->with('success','Campaign submitted successfully.');}else{return redirect()->back()->withInput()->with('errors',$this->validator->getErrors());}}public function submitMarketIdeas(){if($this->request->getMethod()==='post'){$data=['title'=>$this->request->getPost('title'),'description'=>htmlentities($this->request->getPost('description'),ENT_QUOTES,'UTF-8'),'created_by'=>session()->get('user_id'),'assigned_to'=>$this->request->getPost('assigned_to'),'priority'=>$this->request->getPost('priority'),'status'=>'draft','platforms'=>json_encode($this->request->getPost('platforms')),'additional_info'=>htmlentities($this->request->getPost('additional_info'),ENT_QUOTES,'UTF-8'),];$uploadedFiles=$this->request->getFiles();$filePaths=[];if($uploadedFiles&&isset($uploadedFiles['imageFiles'])){foreach($uploadedFiles['imageFiles']as $file){if($file->isValid()&&!$file->hasMoved()){$newName=$file->getRandomName();$file->move(FCPATH.'public/assets/images/Marketing/Ideas',$newName);$filePaths[]=base_url('assets/images/Marketing/Ideas/'.$newName);}}}if(!empty($filePaths)){$data['image_paths']=json_encode($filePaths);}if($this->validate(['title'=>'required','description'=>'required'])){$this->marketingModel->submitIdea($data);return redirect()->back()->with('success','Idea submitted successfully.');}else{return redirect()->back()->withInput()->with('errors',$this->validator->getErrors());}}}public function topCommunities($channel=null){$this->commonData();$MyMIExchange=new MyMIExchange();$exchangeTokens=$MyMIExchange->getSolanaTokens();if(!empty($channel)){if($channel==='Discord'){$this->data['tokens']=$exchangeTokens['discord'];$this->data['pageTitle']='Discord Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\discord',$this->data);}elseif($channel==='Facebook'){$this->data['tokens']=$exchangeTokens['facebook'];$this->data['pageTitle']='Facebook Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\facebook',$this->data);}elseif($channel==='Twitter'){$this->data['tokens']=$exchangeTokens['x_twitter'];$this->data['pageTitle']='Twitter Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\twitter',$this->data);}elseif($channel==='Website'){$this->data['tokens']=$exchangeTokens['website'];$this->data['pageTitle']='Website Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\website',$this->data);}else{$this->data['tokens']=$exchangeTokens['all'];$this->data['pageTitle']='All Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\all_tokens',$this->data);}}else{$this->data['tokens']=$exchangeTokens['all'];$this->data['pageTitle']='All Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\all_tokens',$this->data);}}public function triggerPostAutogenOnEmpty(){$today=date('Y-m-d');$existing=$this->marketingModel->getLatestGeneratedSummaries(5,$today);if(!empty($existing)){return $this->response->setJSON(['status'=>'skipped','message'=>'Summaries already exist for today.']);}try{$this->getMyMIMarketing()->generateFromTempScraper(5);return $this->response->setJSON(['status'=>'generated','message'=>'Generated new summaries.']);}catch(\Throwable $e){log_message('error','triggerPostAutogenOnEmpty error: '.$e->getMessage());return $this->failServerError('Failed to generate summaries.');}}public function twitterDashboard(){$data=['pageTitle'=>'Twitter Dashboard','hashtags'=>$this->request->getPost('hashtags')?? '','tweets'=>[]];if($this->request->getMethod()==='post'){$hashtags=$this->request->getPost('hashtags');$tweets=$this->getMyMIMarketing()->fetchTweets($hashtags);$data['tweets']=$tweets;}return $this->renderTheme('Management/Marketing/Twitter',$data);}public function upcomingEarnings(){$model=new \App\Models\EarningsModel();$upcomingEarnings=$model->getUpcomingEarnings();$this->data['upcomingEarnings']=$upcomingEarnings;return $this->renderTheme('ManagementModule\Views\Marketing\upcoming_earnings',$this->data);}public function updatePlatformToggle($id){$post=$this->request->getJSON(true);$platform=$post['platform'];$enabled=(bool) $post['enabled'];$record=$this->marketingModel->getBufferItem($id);$platforms=json_decode($record['platforms']?? '{}',true);$platforms[$platform]=$enabled;$this->marketingModel->updateBufferItem($id,['platforms'=>json_encode($platforms)]);return $this->respond(['status'=>'success']);}public function viewBlog($slug){$blogPost=$this->marketingModel->getBlogPostBySlug($slug);if(!$blogPost){throw new \CodeIgniter\Exceptions\PageNotFoundException('Blog post not found');}return $this->renderTheme('blog/view',['blogPost'=>$blogPost]);}public function viewCampaign($campaign_id){$campaignModel=new CampaignModel();$campaign=$this->marketingModel->getCampaignsById($campaign_id);if(!$campaign){throw new \CodeIgniter\Exceptions\PageNotFoundException("Campaign not found");}return $this->renderTheme('ManagementModule\Views\Marketing\Campaigns\View',['campaign'=>$campaign]);}public function viewDailyLogs($date=null){$date=$this->siteSettings->date ?? date('Y-m-d');$this->data['pageTitle']='Marketing Daily Log | '.$date.' | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['logs']=$this->marketingModel->getDailyLogsByDate($date);$this->commonData();return $this->renderTheme('ManagementModul\Views\Marketing\Daily_Logs',['logs'=>$logs,'date'=>$date]);}public function viewEmail($titleEncoded=null,$messageId=null){log_message('debug','ðŸ“§ ManagementController::viewEmail called');try{if(empty($messageId)){return redirect()->back()->with('error','Invalid email identifier.');}$emailRecord=$this->marketingModel->getEmailByMessageId($messageId);if(!$emailRecord){return redirect()->back()->with('error','Email not found.');}$socialMediaPosts=$this->getMarketingService()->generateContentFromRaw($emailRecord);$emailRecord['social_media']=$socialMediaPosts['posts']??[];return $this->renderTheme('Management/Marketing/EmailDetail',['email'=>$emailRecord]);}catch(\Throwable $e){log_message('error','âŒ viewEmail() failed: '.$e->getMessage());return $this->failServerError('Unable to load email.');}}public function viewGeneratedContent(){$contentData=$this->marketingModel->getLastGeneratedContent();$platformsContent=json_decode($contentData['platforms_content'],true);$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['platforms_content']=$platformsContent;$this->commonData();$this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneGeneratedContent',$this->data);}public function viewGeneratedSummaries(){$this->data['pageTitle']='Generated Summaries';$this->data['generatedSummaries']=$this->marketingModel->getLatestGeneratedSummaries(25);$this->renderTheme('ManagementModule\Views\Marketing\resources\generatedSummaries',$this->data);}} ?><?php namespace App\Modules\APIs\Controllers;use CodeIgniter\API\ResponseTrait;use CodeIgniter\Controller;use App\Libraries\{BaseLoader,MyMIMarketing};use App\Services\MarketingService;use App\Models\MarketingModel;class MarketingController extends Controller{use ResponseTrait;use BaseLoader;protected $MyMIMarketing;protected $marketingService;protected $marketingModel;public function __construct(){$this->MyMIMarketing=new MyMIMarketing();$this->marketingModel=new MarketingModel();}public function approveBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Record not found.");$this->marketingModel->updateBufferItem($id,['status'=>'approved']);$posts=$this->MyMIMarketing->generateSocialPost($record);$this->MyMIMarketing->distributeContent('discord',$posts['discord']);$this->MyMIMarketing->distributeContent('linkedin',$posts['linkedin']);return $this->respond(['status'=>'success','message'=>'Content approved & promoted!']);}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);return $this->respond(['status'=>'success','message'=>'Content analysis completed.']);}public function cronFetchAndGenerateNews(){try{$this->MyMIMarketing->cronFetchAndGenerateNews();return $this->respond(['status'=>'success','message'=>'News fetched and generated.']);}catch(\Throwable $e){return $this->failServerError($e->getMessage());}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();return $this->respond(['status'=>'success','message'=>'Inbox scraped.']);}public function cronFetchMarketingEmails(){log_message('info','ðŸ“¬ CRON: Fetching marketing emails via inbox scrape');try{$result=$this->getMyMIMarketing()->scrapeInboxAndStore();return $this->respond(['status'=>'success','message'=>'Marketing inbox scrape completed.','result'=>$result]);}catch(\Throwable $e){log_message('error','âŒ cronFetchMarketingEmails() failed: '.$e->getMessage());return $this->failServerError('Inbox fetch failed: '.$e->getMessage());}}public function distributeHighScoreContent(){try{$this->getMyMIMarketing()->autoSendToZapier(80);return $this->respond(['status'=>'success','message'=>'Top scoring posts sent to Zapier']);}catch(\Throwable $e){return $this->failServerError($e->getMessage());}}public function exportBufferPosts(){helper('text');$model=new \App\Models\MarketingModel();$bufferPosts=$model->fetchBufferPostsForScoring();$filename='buffer-posts-'.date('Ymd_His').'.csv';$csvHeader=['ID','Keyword','Summary','Score','Tag Score','Category','Status','Created At'];$csvData=[$csvHeader];foreach($bufferPosts as $post){$csvData[]=[$post['id'],$post['keyword'],word_limiter(strip_tags($post['summary']),10),$post['score'],$post['tag_score'],$post['category'],$post['status'],$post['created_at']?? '',];}header('Content-Type: text/csv');header("Content-Disposition: attachment; filename=\"$filename\"");$f=fopen('php://output','w');foreach($csvData as $row){fputcsv($f,$row);}fclose($f);exit;}public function fetchBufferPaginated(){$request=service('request');$page=(int) $request->getGet('page')?? 1;$limit=(int) $request->getGet('limit')?? 20;$keyword=$request->getGet('keyword');$category=$request->getGet('category');$minTagScore=$request->getGet('min_tag_score')?? 0;$onlySuggested=(bool) $request->getGet('only_suggested');$result=$this->marketingModel->fetchBufferPaginatedWithFilters(['page'=>$page,'limit'=>$limit,'keyword'=>$keyword,'category'=>$category,'min_tag_score'=>$minTagScore,'only_suggested'=>$onlySuggested]);return $this->respond(['status'=>'success','data'=>$result['data'],'pagination'=>$result['pagination']]);}public function fetchGeneratedSummaries(){try{$summaries=$this->marketingModel->getRecentPosts(5);return $this->respond(['status'=>'success','summaries'=>$summaries,]);}catch(\Throwable $e){log_message('error','âŒ fetchGeneratedSummaries Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function fetchGeneratedSummariesBlock(){try{helper('text');$todaysStory=$this->marketingModel->where('DATE(created_at)',date('Y-m-d'))->orderBy('created_at','desc')->findAll();return $this->renderTheme('App\Modules\Management\Views\Marketing\index/generatedSummariesBlock',['todaysStory'=>$todaysStory]);}catch(\Throwable $e){log_message('error','âŒ Failed to fetch summaries block: '.$e->getMessage());return $this->failServerError('Unable to refresh summaries.');}}public function generateContentFromScraper(){try{$this->getMyMIMarketing()->generateFromTempScraper(25);return $this->respond(['status'=>'success','message'=>'Content generated from scraper.']);}catch(\Throwable $e){log_message('error','âŒ generateContentFromScraper Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function generateContentDigestFromStored(){$records=$this->marketingModel->getRecentUnprocessedTempEmails(5);$processedTitles=[];foreach($records as $record){$recordId=$record['id']?? 0;try{if(empty($record['title'])){$record['title']='Fallback Title - ID '.$recordId;}$insertResult=$this->getMyMIMarketing()->generateContentAndInsert($record);if($insertResult){$this->marketingModel->markTempScraperProcessed($recordId);$processedTitles[]=$insertResult['title'];log_message('info',"âœ… Inserted content for ID {$recordId}");}else{log_message('warning',"âš ï¸ Skipped record ID {$recordId} â€” summary not stored");}}catch(\Throwable $e){log_message('error',"âŒ Exception on record ID {$recordId}: {$e->getMessage()}");}}return $this->respond(['status'=>'complete','processed_titles'=>$processedTitles]);}public function generateDailyContentDigest(){@ini_set('memory_limit','768M');$records=$this->marketingModel->getValidUnprocessedEmails(5);$insertedSummaries=[];foreach($records as $record){if(!is_array($record)){log_message('error','âŒ Invalid record structure: Expected array, got '.gettype($record));continue;}try{log_message('debug','ðŸ” Processing record ID '.$record['id']);$result=$this->getMyMIMarketing()->generateContentAndInsert($record);if($result){$this->marketingModel->markTempScraperProcessed($record['id']);$insertedSummaries[]=$result['title']?? '(no title)';log_message('info',"âœ… Successfully processed and inserted record ID {$record['id']}");}else{log_message('warning',"âš ï¸ Skipped or failed to insert record ID {$record['id']}");}}catch(\Throwable $e){log_message('error',"âŒ Exception on record ID {$record['id']}: ".$e->getMessage());}}return $this->respond(['status'=>'success','inserted'=>$insertedSummaries]);}public function generatePostsFromSummary($summaryId=null){try{$summary=$this->marketingModel->find($summaryId);if(!$summary){return $this->failNotFound('Summary not found.');}$decodedTitleRaw=$summary['title']?? '';$decodedSummaryRaw=$summary['summary']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$decodedSummary=quoted_printable_decode($decodedSummaryRaw);$decodedSummary=preg_replace('/=\r?\n/','',$decodedSummary);$decodedSummary=html_entity_decode($decodedSummary,ENT_QUOTES|ENT_HTML5,'UTF-8');$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$decodedTitle);$cleanedSummary=html_entity_decode(strip_tags($decodedSummary));$keywords=$this->MyMIMarketing->extractKeywords($cleanedSummary);$posts=$this->MyMIMarketing->generateSocialPosts($cleanedSummary,$keywords);$this->marketingModel->update($summaryId,['keywords'=>json_encode($keywords),'posts'=>json_encode($posts),]);return $this->respond(['status'=>'success','message'=>'Content generated and stored successfully.','original'=>$summary,'cleaned'=>['title'=>$cleanTitle,'summary'=>$cleanedSummary,'keywords'=>$keywords,'posts'=>$posts,],]);}catch(\Throwable $e){log_message('error','âŒ generatePostsFromSummary() failed: '.$e->getMessage());return $this->failServerError('Error generating posts.');}}public function generateScheduledPosts(){helper('text');$marketingModel=new MarketingModel();$marketing=new MyMIMarketing();$buffer=$marketingModel->getTopBufferPosts(3,6.5);if(empty($buffer)){return $this->respond(['status'=>'empty','message'=>'No queued posts available.']);}foreach($buffer as $post){$marketingModel->updateBufferItem($post['id'],['status'=>'promoted']);$generated=$marketing->generateSocialPost($post);if(json_decode($post['platforms'])->discord ?? false){$marketing->distributeContent('discord',$generated['discord']);}if(json_decode($post['platforms'])->linkedin ?? false){$marketing->distributeContent('linkedin',$generated['linkedin']);}$marketing->notifyModerators($post);}return $this->respond(['status'=>'success','message'=>'Posts published!']);}public function generateVoiceScriptManually(){try{log_message('info','ðŸŽ¤ generateVoiceScriptManually() triggered.');$script=$this->getMyMIMarketing()->generateVoiceoverScript();return $this->response->setJSON(['status'=>'success','script'=>$script]);}catch(\Throwable $e){log_message('error','âŒ Error in generateVoiceScriptManually: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()]);}}public function massResendActivationEmails(){$userModel=new \App\Models\UserModel();$users=$userModel->getPendingActivationUsers();$activator=service('activator');$success=0;$failure=0;foreach($users as $user){if($activator->send($user)){$success++;}else{$failure++;}}return $this->respond(['status'=>'success','message'=>"$success emails sent, $failure failed."]);}public function monitorKeywordsAndScrape(){log_message('info','ðŸ§  Keyword Monitor Started');$keywords=$this->getMyMIMarketing()->getKeywordCandidates();if(empty($keywords)){return $this->respond(['status'=>'no_keywords']);}$results=[];foreach($keywords as $keyword){try{$scrapedData=$this->getMyMIMarketing()->scrapeGoogleSearch($keyword);if(!empty($scrapedData)){$summary=$this->getMyMIMarketing()->generateContentFromScrapedData($scrapedData,'generic');if($summary){$score=$this->getMyMIMarketing()->scoreKeywordRelevance($keyword,$summary);$results[]=['keyword'=>$keyword,'summary'=>$summary,'score'=>$score];$this->marketingModel->storeFinalMarketingContent(['source_id'=>null,'title'=>"Keyword: $keyword",'summary'=>$summary,'keywords'=>$keyword,'score'=>$score,'created_at'=>date('Y-m-d H:i:s')]);}}}catch(\Throwable $e){log_message('error',"âŒ Failed keyword scrape for {$keyword}: ".$e->getMessage());}}return $this->respond(['status'=>'complete','processed'=>$results]);}public function processMarketingTempEmails($limit=5,$mode='daily',$id=null){try{log_message('debug',"ðŸ§  Running unified email processor with mode={$mode}, limit={$limit}, id={$id}");if($id){$record=$this->marketingModel->getEmailRecordById($id);if(!$record||empty($record['content'])){return $this->failNotFound("No valid temp email record found for ID {$id}");}$cleanText=strip_tags($record['content']);$summary=$this->getMyMIMarketing()->summarizeText($cleanText);$keywords=$this->getMyMIMarketing()->extractKeywords($cleanText);if(empty($summary)||empty($keywords)){return $this->fail("Failed to generate summary or keywords for record ID {$id}");}$testPosts=['discord'=>"ðŸ’¬ *{$record['title']}*: {$summary} #".implode(' #',$keywords),'linkedin'=>"ðŸ“¢ {$record['title']} â€” {$summary}",'email'=>"Subject: {$record['title']}\n\n{$summary}",'x'=>substr($summary,0,250).'...'];$generated=['summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts];$this->marketingModel->insertFinalScraper($record,$generated);$this->marketingModel->markTempScraperProcessed($id);return $this->respond(['status'=>'success','message'=>"âœ… Test record stored for ID {$id}",'summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts]);}$records=($mode==='backfill')?$this->marketingModel->getOlderUnprocessedEmails($limit):$this->marketingModel->getValidUnprocessedEmails($limit);$results=[];foreach($records as $record){$recordId=$record['id']?? 0;if(empty($record['title'])){$record['title']="Fallback Title - ID {$recordId}";}try{$insert=$this->getMyMIMarketing()->generateContentAndInsert($record);if($insert){$this->marketingModel->markTempScraperProcessed($recordId);log_message('info',"âœ… Inserted record ID {$recordId}");$results[]=$insert['title'];}else{log_message('warning',"âš ï¸ Skipped ID {$recordId} â€” No summary generated.");}}catch(\Throwable $e){log_message('error',"âŒ Exception on ID {$recordId}: ".$e->getMessage());}}return $this->respond(['status'=>'success','mode'=>$mode,'inserted'=>$results]);}catch(\Throwable $e){return $this->failServerError("ðŸ”¥ Unified content processor failed: ".$e->getMessage());}}public function rankBufferPostsDaily(){$marketingModel=new MarketingModel();$marketing=new MyMIMarketing();$threshold=getenv('MARKETING_TFIDF_THRESHOLD')?:7.5;$pendingPosts=$marketingModel->getPendingBufferItems();foreach($pendingPosts as $post){$scoreData=$marketing->getTopKeywordScores(['summary'=>$post['summary'],]);$update=['score'=>$scoreData['score']?? 0,'tag_score'=>$scoreData['tag_score']?? 0,'tfidf_score'=>$scoreData['tfidf_score']?? 0,'auto_suggest'=>($scoreData['tfidf_score']?? 0)>=$threshold?1:0,];$marketingModel->updateBufferItem($post['id'],$update);}return $this->respond(['status'=>'success','message'=>'Buffer ranks updated.']);}public function rejectBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Record not found.");$this->marketingModel->updateBufferItem($id,['status'=>'rejected']);return $this->respond(['status'=>'success','message'=>'Content rejected.']);}public function runBackfillForTempEmails(){try{log_message('info','[ðŸ”„ Backfill] Starting backfill for unprocessed temp emails...');$unprocessedRecords=$this->marketingModel->where('status',null)->orWhere('status','')->findAll(25);if(empty($unprocessedRecords)){return $this->respond(['status'=>'complete','message'=>'No unprocessed records found.']);}$processedTitles=[];foreach($unprocessedRecords as $record){try{$result=$this->MyMIMarketing->generateContentAndInsert($record);if($result){$this->marketingModel->markTempScraperProcessed($record['id']);$processedTitles[]=$result['title'];}}catch(\Throwable $e){log_message('error','[âŒ Backfill Error] ID '.$record['id'].' â€” '.$e->getMessage());}}return $this->respond(['status'=>'success','processed'=>$processedTitles]);}catch(\Throwable $e){return $this->failServerError('[ðŸ”¥ Backfill Failure] '.$e->getMessage());}}public function testGenerateFromTempEmail($id){try{helper('text');$record=$this->marketingModel->getEmailRecordById($id);if(!$record||empty($record['content'])){return $this->failNotFound("No valid temp email record found for ID {$id}");}log_message('info',"ðŸ§ª Starting test content generation for temp record ID: {$id}");$cleanText=strip_tags($record['content']);$summary=$this->getMyMIMarketing()->summarizeText($cleanText);$summary=quoted_printable_decode($summary);$summary=mb_convert_encoding($summary,'UTF-8','UTF-8');$keywords=$this->getMyMIMarketing()->extractKeywords($cleanText);if(empty($summary)||empty($keywords)){return $this->fail("Failed to generate summary or keywords for record ID {$id}");}$decodedTitleRaw=$record['title']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$decodedTitle);$testPosts=['discord'=>"ðŸ’¬ *{$cleanTitle}*: {$summary} #".implode(' #',$keywords),'linkedin'=>"ðŸ“¢ {$cleanTitle} â€” {$summary}",'email'=>"Subject: {$cleanTitle}\n\n{$summary}",'x'=>substr($summary,0,250).'...',];$generated=['summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts];$this->marketingModel->insertFinalScraper($record,$generated);$this->marketingModel->markTempScraperProcessed($id);log_message('info',"âœ… Test record stored in bf_marketing_scraper for temp ID {$id}");return $this->respond(['status'=>'success','message'=>"Content generated and stored successfully.",'summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts]);}catch(\Throwable $e){log_message('critical',"âŒ testGenerateFromTempEmail({$id}) failed: ".$e->getMessage());return $this->failServerError("An error occurred: ".$e->getMessage());}}public function testTfIdfEdgeCases(){$cases=['Empty String'=>'','Whitespace Only'=>'     ','Single Word'=>'Bitcoin','HTML Only'=>'<div><p></p></div>','Malformed UTF-8'=>"\xB1\x31",'Link-Only Spam'=>'http://marketwatch.com https://example.com','Token Noise'=>str_repeat('$$$!!!@@@###',10),];$results=[];foreach($cases as $label=>$input){try{log_message('info',"ðŸ§ª Running TF-IDF Test Case: $label");$cleanInput=is_string($input)?strip_tags(trim($input)):'';if(strlen($cleanInput)<10||substr_count($cleanInput,' ')<2){log_message('debug',"âš ï¸ Skipping test: $label â€” input too short or lacks structure.");$results[$label]='[Skipped â€” Too short or unstructured]';continue;}$summary=$this->MyMIMarketing->summarizeText($cleanInput);log_message('debug',"Result - Summary: $summary");$results[$label]=$summary;}catch(\Throwable $e){log_message('error',"âŒ $label threw error: ".$e->getMessage());$results[$label]='[Error: '.$e->getMessage().']';}}return $this->renderTheme('App\Modules\Management\Views\Marketing\debugTfIdfResults',['results'=>$results,]);}public function triggerPostAutogenOnEmpty(){try{$existingPosts=$this->marketingModel->where('DATE(scraped_at)',date('Y-m-d'))->countAllResults();if($existingPosts===0){log_message('debug','[ðŸª„ AutoGen Trigger] No posts found for today. Running fallback generatorâ€¦');$this->marketingService->generatePostsFromTodaysSummaries();return $this->respond(['status'=>'success','message'=>'No posts found. Generated fresh content.']);}else{return $this->respond(['status'=>'success','message'=>'Posts already exist for today. No action taken.']);}}catch(\Throwable $e){log_message('error','[âŒ AutoGen Trigger Error] '.$e->getMessage());return $this->respond(['status'=>'error','message'=>'Failed to trigger autogen.','error'=>$e->getMessage()]);}}public function updateBufferScheduleInterval($id){$data=$this->request->getJSON(true);$interval=(int)($data['interval']?? 0);$updated=$this->marketingModel->updateBufferItem($id,['schedule_interval'=>$interval,'scheduled_at'=>null ]);if($updated){return $this->respond(['status'=>'success']);}else{return $this->fail('Failed to update interval.');}}public function updatePlatformToggle($id){$data=$this->request->getJSON(true);$platform=$data['platform'];$enabled=$data['enabled'];$record=$this->marketingModel->find($id);if(!$record){return $this->failNotFound("Record not found.");}$platforms=json_decode($record['platforms']?? '{}',true);$platforms[$platform]=$enabled;$this->marketingModel->update($id,['platforms'=>json_encode($platforms)]);return $this->respond(['status'=>'success']);}} ?><?php namespace App\Libraries;use App\Config\{SiteSettings,SocialMedia};use App\Libraries\{BaseLoader,MyMIInvestments};use App\Libraries\Traits\TextProcessor;use App\Models\{AnalyticalModel,MarketingModel};use App\Services\{EmailService,MarketingService,SolanaService};use CodeIgniter\HTTP\RequestInterface;use CodeIgniter\Session\Session;use Myth\Auth\Authorization\GroupModel;use Exception;use HTMLPurifier;use HTMLPurifier_Config;use Phpml\FeatureExtraction\TokenCountVectorizer;use Phpml\Tokenization\WhitespaceTokenizer;use Phpml\FeatureExtraction\TfIdfTransformer;use NlpTools\Tokenizers\WhitespaceTokenizer as NlpWhitespaceTokenizer;use NlpTools\Similarity\CosineSimilarity;use Facebook\Facebook;use Abraham\TwitterOAuth\TwitterOAuth;use Happyr\LinkedIn\LinkedIn;use Discord\Discord;use Discord\Parts\Channel\Message;use GuzzleHttp\Client;use Scrapemax\ScrapemaxClient;use Pscrape\Pscrape\Scrape as PscrapeScraper;use Symfony\Component\DomCrawler\Crawler;use Google\Cloud\TextToSpeech\V1\TextToSpeechClient;use Google\Cloud\TextToSpeech\V1\SynthesisInput;use Google\Cloud\TextToSpeech\V1\VoiceSelectionParams;use Google\Cloud\TextToSpeech\V1\AudioConfig;use Google\Cloud\TextToSpeech\V1\AudioEncoding;class MyMIMarketing{use BaseLoader;use TextProcessor;protected $auth;protected $cuID;protected $data;protected $debug;protected $logger;protected $request;protected $session;protected $uri;protected $APIs;protected $emailService;protected $solanaService;protected $siteSettings;protected $marketingModel;protected $analyticalModel;protected $socialMedia;protected $facebook;protected $twitter;protected $linkedin;protected $discord;protected $scrapemax;protected $pscrape;public function __construct(){$this->auth=service('authentication');$this->logger=service('logger');$this->request=service('request');$this->session=service('session');$this->uri=$this->request->getUri();$this->APIs=config('APIs');$this->socialMedia=config('SocialMedia');$this->siteSettings=config('SiteSettings');$this->debug=$this->siteSettings->debug;$this->socialMedia=config('SocialMedia');$this->marketingModel=new MarketingModel();$this->analyticalModel=new AnalyticalModel();$this->emailService=service('email');$this->solanaService=new SolanaService();$this->scrapemax=new ScrapemaxClient('https://api.scrapemax.com',$this->APIs->scrapemax_api_key);$this->pscrape=new PscrapeScraper();}public function marketing(){$department=$this->department();$links=$this->social_media();return['links'=>$links,'department'=>$department];}public function distributeTradeAlert($alert,$action='BUY'){$message=$this->generateTradeAlertMessage($alert,$action);$this->postToDiscord($message);$this->postToTwitter($message);$this->postToFacebook($message);$this->postToLinkedIn($message);}public function generateRandomMarketingContent(array $tradeAlert):array{$intros=["ðŸš¨ Breaking Market Update!","ðŸ“¢ Urgent Trade Alert!","ðŸ”¥ High-Momentum Stock Pick!","ðŸš€ Skyrocketing Stocks!","ðŸ’° Smart Money Moves!","âš¡ Quick Market Insight!","ðŸ“ˆ Bullish Breakout Alert!","ðŸ“Š Technical Setup Unfolding!","ðŸ§ Deep Market Analysis!","ðŸ’¡ Pro-Level Trading Insight!"];$emoticons=['ðŸš€','ðŸ”¥','ðŸ’°','ðŸ“ˆ','ðŸ“Š','âš¡','âœ…','ðŸ¤–','ðŸŽ¯','ðŸ”'];$outros=["ðŸ“Š Stay ahead of the markets!","â³ Don't miss this setup!","ðŸ’° Trade smart & maximize gains!","ðŸš€ Follow for more trade alerts!","ðŸ“ˆ Watch this ticker closely!","ðŸ”¥ This could be the next big mover!","ðŸ’¡ Insights that matter. Stay tuned!","ðŸ’Ž Precision trading at its best!","âš¡ More insights coming soon!","ðŸ“¢ Tap in for more premium setups!"];$intro=$intros[array_rand($intros)];$outro=$outros[array_rand($outros)];$emote1=$emoticons[array_rand($emoticons)];$emote2=$emoticons[array_rand($emoticons)];$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$tradeDesc=trim($tradeAlert['trade_description']?? '');$news=trim($tradeAlert['financial_news']?? '');$details=trim($tradeAlert['details']?? '');$price=number_format($tradeAlert['price']?? 0,2);$link=trim($tradeAlert['tv_chart']?? $tradeAlert['tv_chart_link']?? '');$chartText=(!empty($link))?"ðŸ“‰ Chart: [View Here]({$link})\n":'';$fixedLength=strlen($intro)+strlen($outro)+strlen($emote1)+strlen($emote2)+strlen($chartText)+12;$maxMessageLength=2000-$fixedLength;$coreMessage="Trade Alert for **{$ticker}** ({$company}):\n"."Price: \${$price}\n"."Signal: {$tradeDesc}\n"."News: {$news}\n"."Details: {$details}\n".$chartText;if(strlen($coreMessage)>$maxMessageLength){$coreMessage=substr($coreMessage,0,$maxMessageLength-3)."...";}$finalMessage="{$emote1} {$intro}\n{$coreMessage}\n{$outro} {$emote2}";return['twitter'=>substr($finalMessage,0,280),'facebook'=>substr($finalMessage,0,2000),'linkedin'=>substr($finalMessage,0,2000),'discord'=>substr($finalMessage,0,2000)];}public function generateEmailContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$news=$tradeAlert['financial_news']?? '';$details=$tradeAlert['details']?? '';$content="Email Alert for {$ticker} ({$company}):\n"."Current Price: \${$price}\n"."Trade Signal: {$tradeDesc}\n"."Latest News: {$news}\n"."Analysis Details: {$details}\n"."For more information, visit our website.";return $content;}public function generateBlogContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$news=$tradeAlert['financial_news']?? '';$details=$tradeAlert['details']?? '';$content="Blog Post: In-depth Market Analysis on {$ticker} ({$company})\n\n"."Current Price: \${$price}\n\n"."Trade Analysis: {$tradeDesc}\n\n"."Financial News: {$news}\n\n"."Detailed Analysis: {$details}\n\n"."Stay tuned for more insights!";return $content;}public function generateVoiceoverScriptContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$script="Voiceover Script:\n"."Welcome to today's market update. Our focus is on {$ticker} from {$company}.\n"."The current trading price is \${$price}.\n"."Trade insight: {$tradeDesc}.\n"."Thank you for watching. Stay tuned for more updates.";return $script;}public function generateTradeAlertEmailContent(array $tradeAlert):string{$defaultTemplate=<<<S
app/Modules/chatgpt.txt:44:S;}public function formatSocialPost(string $headline,string $summary,string $platform='generic'):string{$hashtags='#MyMIWallet #InvestSmarter #FinancialFreedom';switch($platform){case 'facebook':case 'linkedin':return"{$headline}\n\n{$summary}\n\nStart your journey: https://www.mymiwallet.com\n\n{$hashtags}";case 'twitter':case 'x':$shortSummary=substr($summary,0,180);return"{$headline} â€” {$shortSummary}...\nhttps://www.mymiwallet.com\n{$hashtags}";default:return"{$headline}\n\n{$summary}\nhttps://www.mymiwallet.com";}}public function formatDiscordPost(string $headline,string $summary):string{return"**{$headline}**\n\n{$summary}\n\nðŸ‘‰ <https://www.mymiwallet.com>";}private function normalizeUtf8($text){return mb_convert_encoding($text,'UTF-8',mb_detect_encoding($text,'UTF-8, ISO-8859-1',true));}private function notifyAdminOnError($subject,$message){$this->emailService->setFrom('no-reply@mymiwallet.com','MyMI Wallet');$this->emailService->setTo('team@mymiwallet.com');$this->emailService->setSubject($subject);$this->emailService->setMessage($message);if(!$this->emailService->send()){$this->logger->error('Failed to send error notification email: '.print_r($this->emailService->printDebugger(),true));}}public function notifyModerators(array $post){$platforms=json_decode($post['platforms']?? '{}',true);$used=implode(', ',array_keys(array_filter($platforms)));$subject="ðŸ“¢ Buffer Post Promoted: {$post['keyword']}";$message="âœ… Post ID: {$post['id']}\n\n"."Summary: ".wordwrap($post['summary'],80)."\n\n"."Promoted Platforms: {$used}\n\n".site_url('Marketing/PreviewGeneratedPost/'.$post['id']);$email=\Config\Services::email();$email->setTo('moderators@mymiwallet.com');$email->setSubject($subject);$email->setMessage($message);$email->send();log_message('info',"ðŸ“¬ Sent moderator alert for Buffer ID {$post['id']}");}public function reprocessIncompleteEmails(){$incompleteRecords=$this->marketingModel->getEmailsMissingTitleOrUrl(20);log_message('debug','ðŸ“‹ MyMIMarketing L986 - Incomplete records fetched: '.count($incompleteRecords));foreach($incompleteRecords as $record){try{$emailId=$record['message_id']?? null;$content=$record['content']?? '';$title=$record['title']?? '';$url=$record['url']?? '';if(!$emailId)continue;$email=$this->fetchEmailByMessageId($emailId);if($email){$content=$email['body']?? $content;$title=$email['subject']?? $title;$url=$email['link']?? $url;}$title=$title?:'Untitled Email - '.date('Y-m-d H:i');$url=$url?:'https://mymiwallet.com/news/fallback';$this->marketingModel->updateEmailFields($record['id'],$title,$url,$content);}catch(\Throwable $e){log_message('error','âŒ Error backfilling email ID '.$record['id'].': '.$e->getMessage());}}}private function retry($function,$attempts=3,$delay=2000){$attempt=0;while($attempt<$attempts){try{return $function();}catch(Exception $e){$attempt++;if($attempt>=$attempts){throw $e;}sleep($delay/1000);}}}private function sanitizeContent($content){$content=preg_replace('#<script(.*?)>(.*?)</script>#is','',$content);$content=preg_replace('#<noscript(.*?)>(.*?)</noscript>#is','',$content);$content=strip_tags($content)?? '';$content=preg_replace('/\.\s*/','. ',$content);return $content;}public function sanitizeRawEmailContent(string $rawContent):string{log_message('debug','ðŸ§ª MyMIMarketing L1140 - Raw Email Before Cleaning: {raw}',['raw'=>$rawContent]);$clean=preg_replace("/=\r\n|\=\n/",'',$rawContent);$clean=quoted_printable_decode($clean);$clean=html_entity_decode($clean,ENT_QUOTES|ENT_HTML5,'UTF-8');$clean=strip_tags($clean);$clean=preg_replace('/\s+/',' ',$clean);$clean=mb_convert_encoding($clean,'UTF-8','UTF-8');log_message('debug','âœ… MyMIMarketing L1159 - Cleaned Email Output: {clean}',['clean'=>$clean]);return trim($clean);}private function sanitizeText(string $text):string{return strip_tags(html_entity_decode($text));}public function saveTradingViewChart($chartUrl,$ticker){$saveDir=FCPATH.'assets/images/Alerts/Charts/';if(!is_dir($saveDir)){mkdir($saveDir,0777,true);}$timestamp=time();$filename="{$ticker}_chart_{$timestamp}.jpg";$savePath=$saveDir.$filename;$ch=curl_init($chartUrl);$fp=fopen($savePath,'wb');curl_setopt($ch,CURLOPT_FILE,$fp);curl_setopt($ch,CURLOPT_HEADER,0);curl_exec($ch);curl_close($ch);fclose($fp);if(file_exists($savePath)){return $filename;}else{return null;}}public function scoreKeywordRelevance(string $keyword,string $summary):int{$keyword=strtolower($keyword);$summaryText=strtolower(strip_tags($summary));$totalWords=str_word_count($summaryText);if($totalWords===0)return 0;$matches=substr_count($summaryText,$keyword);$score=min(100,round(($matches/$totalWords)*500));return $score;}public function scrapeTokenContent($tokenInfo){$scrapedData=[];foreach($tokenInfo as $token){if(!empty($token['website'])){log_message('debug','MyMIMarketing L101 - $token[website]: '.$token['website']);$websiteData=$this->scrapeWebsite($token['website']);log_message('debug','MyMIMarketing L103 - $websiteData: '.print_r($websiteData,true));$this->storeTemporaryData($websiteData);$scrapedData[]=$websiteData;}if(!empty($token['facebook'])){log_message('debug','MyMIMarketing L109 - $token[facebook]: '.$token['facebook']);$facebookData=$this->scrapeFacebook($token['facebook']);log_message('debug','MyMIMarketing L111 - $facebookData: '.print_r($facebookData,true));$this->storeTemporaryData($facebookData);$scrapedData[]=$facebookData;}if(!empty($token['twitter'])){log_message('debug','MyMIMarketing L117 - $token[twitter]: '.$token['twitter']);$twitterData=$this->scrapeTwitter($token['twitter']);log_message('debug','MyMIMarketing L119 - $twitterData: '.print_r($twitterData,true));$this->storeTemporaryData($twitterData);$scrapedData[]=$twitterData;}log_message('debug','MyMIMarketing L117 - $token[symbol] $token[name]: '.$token['symbol'].' '.$token['coin_name']);$googleData=$this->scrapeGoogleSearch($token['symbol'].' '.$token['coin_name']);$this->storeTemporaryData($googleData);$scrapedData[]=$googleData;}return $scrapedData;}public function scrapeAndGenerateContent($accountid,$category,$platform=null){$generatedData=[];if($category==='Solana'){$this->solanaModel=new SolanaModel();$tokenInfo=$this->solanaModel->getTokenInfoByID($accountid);}else{$tokenInfo=[];}if(!empty($tokenInfo)){$scrapedData=[];try{log_message('debug','Attempting to scrape token content.');$scrapedData=$this->scrapeTokenContent($tokenInfo);log_message('debug','Scraped Data: '.print_r($scrapedData,true));}catch(\GuzzleHttp\Exception\ClientException $e){if($e->getResponse()->getStatusCode()==403){log_message('critical','403 Forbidden encountered while scraping website: '.$e->getMessage());}else{log_message('critical','ClientException: '.$e->getMessage());}}catch(\Exception $e){log_message('critical','An error occurred while scraping token content: '.$e->getMessage());}try{if(!empty($scrapedData)){log_message('debug','Attempting to generate content from scraped data.');$generatedData=$this->generateContentFromScrapedData($scrapedData,$platform);log_message('debug','Generated Data: '.print_r($generatedData,true));}else{log_message('debug','Scraped data is empty.');}}catch(\Exception $e){log_message('critical','An error occurred while generating content: '.$e->getMessage());}}else{log_message('debug','Token information is empty.');}return $generatedData;}private function scrapeWebsite($url){try{$client=new Client();$response=$client->get($url);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$crawler=new \Symfony\Component\DomCrawler\Crawler($html);return['title'=>$crawler->filter('title')->text(),'content'=>$this->sanitizeContent($crawler->filter('body')->html()),];}}catch(RequestException $e){$this->logger->error('Error scraping website: '.$e->getMessage());}return[];}private function scrapeFacebook($url){return $this->scrapeWithRetries('facebook',$url,function($content){return['title'=>$content['page_title']?? 'No title','content'=>$this->sanitizeContent($content['posts']?? 'No posts'),];});}private function scrapeTwitter($url){return $this->scrapeWithRetries('twitter',$url,function($content){return['title'=>$content['profile']?? 'No title','content'=>$this->sanitizeContent($content['tweets']?? 'No tweets'),];});}private function scrapeWithRetries($type,$url,$transform,$retries=3){$backoff=1;for($i=0;$i<$retries;$i++){try{$response=$this->scrapemax->scrape(['target_url'=>$url,'type'=>'data','js_enabled'=>1,'base64_encoded'=>0]);$content=json_decode($response->getBody()->getContents(),true);if(empty($content)){throw new \Exception("No content returned");}return $transform($content);}catch(ServerException $e){if($i<$retries-1){sleep($backoff);$backoff*=2;continue;}$this->logger->error("Error scraping $type: ".$e->getMessage());}catch(RequestException $e){$this->logger->error("Error scraping $type: ".$e->getMessage());break;}catch(\Exception $e){$this->logger->error("General error scraping $type: ".$e->getMessage());break;}}return['title'=>'No title','content'=>'No content'];}private function scrapeGoogleSearch($query){try{$results=$this->pscrape->rollingCurl('rollingCurl');$results->request('https://www.google.com/search?q='.urlencode($query));$content='';$resultsData=$results->execute();if(!is_array($resultsData)){throw new \Exception("Google search did not return an array");}foreach($resultsData as $result){$content.=$result['title'].' '.$result['link'].' ';}return['title'=>'Google Search Results for '.$query,'content'=>$this->sanitizeContent($content),];}catch(\Exception $e){$this->logger->error('Error scraping Google Search: '.$e->getMessage());}return[];}public function sendZapierTradeAlert($tradeAlert){$zapierWebhookUrl="YOUR_ZAPIER_WEBHOOK_URL";$payload=json_encode(['ticker'=>$tradeAlert['ticker'],'price'=>$tradeAlert['price'],'sentiment'=>$tradeAlert['market_sentiment'],'chart_link'=>$tradeAlert['link'],'created_on'=>$tradeAlert['created_on']]);$ch=curl_init($zapierWebhookUrl);curl_setopt($ch,CURLOPT_HTTPHEADER,['Content-Type: application/json']);curl_setopt($ch,CURLOPT_POST,1);curl_setopt($ch,CURLOPT_POSTFIELDS,$payload);curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);$response=curl_exec($ch);curl_close($ch);return $response;}public function standaloneScrapeWebsite($url){try{$client=new Client();$response=$client->get($url);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$crawler=new Crawler($html);$content=$crawler->filter('body')->each(function($node){return $node->text();});$content=array_filter($content,function($text){return!str_contains($text,'footer')&&!str_contains($text,'head');});$data=['url'=>$url,'content'=>implode(' ',$content),'scraped_at'=>date('Y-m-d H:i:s')];$this->saveTemporaryScrapedData($data);return $data;}else{log_message('error','Failed to scrape website. HTTP status code: '.$response->getStatusCode());}}catch(RequestException $e){log_message('error','RequestException while scraping website: '.$e->getMessage());}catch(\Throwable $th){log_message('error','Throwable error while scraping website: '.$th->getMessage());}return false;}public function saveTemporaryScrapedData($data){$marketingModel=new \App\Models\MarketingModel();return $this->marketingModel->insertTemporaryData($data);}private function storeTemporaryData($data){if(!empty($data)){$this->marketingModel->insertTemporaryData($data);}else{$this->logger->warning('Attempted to store empty data.');}}private function selectSummarySentences($sentences,$scores,$topN=5){arsort($scores,SORT_NUMERIC);$topSentenceIndexes=array_keys(array_slice($scores,0,$topN,true));$summary=array_intersect_key($sentences,array_flip($topSentenceIndexes));usort($summary,function($a,$b)use($sentences){return array_search($a,$sentences)-array_search($b,$sentences);});return $summary;}private function splitIntoSentences($content){$content=preg_replace('/\s+/',' ',trim($content));$sentences=preg_split('/(?<=[.!?])\s+/',$content,-1,PREG_SPLIT_NO_EMPTY);return array_filter($sentences,function($sentence){return strlen(trim($sentence))>0;});}public function summarize($text,$method='textrank',$charLimit=500){$text=$this->cleanText($text);if($method==='tfidf'){return $this->summarizeText($text);}else{return $this->summarizeContent($text,$charLimit);}}public function summarizeContent($content,$charLimit=500){if(empty(trim($content))){$this->logger->error('$content is Empty for summarizeContent() function');return[];}$sentences=$this->splitIntoSentences($content);if(empty($sentences)){log_message('warning','âš ï¸ MyMIMarketing L1306 - summarizeContent(): No valid sentences found in content.');return null;}if(empty($sentences)){$this->logger->error('No sentences found for summarization');return[];}$tokens=$this->tokenizeWithNlpTools($content);$features=$this->extractFeaturesWithPhpMl($content);$wordFrequencies=$this->calculateWordFrequencies($content,$this->getStopWords());$similarityMatrix=$this->buildSimilarityMatrix($sentences,$wordFrequencies);$scores=$this->pageRank($similarityMatrix);$summary=$this->buildSummaryToCharLimit($sentences,$scores,$charLimit);$finalSummary=$this->convertUrlsToLinks($summary);return!empty($finalSummary)?['sentences'=>$sentences,'tokens'=>$tokens,'features'=>$features,'wordFrequencies'=>$wordFrequencies,'similarityMatrix'=>$similarityMatrix,'scores'=>$scores,'summary'=>$finalSummary,]:$summary;}public function summarizeContentFromHtml(string $html,$recordId=null):array{$html=quoted_printable_decode($html);$html=html_entity_decode($html,ENT_QUOTES|ENT_HTML5,'UTF-8');$html=preg_replace('/=\r?\n/','',$html);$plainText=strip_tags(html_entity_decode($html));$cleaned=$this->sanitizeRawEmailContent($plainText);if(strlen($cleaned)<300||substr_count($cleaned,' ')<20){$logSuffix=$recordId?" (ID: $recordId)":'';log_message('info',"[MyMIMarketing] summarizeContentFromHtml(): Skipping â€” content too short or lacks structure{$logSuffix}");return['summary'=>'','keywords'=>[]];}$cleaned=preg_replace('/\s{2,}/',' ',$cleaned);$summaryData=$this->summarizeContent($cleaned);if(!is_array($summaryData)||empty($summaryData['summary'])){return['summary'=>'','keywords'=>[]];}$keywords=$this->marketingModel->extractKeywords($cleaned);return['summary'=>$summaryData['summary'],'keywords'=>$keywords ??[],'featureScore'=>$summaryData['featureScore']?? null,'keywordScore'=>$summaryData['keywordScore']?? null,'pageRankScore'=>$summaryData['pageRankScore']?? null,'semanticDiversityScore'=>$summaryData['semanticDiversityScore']?? null,];}public function summarizeContentTextRank($content){$sentences=$this->splitIntoSentences($content);$similarityMatrix=$this->buildSimilarityMatrix($sentences);$scores=$this->pageRank($similarityMatrix);return $this->extractTopSentences($sentences,$scores);}public function summarizeText($text,$maxSentences=5){if(!is_string($text)||empty(trim($text))){log_message('error','summarizeText(): Empty or invalid input text provided.');return 'Summary not available.';}$sentences=$this->splitIntoSentences($text);if(empty($sentences)||count($sentences)<2){log_message('warning','summarizeText(): Not enough content to summarize.');return implode(' ',$sentences);}$vectorizer=new TokenCountVectorizer(new WhitespaceTokenizer());$vectorizer->fit($sentences);$vectorizer->transform($sentences);$tfidf=new TfIdfTransformer();try{$tfidf->fit($sentences);$tfidf->transform($sentences);}catch(\Throwable $e){log_message('error','summarizeText(): TF-IDF transform failed â€” '.$e->getMessage());return 'Summary unavailable due to processing error.';}$scores=[];foreach($sentences as $i=>$vector){$score=0;foreach($vector as $value){$score+=(float)$value;}$scores[$i]=$score;}arsort($scores);$topIndexes=array_slice(array_keys($scores),0,$maxSentences);sort($topIndexes);$originalSentences=$this->splitIntoSentences($text);$summary=implode(' ',array_map(fn($i)=>$originalSentences[$i],$topIndexes));return $summary;}private function tokenizeSmart($text,$method='nlp'){return $method==='nlp'?$this->tokenizeWithNlpTools($text):$this->tokenizeText($text);}private function tokenizeText($text){$text=strtolower(strip_tags($text));return preg_split('/\W+/',$text,-1,PREG_SPLIT_NO_EMPTY);}public function tokenizeWithNlpTools($content){$tokenizer=new NlpWhitespaceTokenizer();$tokens=$tokenizer->tokenize($content);$this->logger->debug('Tokens: '.print_r($tokens,true));return $tokens;}public function insertFinalScraper($record,$summary){$model=new MarketingModel();if(!isset($record['id'])||!$summary){log_message('error','âŒ Missing record ID or summary when calling insertFinalScraper()');return false;}$existing=$model->where('source_id',$record['id'])->first();if($existing){log_message('info',"âš ï¸ Final scrape already exists for source_id: {$record['id']}");return false;}$cleanSummary=mb_convert_encoding($summary['summary'],'UTF-8','UTF-8');$cleanTitle=isset($record['title'])?$record['title']:word_limiter($cleanSummary,12);$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$cleanTitle);$data=['source_id'=>$record['id'],'title'=>trim($cleanTitle),'summary'=>trim($cleanSummary),'keywords'=>isset($summary['keywords'])?implode(',',$summary['keywords']):'','date_created'=>date('Y-m-d H:i:s'),];$result=$model->insert($data);if($result){log_message('info',"âœ… Final scraped content inserted for source_id: {$record['id']}");}else{log_message('error',"âŒ Failed to insert final scrape for source_id: {$record['id']}");}return $result;}private function cleanText($text){$text=$this->decodeSpecialCharacters($text);$text=$this->sanitizeRawEmailContent($text);return $this->normalizeUtf8(strip_tags($text));}private function combineScores($featureScore,$keywordScore,$pageRankScore,$semanticDiversityScore){$featureScore=is_numeric($featureScore)?(float)$featureScore:0.0;$keywordScore=is_numeric($keywordScore)?(float)$keywordScore:0.0;$pageRankScore=is_numeric($pageRankScore)?(float)$pageRankScore:0.0;$semanticDiversityScore=is_numeric($semanticDiversityScore)?(float)$semanticDiversityScore:0.0;$combinedScore=0.4*$featureScore+0.2*$keywordScore+0.3*$pageRankScore+0.1*$semanticDiversityScore;$this->logger->debug('âœ… Combined Score for sentence: '.$combinedScore);return $combinedScore;}private function buildSimilarityMatrix($sentences,$wordFrequencies){$matrix=[];$sentenceLength=count($sentences);for($i=0;$i<$sentenceLength;$i++){for($j=0;$j<$sentenceLength;$j++){if($i!=$j){$matrix[$i][$j]=$this->calculateSimilarity($sentences[$i],$sentences[$j],$wordFrequencies);}}}return $matrix;}private function calculateSimilarity($sentence1,$sentence2,$wordFrequencies){$sentence1=is_string($sentence1)?strtolower($sentence1):'';$sentence2=is_string($sentence2)?strtolower($sentence2):'';$words1=array_unique(str_word_count($sentence1,1));$words2=array_unique(str_word_count($sentence2,1));$commonWords=array_intersect($words1,$words2);$score=0;foreach($commonWords as $word){$score+=(float)($wordFrequencies[$word]?? 0);}$logWordCount1=count($words1)>0?log(count($words1)):0;$logWordCount2=count($words2)>0?log(count($words2)):0;if($logWordCount1+$logWordCount2==0){return 0;}return $score/($logWordCount1+$logWordCount2);}private function calculateWordFrequencies($content,$stopWords){$frequencies=[];$words=preg_split('/\s+/',strtolower($content));foreach($words as $word){if(!in_array($word,$stopWords)&&strlen($word)>1){$frequencies[$word]=($frequencies[$word]?? 0)+1;}}arsort($frequencies);return $frequencies;}public function decodeMimeHeaderSafe($string){try{return mb_decode_mimeheader($string);}catch(\Throwable $e){log_message('error','decodeMimeHeaderSafe() failed: '.$e->getMessage());return $string;}}private function decodeSpecialCharacters($text){return html_entity_decode($text,ENT_QUOTES|ENT_HTML5,'UTF-8');}public function getScrapesByKeyword($keyword){return $this->marketingModel->getScrapesByKeyword($keyword);}private function getStopWords(){return["a","the","and","of","in","to","is","you","that","it","he","was","for","on","are","as","with","his","they","I","at","be","this","have","from","or","one","had","by","word","but","not","what","all","were","we","when","your","can","said","there","use","an","each","which","she","do","how","their","if","will","up","other","about","out","many","then","them","these","so","some","her","would","make","like","him","into","time","has","look","two","more","write","go","see","number","no","way","could","people","my","than","first","water","been","call","who","oil","its","now","find","long","down","day","did","get","come","made","may","part"];}public function getTopKeywordScores($content,$max=10){if(!is_string($content)){log_message('error','MyMIMarketing L1706 - getTopKeywordScores(): Content must be a string');return[];}$content=$this->normalizeUtf8($content);$sentences=$this->splitIntoSentences($content);if(empty($sentences)){log_message('error','MyMIMarketing L1713 - getTopKeywordScores(): No valid sentences to process');return[];}$tfIdf=new TfIdfTransformer();$tokenized=array_values(array_filter(array_map(function($sentence){$cleaned=strtolower($this->normalizeUtf8(trim($sentence)));$tokens=array_filter(explode(' ',$cleaned),fn($w)=>strlen($w)>1);return count($tokens)>0?$tokens:null;},$sentences)));if(empty($tokenized)||!isset($tokenized[0])||!is_array($tokenized[0])||empty($tokenized[0])){log_message('error','âŒ MyMIMarketing L1725 - Tokenized input invalid for TF-IDF. Tokenized: '.json_encode($tokenized));return[];}try{$tfIdf->fit($tokenized);log_message('debug','ðŸ“Š MyMIMarketing L1731 - TF-IDF Document Preview: '.json_encode(array_slice($tokenized,0,1)));$tfIdf->transform($tokenized);}catch(\Throwable $e){log_message('error','âŒ MyMIMarketing L1734 - TF-IDF error: '.$e->getMessage());return[];}$scores=[];foreach($tokenized as $docIndex=>$tokens){foreach($tokens as $token){if(!is_string($token))continue;if(!isset($scores[$token])){$scores[$token]=0.0;}$scores[$token]+=1.0;}}if(empty($scores)){log_message('error','âŒ MyMIMarketing L1752 - No TF-IDF scores generated');return[];}arsort($scores);return array_keys(array_slice($scores,0,$max,true));}private function isSemanticallyDifferent($sentence1,$sentence2,$tokens){$tokens1=array_intersect($tokens,str_word_count(strtolower($sentence1),1));$tokens2=array_intersect($tokens,str_word_count(strtolower($sentence2),1));$overlap=count(array_intersect($tokens1,$tokens2));$threshold=2;return $overlap<$threshold;}private function pageRank($matrix,$dampingFactor=0.85,$maxIterations=100,$tolerance=1e-6){$numSentences=count($matrix);if($numSentences==0){return[];}$pagerank=array_fill(0,$numSentences,1/$numSentences);$tempRank=array_fill(0,$numSentences,0);for($iter=0;$iter<$maxIterations;$iter++){for($i=0;$i<$numSentences;$i++){$tempRank[$i]=(1-$dampingFactor)/$numSentences;for($j=0;$j<$numSentences;$j++){if($i!=$j&&isset($matrix[$j][$i])){$matrixRowSum=array_sum($matrix[$j]);if($matrixRowSum!=0){$tempRank[$i]+=$dampingFactor*($matrix[$j][$i]*$pagerank[$j]/$matrixRowSum);}}}}$diff=0;for($i=0;$i<$numSentences;$i++){$diff+=abs($tempRank[$i]-$pagerank[$i]);}if($diff<$tolerance){break;}$pagerank=$tempRank;}return $pagerank;}private function extractTopSentences($sentences,$scores,$topN=5){asort($scores,SORT_NUMERIC);$topSentenceIndexes=array_keys(array_slice($scores,-$topN,$topN,true));$summary=[];foreach($topSentenceIndexes as $index){$summary[]=trim($sentences[$index]);}return $summary;}public function enqueueEmailJob($emailData){$data=['type'=>'email_processing','data'=>json_encode($emailData)];$this->marketingModel->insertJobQueue($data);}private function stripHtmlTags($htmlContent){return strip_tags($htmlContent);}public function social_media(){return['discord'=>$this->socialMedia->discord,'facebook_page'=>$this->socialMedia->facebook_page,'facebook_group'=>$this->socialMedia->facebook_group,'linkedin'=>$this->socialMedia->linkedin,'twitter'=>$this->socialMedia->twitter,'youtube'=>$this->socialMedia->youtube,];}public function department(){$activeCampaigns=$this->marketingModel->getActiveCampaigns();$totalActiveCampaigns=$activeCampaigns['num_rows'];$activePriorityCampaigns=$this->marketingModel->getActivePriorityCampaigns();$totalActivePriorityCampaigns=$activePriorityCampaigns['num_rows'];return['getActiveCampaigns'=>$activeCampaigns['result'],'totalActiveCampaigns'=>$totalActiveCampaigns,'getActivePriorityCampaigns'=>$activePriorityCampaigns['result'],'totalActivePriorityCampaigns'=>$totalActivePriorityCampaigns,];}public function seoCheck(){$uri_string=$this->request->getUri()->getPath();$query=$this->marketingModel->where('url',$uri_string)->first();if(!$query){$data=['url'=>$uri_string,'title'=>str_replace(['_','/'],[' ',' - '],$uri_string),'description'=>"Experience the future of personal finance with MyMI Wallet. We provide advanced budgeting and investment portfolio management solutions, empowering individuals to better manage their finances. Streamline your financial journey with our intuitive online fintech application and service.",'image'=>base_url('/assets/images/Company/MyMI-Wallet-White.png'),];$this->marketingModel->insert($data);$insert_id=$this->marketingModel->getInsertID();$task_info=['task'=>'Page SEO Edit','title'=>str_replace(['_','/'],[' ',' - '],$uri_string),'seo_id'=>$insert_id,'url'=>$uri_string,];$this->assignMarketingTask($task_info);}}public function assignMarketingTask($task_info){$data=['status'=>'Pending','group'=>'Marketing','task'=>$task_info['task'],'title'=>$task_info['title'],'description'=>'Complete SEO for '.$task_info['url'],'url'=>site_url('/Management/Marketing/Page-SEO/'.$task_info['seo_id']),];$this->marketingModel->insertManagementTask($data);}public function autoDistributeHighRelevanceSummaries($minScore=75){$posts=$this->marketingModel->getRecentPosts(10);foreach($posts as $post){if(($post['score']?? 0)>=$minScore){$message="**{$post['title']}**\n\n".word_limiter(strip_tags($post['summary']),60);$this->sendToDiscordNotification($message);}}}public function autoSendToZapier($minScore=75){$posts=$this->marketingModel->getRecentPosts(10);foreach($posts as $post){if(($post['score']?? 0)>=$minScore){$this->sendToZapier('facebook',$post['summary']);}}}public function getPageHeaders(){$getPageSEO=$this->marketingModel->getMarketingPageSeo();$pageSEOData=[];foreach($getPageSEO as $pageSEO){$pageSEOData[]=['page_id'=>$pageSEO['id'],'page_name'=>$pageSEO['page_name'],'page_title'=>$pageSEO['page_title'],'page_url'=>$pageSEO['page_url'],'page_sitemap_url'=>$pageSEO['page_sitemap_url'],'page_internal_url'=>$pageSEO['page_internal_url'],'page_controller'=>$pageSEO['page_controller'],'page_controller_url'=>$pageSEO['page_controller_url'],'page_controller_directory'=>$pageSEO['page_controller_directory'],'page_file_directory'=>$pageSEO['page_file_directory'],'page_image'=>$pageSEO['page_image'],'page_description'=>$pageSEO['page_description'],'page_address'=>$pageSEO['page_address'],'page_city'=>$pageSEO['page_city'],'page_state'=>$pageSEO['page_state'],'page_country'=>$pageSEO['page_country'],'page_zipcode'=>$pageSEO['page_zipcode'],'page_facebook'=>$pageSEO['page_facebook'],'linked'=>$pageSEO['linked'],'functionality'=>$pageSEO['functionality'],'design'=>$pageSEO['design'],'seo'=>$pageSEO['seo'],'ext_links'=>$pageSEO['ext_links'],'grammar'=>$pageSEO['grammar'],'d_optimize'=>$pageSEO['d_optimize'],'load_perf'=>$pageSEO['load_perf'],'additional_notes'=>$pageSEO['additional_notes'],];}return $pageSEOData;}public function getPageHeadersByName($pageName){$getPageSEO=$this->marketingModel->getMarketingPageSeoByName($pageName);$pageSEOData=[];foreach($getPageSEO as $pageSEO){$pageSEOData[]=['page_id'=>$pageSEO['id'],'page_name'=>$pageSEO['page_name'],'page_title'=>$pageSEO['page_title'],'page_url'=>$pageSEO['page_url'],'page_sitemap_url'=>$pageSEO['page_sitemap_url'],'page_internal_url'=>$pageSEO['page_internal_url'],'page_controller'=>$pageSEO['page_controller'],'page_controller_url'=>$pageSEO['page_controller_url'],'page_controller_directory'=>$pageSEO['page_controller_directory'],'page_file_directory'=>$pageSEO['page_file_directory'],'page_image'=>$pageSEO['page_image'],'page_description'=>$pageSEO['page_description'],'page_address'=>$pageSEO['page_address'],'page_city'=>$pageSEO['page_city'],'page_state'=>$pageSEO['page_state'],'page_country'=>$pageSEO['page_country'],'page_zipcode'=>$pageSEO['page_zipcode'],'page_facebook'=>$pageSEO['page_facebook'],'linked'=>$pageSEO['linked'],'functionality'=>$pageSEO['functionality'],'design'=>$pageSEO['design'],'seo'=>$pageSEO['seo'],'ext_links'=>$pageSEO['ext_links'],'grammar'=>$pageSEO['grammar'],'d_optimize'=>$pageSEO['d_optimize'],'load_perf'=>$pageSEO['load_perf'],'additional_notes'=>$pageSEO['additional_notes'],];}return $pageSEOData;}public function postToDiscord($message){$discordWebhookUrl=getenv('DISCORD_WEBHOOK_URL');if(strlen($message)>2000){$message=substr($message,0,1997)."...";}$payload=json_encode(["content"=>$message]);$ch=curl_init($discordWebhookUrl);curl_setopt($ch,CURLOPT_HTTPHEADER,['Content-Type: application/json']);curl_setopt($ch,CURLOPT_POST,1);curl_setopt($ch,CURLOPT_POSTFIELDS,$payload);curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);$response=curl_exec($ch);curl_close($ch);return $response;}public function postToFacebookPage($pageId,$message){try{$response=$this->facebook->post("/{$pageId}/feed",['message'=>$message,],$this->facebook->getAccessToken());return $response->getGraphNode();}catch(Facebook\Exceptions\FacebookResponseException $e){log_message('error','Graph returned an error: '.$e->getMessage());return false;}catch(Facebook\Exceptions\FacebookSDKException $e){log_message('error','Facebook SDK returned an error: '.$e->getMessage());return false;}}public function postToFacebookGroup($groupId,$message){try{$response=$this->facebook->post("/{$groupId}/feed",['message'=>$message,],$this->facebook->getAccessToken());return $response->getGraphNode();}catch(Facebook\Exceptions\FacebookResponseException $e){log_message('error','Graph returned an error: '.$e->getMessage());return false;}catch(Facebook\Exceptions\FacebookSDKException $e){log_message('error','Facebook SDK returned an error: '.$e->getMessage());return false;}}public function sendNotification($type,$viewPath,$data,$targetGroup=null,$socialMedia=[]){$userModel=new UserModel();if($targetGroup){$users=$userModel->where('group',$targetGroup)->findAll();}else{$users=$userModel->findAll();}$viewContent=view($viewPath,$data);$notoCount=0;$emailNotoCount=0;if(in_array('in-app',$type)){foreach($users as $user){$this->sendInAppNotification($user,$viewContent);$notoCount++;}}if(in_array('email',$type)){foreach($users as $user){$this->sendEmailNotification($user,$viewContent);$emailNotoCount++;}}foreach($socialMedia as $platform){switch($platform){case 'facebook':$this->postToFacebook($data['message']);break;case 'twitter':$this->postToTwitter($data['message']);break;case 'linkedin':$this->postToLinkedIn($data['message']);break;case 'discord':$this->postToDiscord($data['message']);break;}}$notificationData=['active'=>1,'message'=>$viewContent,'created_at'=>date('Y-m-d H:i:s'),'created_by'=>session('user_id'),'noto_count'=>$notoCount,'email_noto_count'=>$emailNotoCount,];$this->marketingModel->storeNotification($notificationData);}private function sendInAppNotification($user,$content){$db=\Config\Database::connect();$db->table('user_notifications')->insert(['user_id'=>$user->id,'content'=>$content,'created_at'=>date('Y-m-d H:i:s')]);}private function sendEmailNotification($user,$content){$email=\Config\Services::email();$email->setTo($user->email);$email->setSubject('Notification');$email->setMessage($content);$email->send();}public function postToSocialMedia($content){try{$this->postToFacebook($content);$this->postToTwitter($content);$this->postToLinkedIn($content);}catch(\Throwable $e){$this->logger->error('âŒ postToSocialMedia() failed: '.$e->getMessage());}}private function postToFacebook($message){try{$response=$this->facebook->post('/me/feed',['message'=>$message],$this->socialMedia->facebook_access_token);return $response->getGraphNode();}catch(Facebook\Exceptions\FacebookResponseException $e){$this->logger->error('Facebook Graph returned an error: '.$e->getMessage());return false;}catch(Facebook\Exceptions\FacebookSDKException $e){$this->logger->error('Facebook SDK returned an error: '.$e->getMessage());return false;}}public function fetchTweets($query,$count=100){try{$tweets=$this->twitter->get('search/tweets',['q'=>$query,'count'=>$count]);if($this->twitter->getLastHttpCode()===200){$processedTweets=[];foreach($tweets->statuses as $tweet){$processedTweets[]=['tweet_id'=>$tweet->id_str,'content'=>$tweet->text,'author'=>$tweet->user->screen_name,'created_at'=>$tweet->created_at,'url'=>"https://twitter.com/{$tweet->user->screen_name}/status/{$tweet->id_str}"];}foreach($processedTweets as $tweetData){$this->marketingModel->storeScrapedContent(['title'=>$tweetData['content'],'url'=>$tweetData['url'],'content'=>$tweetData['content'],'keywords'=>json_encode([$tweetData['author']]),'scraped_at'=>date('Y-m-d H:i:s')]);}return $processedTweets;}else{throw new \Exception('Failed to fetch tweets: '.$this->twitter->getLastBody());}}catch(\Throwable $th){log_message('error','Error fetching tweets: '.$th->getMessage());return[];}}public function generateContentFromTweets($tweets){$summary=$this->summarizeText(implode(' ',array_column($tweets,'content')));$keywords=$this->extractKeywords($summary);return['summary'=>$summary,'keywords'=>$keywords,'platform_content'=>$this->generatePlatformContent($summary,$keywords)];}public function generateFromTempScraper($limit=5){$records=$this->marketingModel->getLatestTempRecords($limit);if(empty($records)){log_message('info','No temp scraper records found to process.');return;}foreach($records as $record){try{log_message('debug','ðŸ§ª Processing record ID '.$record['id']);$summary=$this->generateContentFromRaw($record);if($summary){$this->marketingModel->markTempScraperProcessed($record['id']);log_message('info','âœ… Processed and stored content for record ID '.$record['id']);}else{log_message('warning','âš ï¸ Summary was null/empty for record ID '.$record['id']);}}catch(\Throwable $e){log_message('error','âŒ Error generating content for record ID '.$record['id'].': '.$e->getMessage());}}}public function postToTwitter($content){try{$response=$this->twitter->post('statuses/update',['status'=>$content]);if($this->twitter->getLastHttpCode()===200){log_message('info','Successfully posted to Twitter: '.$content);return $response;}else{throw new \Exception('Failed to post to Twitter: '.json_encode($response));}}catch(\Throwable $th){log_message('error','Error posting to Twitter: '.$th->getMessage());return false;}}private function postToLinkedIn($message){try{$response=$this->linkedin->post('/people/~/shares',['comment'=>$message,'visibility'=>['code'=>'anyone']],$this->socialMedia->linkedin_access_token);return $response;}catch(Exception $e){$this->logger->error('LinkedIn API returned an error: '.$e->getMessage());return false;}}private function postToBlog($content){$client=new Client(['base_uri'=>$this->siteSettings->wordpress_site_url,]);try{$response=$client->post('/wp-json/wp/v2/posts',['auth'=>[$this->siteSettings->wordpress_username,$this->siteSettings->wordpress_password],'json'=>['title'=>substr($content,0,50),'content'=>$content,'status'=>'publish',],]);if($response->getStatusCode()==201){$this->logger->info('Posted to blog: '.$content);return json_decode($response->getBody(),true);}else{$this->logger->error('Failed to post to blog: '.$response->getBody());return false;}}catch(RequestException $e){$this->logger->error('Blog post request error: '.$e->getMessage());return false;}}public function distributeContentToSocialMedia($content){$twitterPost="ï¿½ **Stock Market Highlights** ï¿½\n";$facebookPost="ï¿½ **Market Movers Update** ï¿½\n";$linkedinPost="ï¿½ **Today's Market Summary** ï¿½\n";$discordPost="ï¿½ **TRADE ALERTS UPDATE!** ï¿½\n";foreach($content['expandedContent']as $post){$twitterPost.=$post."\n";$facebookPost.=$post."\n";$linkedinPost.=$post."\n";$discordPost.=$post."\n";}$this->postToTwitter($twitterPost);$this->postToFacebook($facebookPost);$this->postToLinkedIn($linkedinPost);$this->postToDiscord($discordPost);return['twitter'=>$twitterPost,'facebook'=>$facebookPost,'linkedin'=>$linkedinPost,'discord'=>$discordPost];}public function generateAndPostContent(){$emailSummaries=$this->marketingModel->getEmailSummariesForReview();foreach($emailSummaries as $summary){log_message('info','Generating content for email summary: '.$summary['email_subject']);$content=$this->generateMarketingContent($summary['summary']);log_message('debug','Generated content: '.print_r($content,true));$this->postToSocialMedia($content);$this->postToBlog($content);$this->marketingModel->updateEmailStatus($summary['email_identifier'],'Posted');log_message('info','Updated email status to Posted for: '.$summary['email_subject']);}}public function generateMarketingContent():void{$topStories=$this->marketingModel->getTopStories(10);$count=0;foreach($topStories as $story){if(empty(trim($story['title']?? ''))){log_message('debug','â­ Skipped record ID '.$story['id'].' - no title provided.');continue;}if($count>=5){break;}$headline=$story['title'];$url=$story['source_url']?? '#';$summary=$this->generateSummary($story);$hashtags=$this->extractHashtags($story['title'].' '.$story['email_body']);$platformPosts=['discord'=>"**{$headline}**\n{$summary}\nðŸ”— {$url}\n{$hashtags}",'twitter'=>"{$headline} {$url} {$hashtags}",'linkedin'=>"{$headline}\n{$summary}\nRead more: {$url} {$hashtags}",'facebook'=>"{$headline}\n{$summary}\n{$url} {$hashtags}",'email'=>['subject'=>$headline,'body'=>"{$summary}\n\nRead More: {$url}\n{$hashtags}",],];$this->marketingModel->storeGeneratedContent($story['id'],$platformPosts);$count++;}}private function logScrapeError($url,$error){log_message('error',"Scraping failed for URL: $url, Error: $error");}public function generateContentFromData($title,$content,$tags){$summary=$this->summarizeContent($content);return $title." - ".$summary." Tags: ".implode(', ',$tags);}public function generateContentFromScrapedData($scrapedData,$platform=null){if(empty($scrapedData)||!is_array($scrapedData)){log_message('error','âŒ generateContentFromScrapedData() called with empty or invalid $scrapedData');return[];}$cleanedSummaries=[];foreach($scrapedData as $record){$rawContent=$record['content']?? '';$cleaned=$this->sanitizeRawEmailContent($rawContent);if(strlen($cleaned)<300||substr_count($cleaned,' ')<20){log_message('warning','[MyMIMarketing] Skipped record due to short or unstructured content (Title: '.($record['title']?? 'Untitled').')');continue;}try{$summaryData=$this->summarizeContent($cleaned);if(!is_array($summaryData)||empty($summaryData['summary'])){log_message('warning','âš ï¸ generateContentFromScrapedData(): Summary was null/empty for record title: '.($record['title']?? 'Untitled'));continue;}$headline=$this->generateHeadline($summaryData['summary']);$platformPosts=$this->generatePlatformContent($summaryData['summary'],$summaryData['tokens']??[]);$payload=['title'=>$record['title']?? $headline,'source'=>$record['url']?? 'unknown','summary'=>$summaryData['summary'],'keywords'=>$summaryData['tokens']??[],'headline'=>$headline,'platform_content'=>$platformPosts,'platform'=>$platform,'created_on'=>date("Y-m-d H:i:s"),];$this->marketingModel->storeGeneratedContent($record['id']?? null,$platformPosts);$cleanedSummaries[]=$payload;}catch(\Throwable $e){log_message('error','âŒ Exception in generateContentFromScrapedData(): '.$e->getMessage());}}return $cleanedSummaries;}public function generateContentFromLargeText($content,$tags){if(empty($content)){log_message('error','Content is empty in generateContentFromLargeText.');return['summary'=>'','keywords'=>[],'platforms_content'=>[],];}$tokenizer=new WhitespaceTokenizer();$samples=[$tokenizer->tokenize($content)];log_message('debug','Tokenized samples: '.print_r($samples,true));if(empty($samples)||!isset($samples[0])||!is_array($samples[0])||empty($samples[0])){log_message('error','ðŸš« Empty or malformed document array before TF-IDF.');return['summary'=>'','keywords'=>[],'platforms_content'=>[],];}try{$tfidf=new TfIdfTransformer();$tfidf->fit($samples);$tfidf->transform($samples);log_message('debug','TfIdf transformation successful.');}catch(\Exception $e){log_message('error','TfIdfTransformer failed: '.$e->getMessage());return['summary'=>'','keywords'=>[],'platforms_content'=>[],];}$summary=$this->summarizeText($content);$keywords=$this->extractKeywords($content);$platforms_content=$this->generatePlatformContent($summary,$keywords);return['summary'=>$summary,'keywords'=>$keywords,'platforms_content'=>$platforms_content,];}public function generateCanvaVideo(){$scriptResponse=$this->generateVoiceoverScript();if(!$scriptResponse['status']==='success'){return $this->respond(['status'=>'error','message'=>'Voiceover script not found'],404);}$scriptText=$scriptResponse['script'];$canvaApiUrl="https://api.canva.com/v1/projects";$headers=['Authorization: Bearer YOUR_CANVA_API_KEY','Content-Type: application/json'];$payload=['title'=>'MyMI Trade Alerts Video','template'=>'YOUR_CANVA_TEMPLATE_ID','elements'=>['text'=>$scriptText,'voiceover'=>base_url('uploads/voiceover.mp3')]];$ch=curl_init($canvaApiUrl);curl_setopt($ch,CURLOPT_HTTPHEADER,$headers);curl_setopt($ch,CURLOPT_POST,true);curl_setopt($ch,CURLOPT_POSTFIELDS,json_encode($payload));curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);$response=curl_exec($ch);curl_close($ch);return $this->respond(['status'=>'success','message'=>'Video generated','video_url'=>json_decode($response)->video_url]);}public function generateEnhancedContent($voiceScript){$summary=$this->summarizeContent($voiceScript);$checkedContent=$this->spellCheckAndRefine($summary);$expandedContent=$this->contentGenerator($checkedContent);return['summary'=>$summary,'checkedContent'=>$checkedContent,'expandedContent'=>$expandedContent];}private function generatePrimaryContent($scrapedData){$content="";foreach($scrapedData as $data){$content.="Source: {$data['source']}\n";$content.="Title: {$data['title']}\n";$content.="Content: ".substr($data['content'],0,200)."...\n";$content.="Link: ".($data['url']?? 'N/A')."\n\n";}return $content;}public function generatePlatformContent($summary,$keywords,$mediaAssets=[]){$facebookContent="Facebook Post: ".$summary."\n\n"."Related: #".implode(' #',$keywords);$twitterContent="Twitter: ".substr($summary,0,280)."\n\n#".implode(' #',$keywords);$stocktwitsContent="StockTwits: ".substr($summary,0,250)."\n\n".implode(' ',$keywords);$discordContent="Discord: ".$summary."\n\nJoin the discussion! #".implode(' #',$keywords);$blogContent="Blog Post\n\n".$summary."\n\nKeywords: ".implode(', ',$keywords);$emailContent="Email Notification: ".$summary."\n\nRead more on our blog.";$browserNotificationContent="New Update: ".substr($summary,0,100)."... Click to learn more.";$tiktokScript=$this->generateTikTokScript($summary,$keywords,$mediaAssets);$youtubeScript=$this->generateYouTubeScript($summary,$keywords,$mediaAssets);return['Facebook'=>$facebookContent,'Twitter'=>$twitterContent,'StockTwits'=>$stocktwitsContent,'Discord'=>$discordContent,'Blog'=>$blogContent,'Email'=>$emailContent,'BrowserNotification'=>$browserNotificationContent,'TikTok'=>$tiktokScript,'YouTube'=>$youtubeScript];}public function generateSocialPost(array $summary):array{$text=$summary['summary']?? '';$keywords=$summary['keywords']??[];$hashtags=implode(' ',array_map(function($word){return '#'.ucfirst(trim($word));},array_slice($keywords,0,5)));return['twitter'=>substr("{$text} {$hashtags}",0,280),'facebook'=>"{$text}\n\n{$hashtags}",'linkedin'=>"{$text}\n\n#StayInformed {$hashtags}",'discord'=>"**News Summary:**\n{$text}\n\n{$hashtags}",];}private function generateSocialMediaContent($scrapedData){$facebookContent="Facebook: ";$twitterContent="Twitter: ";$linkedinContent="LinkedIn: ";foreach($scrapedData as $data){$facebookContent.=$data['title']." ".($data['url']?? '')."\n";$twitterContent.=$data['title']." ".($data['url']?? '')."\n";$linkedinContent.=$data['title']." ".($data['url']?? '')."\n";}return['Facebook'=>$facebookContent,'Twitter'=>$twitterContent,'LinkedIn'=>$linkedinContent,];}protected function generateSummary(array $story):string{return substr(strip_tags($story['email_body']?? ''),0,250).'...';}public function generateTikTokScript($summary,$keywords,$mediaAssets=[]){$hook="Did you know?";$cta="Follow us for more updates!";$mediaInclusion=!empty($mediaAssets)?"Include these images/videos: ".implode(", ",$mediaAssets):"";return"TikTok Video Script:\n1. Hook: \"{$hook}\"\n2. Summary: {$summary}\n3. Media: {$mediaInclusion}\n4. CTA: {$cta}";}public function generateYouTubeScript($summary,$keywords,$mediaAssets=[]){$hook="Breaking news in the world of finance...";$cta="Like, subscribe, and share for more updates!";$mediaInclusion=!empty($mediaAssets)?"Include these images/videos: ".implode(", ",$mediaAssets):"";return"YouTube Video Script:\n1. Hook: \"{$hook}\"\n2. Detailed Summary: {$summary}\n3. Media: {$mediaInclusion}\n4. CTA: {$cta}";}public function generateVoiceoverAudio($text){$client=new TextToSpeechClient();$input=new SynthesisInput();$input->setText($text);$voice=new VoiceSelectionParams();$voice->setLanguageCode('en-US');$voice->setSsmlGender('MALE');$audioConfig=new AudioConfig();$audioConfig->setAudioEncoding(AudioEncoding::MP3);$response=$client->synthesizeSpeech($input,$voice,$audioConfig);$audioContent=$response->getAudioContent();$filePath=WRITEPATH.'uploads/voiceover.mp3';file_put_contents($filePath,$audioContent);return base_url('uploads/voiceover.mp3');}public function generateVoiceoverScript(){$tradeAlerts=$this->alertsModel->getFilteredTradeAlerts(['start'=>date('Y-m-d 00:00:00'),'end'=>date('Y-m-d 23:59:59')])->get()->getResultArray();if(empty($tradeAlerts)){return $this->respond(['status'=>'error','message'=>'No trade alerts found for today.'],404);}$script="**Voiceover Script: MyMI Trade Alerts - Top Stock Movers**\n\n[INTRO]\n";$script.="Welcome to todayâ€™s MyMI Trade Alerts! Weâ€™re breaking down the hottest stocks in the market based on momentum, volume, and breakout potential. Letâ€™s jump right in!\n\n";foreach($tradeAlerts as $alert){$script.="**[{$alert['ticker']} - {$alert['company']}]**\n";$script.="**Price:** \${$alert['price']}  |  **% Change:** {$alert['change']}%  |  **Volume:** {$alert['volume']}M\n";$script.="ï¿½ 52-Week High: \${$alert['high']}  |  ï¿½ 52-Week Low: \${$alert['low']}\n";$script.="Market Cap: {$alert['market_cap']}\n\n";}$script.="[OUTRO]\nThatâ€™s it for todayâ€™s MyMI Trade Alerts! Donâ€™t forget to like, subscribe, and stay tuned for more market insights. Drop your thoughts in the commentsâ€”whatâ€™s your top stock pick today? See you in the next update!\n";return $this->respond(['status'=>'success','script'=>$script]);}public function generateStockInformation($cuID){$MyMIInvestments=new MyMIInvestments();$investmentData=$MyMIInvestments->getInvestmentDashboard($cuID);$symbols=$this->getSymbolsByAssetType($investmentData['getSymbols']);$forecastData=[];$riskData=[];foreach($symbols as $type=>$symbolList){switch($type){case 'stocks':$forecastData['stocks']=$MyMIInvestments->performARIMAForecast($symbolList);$riskData['stocks']=$MyMIInvestments->generateRiskManagementTools($cuID,'stocks');break;case 'etfs':$forecastData['etfs']=$MyMIInvestments->performARIMAForecast($symbolList);$riskData['etfs']=$MyMIInvestments->generateRiskManagementTools($cuID,'etfs');break;case 'crypto':$forecastData['crypto']=$MyMIInvestments->performARIMAForecast($symbolList);$riskData['crypto']=$MyMIInvestments->generateRiskManagementTools($cuID,'crypto');break;}}$content=$this->generateContent($forecastData,$riskData);return $content;}private function getSymbolsByAssetType($symbols){$result=['stocks'=>[],'etfs'=>[],'crypto'=>[]];foreach($symbols as $symbol){if(preg_match('/^[A-Z]{1,5}$/',$symbol)){$result['stocks'][]=$symbol;}elseif(preg_match('/^[A-Z]{1,5}$/',$symbol)){$result['etfs'][]=$symbol;}else{$result['crypto'][]=$symbol;}}return $result;}private function generateContent($forecastData,$riskData){$content="";if(!empty($forecastData['stocks'])){$content.="### Stock Investment Forecast\n";foreach($forecastData['stocks']as $symbol=>$forecast){$content.="- **{$symbol}**: ".json_encode($forecast)."\n";}}if(!empty($forecastData['etfs'])){$content.="### ETF Investment Forecast\n";foreach($forecastData['etfs']as $symbol=>$forecast){$content.="- **{$symbol}**: ".json_encode($forecast)."\n";}}if(!empty($forecastData['crypto'])){$content.="### Crypto Investment Forecast\n";foreach($forecastData['crypto']as $symbol=>$forecast){$content.="- **{$symbol}**: ".json_encode($forecast)."\n";}}$content.="\n### Risk Management Insights\n";foreach($riskData as $type=>$riskMetrics){$content.="#### ".ucfirst($type)." Risks\n";foreach($riskMetrics as $riskMetric=>$details){$content.="- **{$riskMetric}**: ".json_encode($details)."\n";}}return $content;}public function getRecentPosts($limit=5){return $this->marketingModel->getRecentPosts($limit);}public function pullFinancialNews():void{$response=$this->client->get('https://www.marketaux.com/api/v1/news/all',['query'=>['api_token'=>getenv('marketaux.apiKey'),'language'=>'en','country'=>'us','published_after'=>date('Y-m-d\TH:i:s\Z',strtotime('-1 hour')),'limit'=>50,],]);$data=json_decode($response->getBody(),true);if(isset($data['data'])){foreach($data['data']as $story){$this->marketingModel->saveNews($story);}}}public function rankBufferCandidates(){$buffer=$this->marketingModel->fetchBufferPostsForScoring();foreach($buffer as $post){$keywords=$this->extractKeywords($post['summary']);$score=array_sum(array_column($keywords,'score'));$tagScore=min($score/10,10);$this->marketingModel->updateBufferItem($post['id'],['tag_score'=>$tagScore]);}}public function rankNewsArticles():void{$unrankedNews=$this->marketingModel->getUnrankedNews();foreach($unrankedNews as $news){$content=strtolower(($news['title']?? '').' '.($news['email_subject']?? '').' '.($news['email_body']?? ''));$words=str_word_count(strip_tags($content),1);$wordFreq=array_count_values($words);$filtered=array_filter($wordFreq,fn($freq,$word)=>strlen($word)>3&&$freq>1,ARRAY_FILTER_USE_BOTH);arsort($filtered);$score=array_sum(array_values($filtered));$topKeywords=array_slice(array_keys($filtered),0,5);$this->marketingModel->updateRankedNews($news['id'],$score,implode(',',$topKeywords));}}public function summarizeMultipleArticles(array $articles):string{$allContent='';foreach($articles as $article){$content=$article['content']?? '';$allContent.=strip_tags($content).' ';}if(empty(trim($allContent))){log_message('error','summarizeMultipleArticles() received empty content.');return 'No content available to summarize.';}$summaryData=$this->summarizeContent($allContent);return is_array($summaryData)&&isset($summaryData['summary'])?$summaryData['summary']:substr($allContent,0,300).'...';}} ?><?php namespace App\Models;use CodeIgniter\Model;use Phpml\FeatureExtraction\TfIdfTransformer;use Phpml\Tokenization\WhitespaceTokenizer;class MarketingModel extends Model{protected $table='bf_marketing_scraper';protected $primaryKey='id';protected $useAutoIncrement=true;protected $returnType='object';protected $useSoftDeletes=false;protected $allowedFields=['title','description','created_on','modified_on','status','type','day','time','activity','link','url','summary','content','email_identifier','email_date','email_sender','email_subject','email_body','email_attachments','keywords','scraped_at','links','images','videos','metadata','structured_data','sched_id','escalated','audience_type','stage','name','assigned_on','assigned_to','completed_on','scheduled_at','primary_content','secondary_content','html_content','voice_script','shared','shared_users','blog','in_app','email','discord','facebook','linkedin','telegram','twitter','website','promotional_links','facebook_message','linkedin_message','discord_message','stocktwits_message','tiktok_message','youtube_message','email_message','additional_info','image_paths'];protected $useTimestamps=true;protected $createdField='created_on';protected $updatedField='modified_on';public function addMarketingCampaign($campaignData){log_message('debug','MarketingModel L206 - $marketingData: '.(print_r($campaignData,true)));$dbData=['beta'=>$campaignData['beta'],'config_mode'=>$campaignData['config_mode'],'form_mode'=>$campaignData['form_mode'],'escalated'=>$campaignData['escalated'],'created_by'=>$campaignData['user_id'],'user_id'=>$campaignData['user_id'],'user_email'=>$campaignData['user_email'],'username'=>$campaignData['username'],'assigned_to'=>$campaignData['assigned_to'],'assigned_on'=>$campaignData['date'].' - '.$campaignData['time'],'name'=>$campaignData['campaign_name'],'promotional_links'=>$campaignData['promotionalLinks'],'overall_campaign_description'=>$campaignData['overall_campaign_description'],'voice_script'=>$campaignData['voice_script'],'facebook_message'=>$campaignData['facebookMessage'],'linkedin_message'=>$campaignData['linkedinMessage'],'discord_message'=>$campaignData['discordMessage'],'stocktwits_message'=>$campaignData['stocktwitsMessage'],'tiktok_message'=>$campaignData['tiktokMessage'],'youtube_message'=>$campaignData['youtubeMessage'],'email_message'=>$campaignData['emailMessage'],'additional_info'=>$campaignData['additionalInfo'],'hashtags'=>$campaignData['hashtags'],];log_message('debug','MarketingModel L206 - $marketingData: '.(print_r($dbData,true)));if($this->db->table('bf_marketing_campaigns')->insert($dbData)){log_message('info','Campaign created successfully.');return $this->getInsertID();}else{log_message('error','DB Insert Error: '.json_encode($this->errors()));return false;}}public function addMarketingSchedule($data){$data['zapier_webhook_url']=$data['zapier_webhook_url']?? null;$data['post_status']='pending';$this->db->table('bf_marketing_schedule')->insert($data);return $this->db->insertID();}public function addSubscriber($subscriberData){if($this->db->table('bf_users_subscribers')->insert($subscriberData)){log_message('info','Subscriber added successfully.');return true;}else{log_message('error','DB Insert Error: '.json_encode($this->errors()));return false;}}public function cleanHtmlEmailContent($raw):string{$raw=is_string($raw)?$raw:'';$decoded=quoted_printable_decode($raw);$decoded=is_string($decoded)?$decoded:'';$text=strip_tags($decoded);$text=preg_replace('/\s+/',' ',str_replace(["\r","\n","\t",'&nbsp;'],' ',$text));return trim(substr($text,0,5000));}public function copyMarketingCampaign($marketingData){unset($marketingData['id']);if($this->insert($marketingData)){log_message('info','Campaign copied successfully.');return $this->getInsertID();}else{log_message('error','DB Insert Error: '.json_encode($this->errors()));return false;}}public function countBlogs(){return $this->db->table('bf_marketing_blog_posts')->countAllResults();}public function countNewlyInsertedToday():int{return $this->where('DATE(scraped_at)',date('Y-m-d'))->countAllResults();}public function createSlug($title){$slug=url_title($title,'-',true);$existing=$this->db->table('bf_marketing_blog_posts')->where('slug',$slug)->countAllResults();return $existing?$slug.'-'.uniqid():$slug;}public function deleteMarketingCampaign($id){if($this->delete($id)){log_message('info','Campaign deleted successfully.');return true;}else{log_message('error','DB Delete Error: '.json_encode($this->errors()));return false;}}public function deleteSchedule($id){return $this->db->table('bf_marketing_schedule')->where('id',$id)->delete();}public function editMarketingCampaign($marketingData){if($this->update($marketingData['id'],$marketingData)){log_message('info','Campaign updated successfully.');return true;}else{log_message('error','DB Update Error: '.json_encode($this->errors()));return false;}}public function extractKeywords($text){if(empty($text)||strlen(trim($text))<50){return[];}$tokenizer=new WhitespaceTokenizer();$tokens=array_filter($tokenizer->tokenize($text));if(empty($tokens)){return[];}$documents=[$tokens];$tfidf=new TfIdfTransformer();try{$tfidf->transform($documents);}catch(\Exception $e){log_message('error','TfIdfTransformer failed: '.$e->getMessage());return[];}$keywordScores=[];foreach($documents[0]as $word=>$score){$keywordScores[$word]=$score;}arsort($keywordScores);return array_slice(array_keys($keywordScores),0,10);}public function fetchBufferPaginated($page=1,$limit=20){$offset=($page-1)*$limit;$builder=$this->db->table('bf_marketing_buffer')->where('status !=','promoted')->orderBy('tag_score','DESC')->limit($limit,$offset);$results=$builder->get()->getResultArray();$total=$this->db->table('bf_marketing_buffer')->where('status !=','promoted')->countAllResults();return['data'=>$results,'pagination'=>['page'=>$page,'pages'=>ceil($total/$limit),]];}public function fetchBufferPaginatedWithFilters(array $params=[]){$page=$params['page']?? 1;$limit=$params['limit']?? 20;$offset=($page-1)*$limit;$keyword=$params['keyword']?? null;$category=$params['category']?? null;$minTagScore=$params['min_tag_score']?? 0;$onlySuggested=$params['only_suggested']?? false;$builder=$this->db->table('bf_marketing_buffer')->where('status !=','promoted');if(!empty($keyword)){$builder->like('keyword',$keyword);}if(!empty($category)){$builder->where('category',$category);}if(!empty($minTagScore)){$builder->where('tag_score >=',$minTagScore);}if($onlySuggested){$builder->where('auto_suggest',1);}$totalQuery=clone $builder;$total=$totalQuery->countAllResults(false);$results=$builder->orderBy('tag_score','DESC')->limit($limit,$offset)->get()->getResultArray();return['data'=>$results,'pagination'=>['page'=>$page,'limit'=>$limit,'pages'=>ceil($total/$limit),'total'=>$total,],];}public function fetchBufferPostsForReview($limit=25){return $this->db->table('bf_marketing_buffer')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getBufferItem($id){return $this->db->table('bf_marketing_buffer')->where('id',$id)->get()->getRowArray();}public function getPendingAutoSuggested($limit=5){return $this->db->table('bf_marketing_buffer')->where('status','pending')->where('auto_suggest',1)->orderBy('tfidf_score','DESC')->limit($limit)->get()->getResultArray();}public function getPendingScheduledPosts($currentTimestamp){return $this->db->table('bf_marketing_schedule')->where('post_time <=',$currentTimestamp)->where('post_status','pending')->get()->getResult();}public function getPendingScraperSummaries($limit=10){return $this->db->table('bf_marketing_scraper')->where('status',null)->orWhere('status','')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getProcessedEmails($date=null){$builder=$this->select('email_identifier');if($date){$builder->where('DATE(email_date)',$date);}$results=$builder->get()->getResultArray();$identifiers=[];foreach($results as $row){if(!empty($row->email_identifier)){$identifiers[]=$row->email_identifier;}}return $identifiers;}public function findBufferItem($id){return $this->db->table('bf_marketing_buffer')->where('id',$id)->get()->getRowArray();}public function findFinalizedById($id){return $this->db->table('bf_marketing_scraper')->where('id',$id)->get()->getRowArray();}public function getActiveCampaigns(){$builder=$this->db->table('bf_marketing_campaigns');$num_rows=$builder->where('status',1)->countAllResults(false);$result=$builder->where('status',1)->get()->getResultArray();return['result'=>$result,'num_rows'=>$num_rows];}public function getActiveIdeas(){return $this->db->table('bf_marketing_ideas')->where('status !=','approved')->get()->getResultArray();}public function getActivePriorityCampaigns(){$builder=$this->db->table('bf_marketing_campaigns');$num_rows=$builder->where('status',1)->where('escalated',1)->countAllResults(false);$result=$builder->where('status',1)->where('escalated',1)->get()->getResultArray();return['result'=>$result,'num_rows'=>$num_rows];}public function getApprovedBufferWithoutSchedule(){return $this->db->table('bf_marketing_buffer')->where('status','approved')->where('scheduled_at IS NULL',null,false)->where('schedule_interval >',0)->orderBy('tag_score','DESC')->limit(10)->get()->getResultArray();}public function getApprovedLogos(){return $this->db->table('bf_company_logos')->get()->getResultArray();}public function getBlogPostBySlug($slug){return $this->db->table('bf_marketing_blog_posts')->where('slug',$slug)->get()->getRow();}public function getBlogPostDetails($id){return $this->find($id);}public function getBlogPosts(){return $this->where('type','Email/Newsletters')->limit(50)->get()->getResultArray();}public function getBlogs(){return $this->db->table('bf_marketing_blog_posts')->orderBy('created_on','DESC')->get()->getResult();}public function getBufferItems($limit=50){return $this->builder()->where('status','pending')->orderBy('score','DESC')->limit($limit)->get()->getResultArray();}public function getCampaignById($campaign_id){return $this->db->table('bf_marketing_campaigns')->where('id',$campaign_id)->get()->getResultArray();}public function getCampaignsBySchedId($accountid){return $this->db->table('bf_marketing_campaigns')->where('sched_id',$accountid)->get()->getResultArray();}public function getDailyLogsByDate($date){return $this->db->table('bf_marketing_scraper')->where('DATE(created_on)',$date)->get()->getResult();}public function getEmailRecordById($id){return $this->db->table('bf_marketing_temp_scraper')->where('id',$id)->get()->getRowArray();}public function getEmailByMessageId($messageId){return $this->db->table('bf_marketing_temp_scraper')->where('email_identifier',$messageId)->get()->getRowArray();}public function getEmailContentsForNewsletter(){return $this->where('include_newsletter',false)->limit(50)->get()->getResultArray();}public function getEmailsMissingTitleOrUrl($limit=20){return $this->db->table('bf_marketing_temp_scraper')->where('(title IS NULL OR title = "" OR url IS NULL OR url = "")',null,false)->orderBy('date_scraped','DESC')->limit($limit)->get()->getResultArray();}public function getEmailSummariesForReview(){return $this->where('status','In Review')->limit(50)->get()->getResultArray();}public function getExchangeTokenById($id){return $this->db->table('bf_exchanges_assets')->where('id',$id)->get()->getRowArray();}public function getExistingLogoBySymbol($symbol){return $this->db->table('bf_company_logos')->where('symbol',$symbol)->get()->getRow();}public function getFeatures(){return $this->db->table('bf_users_memberships')->where('active',1)->orderBy('feature_level','ASC')->orderBy('feature_name','ASC')->get()->getResultArray();}public function getGeneratedContent($postId){return $this->db->table('bf_marketing_campaigns')->where('sched_id',$postId)->get()->getRowArray();}public function getGeneratedPostsBySourceId($id){$row=$this->db->table('bf_marketing_scraper')->where('source_id',$id)->get()->getRowArray();if(!$row||empty($row['platforms']))return[];$decoded=json_decode($row['platforms'],true);if(!is_array($decoded))return[];return $decoded;}public function getLatestGeneratedSummaries($limit=25){return $this->db->table('bf_marketing_scraper')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getLatestNewsletterDraft(){return $this->db->table('bf_marketing_newsletters')->orderBy('created_at','DESC')->first();}public function getLatestTempRecords($limit=5){return $this->db->table('bf_marketing_temp_scraper')->where('status','In Review')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getLatestUnprocessedEmails($limit=10){return $this->db->table('bf_marketing_temp_scraper')->where('status','In Review')->orderBy('scraped_at','DESC')->limit($limit)->get()->getResultArray();}public function getMarketingBuffer($status='Pending'){return $this->builder()->where('status',$status)->orderBy('created_at','DESC')->get()->getResultArray();}public function getMarketingPageSeoByName($pageTitle){return $this->where('page_name',$pageTitle)->get()->getResultArray();}public function getMarketingTeam(){$result=$this->db->table('bf_management_positions')->where('department','Marketing')->get()->getResultArray();return $result;}public function getNewsArticles(){$result=$this->select('articles_json')->first();return json_decode($result->articles_json ?? '[]',true);}public function getNewEmails(){return $this->db->table('bf_marketing_raw_emails')->where('status','unprocessed')->get()->getResultArray();}public function getNewsPosts(){return $this->where('type','news_post')->limit(50)->get()->getResultArray();}public function getNextScheduledPost(){return $this->db->table('bf_marketing_buffer')->where('status','approved')->where('tag_score >=',7.0)->orderBy('tag_score','DESC')->limit(1)->get()->getRowArray();}public function getRecentPosts($limit=5){$results=$this->asObject()->select("id, title, category, created_at, blog_content")->orderBy('created_at','DESC')->limit($limit)->findAll();log_message('info','MarketingModel L437 - $result Array: '.(print_r($results,true)));foreach($results as $r){$r->short_description=substr(strip_tags($r->blog_content ?? 0),0,150);}return $results;}public function getRecentScrapes(){return $this->db->table('bf_marketing_temp_scraper')->orderBy('scraped_at','DESC')->limit(5)->get()->getResult();}public function getRecentSummaries($limit=5){return $this->db->table('bf_marketing_scraper')->select('id, title, summary, keywords, scraped_at')->where("CHAR_LENGTH(summary) >=",100)->where("summary LIKE",'% % % % % % % % % %')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function getRecentUnprocessedTempEmails($limit=5){return $this->db->table('bf_marketing_temp_scraper')->where('status','In Review')->orderBy('id','DESC')->limit($limit)->get()->getResultArray();}public function getScheduledBufferPosts($timestamp){return $this->db->table('bf_marketing_buffer')->where('status','approved')->where('scheduled_at <=',$timestamp)->orderBy('scheduled_at','ASC')->limit(3)->get()->getResultArray();}public function getScheduledCampaigns(){return $this->db->table('bf_marketing_newsletters')->where('status','scheduled')->where('scheduled_date <=',date('Y-m-d H:i:s'))->get()->getResultArray();}public function getScheduleByDay($day){return $this->db->table('bf_marketing_calendar')->where('day',ucfirst($day))->get()->getResultArray();}public function getScheduleById($id){return $this->db->table('bf_marketing_schedule')->where('id',$id)->get()->getRow();}public function getScrapesByDate($date){return $this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',$date)->orderBy('scraped_at','DESC');if($limit){$builder->limit($limit);}return $builder->get()->getResultArray();}public function getScrapesByKeyword($keyword){return $this->db->table('bf_marketing_scraper')->like('summary',$keyword)->orLike('keywords',$keyword)->orderBy('created_on','DESC')->limit(10)->get()->getResultArray();}public function getTodaysNewsContent($limit=10){$builder=$this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',date('Y-m-d'))->where('type !=','todays_story')->orderBy('scraped_at','DESC')->limit($limit);$query=$builder->get();$results=$query->getResultArray();if(empty($results)){log_message('info','No scraped content found for today.');}return $results;}public function getTodaysScrapedContent(){return $this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',date('Y-m-d'))->orderBy('feature_score','DESC')->get()->getResultArray();}public function getTodaysStory(){return $this->db->table('bf_marketing_temp_scraper')->where('type','todays_story')->where('DATE(scraped_at)',date('Y-m-d'))->orderBy('scraped_at','DESC')->get()->getRowArray();}public function getTopBufferPosts($limit=5,$minTagScore=7.5){return $this->builder('bf_marketing_buffer')->where('status','approved')->where('tag_score >=',$minTagScore)->orderBy('tag_score','DESC')->limit($limit)->get()->getResultArray();}public function getTopStories($limit=10){return $this->db->table('bf_marketing_scraper')->where('status','pending')->where('title IS NOT NULL')->where('title !=','')->orderBy('feature_score','DESC')->limit($limit)->get()->getResultArray();}public function getTopTempRecords($limit=5){return $this->db->table('bf_marketing_temp_scraper')->where('title IS NOT NULL')->orderBy('created_at','desc')->limit($limit)->get()->getResultArray();}public function getUpcomingSchedule(){return $this->db->table('bf_marketing_schedule')->select('id, post_date, completed, GROUP_CONCAT(DISTINCT platform ORDER BY platform ASC SEPARATOR ", ") as platforms, MIN(content_subject) as subjects, MIN(content_description) as descriptions')->where('post_date >=',date('Y-m-d'))->groupBy('post_date')->orderBy('post_date','ASC')->get()->getResultArray();}public function getUpcomingEarnings(){$builder=$this->db->where('bf_investment_calendar')->where('date >=',date('Y-m-d'))->where('event_type','Earnings')->orderBy('date','ASC')->get()->getResultArray();log_message('debug','MarketingModel L211 - getUpcomingEvents $builder Array: '.(print_r($builder,true)));return $builder;}public function getValidUnprocessedEmails($limit=10){$builder=$this->db->table('bf_marketing_temp_scraper');$builder->where('processed',0);$builder->limit($limit*2);$query=$builder->get();$results=$query->getResultArray();$valid=[];foreach($results as $row){$id=$row['id'];if(empty($row['title'])){log_message('debug',"ðŸª“ Skipping record ID {$id} â€” Missing title.");continue;}if(empty($row['content'])||strlen(strip_tags($row['content']))<100){log_message('debug',"ðŸª“ Skipping record ID {$id} â€” Content empty or too short.");continue;}$textContent=strip_tags($row['content']);$htmlRatio=strlen($textContent)/strlen($row['content']?? '');if($htmlRatio<0.3){log_message('debug',"ðŸª“ Skipping record ID {$id} â€” HTML-dominant content ({$htmlRatio}).");continue;}$valid[]=$row;if(count($valid)>=$limit){break;}}return $valid;}public function getValidUnprocessedEmailsFromToday($limit=10){return $this->db->table('bf_marketing_temp_scraper')->where('DATE(scraped_at)',date('Y-m-d'))->where('content IS NOT NULL',null,false)->where('title IS NOT NULL',null,false)->where('CHAR_LENGTH(content) >',250)->orderBy('id','DESC')->limit($limit)->get()->getResultArray();}public function incrementRetryCount($id){return $this->db->table('bf_marketing_schedule')->where('id',$id)->set('retry_count','retry_count + 1',false)->update(['last_attempt_at'=>date('Y-m-d H:i:s')]);}public function insertBufferItem(array $summary){$MyMIMarketing=new \App\Libraries\MyMIMarketing();$scoreData=$MyMIMarketing->getTopKeywordScores($summary['summary']);$threshold=getenv('MARKETING_TFIDF_THRESHOLD')?:7.5;$bufferRecord=['keyword'=>$scoreData['top_keyword']?? 'general','summary'=>$summary['summary'],'score'=>$scoreData['score']?? 0,'tag_score'=>$scoreData['tag_score']?? 0,'category'=>$scoreData['category']?? 'Uncategorized','status'=>'pending','tfidf_score'=>$scoreData['tfidf_score']?? 0,'auto_suggest'=>($scoreData['tfidf_score']?? 0)>=$threshold?1:0,'platforms'=>json_encode(['discord'=>true,'linkedin'=>true,'x'=>false,'email'=>false,]),'created_at'=>date('Y-m-d H:i:s'),];return $this->insert($bufferRecord);}public function insertFinalScraper(array $record,array $summary){$data=['source_id'=>$record['id'],'title'=>$record['title']?? '(No Title)','summary'=>$summary['summary']?? '','keywords'=>json_encode($summary['keywords']??[]),'platforms'=>json_encode($summary['posts']??[]),'status'=>'ready','created_on'=>date('Y-m-d H:i:s'),];return $this->db->table('bf_marketing_scraper')->insert($data);}public function insertNewsContent(array $newsItem,string $ticker){$data=['title'=>$newsItem['title']?? '','summary'=>$newsItem['summary']?? '','content'=>$newsItem['content']?? '','type'=>'financial_news','status'=>'Published','created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),'scraped_at'=>date('Y-m-d H:i:s'),'keywords'=>json_encode($newsItem['keywords']??[]),'links'=>json_encode($newsItem['links']??[]),'audience_type'=>'investor','activity'=>$ticker,];return $this->db->table('bf_marketing_scraper')->insert($data);}public function insertTempScraper($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function idleFetchEmails(){$config=config('NewsEmailServer');$connectionString="{$config->host}:{$config->port}/imap/{$config->encryption}";$inbox=@imap_open($connectionString,$config->username,$config->password);if(!$inbox){log_message('error','Cannot connect to email server: '.imap_last_error());return;}try{while(true){if(function_exists('imap_idle')){$status=imap_idle($inbox);}else{log_message('warning','ðŸ“­ imap_idle not supported on this server. Falling back to polling.');sleep(30);continue;}$status=imap_idle($inbox);if($status){$emails=imap_search($inbox,'ALL');if($emails){foreach($emails as $email_number){$overview=imap_fetch_overview($inbox,$email_number,0)[0];$sender=$overview->from;$subject=$overview->subject;$body=imap_fetchbody($inbox,$email_number,1);$data=['status'=>'In Review','type'=>'Email/Newsletters','email_identifier'=>md5($subject.$sender.$overview->date),'email_date'=>date('Y-m-d H:i:s',strtotime($overview->date)),'email_sender'=>$sender,'email_subject'=>$subject,'email_body'=>$body,'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];if($this->isEmailProcessed($data['email_identifier'])){log_message('debug','Email already processed: '.$data['email_identifier']);}else{$this->storeEmailContent($data);}}}else{log_message('debug','No new emails found or imap_search returned false');}}sleep(30);}}catch(\Exception $e){log_message('error','An exception occurred during email fetching: '.$e->getMessage());}finally{imap_close($inbox);}}public function isEmailProcessed($emailIdentifier){return $this->where('email_identifier',$emailIdentifier)->countAllResults()>0;}private function mapToContextualHashtags($keywords){return array_map(fn($keyword)=>'#'.preg_replace('/\s+/','',ucfirst($keyword)),$keywords);}public function markEmailsAsProcessed($ids=[]){if(!empty($ids)){return $this->db->table('bf_marketing_temp_scraper')->whereIn('id',$ids)->update(['status'=>'Processed']);}return false;}public function markTempRecordAsProcessed($id){return $this->db->table('bf_marketing_temp_scraper')->where('id',$id)->update(['status'=>'Processed','updated_at'=>date('Y-m-d H:i:s')]);}public function markTempScraperProcessed($id){$this->db->table('bf_marketing_temp_scraper')->where('id',$id)->update(['status'=>'Processed']);}public function processText($emailBody){$summary=$this->summarizeText($emailBody);$keywords=$this->extractKeywords($emailBody);$hashtags=$this->mapToContextualHashtags($keywords);if(empty($summary)||empty($hashtags)){log_message('error','Text processing failed');return false;}return $summary.' '.implode(' ',$hashtags);}public function saveApprovedLogo($symbol,$imageUrl){$symbol=strtoupper(trim($symbol));$data=['symbol'=>$symbol,'image_url'=>$imageUrl,'approved_at'=>date('Y-m-d H:i:s'),'updated_at'=>date('Y-m-d H:i:s'),];try{$existingLogo=$this->db->table('bf_company_logos')->where('symbol',$symbol)->get()->getRow();if($existingLogo){if($existingLogo->image_url!==$imageUrl){$this->db->table('bf_company_logos')->where('symbol',$symbol)->update($data);log_message('info',"Logo for symbol {$symbol} updated in bf_company_logos.");}else{log_message('info',"Logo for symbol {$symbol} already exists and is up to date.");}}else{$this->db->table('bf_company_logos')->insert($data);log_message('info',"Logo for symbol {$symbol} added to bf_company_logos.");}}catch(\Exception $e){log_message('error',"Failed to save or update logo for symbol {$symbol}: ".$e->getMessage());}}public function saveDailyLog($data){return $this->db->table('bf_marketing_scraper')->insert($data);}public function saveLogo($data){$symbol=strtoupper(trim($data['symbol']));$existing=$this->db->table('bf_company_logos')->where('symbol',$symbol)->get()->getRow();$data['symbol']=$symbol;$data['updated_at']=date('Y-m-d H:i:s');if($existing){$this->db->table('bf_company_logos')->where('symbol',$symbol)->update($data);log_message('info',"Logo for symbol {$symbol} updated in bf_company_logos.");}else{$data['created_at']=date('Y-m-d H:i:s');$this->db->table('bf_company_logos')->insert($data);log_message('info',"Logo for symbol {$symbol} added to bf_company_logos.");}}public function scheduleNewsletterCampaign($data){return $this->db->table('bf_marketing_newsletters')->insert($data);}public function storeContentAnalytics(array $data){return $this->db->table('bf_marketing_analysis')->insert($data);}public function storeEmail($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function storeEmailContent($data){return $this->insert($data);}public function storeFinalMarketingContent($data){return $this->db->table('bf_marketing_scraper')->insert($data);}public function storeTodaysStory($title,$content){$data=['title'=>$title,'content'=>$content,'links'=>json_encode([]),'url'=>'','type'=>'todays_story','scraped_at'=>date('Y-m-d H:i:s'),'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function submitCampaignContent($data){if(isset($data['promotional_links'])&&is_array($data['promotional_links'])){$data['promotional_links']=json_encode($data['promotional_links']);}$data['status']=$data['status']?? 1;$data['stage']=$data['stage']?? 'draft';$data['created_on']=date('Y-m-d H:i:s');return $this->save($data);}public function storeNewsletterDraft($data){return $this->db->table('bf_marketing_newsletters')->insert($data);}public function storeNotification($data){return $this->db->table('bf_users_promotional_messages')->insert($data);}public function storeScrapedContent($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function storeTempScrapedData($data){return $this->db->table('bf_marketing_temp_scraper')->insert($data);}public function summarizeText($text){if(empty($text)){return '';}$sentences=explode('.',$text);if(count($sentences)<=1){return substr($text,0,200);}$tokenizer=new WhitespaceTokenizer();$documents=array_map([$tokenizer,'tokenize'],$sentences);$documents=array_filter($documents);if(empty($documents)){return '';}$tfidf=new TfIdfTransformer();try{$tfidf->transform($documents);}catch(\Exception $e){log_message('error','TfIdfTransformer failed: '.$e->getMessage());return '';}$sentenceScores=[];foreach($documents as $index=>$document){$sentenceScores[$index]=array_sum($document);}arsort($sentenceScores);$numSentences=min(5,count($sentenceScores));$summarySentences=array_slice(array_keys($sentenceScores),0,$numSentences);return implode('. ',array_intersect_key($sentences,array_flip($summarySentences)));}public function updateBufferItem($id,$data){return $this->db->table('bf_marketing_buffer')->where('id',$id)->update($data);}public function updateBufferStatus($id,$status){return $this->db->table('bf_marketing_buffer')->where('id',$id)->update(['status'=>$status]);}public function updateCampaignStatus($id,$status){return $this->db->table('bf_marketing_newsletters')->where('id',$id)->update(['status'=>$status]);}public function updateEmailFields($id,$title,$url,$content=null){$data=['title'=>$title,'url'=>$url];if(!empty($content)){$data['content']=$content;}return $this->db->table('bf_marketing_temp_scraper')->where('id',$id)->update($data);}public function updateExchangeToken($id,$data){return $this->update($id,$data);}public function updateNotification($data){return $this->db->table('bf_users_promotional_messages')->update($data);}public function updateSchedule($id,$data){return $this->db->table('bf_marketing_schedule')->where('id',$id)->update($data);}public function updatePostStatus($id,$status){return $this->db->table('bf_marketing_schedule')->where('id',$id)->update(['post_status'=>$status,'last_attempt_at'=>date('Y-m-d H:i:s')]);}} ?><?php namespace App\Services;use App\Libraries\{BaseLoader,MyMIMarketing};use App\Models\{MarketingModel};use GuzzleHttp\Client;class MarketingService{use BaseLoader;protected $MyMIMarketing;protected $marketingModel;protected $httpClient;public function __construct(){$this->MyMIMarketing=new MyMIMarketing();$this->marketingModel=new MarketingModel();$this->httpClient=new Client(['timeout'=>5,'stream'=>true,'http_errors'=>false,'headers'=>['User-Agent'=>'MyMI Content Bot','Accept-Encoding'=>'gzip, deflate, br',]]);}public function distributeContent($platform,$message){switch($platform){case 'discord':return $this->sendToDiscordWebhook($message);case 'facebook':return $this->sendToZapier('facebook',$message);case 'linkedin':return $this->sendToZapier('linkedin',$message);default:return false;}}public function extractTopKeywords($summary){return $this->getMyMIMarketing()->extractKeywords($summary['summary']);}public function fetchUnprocessedEmailSummaries(){return $this->getMyMIMarketing()->getEmailSummariesForReview();}public function getEmailRecordById($id){return $this->marketingModel->getEmailRecordById($id);}public function getFeatures(){$getFeatures=$this->getMyMIMarketing()->getFeatures();return $getFeatures;}public function gatherKeywordBasedContent($keywords){$allContent=[];foreach($keywords as $keyword){$secData=$this->getMyMIMarketing()->scrapeGoogleSearch("SEC filings {$keyword}");$alphaVantageData=$this->getMyMIMarketing()->scrapeGoogleSearch("AlphaVantage {$keyword}");$googleData=$this->getMyMIMarketing()->scrapeGoogleSearch($keyword,$this->httpClient);$internalData=$this->getMyMIMarketing()->getScrapesByKeyword($keyword);$allContent[]=array_merge([$secData],[$alphaVantageData],[$googleData],$internalData);}return $allContent;}public function generateContentFromPost($title,$content,$tags){$summaryData=$this->getMyMIMarketing()->summarizeContent($content);if(empty($summaryData)||empty($summaryData['summary'])){log_message('error','generateContentFromPost() failed to generate summary.');return null;}return $this->getMyMIMarketing()->generatePlatformContent($summaryData['summary'],$tags);}public function generateFinalContentFromTemp(){$records=$this->marketingModel->getTopTempRecords(5);foreach($records as $record){if(empty($record['title'])||empty($record['content']))continue;$summary=$this->summarizeContent($record['content']);$socialMediaPost=$this->generateSocialPost($summary);$final=['title'=>$record['title'],'content'=>$summary,'post_text'=>$socialMediaPost,'source'=>'email','created_at'=>date('Y-m-d H:i:s'),];$this->marketingModel->insertFinalScraper($final);}}public function generatePlatformPosts($content){$summaryText=implode(" ",array_column($content,'content'));return $this->getMyMIMarketing()->generateContentFromLargeText($summaryText,[]);}public function getManagementTeam(){$getManagementTeam=$this->getMyMIMarketing()->getManagementTeam();return $getManagementTeam;}public function getMarketingData($accountid,$category,$platform){$data=[];if($category&&$accountid){$scrapedData=$this->getMyMIMarketing()->scrapeTokenContentByAccountId($accountid);if($scrapedData){$data['generatedData']=$this->getMyMIMarketing()->generateContentFromScrapedData($scrapedData,$platform);}else{$data['generatedData']=[];}}return $data;}public function getPromotionalBanners($userId){return $this->getMyMIMarketing()->fetchPromotionalBanners($userId);}public function getRecentGeneratedContent($limit=10){return $this->db->table('bf_marketing_scraper')->orderBy('created_on','DESC')->limit($limit)->get()->getResultArray();}public function regeneratePostsFromEmailId($id){$record=$this->getEmailRecordById($id);if(!$record||empty($record['content'])){log_message('error',"âŒ Email record not found or empty for ID: $id");return null;}$processed=$this->getMyMIMarketing()->generateContentFromRaw($record);if($processed){$this->marketingModel->insertFinalScraper($record,$processed);$this->marketingModel->markEmailsAsProcessed([$id]);return $processed;}return null;}public function sanitizeAndSummarize($content){$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($content);return $this->getMyMIMarketing()->summarizeContent($cleanedBody);}public function storeGeneratedPostsForDashboard($posts){$this->getMyMIMarketing()->storeGeneratedContent(['primary_content'=>$posts['summary'],'social_media_content'=>json_encode($posts['platforms_content']),'status'=>'Generated','created_on'=>date('Y-m-d H:i:s'),]);}protected function sendToDiscordWebhook($message){$webhook=getenv('DISCORD_WEBHOOK_URL');if(!$webhook)return false;$client=\Config\Services::curlrequest();$payload=['content'=>$message];$response=$client->post($webhook,['json'=>$payload]);return $response->getStatusCode()===204;}protected function sendToZapier($platform,$message){$zapierHooks=['facebook'=>getenv('ZAPIER_FACEBOOK_WEBHOOK'),'linkedin'=>getenv('ZAPIER_LINKEDIN_WEBHOOK'),];$hook=$zapierHooks[$platform]?? null;if(!$hook)return false;$client=\Config\Services::curlrequest();$payload=['message'=>$message,'platform'=>$platform];$response=$client->post($hook,['json'=>$payload]);return $response->getStatusCode()===200;}public function storeScrapedContent($content){foreach($content as $data){$this->getMyMIMarketing()->storeTempScrapedData(['title'=>$data['title'],'content'=>$data['content'],'scraped_at'=>date('Y-m-d H:i:s'),'type'=>'keyword_summary',]);}}} ?><?php namespace App\Modules\APIs\Controllers;use CodeIgniter\Controller;use App\Modules\APIs\Controllers\MarketingController;use App\Libraries\{BaseLoader,MyMIAlerts,MyMIMarketing};use App\Models\{AlertsModel,ExchangeModel,MarketingModel,ReferralModel,SupportModel,UserModel};use App\Services\{MarketingService};use CodeIgniter\API\ResponseTrait;class ManagementController extends UserController{use BaseLoader;use ResponseTrait;protected $alertManager;protected $MyMIMarketing;protected $marketingService;protected $alertsModel;protected $exchangeModel;protected $marketingModel;protected $userModel;protected $referralModel;protected $supportModel;public function __construct(){$this->alertManager=new MyMIAlerts();$this->MyMIMarketing=new MyMIMarketing();$this->alertsModel=new AlertsModel();$this->exchangeModel=new ExchangeModel();$this->marketingModel=new MarketingModel();$this->marketingService=new MarketingService();$this->referralModel=new ReferralModel();$this->supportModel=new SupportModel();$this->userModel=new UserModel();}public function runCRONTasks(){log_message('info','ðŸ› ï¸ ManagementController::runCRONTasks() initiated.');$marketingController=new MarketingController();log_message('info','ðŸ“Œ Step 1: cronFetchAndGenerateNews()');try{$marketingController->cronFetchAndGenerateNews();}catch(\Throwable $e){log_message('error','âŒ cronFetchAndGenerateNews failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 3: generateDailyContentDigest()');try{$todayNews=$this->marketingModel->getTodaysScrapedContent();if(!empty($todayNews)){$marketingController->generateDailyContentDigest();}else{log_message('info','ðŸ›‘ Skipping summary generation â€” no scraped news available today.');}}catch(\Throwable $e){log_message('error','âŒ generateDailyContentDigest() failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 4: cronFetchInbox()');try{$marketingController->cronFetchInbox();}catch(\Throwable $e){log_message('error','âŒ cronFetchInbox() failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 5: cronAnalyzeContent()');try{$marketingController->cronAnalyzeContent();}catch(\Throwable $e){log_message('error','âŒ cronAnalyzeContent() failed: '.$e->getMessage());}log_message('info','ðŸ“Œ Step 6: reprocessIncompleteEmails()');try{$marketingController->runBackfillForTempEmails();}catch(\Throwable $e){log_message('error','âŒ reprocessIncompleteEmails() failed: '.$e->getMessage());}log_message('info','âœ… ManagementController::runCRONTasks() completed.');}public function ajaxGetActiveUsers(){log_message('debug','ðŸ“¥ ajaxGetActiveUsers() called.');$request=service('request');$post=$request->getPost();log_message('debug','ðŸ“¦ Incoming POST: '.print_r($post,true));$start=$post['start']?? 0;$length=$post['length']?? 10;$search=$post['search']['value']?? '';$records=$this->userModel->getUsersByStatus(1,$search);$totalRecords=count($records);$records=array_slice($records,$start,$length);$data=[];foreach($records as $user){try{$actionView=view('ManagementModule\Views\Users\partials\action_buttons',['user'=>$user]);}catch(\Throwable $e){log_message('error','âŒ Error rendering action_buttons view for user ID '.$user['id'].': '.$e->getMessage());$actionView='<span class="text-danger">View Error</span>';}$data[]=['id'=>'<a href="'.site_url('Management/Users/Profile/'.$user['username']).'">'.$user['id'].'</a>','type'=>$user['type'],'name'=>$user['first_name'].' '.$user['last_name'].' '.$user['name_suffix'],'email'=>'<a href="mailto:'.$user['email'].'">'.$user['email'].'</a>','location'=>$user['city'].', '.$user['state'],'referral_code'=>$user['referral_code'],'actions'=>$actionView,];}return $this->response->setJSON(['draw'=>intval($post['draw']?? 1),'recordsTotal'=>$totalRecords,'recordsFiltered'=>$totalRecords,'data'=>$data,]);}public function ajaxGetInactiveUsers(){log_message('debug','ðŸ“¥ ajaxGetInactiveUsers() called.');$request=service('request');$post=$request->getPost();log_message('debug','ðŸ“¦ Incoming POST: '.print_r($post,true));$start=$post['start']?? 0;$length=$post['length']?? 10;$search=$post['search']['value']?? '';$records=$this->userModel->getUsersByStatus(0,$search);$totalRecords=count($records);$records=array_slice($records,$start,$length);$data=[];foreach($records as $user){try{$actionView=view('ManagementModule\Views\Users\partials\action_buttons',['user'=>$user]);}catch(\Throwable $e){log_message('error','âŒ Error rendering action_buttons view for user ID '.$user['id'].': '.$e->getMessage());$actionView='<span class="text-danger">View Error</span>';}$data[]=['id'=>'<a href="'.site_url('Management/Users/Profile/'.$user['username']).'">'.$user['id'].'</a>','type'=>$user['type'],'name'=>$user['first_name'].' '.$user['last_name'].' '.$user['name_suffix'],'email'=>'<a href="mailto:'.$user['email'].'">'.$user['email'].'</a>','location'=>$user['city'].', '.$user['state'],'referral_code'=>$user['referral_code'],'actions'=>$actionView,];}return $this->response->setJSON(['draw'=>intval($post['draw']?? 1),'recordsTotal'=>$totalRecords,'recordsFiltered'=>$totalRecords,'data'=>$data,]);}protected function arrayToXml(array $data,\SimpleXMLElement $xml){foreach($data as $key=>$value){is_array($value)?$this->arrayToXml($value,$xml->addChild($key)):$xml->addChild($key,htmlspecialchars($value));}return $xml;}public function checkForSpamUsers(){try{$MyMIUser=new \App\Libraries\MyMIUser();$spamAccounts=$MyMIUser->findPotentialSpamUsers();return $this->response->setJSON(['status'=>'success','message'=>count($spamAccounts).' spam accounts detected.','data'=>$spamAccounts]);}catch(\Throwable $e){log_message('error','âŒ Error checking spam users: '.$e->getMessage());return $this->failServerError('Failed to check for spam accounts.');}}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);log_message('debug','âœ… Content digest completed.');}public function cronFetchAndGenerateNews(){try{$this->getMyMIMarketing()->cronFetchAndGenerateNews();return $this->response->setJSON(['status'=>'success','message'=>'MarketAux news pulled, ranked, and content generated.']);}catch(\Throwable $e){return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();log_message('debug','âœ… Inbox scrape completed.');}public function cronFetchMarketingEmails(){log_message('info','CRON: Starting Marketing Email Fetch');$service=new MarketingService();$emailsFetched=$service->fetchAndStoreMarketingEmails();log_message('info','CRON: Fetched '.$emailsFetched.' marketing emails');return $this->respond(['status'=>'success','fetched'=>$emailsFetched]);}public function cronFetchAndStoreEmails(){try{$this->logMessage('ðŸ“¥ [CRON] Started cronFetchAndStoreEmails');$marketingService=$this->getMarketingService();$fetched=$marketingService->scrapeInboxAndStore();$this->logMessage("ðŸ“© [CRON] Fetched and stored {$fetched} emails into bf_marketing_temp_scraper");return $this->respond(['status'=>'success','stored'=>$fetched]);}catch(\Throwable $e){log_message('error','[CRON] Error in cronFetchAndStoreEmails: '.$e->getMessage());return $this->failServerError('Failed to fetch emails');}}public function distributeTodaysNewsContent(){$generated=$this->generateTodaysNewsSummary();$result=$this->getMyMIMarketing()->sendToZapier($generated['content']);return $this->response->setJSON(['status'=>'success','message'=>'Content distributed via Zapier.','zapier_result'=>$result]);}public function exportPostJson($id){$post=$this->marketingModel->getGeneratedPostById($id);if(!$post||empty($post['posts'])){return $this->failNotFound('Post not found.');}$posts=json_decode($post['posts'],true);$export=['title'=>$post['title'],'summary'=>$post['summary'],'cta'=>'Check it out at https://mymiwallet.com','keywords'=>explode(',',$post['keywords']?? ''),'platform_captions'=>$posts,];return $this->response->setHeader('Content-Type','application/json')->setHeader('Content-Disposition','attachment; filename="canva_post_'.$id.'.json"')->setJSON($export);}public function fetchAlphaVantageNewsForTradeAlerts(){$alerts=$this->alertsModel->getTradeAlertsWithCreatedFlag();log_message('info','ðŸ“ˆ Processing '.count($alerts).' trade alerts.');foreach($alerts as $alert){try{log_message('info','ðŸ” Fetching AlphaVantage news for: '.$alert['ticker']);$newsItems=$this->alertManager->fetchAlphaVantageNews($alert['ticker']);log_message('info','ðŸ“° '.count($newsItems).' news items fetched for '.$alert['ticker']);foreach($newsItems as $news){$this->marketingModel->insertNewsContent($news,$alert['ticker']);}}catch(\Throwable $e){log_message('error','âŒ AlphaVantage fetch failed for '.$alert['ticker'].': '.$e->getMessage());}}return $this->response->setJSON(['status'=>'success','message'=>'Financial news processed for alerts.']);}public function fetchEmailsToTempScraper(){try{log_message('info','ðŸ“¥ Starting email scrape to bf_marketing_temp_scraper...');$this->getMyMIMarketing()->fetchAndStoreEmails('news');log_message('info','ðŸ“¬ Number of emails fetched: '.count($emails));return $this->response->setJSON(['status'=>'success','message'=>'Emails stored successfully.']);}catch(\Throwable $e){log_message('error','âŒ fetchEmailsToTempScraper error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function fetchNewsEmails(){log_message('info','ðŸ“¥ fetchNewsEmails - Started.');try{$this->getMyMIMarketing()->fetchAndStoreEmails('news');return $this->response->setJSON(['status'=>'success','message'=>'News emails fetched successfully.']);}catch(\Exception $e){log_message('error','âŒ fetchNewsEmails - Error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function forceFetchEmails(){try{$result=$this->alertManager->fetchAndStoreEmails();return $this->response->setJSON(['status'=>'success','message'=>'Emails fetched and processed successfully.']);}catch(\Exception $e){return $this->response->setJSON(['status'=>'error','message'=>'Error fetching emails: '.$e->getMessage()],500);}}public function generateContentDigestFromStored(){log_message('info','Marketing: Starting summary generation from stored marketing emails.');$model=new MarketingModel();$records=$model->getRecentUnprocessedTempEmails(5);$results=[];foreach($records as $record){if(empty($record['title'])||empty($record['content'])){log_message('debug','Skipped record due to missing title/content ID: '.$record['id']);continue;}try{$summary=$this->getMarketingService()->generateContentFromRaw($record['title'],$record['content']);$model->storeFinalMarketingContent(['source_id'=>$record['id'],'title'=>$record['title'],'summary'=>$summary,'created_at'=>date('Y-m-d H:i:s')]);$model->markTempRecordAsProcessed($record['id']);$results[]=$record['title'];}catch(\Throwable $e){log_message('error','Failed to process record ID '.$record['id'].': '.$e->getMessage());}}return $this->respond(['status'=>'complete','processed_titles'=>$results]);}public function generateContentFromScraper(){log_message('debug','ðŸ” API::MarketingController::generateContentFromScraper called');try{$limit=$this->request->getGet('limit')?? 5;$records=[];$allRecords=$this->marketingModel->getValidUnprocessedEmails($limit);if(!is_array($allRecords)){log_message('error','âŒ $allRecords is not an array or null. Cannot proceed.');return $this->respond(['status'=>'error','message'=>'Failed to fetch records.']);}foreach($allRecords as $record){$titleOk=!empty($record['title']);$contentOk=strlen(strip_tags($record['content']?? ''))>1000;if($titleOk&&$contentOk){$records[]=$record;if(count($records)>=$limit)break;}else{log_message('debug',"âš ï¸ Skipping invalid record ID {$record['id']} during prefilter (Title or content missing/too short).");$this->marketingModel->markEmailsAsProcessed([$record['id']]);}}if(empty($records)){return $this->respond(['status'=>'no_data','message'=>'No unprocessed records found.']);}$processedSummaries=[];foreach($records as $record){$content=$record['content']?? '';$title=$record['title']?? '';$recordId=$record['id']?? 0;if(empty(trim($content))||strlen($content)<1000){log_message('debug',"â­ï¸ Skipping record ID {$recordId} - content too short or empty.");continue;}if(empty(trim($title))){log_message('debug',"â­ï¸ Skipping record ID {$recordId} - missing title.");continue;}if(stripos($content,'<html')!==false&&substr_count($content,'<')>50){log_message('debug',"â­ï¸ Skipping record ID {$recordId} - content likely raw HTML.");continue;}try{$processed=$this->getMarketingService()->generateContentFromRaw($record);if(!is_array($processed)){log_message('debug',"âš ï¸ Skipped record ID {$recordId} - generateContentFromRaw() returned invalid structure.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$this->marketingModel->markEmailsAsProcessed([$recordId]);$processedSummaries[]=['id'=>$recordId,'title'=>$processed['headline']?? $title,'summary'=>$processed['summary']?? '','keywords'=>$processed['keywords']??[],];}catch(\Throwable $e){log_message('error',"âŒ Failed to process record ID {$recordId}: {$e->getMessage()}");}}return $this->respond(['status'=>'success','message'=>count($processedSummaries).' records processed successfully.','data'=>$processedSummaries]);}catch(\Throwable $e){log_message('error','âŒ API::generateContentFromScraper error - '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function generateDailyContentDigest(){log_message('debug','ðŸ§  Start Memory Usage: '.memory_get_usage(true));@ini_set('memory_limit','768M');$limit=5;$summary=[];try{$records=$this->marketingModel->getValidUnprocessedEmails($limit);if(!is_array($records)||empty($records)){log_message('info','ðŸš« No valid records returned from getValidUnprocessedEmails().');return $this->response->setJSON(['status'=>'no_data','message'=>'No valid records to process.']);}foreach($records as $record){$recordId=$record['id']?? 0;$title=$record['title']?? '';$content=$record['content']?? '';$contentSize=strlen(strip_tags($content));if(empty(trim($title))||$contentSize<1000){log_message('debug',"âš ï¸ Skipping record ID {$recordId} â€” title missing or content too short ({$contentSize} chars).");$this->marketingModel->markEmailsAsProcessed([$recordId]);continue;}if(stripos($content,'<html')!==false&&substr_count($content,'<')>50){log_message('debug',"â­ï¸ Skipping record ID {$recordId} â€” likely raw HTML content.");$this->marketingModel->markEmailsAsProcessed([$recordId]);continue;}try{gc_collect_cycles();$processed=$this->getMarketingService()->generateContentFromRaw($record);if(!is_array($processed)){log_message('warning',"âš ï¸ Skipped record ID {$recordId} â€” generateContentFromRaw() returned invalid result.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$this->marketingModel->markEmailsAsProcessed([$recordId]);$summary[]=['title'=>$processed['headline']?? 'Untitled','summary'=>$processed['summary']?? '','subtopics'=>$processed['subtopics']??[],'platform_posts'=>$processed['posts']??[],];}catch(\Throwable $e){log_message('error',"âŒ Error processing record ID {$recordId}: {$e->getMessage()}");}}log_message('debug','ðŸ Peak Memory Usage: '.memory_get_peak_usage(true));return $this->response->setJSON(['status'=>'success','digest'=>$summary]);}catch(\Throwable $e){log_message('error','âŒ generateDailyContentDigest fatal error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function generateRankedMarketingContent(){$this->getMyMIMarketing()->generateRankedMarketingContent();return $this->response->setJSON(['status'=>'success','message'=>'Ranked content generated.']);}public function getBalanceSheet($symbol,$apikey){$url="https://www.alphavantage.co/query?function=BALANCE_SHEET&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getCashFlowStatement($symbol,$apikey){$url="https://www.alphavantage.co/query?function=CASH_FLOW&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getCompanyOverview($symbol,$apikey){$url="https://www.alphavantage.co/query?function=OVERVIEW&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getEarningsCalendar($apikey,$horizon='3month'){$url="https://www.alphavantage.co/query?function=EARNINGS_CALENDAR&horizon=".$horizon."&apikey=".$apikey;$csv=file_get_contents($url);$lines=explode("\n",trim($csv));$data=array_map('str_getcsv',$lines);return $data;}public function getFixedWindowAnalytics($symbols,$rangeStart,$rangeEnd,$calculations,$apikey){$url="https://alphavantageapi.co/timeseries/analytics?SYMBOLS=".urlencode($symbols);$url.="&RANGE=".$rangeStart."&RANGE=".$rangeEnd;$url.="&INTERVAL=DAILY&OHLC=close";$url.="&CALCULATIONS=".urlencode($calculations)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getIncomeStatement($symbol,$apikey){$url="https://www.alphavantage.co/query?function=INCOME_STATEMENT&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getInsiderTransactions($symbol,$apikey){$url="https://www.alphavantage.co/query?function=INSIDER_TRANSACTIONS&symbol=".urlencode($symbol)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getNewsSentiment($apikey,$tickers='',$topics='',$time_from='',$time_to='',$sort='LATEST',$limit=50){$url="https://www.alphavantage.co/query?function=NEWS_SENTIMENT";$url.="&tickers=".urlencode($tickers);$url.="&topics=".urlencode($topics);if($time_from)$url.="&time_from=".$time_from;if($time_to)$url.="&time_to=".$time_to;$url.="&sort=".$sort."&limit=".$limit."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getSlidingWindowAnalytics($symbols,$range,$windowSize,$calculations,$apikey){$url="https://alphavantageapi.co/timeseries/running_analytics?SYMBOLS=".urlencode($symbols);$url.="&RANGE=".$range."&INTERVAL=DAILY&OHLC=close";$url.="&WINDOW_SIZE=".$windowSize;$url.="&CALCULATIONS=".urlencode($calculations)."&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function generatePostsFromSummary($summaryId=null){try{$summary=$this->marketingModel->find($summaryId);if(!$summary){return $this->failNotFound('Summary not found.');}$decodedTitleRaw=$summary['title']?? '';$decodedSummaryRaw=$summary['summary']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$decodedSummary=quoted_printable_decode($decodedSummaryRaw);$cleanedSummary=html_entity_decode(strip_tags($decodedSummary));$keywords=$this->MyMIMarketing->extractKeywords($cleanedSummary);$posts=$this->MyMIMarketing->generateSocialPosts($cleanedSummary,$keywords);$this->marketingModel->update($summaryId,['keywords'=>json_encode($keywords),'posts'=>json_encode($posts),]);return $this->respond(['status'=>'success','message'=>'Content generated and stored successfully.','original'=>$summary,'cleaned'=>['title'=>$decodedTitle,'summary'=>$cleanedSummary,'keywords'=>$keywords,'posts'=>$posts,],]);}catch(\Throwable $e){log_message('error','âŒ generatePostsFromSummary() failed: '.$e->getMessage());return $this->failServerError('Error generating posts.');}}public function testTfIdfPipeline(){$samples=['Short unstructured','This is a valid test document with enough content and structure to process correctly.','     ','<html><body>Broken HTML without substance</body></html>','Here is another test input to validate TF-IDF scoring logic.',];foreach($samples as $i=>$text){$summary=$this->MyMIMarketing->summarizeText($text);$keywords=$this->MyMIMarketing->extractKeywords($text);$scorePreview=$this->MyMIMarketing->getTopKeywordScores($text,5);log_message('debug',"ðŸ§ª Test #{$i} | Summary: {$summary}");log_message('debug',"ðŸ§ª Test #{$i} | Keywords: ".implode(',',$keywords));log_message('debug',"ðŸ“Š Test #{$i} | TF-IDF Scores: ".print_r($scorePreview,true));}return $this->respond(['status'=>'ok','message'=>'TF-IDF test pipeline ran successfully.']);}public function generateTodaysNewsSummary(){$todayNews=$this->marketingModel->getTodaysNewsContent();$summary=$this->getMyMIMarketing()->summarizeMultipleArticles($todayNews);$content=$this->getMyMIMarketing()->generateMarketingContent($summary);return $this->response->setJSON(['status'=>'success','summary'=>$summary,'content'=>$content]);}public function generateTodaysStory(){ini_set('memory_limit','1024M');try{log_message('info','ðŸ” Starting email scrape for news@mymiwallet.com...');$this->getMyMIMarketing()->fetchAndStoreEmails('news');$today=date('Y-m-d');$scrapes=$this->marketingModel->getScrapesByDate($today,10);if(empty($scrapes)){log_message('info','No scraped emails found for today.');return $this->response->setJSON(['status'=>'error','message'=>'No emails found for today.'],404);}$summaries=[];foreach(array_chunk($scrapes,10)as $scrapeChunk){foreach($scrapeChunk as $scrape){$content=$scrape['email_body']?? $scrape['content']?? '';log_message('info','Content size: '.strlen($content));$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($content);$summary=$this->getMyMIMarketing()->summarizeContent($cleanedBody);log_message('debug','Memory after summary: '.memory_get_usage(true));if(is_array($summary)){$summary=$summary['summary']?? implode('. ',array_map('strval',$summary));}$summaries[]=$summary;}}$combinedSummary=implode("\n\n",$summaries);if(strlen($combinedSummary)>500000){log_message('warning','Combined summary too long. Truncating...');$combinedSummary=substr($combinedSummary,0,500000);}$todayTitle="Today's Top Stories - ".date('F j, Y');$data=['title'=>$todayTitle,'content'=>$combinedSummary,'links'=>json_encode([]),'url'=>'','type'=>'todays_story','scraped_at'=>date('Y-m-d H:i:s'),'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeTempScrapedData($data);log_message('info','âœ… Todayâ€™s story generated and stored.');return $this->response->setJSON(['status'=>'success','message'=>'Todayâ€™s story generated and stored successfully!','title'=>$todayTitle,'summary'=>$combinedSummary]);}catch(\Throwable $e){log_message('error','âŒ generateTodaysStory error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function generateVoiceScriptManually(){try{log_message('info','ðŸŽ¤ generateVoiceScriptManually() triggered.');$script=$this->getMyMIMarketing()->generateVoiceoverScript();return $this->response->setJSON(['status'=>'success','script'=>$script]);}catch(\Throwable $e){log_message('error','âŒ Error in generateVoiceScriptManually: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()]);}}public function getAlerts(){log_message('debug','ðŸ” getAlerts called');try{$alerts=$this->alertsModel->getAllTradeAlerts();log_message('debug','âœ… getAlerts retrieved '.count($alerts).' alerts.');return $this->response->setJSON($alerts);}catch(\Throwable $e){log_message('error','âŒ getAlerts error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getAssets(){log_message('debug','ðŸ“Š getAssets called');try{$assets=$this->exchangeModel->getManagementAssets();log_message('debug','âœ… getAssets retrieved '.count($assets).' assets.');return $this->response->setJSON($assets);}catch(\Throwable $e){log_message('error','âŒ getAssets error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getNews(){log_message('debug','ðŸ“° getNews called');try{$news=$this->marketingModel->getNewsAlerts();log_message('debug','âœ… getNews retrieved '.count($news).' news records.');return $this->response->setJSON($news);}catch(\Throwable $e){log_message('error','âŒ getNews error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getReferrals(){log_message('debug','ðŸ” getReferrals called');try{$referrals=$this->referralModel->getAllReferrals();log_message('debug','âœ… getReferrals retrieved '.count($referrals).' referrals.');return $this->response->setJSON($referrals);}catch(\Throwable $e){log_message('error','âŒ getReferrals error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getSupport(){log_message('debug','ðŸ§¾ getSupport called');try{$support=$this->supportModel->getManagementSupport();log_message('debug','âœ… getSupport retrieved '.count($support).' support records.');return $this->response->setJSON($support);}catch(\Throwable $e){log_message('error','âŒ getSupport error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function getTopMovers($apikey){$url="https://www.alphavantage.co/query?function=TOP_GAINERS_LOSERS&apikey=".$apikey;$json=file_get_contents($url);return json_decode($json,true);}public function getUpcomingIPOs($apikey){$url="https://www.alphavantage.co/query?function=IPO_CALENDAR&apikey=".$apikey;$csv=file_get_contents($url);$lines=explode("\n",trim($csv));$data=array_map('str_getcsv',$lines);return $data;}public function getUsers(){log_message('debug','ðŸ” getUsers called');}public function massResendActivationEmails(){$users=$this->userModel->getPendingActivationUsers();$activator=service('activator');$emailer=\Config\Services::email();$successCount=0;$failureCount=0;foreach($users as $user){$sent=$activator->send($user);if($sent){$successCount++;log_message('info',"Activation email sent to: {$user->email}");}else{$failureCount++;log_message('error',"Failed to send activation email to: {$user->email}");}}$summary="{$successCount} emails sent successfully, {$failureCount} failed.";return redirect()->to('/Management/Users')->with('message',$summary);}public function processAllTradeAlerts(){try{log_message('info','âš¡ Management API - processAllTradeAlerts triggered.');$this->alertManager->fetchAndStoreAlertsEmails();$this->alertManager->processTradeAlertsInBatches(50);$this->alertManager->updateAlerts();return $this->response->setJSON(['status'=>'success','message'=>'All trade alerts processed successfully.']);}catch(\Exception $e){log_message('error','âŒ Management API - Error processing trade alerts: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function processAndGenerateMarketingContent(){$emails=$this->getMarketingService()->fetchUnprocessedEmailSummaries();if(!empty($emails)&&is_array($emails)){foreach($emails as $email){$cleanContent=$this->getMarketingService()->sanitizeAndSummarize($email['email_body']);$keywords=$this->getMyMIMarketing()->extractTopKeywords($cleanContent);$externalContent=$this->getMarketingService()->gatherKeywordBasedContent($keywords);$this->getMarketingService()->storeScrapedContent($externalContent);$generatedPosts=$this->getMarketingService()->generatePlatformPosts($externalContent);$this->getMarketingService()->storeGeneratedPostsForDashboard($generatedPosts);}}return redirect()->to('/Management/Marketing')->with('message','Content generation completed.');}public function processTempEmailsToScraper(){try{log_message('info','âš™ï¸ Starting content generation from bf_marketing_temp_scraper...');$tempEmails=$this->marketingModel->getRecentScrapes();foreach($tempEmails as $email){$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($email->email_body);$summary=$this->getMyMIMarketing()->summarizeContent($cleanedBody);$keywords=$this->marketingModel->extractKeywords($email->email_body);$hashtags=$this->marketingModel->mapToContextualHashtags($keywords);$data=['title'=>$email->email_subject ?? 'Generated Content','summary'=>is_array($summary)?implode("\n",$summary):$summary,'content'=>$email->email_body,'tags'=>implode(',',$keywords),'type'=>'Email/Newsletters','status'=>'pending','created_on'=>date('Y-m-d H:i:s'),'author_information'=>$email->email_sender,];$this->marketingModel->saveDailyLog($data);}log_message('info','âœ… Finished processing and saving to bf_marketing_scraper.');return $this->response->setJSON(['status'=>'success','message'=>'Content generated and saved to bf_marketing_scraper.',]);}catch(\Throwable $e){log_message('error','âŒ processTempEmailsToScraper error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function reprocessIncompleteEmails(){try{$this->getMyMIMarketing()->reprocessIncompleteEmails();return $this->response->setJSON(['status'=>'success','message'=>'Backfilled incomplete emails.']);}catch(\Throwable $e){log_message('error','âŒ reprocessIncompleteEmails error: '.$e->getMessage());return $this->failServerError('Failed to reprocess incomplete emails.');}}public function runCronManually(){$this->runCRONTasks();return $this->response->setJSON(['status'=>'success','message'=>'Manual CRON execution complete.']);}public function runDailyAlphaVantageDataPipeline(){$symbols=$this->alertsModel->getTopWatchlistSymbols();$apikey=getenv('ALPHA_VANTAGE_KEY');foreach($symbols as $symbol){$this->fetchAlphaVantageNewsForTradeAlerts($symbol['symbol'],$apikey);$this->getCompanyOverview($symbol['symbol'],$apikey);$this->getIncomeStatement($symbol['symbol'],$apikey);}return $this->response->setJSON(['status'=>'success','message'=>'Daily Alpha Vantage data pipeline completed.']);}public function sendToZapierManually(){$summary=$this->generateTodaysNewsSummary();$result=$this->getMyMIMarketing()->sendToZapier($summary['content']);return $this->response->setJSON(['status'=>'success','message'=>'Sent manually to Zapier.','result'=>$result]);}public function scrapeAndGenerateTodaysStoryFromInbox(){try{log_message('info','ðŸ“¥ Starting inbox scrape for news@mymiwallet.com...');$this->getMyMIMarketing()->fetchAndStoreEmails('news');$today=date('Y-m-d');$scrapes=$this->marketingModel->getScrapesByDate($today);if(empty($scrapes)){log_message('info','ðŸ“­ No emails found for today.');return $this->response->setJSON(['status'=>'error','message'=>'No emails found for today.'],404);}$summaries=[];foreach($scrapes as $scrape){$cleanedBody=$this->marketingModel->cleanHtmlEmailContent($scrape['content']);$summary=$this->getMyMIMarketing()->summarizeContent($cleanedBody);if(is_array($summary)){$summary=$summary['summary']?? implode('. ',array_map('strval',$summary));}$summaries[]=$summary;}$combinedSummary=implode("\n\n",$summaries);if(strlen($combinedSummary)>500000){log_message('warning','Combined summary too long. Truncating...');$combinedSummary=substr($combinedSummary,0,500000);}$todayTitle="Today's News Highlights - ".date('F j, Y');$data=['title'=>$todayTitle,'content'=>$combinedSummary,'links'=>json_encode([]),'url'=>'','type'=>'todays_story','scraped_at'=>date('Y-m-d H:i:s'),'created_on'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeTempScrapedData($data);log_message('info','âœ… Todayâ€™s story generated and stored.');return $this->response->setJSON(['status'=>'success','message'=>'Todayâ€™s story generated and stored successfully!','title'=>$todayTitle,'summary'=>$combinedSummary]);}catch(\Throwable $e){log_message('error','âŒ scrapeAndGenerateTodaysStoryFromInbox error: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()],500);}}public function sharePost($id,$platform){try{$post=$this->marketingModel->getGeneratedPostById($id);if(!$post||empty($post['posts'])){return $this->failNotFound('Post not found or invalid.');}$posts=json_decode($post['posts'],true);$message=$posts[$platform]?? null;if(!$message){return $this->failValidationError("No formatted message found for platform: $platform");}$success=$this->getMarketingService()->distributeContent($platform,$message);if($success){return $this->respond(['status'=>'success','message'=>'Post shared.']);}else{return $this->failServerError('Failed to dispatch post.');}}catch(\Throwable $e){log_message('error',"[PostShare] Error: ".$e->getMessage());return $this->failServerError('An unexpected error occurred.');}}public function sendAllDiscordAlerts(){$alerts=$this->alertsModel->getAlertsWithNewTVChart();if(empty($alerts)){return $this->response->setJSON(['status'=>'error','message'=>'No new alerts to send.'],404);}foreach($alerts as $alert){$this->alertManager->sendDiscordNotification($alert);}return $this->response->setJSON(['status'=>'success','message'=>'All Discord notifications sent.']);}public function updateMarketDataForAlerts(){try{$this->alertManager->updateAlerts();return $this->response->setJSON(['status'=>'success','message'=>'Trade alerts updated with market data.']);}catch(\Exception $e){return $this->response->setJSON(['status'=>'error','message'=>'Failed to update market data: '.$e->getMessage()],500);}}} ?><?php $managementActionItems=$siteSettings->managementActionItems;$department=$uri->getSegment(2);$viewFileData=['managementActionItems'=>$managementActionItems,'targetUsers'=>$targetUsers ?? 0,'totalActiveUsers'=>$totalActiveUsers ?? 0,'totalActivePartners'=>$totalActivePartners ?? 0,'totalActiveCampaigns'=>$totalActiveCampaigns ??[],'getTasksByDepartment'=>$getTasksByDepartment ??[],'totalDepartmentTasks'=>$totalDepartmentTasks ??[],'totalPageSEOTasks'=>$totalPageSEOTasks ??[],'totalTransFees'=>$totalTransFees ?? 0,'totalLastTransFees'=>$totalLastTransFees ?? 0,'usersPercentage'=>$usersPercentage ?? 0,'getActiveCampaigns'=>$getActiveCampaigns ??[],'totalApprovedAssets'=>$totalApprovedAssets ?? 0,'totalPendingAssets'=>$totalPendingAssets ?? 0,'userGoals'=>$userGoals ??[],'newsUpdates'=>$newsUpdates ??[],'getBlogPosts'=>$getBlogPosts ??[],'recentMarketingPosts'=>$recentMarketingPosts ??[],'todaysStory'=>$todaysStory ??[],]; ?><div class="nk-block"><div class="row gy-gs"><div class="col-lg-12"><div class="nk-block-head-xs"><div class="nk-block-head-content"><h1 class="title nk-block-title">MyMI Management -<?=esc($department)?></h1><a href="<?=site_url('/Management')?>">â† Back to Management Dashboard</a></div></div></div><div class="col-12 col-xxl-4"><?=view('ManagementModule\Views\Marketing\index\action_center_new',$viewFileData)?></div><div class="col-12 col-xxl-8"><?=view('ManagementModule\Views\Marketing\index\most_recent_content',$viewFileData)?></div><div class="col-12"><?php  ?></div><div class="col-12"><?php  ?></div><div class="col-12 col-xxl-6"><?=view('ManagementModule\Views\Marketing\resources\controlPanelBlock',$viewFileData)?><?php  ?></div><div class="col-12 col-xxl-6"><?=view('ManagementModule\Views\Marketing\resources\ctaRecommenderModule',$viewFileData)?></div><div class="col-12 col-xxl-12 px-2"><div class="generated-summaries"id="generatedSummariesBlock"><?=view('ManagementModule\Views\Marketing\resources\generatedSummaries',$viewFileData)?></div></div><div class="col-12 mt-3 col-xxl-12"><div class="card card-bordered"><div class="card-inner"><h5 class="title">ðŸ“° Recent Marketing Posts</h5><?php $validPosts=array_filter($recentMarketingPosts,fn($p)=>!empty($p->title));if(!empty($validPosts)): ?><ul class="list-group"><?php foreach($validPosts as $post): ?><li class="d-flex justify-content-between align-items-start flex-column list-group-item"><div class="w-100"><strong><?=esc($post->title?:'(Untitled Post)')?></strong><br><small class="text-muted"><?=date('M d, Y h:i A',strtotime($post->created_at))?></small><br><?php if(!empty($post->short_description)): ?><small class="text-secondary"><?=esc($post->short_description)?>...</small><?php else: ?><small class="text-secondary">No description available.</small><?php endif; ?></div><div class="mt-2"><button class="btn btn-primary btn-sm"onclick='dynamicModalLoader("Marketing","PreviewGeneratedPost","<?=$post->id?>")'>Preview</button></div></li><?php endforeach; ?></ul><?php else: ?><p>No posts with valid titles available yet. Click 'Generate' to create one!</p><?php endif; ?></div></div></div><div class="col-12 mt-3 col-xxl-4"><?=view('ManagementModule\Views\Marketing\index\exchange_action_center',$viewFileData)?></div><div class="col-12 mt-3 col-xxl-8"><?=view('ManagementModule\Views\Marketing\index\target_users',$viewFileData)?></div></div></div><script <?= $nonce['script'] ?? '' ?>></script><div class="nk-block"><div class="nk-block-head"><div class="d-flex justify-content-between align-items-center nk-block-head-content"><h4 class="nk-block-title">ðŸ“¢ Generated Marketing Summaries</h4><div><div class="d-flex justify-content-end mt-3"><label class="form-check form-switch ml-2"><input class="btn btn-lg form-check-input"id="liveModeToggle"type="checkbox"> <span class="form-check-label">Live Mode</span></label></div></div></div><p class="text-soft">This section shows finalized summaries ready for distribution across platforms.</p></div><div class="row"id="generatedSummariesBlock"><?php if(!empty($todaysStory)): ?><?php foreach($todaysStory as $summary): ?><div class="mb-4 col-lg-4 col-md-6"><div class="card h-100 shadow-sm"><div class="d-flex flex-column card-body"><h6 class="title mb-1"><?=esc($summary['title'])?></h6><p class="small mb-2 text-soft"><?=date('F j, Y g:i A',strtotime($summary['created_at']))?></p><div class="small mb-2"><?=esc($summary['summary'])?></div><?php if(!empty($summary['keywords'])): ?><div class="small mb-2 text-muted"><strong>#Tags:</strong><?php foreach(explode(',',$summary['keywords'])as $tag): ?><span class="badge bg-light me-1 text-dark">#<?=trim($tag)?></span><?php endforeach; ?></div><?php endif; ?><?php if(!empty($summary['cta'])): ?><div class="small mb-2 text-primary"><strong>ðŸ“£ CTA:</strong><?=esc($summary['cta'])?></div><?php endif; ?><a href="javascript:void(0);"class="btn btn-primary btn-sm mt-auto"onclick='dynamicModalLoader("/API/Management/PreviewGeneratedPost/<?=$summary['id']?>")'>ðŸ” Preview Post</a></div></div></div><?php endforeach; ?><?php else: ?><div class="col-12"><div class="alert alert-warning">âš ï¸ No summaries available. Click "Generate Todayâ€™s Content" to begin.</div></div><?php endif; ?></div></div><script <?= $nonce['script'] ?? '' ?>>const liveToggle = document.getElementById('liveModeToggle');
app/Modules/Notifications/Controllers/PushController.php:62:        $url   = (string) ($this->request->getPost('url') ?? site_url('/'));
app/Modules/Notifications/Controllers/PushController.php:64:            'title'=>$title,'body'=>$body,'url'=>$url,'icon'=>'/icons/icon-192.svg','tag'=>'test'
app/Modules/User/Views/Wallets/Complete_Purchase/paypal_checkout.php:34:        $url        = site_url('MyMI-Gold/Purchase-Complete/' . $orderID);
app/Modules/User/Views/Wallets/Complete_Purchase/paypal_checkout.php:36:		window.location.href = <?php echo '\'' . $url . '\'';?>;
app/Modules/User/Views/Wallets/index copy.php:161:$url                            = $api_base_url . '/link/token/create';
app/Modules/User/Views/Wallets/index copy.php:162:curl_setopt($ch, CURLOPT_URL, $url);
app/Modules/User/Controllers/SearchController.php:19:            $url = site_url('API/Investments/searchTickers?query=' . urlencode($q) . '&limit=15');
app/Modules/User/Controllers/SearchController.php:22:                $response = $client->get($url);
app/Modules/Exchange/Controllers/ExchangeController.php:728:        $url = "https://www.alphavantage.co/query?function={$function}&symbol={$symbol}&apikey={$this->alphavantageKey}";
app/Modules/Exchange/Controllers/ExchangeController.php:729:        $response = $this->curlRequest->get($url);
app/Modules/Management/Views/Marketing/dashboard.txt:652:        $url = "https://www.alphavantage.co/query?function=BALANCE_SHEET&symbol=" . urlencode($symbol) . "&apikey=" . $apikey;
app/Modules/Management/Views/Marketing/dashboard.txt:653:        $json = file_get_contents($url);
app/Modules/Management/Views/Marketing/dashboard.txt:658:        $url = "https://www.alphavantage.co/query?function=CASH_FLOW&symbol=" . urlencode($symbol) . "&apikey=" . $apikey;
app/Modules/Management/Views/Marketing/dashboard.txt:659:        $json = file_get_contents($url);
app/Modules/Management/Views/Marketing/dashboard.txt:664:        $url = "https://www.alphavantage.co/query?function=OVERVIEW&symbol=" . urlencode($symbol) . "&apikey=" . $apikey;
app/Modules/Management/Views/Marketing/dashboard.txt:665:        $json = file_get_contents($url);
app/Modules/Management/Views/Marketing/dashboard.txt:670:        $url = "https://www.alphavantage.co/query?function=EARNINGS_CALENDAR&horizon=" . $horizon . "&apikey=" . $apikey;
app/Modules/Management/Views/Marketing/dashboard.txt:671:        $csv = file_get_contents($url);
app/Modules/Management/Views/Marketing/dashboard.txt:678:        $url = "https://alphavantageapi.co/timeseries/analytics?SYMBOLS=" . urlencode($symbols);
app/Modules/Management/Views/Marketing/dashboard.txt:679:        $url .= "&RANGE=" . $rangeStart . "&RANGE=" . $rangeEnd;
app/Modules/Management/Views/Marketing/dashboard.txt:680:        $url .= "&INTERVAL=DAILY&OHLC=close";
app/Modules/Management/Views/Marketing/dashboard.txt:681:        $url .= "&CALCULATIONS=" . urlencode($calculations) . "&apikey=" . $apikey;
app/Modules/Management/Views/Marketing/dashboard.txt:683:        $json = file_get_contents($url);
app/Modules/Management/Views/Marketing/dashboard.txt:688:        $url = "https://www.alphavantage.co/query?function=INCOME_STATEMENT&symbol=" . urlencode($symbol) . "&apikey=" . $apikey;
app/Modules/Management/Views/Marketing/dashboard.txt:689:        $json = file_get_contents($url);
app/Modules/Management/Views/Marketing/dashboard.txt:694:        $url = "https://www.alphavantage.co/query?function=INSIDER_TRANSACTIONS&symbol=" . urlencode($symbol) . "&apikey=" . $apikey;
app/Modules/Management/Views/Marketing/dashboard.txt:695:        $json = file_get_contents($url);
app/Modules/Management/Views/Marketing/dashboard.txt:700:        $url = "https://www.alphavantage.co/query?function=NEWS_SENTIMENT";
app/Modules/Management/Views/Marketing/dashboard.txt:701:        $url .= "&tickers=" . urlencode($tickers);
app/Modules/Management/Views/Marketing/dashboard.txt:702:        $url .= "&topics=" . urlencode($topics);
app/Modules/Management/Views/Marketing/dashboard.txt:703:        if ($time_from) $url .= "&time_from=" . $time_from;
app/Modules/Management/Views/Marketing/dashboard.txt:704:        if ($time_to) $url .= "&time_to=" . $time_to;
app/Modules/Management/Views/Marketing/dashboard.txt:705:        $url .= "&sort=" . $sort . "&limit=" . $limit . "&apikey=" . $apikey;
app/Modules/Management/Views/Marketing/dashboard.txt:707:        $json = file_get_contents($url);
app/Modules/Management/Views/Marketing/dashboard.txt:712:        $url = "https://alphavantageapi.co/timeseries/running_analytics?SYMBOLS=" . urlencode($symbols);
app/Modules/Management/Views/Marketing/dashboard.txt:713:        $url .= "&RANGE=" . $range . "&INTERVAL=DAILY&OHLC=close";
app/Modules/Management/Views/Marketing/dashboard.txt:714:        $url .= "&WINDOW_SIZE=" . $windowSize;
app/Modules/Management/Views/Marketing/dashboard.txt:715:        $url .= "&CALCULATIONS=" . urlencode($calculations) . "&apikey=" . $apikey;
app/Modules/Management/Views/Marketing/dashboard.txt:717:        $json = file_get_contents($url);
app/Modules/Management/Views/Marketing/dashboard.txt:874:        $url = "https://www.alphavantage.co/query?function=TOP_GAINERS_LOSERS&apikey=" . $apikey;
app/Modules/Management/Views/Marketing/dashboard.txt:875:        $json = file_get_contents($url);
app/Modules/Management/Views/Marketing/dashboard.txt:880:        $url = "https://www.alphavantage.co/query?function=IPO_CALENDAR&apikey=" . $apikey;
app/Modules/Management/Views/Marketing/dashboard.txt:881:        $csv = file_get_contents($url);
app/Modules/Management/Views/Marketing/dashboard.txt:2444:        $url = $jsonData['url'] ?? null;
app/Modules/Management/Views/Marketing/dashboard.txt:2446:        if (!$url) {
app/Modules/Management/Views/Marketing/dashboard.txt:2452:            log_message('debug', 'scrapeLink: Scraping URL - ' . $url);
app/Modules/Management/Views/Marketing/dashboard.txt:2453:            $scrapedData = $this->scrapeWebsiteWithFallback($url);
app/Modules/Management/Views/Marketing/dashboard.txt:2484:            $url = filter_var($link['href'], FILTER_SANITIZE_URL);
app/Modules/Management/Views/Marketing/dashboard.txt:2485:            if (filter_var($url, FILTER_VALIDATE_URL)) {
app/Modules/Management/Views/Marketing/dashboard.txt:2486:                $scrapedData = $this->scrapeWebsite($url);
app/Modules/Management/Views/Marketing/dashboard.txt:2495:    private function scrapeWebsite($url) {
app/Modules/Management/Views/Marketing/dashboard.txt:2498:            $response = $client->get($url, [
app/Modules/Management/Views/Marketing/dashboard.txt:2520:                    log_message('debug', 'scrapeWebsite: Scraping successful for URL - ' . $url);
app/Modules/Management/Views/Marketing/dashboard.txt:2528:                    log_message('error', 'scrapeWebsite: DOM parsing failed for URL - ' . $url);
app/Modules/Management/Views/Marketing/dashboard.txt:2537:                log_message('error', 'scrapeWebsite: Unauthorized access for URL - ' . $url);
app/Modules/Management/Views/Marketing/dashboard.txt:2548:    private function scrapeWebsiteWithFallback($url) {
app/Modules/Management/Views/Marketing/dashboard.txt:2550:            log_message('debug', 'scrapeWebsiteWithFallback: Scraping URL - ' . $url);
app/Modules/Management/Views/Marketing/dashboard.txt:2551:            $scrapedData = $this->scrapeWebsite($url);
app/Modules/Management/Views/Marketing/dashboard.txt:2555:                $googleSearchResults = $this->scrapeGoogleSearch($url);
app/Modules/Management/Views/Marketing/dashboard.txt:2718:            $url = $this->request->getPost('url');
app/Modules/Management/Views/Marketing/dashboard.txt:2742:                'url' => $url,
app/Modules/Management/Views/Marketing/dashboard.txt:3956:                $url = $record['url'] ?? '';
app/Modules/Management/Views/Marketing/dashboard.txt:3964:                    $url = $email['link'] ?? $url;
app/Modules/Management/Views/Marketing/dashboard.txt:3969:                $url = $url ?: 'https://mymiwallet.com/news/fallback';
app/Modules/Management/Views/Marketing/dashboard.txt:3971:                $model->updateEmailFields($record['id'], $title, $url, $content);
app/Modules/Management/Views/Marketing/dashboard.txt:4147:    private function scrapeWebsite($url)
app/Modules/Management/Views/Marketing/dashboard.txt:4151:            $response = $client->get($url);
app/Modules/Management/Views/Marketing/dashboard.txt:4166:    private function scrapeFacebook($url)
app/Modules/Management/Views/Marketing/dashboard.txt:4168:        return $this->scrapeWithRetries('facebook', $url, function($content) {
app/Modules/Management/Views/Marketing/dashboard.txt:4176:    private function scrapeTwitter($url)
app/Modules/Management/Views/Marketing/dashboard.txt:4178:        return $this->scrapeWithRetries('twitter', $url, function($content) {
app/Modules/Management/Views/Marketing/dashboard.txt:4186:    private function scrapeWithRetries($type, $url, $transform, $retries = 3) {
app/Modules/Management/Views/Marketing/dashboard.txt:4190:                $response = $this->scrapemax->scrape(['target_url' => $url, 'type' => 'data', 'js_enabled' => 1, 'base64_encoded' => 0]);
app/Modules/Management/Views/Marketing/dashboard.txt:4259:    public function standaloneScrapeWebsite($url) {
app/Modules/Management/Views/Marketing/dashboard.txt:4262:            $response = $client->get($url);
app/Modules/Management/Views/Marketing/dashboard.txt:4276:                    'url' => $url,
app/Modules/Management/Views/Marketing/dashboard.txt:5219:            $url = $story['source_url'] ?? '#';
app/Modules/Management/Views/Marketing/dashboard.txt:5224:                'discord'  => "**{$headline}**\n{$summary}\nðŸ”— {$url}\n{$hashtags}",
app/Modules/Management/Views/Marketing/dashboard.txt:5225:                'twitter'  => "{$headline} {$url} {$hashtags}",
app/Modules/Management/Views/Marketing/dashboard.txt:5226:                'linkedin' => "{$headline}\n{$summary}\nRead more: {$url} {$hashtags}",
app/Modules/Management/Views/Marketing/dashboard.txt:5227:                'facebook' => "{$headline}\n{$summary}\n{$url} {$hashtags}",
app/Modules/Management/Views/Marketing/dashboard.txt:5230:                    'body'    => "{$summary}\n\nRead More: {$url}\n{$hashtags}",
app/Modules/Management/Views/Marketing/dashboard.txt:5239:    private function logScrapeError($url, $error)
app/Modules/Management/Views/Marketing/dashboard.txt:5241:        log_message('error', "Scraping failed for URL: $url, Error: $error");
app/Modules/Management/Views/Web_Design/Content_Creator/FLinks/Flinks_API.php:399:        src="<?php //echo $url; ?>">
app/Modules/Management/Views/Web_Design/Content_Creator/FLinks/Flinks.php:45:$url                                = $mainURL . $closeEnable . '&termsUrl=' . $termsCondURL . '&customerName=MyMI+Wallet&' . $consentEnable . '&features=TransactionHistory%2CAccountNumber&' . $accountSelectorEnable . '&' . $showAllEnable . '&' . $multiAccountSelector; 
app/Modules/Management/Views/Web_Design/Content_Creator/FLinks/Flinks.php:46:// echo $url; 
app/Modules/Management/Views/Web_Design/Content_Creator/FLinks/Flinks.php:54:        src="<?php //echo $url; ?>">
app/Modules/Management/Views/Web_Design/Content_Creator/Codat/GuzzleHttp.php:6:$url        = "https://api.codat.io/v1/companies?limit=100&offset=0";
app/Modules/Management/Views/Web_Design/Content_Creator/Codat/GuzzleHttp.php:9:$reponse    = $client->get($url); 
app/Modules/Management/Views/Web_Design/Content_Creator/Codat.php:39:$url                = 'https://api.codat.io/companies/' . $companyID . '/connections?page=1&pageSize=100';
app/Modules/Management/Views/Web_Design/Content_Creator/Codat.php:40:$result             = $this->curl->simple_get($url, array(), array(CURLOPT_HTTPHEADER => $headers));
app/Modules/Management/Views/Web_Design/Content_Creator/Codat.php:80:// $url                = 'https://api.codat.io/companies/' . $companyID . '/connections?page=1&pageSize=100';
app/Modules/Management/Views/Web_Design/Content_Creator/Codat.php:88:// $result             = file_get_contents($url, false, $context);
app/Modules/Management/Views/Web_Design/Content_Creator/Plaid/Integration.php:21:$url                            = $api_base_url . '/link/token/create';
app/Modules/Management/Views/Web_Design/Content_Creator/Plaid/Integration.php:22:curl_setopt($ch, CURLOPT_URL, $url);
app/Modules/Management/Controllers/AlertsController.php:828:        $url = "https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol={$ticker}&apikey={$apiKey}";
app/Modules/Management/Controllers/AlertsController.php:830:        $response = file_get_contents($url);
app/Modules/Management/Controllers/AlertsController.php:858:            $url = "https://www.alphavantage.co/query?function=OVERVIEW&symbol={$symbol}&apikey={$apiKey}";
app/Modules/Management/Controllers/AlertsController.php:860:            $response = file_get_contents($url);
app/Modules/Management/Controllers/MarketingController.php:1677:        $url = $jsonData['url'] ?? null;
app/Modules/Management/Controllers/MarketingController.php:1679:        if (!$url) {
app/Modules/Management/Controllers/MarketingController.php:1685:            log_message('debug', 'scrapeLink: Scraping URL - ' . $url);
app/Modules/Management/Controllers/MarketingController.php:1686:            $scrapedData = $this->scrapeWebsiteWithFallback($url);
app/Modules/Management/Controllers/MarketingController.php:1719:            $url = filter_var($link['href'], FILTER_SANITIZE_URL);
app/Modules/Management/Controllers/MarketingController.php:1720:            if (filter_var($url, FILTER_VALIDATE_URL)) {
app/Modules/Management/Controllers/MarketingController.php:1721:                $scrapedData = $this->scrapeWebsite($url);
app/Modules/Management/Controllers/MarketingController.php:1730:    private function scrapeWebsite($url) {
app/Modules/Management/Controllers/MarketingController.php:1733:            $response = $client->get($url, [
app/Modules/Management/Controllers/MarketingController.php:1755:                    log_message('debug', 'scrapeWebsite: Scraping successful for URL - ' . $url);
app/Modules/Management/Controllers/MarketingController.php:1763:                    log_message('error', 'scrapeWebsite: DOM parsing failed for URL - ' . $url);
app/Modules/Management/Controllers/MarketingController.php:1772:                log_message('error', 'scrapeWebsite: Unauthorized access for URL - ' . $url);
app/Modules/Management/Controllers/MarketingController.php:1783:    private function scrapeWebsiteWithFallback($url) {
app/Modules/Management/Controllers/MarketingController.php:1785:            log_message('debug', 'scrapeWebsiteWithFallback: Scraping URL - ' . $url);
app/Modules/Management/Controllers/MarketingController.php:1786:            $scrapedData = $this->scrapeWebsite($url);
app/Modules/Management/Controllers/MarketingController.php:1790:                $googleSearchResults = $this->scrapeGoogleSearch($url);
app/Modules/Management/Controllers/MarketingController.php:1953:            $url = $this->request->getPost('url');
app/Modules/Management/Controllers/MarketingController.php:1977:                'url' => $url,
app/Modules/Management/Controllers/MarketingController.11202024.php:792:        $url = $jsonData['url'] ?? null;
app/Modules/Management/Controllers/MarketingController.11202024.php:794:        if (!$url) {
app/Modules/Management/Controllers/MarketingController.11202024.php:800:            log_message('debug', 'scrapeLink: Scraping URL - ' . $url);
app/Modules/Management/Controllers/MarketingController.11202024.php:801:            $scrapedData = $this->scrapeWebsiteWithFallback($url);
app/Modules/Management/Controllers/MarketingController.11202024.php:833:            $url = filter_var($link['href'], FILTER_SANITIZE_URL);
app/Modules/Management/Controllers/MarketingController.11202024.php:834:            if (filter_var($url, FILTER_VALIDATE_URL)) {
app/Modules/Management/Controllers/MarketingController.11202024.php:835:                $scrapedData = $this->scrapeWebsite($url);
app/Modules/Management/Controllers/MarketingController.11202024.php:844:    private function scrapeWebsite($url)
app/Modules/Management/Controllers/MarketingController.11202024.php:848:            $response = $client->get($url);
app/Modules/Management/Controllers/MarketingController.11202024.php:862:                    log_message('debug', 'scrapeWebsite: Scraping successful for URL - ' . $url);
app/Modules/Management/Controllers/MarketingController.11202024.php:870:                    log_message('error', 'scrapeWebsite: DOM parsing failed for URL - ' . $url);
app/Modules/Management/Controllers/MarketingController.11202024.php:879:                log_message('error', 'scrapeWebsite: Unauthorized access for URL - ' . $url);
app/Modules/Management/Controllers/MarketingController.11202024.php:890:    private function scrapeWebsiteWithFallback($url)
app/Modules/Management/Controllers/MarketingController.11202024.php:893:            log_message('debug', 'scrapeWebsiteWithFallback: Scraping URL - ' . $url);
app/Modules/Management/Controllers/MarketingController.11202024.php:894:            $scrapedData = $this->scrapeWebsite($url);
app/Modules/Management/Controllers/MarketingController.11202024.php:898:                $googleSearchResults = $this->scrapeGoogleSearch($url);
app/Modules/Management/Controllers/MarketingController.11202024.php:930:            $url = $this->request->getPost('url');
app/Modules/Management/Controllers/MarketingController.11202024.php:954:                'url' => $url,
app/Modules/Management/Controllers/MarketingController-07012024.php:281:        $url = $jsonData['url'] ?? null;
app/Modules/Management/Controllers/MarketingController-07012024.php:283:        if (!$url) {
app/Modules/Management/Controllers/MarketingController-07012024.php:289:            log_message('debug', 'scrapeLink: Scraping URL - ' . $url);
app/Modules/Management/Controllers/MarketingController-07012024.php:290:            $scrapedData = $this->scrapeWebsiteWithFallback($url);
app/Modules/Management/Controllers/MarketingController-07012024.php:315:    private function scrapeWebsiteWithFallback($url)
app/Modules/Management/Controllers/MarketingController-07012024.php:318:            log_message('debug', 'scrapeWebsiteWithFallback: Scraping URL - ' . $url);
app/Modules/Management/Controllers/MarketingController-07012024.php:319:            $scrapedData = $this->scrapeWebsite($url);
app/Modules/Management/Controllers/MarketingController-07012024.php:323:                $googleSearchResults = $this->scrapeGoogleSearch($url);
app/Modules/Management/Controllers/MarketingController-07012024.php:339:    private function scrapeWebsite($url)
app/Modules/Management/Controllers/MarketingController-07012024.php:343:            $response = $client->get($url);
app/Modules/Management/Controllers/MarketingController-07012024.php:357:                    log_message('debug', 'scrapeWebsite: Scraping successful for URL - ' . $url);
app/Modules/Management/Controllers/MarketingController-07012024.php:358:                    return ['title' => $title, 'content' => $bodyContent, 'links' => $links, 'url' => $url];
app/Modules/Management/Controllers/MarketingController-07012024.php:360:                    log_message('error', 'scrapeWebsite: DOM parsing failed for URL - ' . $url);
app/Modules/Management/Controllers/MarketingController-07012024.php:369:                log_message('error', 'scrapeWebsite: Unauthorized access for URL - ' . $url);
app/Modules/Management/Controllers/MarketingController-07012024.php:421:            $url = filter_var($link['href'], FILTER_SANITIZE_URL);
app/Modules/Management/Controllers/MarketingController-07012024.php:422:            if (filter_var($url, FILTER_VALIDATE_URL)) {
app/Modules/Management/Controllers/MarketingController-07012024.php:423:                $scrapedData = $this->scrapeWebsite($url);
app/Modules/Management/Controllers/MarketingController-07012024.php:517:    private function scrapeFacebook($url)
app/Modules/Management/Controllers/MarketingController-07012024.php:520:        $content = $scraper->scrape($url);
app/Modules/Management/Controllers/MarketingController-07012024.php:527:    private function scrapeTwitter($url)
app/Modules/Management/Controllers/MarketingController-07012024.php:530:        $content = $scraper->scrape($url);
app/Modules/Management/Controllers/MarketingController-07012024.php:634:    private function logScrapeError($url, $error)
app/Modules/Management/Controllers/MarketingController-07012024.php:636:        log_message('error', "Scraping failed for URL: $url, Error: $error");
app/Modules/Blog/Controllers/EarningsController.php:118:        $url = "https://www.alphavantage.co/query?function=TIME_SERIES_DAILY_ADJUSTED&symbol=$symbol&apikey=$apiKey";
app/Modules/Blog/Controllers/EarningsController.php:120:        $response = file_get_contents($url);
app/Modules/Marketing_New/Controllers/ScraperController.php:27:    private function scrapeWebsiteWithFallback($url)
app/Modules/Marketing_New/Controllers/ScraperController.php:30:            log_message('debug', 'scrapeWebsiteWithFallback: Scraping URL - ' . $url);
app/Modules/Marketing_New/Controllers/ScraperController.php:31:            $scrapedData = $this->scrapeWebsite($url);
app/Modules/Marketing_New/Controllers/ScraperController.php:34:                $googleSearchResults = $this->scrapeGoogleSearch($url);
app/Modules/Marketing_New/Libraries/WebScraper.php:18:    public function scrapeWebsite($url)
app/Modules/Marketing_New/Libraries/WebScraper.php:20:        $crawler = $this->client->request('GET', $url);
app/Modules/Marketing_New/Libraries/WebScraper.php:26:            'url' => $url,
app/Config/Events.12022024.php:53:    $url = (string) $request->getUri();
app/Config/Events.12022024.php:56:    set_error_handler(static function ($severity, $message, $file, $line) use ($url, $ipAddress) {
app/Config/Events.12022024.php:57:        log_message('error', "Error: {$message} in {$file} on line {$line} | URL: {$url} | IP: {$ipAddress}");
app/Config/Events.12022024.php:60:    set_exception_handler(static function (Throwable $exception) use ($url, $ipAddress) {
app/Config/Events.12022024.php:61:        log_message('critical', "Exception: {$exception->getMessage()} in {$exception->getFile()} on line {$exception->getLine()} | URL: {$url} | IP: {$ipAddress}");

### $link
app/Views/themes/public/layouts/js-links.php:83:        $link = $('.link-to');
app/Views/themes/public/layouts/js-links.php:85:    $link.on('click', function() {
app/Views/themes/dashboard/layouts/js-links_old.php:39:        $link = $('.link-to');
app/Views/themes/dashboard/layouts/js-links_old.php:41:    $link.on('click', function() {
app/Views/themes/dashboard/layouts/js-links.php:105:  var $win = $(window), $introNav = $('.intro-navbar'), FIX='navbar-fixed', $link=$('.link-to');
app/Views/themes/dashboard/layouts/js-links.php:107:  $link.on('click', function(e){
app/Services/SearchRotationService.php:73:            foreach ($topLinks as $link) {
app/Services/SearchRotationService.php:78:                $scraped = $this->scrapeUrlContent($link);
app/Services/SearchRotationService.php:80:                    $model->cacheScrapedLinkWithKeyword($link, $scraped, $term);
app/Libraries/MyMIMarketing-06162025.php:255:    private function cacheScrapedLink($link, $content)
app/Libraries/MyMIMarketing-06162025.php:258:            'url' => $link,
app/Libraries/MyMIMarketing-06162025.php:2109:        $link = trim($tradeAlert['tv_chart'] ?? $tradeAlert['tv_chart_link'] ?? '');
app/Libraries/MyMIMarketing-06162025.php:2112:        $chartText = (!empty($link)) ? "ðŸ“‰ Chart: [View Here]({$link})\n" : '';
app/Libraries/MyMIMarketing-06162025.php:4029:        foreach ($topLinks as $link) {
app/Libraries/MyMIMarketing-06162025.php:4030:            $cached = $this->marketingModel->getCachedLink($link);
app/Libraries/MyMIMarketing-06162025.php:4036:            $scraped = $this->scrapeUrlContent($link);
app/Libraries/MyMIMarketing-06162025.php:4039:                $this->marketingModel->cacheScrapedLink($link, $scraped);
app/Libraries/MyMIMarketing-06162025.php:4132:        foreach ($topLinks as $link) {
app/Libraries/MyMIMarketing-06162025.php:4133:            $cached = $this->marketingModel->getCachedLink($link);
app/Libraries/MyMIMarketing-06162025.php:4139:            $scraped = $this->scrapeUrlContent($link);
app/Libraries/MyMIMarketing-06162025.php:4142:                $this->marketingModel->cacheScrapedLink($link, $scraped);
app/Libraries/MyMIAlerts.php:431:        foreach ($topLinks as $link) {
app/Libraries/MyMIAlerts.php:432:            $cached = $model->getCachedLink($link);
app/Libraries/MyMIAlerts.php:438:            $scraped = $marketing->scrapeUrlContent($link);
app/Libraries/MyMIAlerts.php:441:                $model->cacheScrapedLink($link, $scraped);
app/Libraries/MyMIMarketing-05122025.php:1686:        $link = trim($tradeAlert['tv_chart'] ?? $tradeAlert['tv_chart_link'] ?? '');
app/Libraries/MyMIMarketing-05122025.php:1689:        $chartText = (!empty($link)) ? "ðŸ“‰ Chart: [View Here]({$link})\n" : '';
app/Libraries/MyMIMarketing.php:277:    private function cacheScrapedLink($link, $content)
app/Libraries/MyMIMarketing.php:280:            'url' => $link,
app/Libraries/MyMIMarketing.php:2320:        $link = trim($tradeAlert['tv_chart'] ?? $tradeAlert['tv_chart_link'] ?? '');
app/Libraries/MyMIMarketing.php:2323:        $chartText = (!empty($link)) ? "ðŸ“‰ Chart: [View Here]({$link})\n" : '';
app/Libraries/MyMIMarketing.php:4970:        foreach ($topLinks as $link) {
app/Libraries/MyMIMarketing.php:4971:            $cached = $this->marketingModel->getCachedLink($link);
app/Libraries/MyMIMarketing.php:4977:            $scraped = $this->scrapeUrlContent($link);
app/Libraries/MyMIMarketing.php:4980:                $this->marketingModel->cacheScrapedLink($link, $scraped);
app/Libraries/MyMIMarketing.php:5073:        foreach ($topLinks as $link) {
app/Libraries/MyMIMarketing.php:5074:            $cached = $this->marketingModel->getCachedLink($link);
app/Libraries/MyMIMarketing.php:5080:            $scraped = $this->scrapeUrlContent($link);
app/Libraries/MyMIMarketing.php:5083:                $this->marketingModel->cacheScrapedLink($link, $scraped);
app/Libraries/test.txt:3594:                foreach ($xpath->query('//a[@href]') as $link) {
app/Libraries/test.txt:3595:                    $href = $link->getAttribute('href');
app/Libraries/test.txt:3598:                        $text = $link->nodeValue;
app/Libraries/test.txt:3659:        foreach ($links as $link) {
app/Libraries/test.txt:3660:            $url = filter_var($link['href'], FILTER_SANITIZE_URL);
app/Libraries/test.txt:3691:                    foreach ($dom->find('a') as $link) {
app/Libraries/test.txt:3692:                        $href = $link->getAttribute('href');
app/Libraries/test.txt:3693:                        $text = $link->text;
app/Libraries/test.txt:5897:        $link = trim($tradeAlert['tv_chart'] ?? $tradeAlert['tv_chart_link'] ?? '');
app/Libraries/test.txt:5900:        $chartText = (!empty($link)) ? "ðŸ“‰ Chart: [View Here]({$link})\n" : '';
app/Modules/APIs/Controllers/MarketingController.php:1346:            foreach (array_slice($urls, 0, 5) as $link) {
app/Modules/APIs/Controllers/MarketingController.php:1347:                $text = $this->fetchAndCleanHtml($link);
app/Modules/APIs/Controllers/MarketingController.php:1354:                            'url'       => $link,
app/Modules/chatgpt.txt:1:<?php namespace App\Modules\Management\Controllers;use CodeIgniter\Controller;use Config\Services;use App\Config\{APIs,Auth,SiteSettings,SocialMedia};use App\Controllers\UserController;use App\Libraries\{BaseLoader,HtmlFormatter,MyMIAnalytics,MyMIAlerts,MyMIBudget,MyMIDashboard,MyMIExchange,MyMIMarketing,MyMIUser};use App\Models\{AlertsModel,AnnouncementModel,InvestmentModel,ManagementModel,MarketingModel,MyMIGoldModel,SolanaModel,UserModel};use App\Services\{DashboardService,GoalTrackingService,MarketingService,SolanaService,UserService};use CodeIgniter\API\ResponseTrait;use GuzzleHttp\Client;use GuzzleHttp\Exception\RequestException;use voku\helper\HtmlDomParser;class MarketingController extends UserController{use ResponseTrait;use BaseLoader;protected $API;protected $auth;protected $cuID;protected $data;protected $debug;protected $helpers=['auth','form','url'];protected $logger;protected $request;protected $session;protected $uri;protected $siteSettings;protected $NewsEmail;protected $HtmlFormatter;protected $MyMIAnalytics;protected $MyMIAlerts;protected $MyMIBudget;protected $MyMIDashboard;protected $MyMIExchange;protected $MyMIMarketing;protected $MyMIUser;protected $dashboardService;protected $goalTrackingService;protected $marketingService;protected $solanaService;protected $userService;protected $alertsModel;protected $investmentModel;protected $marketingModel;protected $userModel;protected $userAccount;protected $userDashboard;protected $getBlogPosts;protected $departmentTasks;protected $marketing;protected $reporting;public function __construct(){$this->API=config('APIs');$this->auth=service('authentication');$this->logger=service('logger');$this->NewsEmail=config('NewsEmailServer');$this->request=service('request');$this->session=Services::session();$this->siteSettings=config('SiteSettings');$this->debug=$this->siteSettings->debug;$this->uri=$this->request->getUri();$this->alertsModel=new AlertsModel();$this->investmentModel=new InvestmentModel();$this->marketingModel=new MarketingModel();$this->userDashboard=$this->getMyMIDashboard()->dashboardInfo($this->cuID);$this->departmentTasks=$this->getMyMIAnalytics()->get_department_tasks($this->uri->getSegment(2),['Page SEO Edit']);$this->getBlogPosts=$this->getMyMIMarketing()->getBlogPosts();$this->cuID=$this->session->get('user_id')?? $this->auth->id();if(!$this->cuID){log_message('error','Investments ControllerFailed to retrieve valid User ID in MyMIInvestments');throw new \RuntimeException('User ID could not be retrieved.');}log_message('debug',"InvestmentsController: cuID initialized as {$this->cuID}");$this->userAccount=$this->getMyMIUser()->getUserInformation($this->cuID);$userBudget=$this->getMyMIBudget()->getUserBudget($this->cuID);log_message('info','DashboardController L72 - $checkingSummary: '.$userBudget['checkingSummary']);$this->data['checkingSummary']=$userBudget['checkingSummary'];}public function commonData(): array{$this->data=$this->data ??[];$userData=$this->getuserService()->commonData();$this->data=array_merge($this->data,$userData);$this->data['siteSettings']=$this->siteSettings;$this->data['beta']=(string)$this->siteSettings->beta;$this->data['uri']=$this->request->getUri();$this->data['date']=$this->siteSettings->date;$this->data['time']=$this->siteSettings->time;$this->data['hostTime']=$this->siteSettings->hostTime;$dashboardInfo=$this->getDashboardService()->getDashboardInfo($this->cuID);$this->data['completedGoals']=$this->getGoalTrackingService()->getCompletedGoals($this->cuID);$this->data['pendingGoals']=$this->getGoalTrackingService()->getPendingGoals($this->cuID);$this->data['promotionalBanners']=$dashboardInfo['promotionalBanners'];$userBudget=$this->getBudgetService()->getUserBudget($this->cuID);$this->data['totalAccountBalance']=$userBudget['totalAccountBalance']?? 0;$this->data['totalAccountBalanceFMT']=$userBudget['totalAccountBalanceFMT']?? '0.00';$userSolanaData=$this->getSolanaService()->getSolanaData($this->cuID);$this->data['cuSolanaDW']=$userSolanaData['userSolanaWallets']['cuSolanaDW']?? null;$this->data['solanaNetworkStatus']=$userSolanaData['solanaNetworkStatus'];$this->data['cuSolanaTotal']=$userSolanaData['userSolanaWallets']['cuSolanaTotal']?? 0;$this->data['cuSolanaValue']=$userSolanaData['userSolanaWallets']['cuSolanaValue']?? 0;$this->data=array_merge($this->data,$userData);if($this->debug===1){}}public function index(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['recentMarketingPosts']=$this->getMyMIMarketing()->getRecentPosts(5);if(empty($this->data['recentMarketingPosts'])){log_message('info','ðŸ“­ No recent posts found. Running fallback generation...');$this->getMyMIMarketing()->generateFromTempScraper(5);$this->data['recentMarketingPosts']=$this->getMyMIMarketing()->getRecentPosts(25);}$this->data['todaysStory']=$this->marketingModel->getTodaysStory();$this->data['generatedSummaries']=$this->marketingModel->getLatestGeneratedSummaries(25);$this->data['marketingBuffer']=$this->marketingModel->getMarketingBuffer();if(empty($this->data['todaysStory'])){log_message('info','ðŸ“… No content generated today. Triggering summary fallback...');$this->getMyMIMarketing()->generateFromTempScraper(5);$this->data['todaysStory']=$this->marketingModel->where('DATE(created_at)',date('Y-m-d'))->orderBy('created_at','DESC')->findAll();}$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\index',$this->data);}public function add($type=null){log_message('debug','MarketingController L183 - add() method called with type: '.(is_null($type)?'null':$type));if(!empty($type)){if($this->request->getMethod()==='POST'){log_message('debug','Handling POST request for type: '.$type);if($type==='Schedule'){log_message('info','Processing Schedule submission');try{$this->marketingModel->addMarketingSchedule($this->request->getPost());log_message('info','Schedule data saved successfully');if($this->request->isAJAX()){return $this->response->setJSON(['success'=>true,'message'=>'Schedule added successfully']);}else{return redirect()->to('/Management/Marketing/Schedule')->with('success','Schedule added successfully');}}catch(\Exception $e){log_message('error','Error saving schedule: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to save schedule.']);}}elseif($type==='Campaign'){log_message('info','Processing Campaign submission');try{$campaignData=['beta'=>$this->request->getPost('beta'),'config_mode'=>$this->request->getPost('config_mode'),'form_mode'=>$this->request->getPost('form_mode'),'escalated'=>$this->request->getPost('escalated'),'user_id'=>$this->request->getPost('user_id'),'user_email'=>$this->request->getPost('user_email'),'username'=>$this->request->getPost('username'),'assigned_to'=>$this->request->getPost('assigned_to'),'date'=>$this->siteSettings->date,'time'=>$this->siteSettings->time,'campaign_name'=>$this->request->getPost('campaign_name'),'promotionalLinks'=>json_encode($this->request->getPost('promotionalLinks')),'overall_campaign_description'=>$this->request->getPost('overall_campaign_description'),'voice_script'=>$this->request->getPost('voice_script'),'facebookMessage'=>$this->request->getPost('facebookMessage'),'linkedinMessage'=>$this->request->getPost('linkedinMessage'),'discordMessage'=>$this->request->getPost('discordMessage'),'stocktwitsMessage'=>$this->request->getPost('stocktwitsMessage'),'tiktokMessage'=>$this->request->getPost('tiktokMessage'),'youtubeMessage'=>$this->request->getPost('youtubeMessage'),'emailMessage'=>$this->request->getPost('emailMessage'),'additionalInfo'=>$this->request->getPost('additionalInfo'),'hashtags'=>$this->request->getPost('hashtags'),];$this->marketingModel->addMarketingCampaign($campaignData);log_message('info','Campaign data saved successfully');if($this->request->isAJAX()){log_message('info','MarketingController L251 - This is using the $this->request->isAJAX() Form Submission');return $this->response->setJSON(['success'=>true,'message'=>'Campaign added successfully']);}else{log_message('info','MarketingController L251 - This is NOT using the $this->request->isAJAX() Form Submission');return redirect()->to('/Management/Marketing/Campaigns')->with('success','Campaign added successfully');}}catch(\Exception $e){log_message('error','Error saving campaign: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to save campaign.']);}}else{log_message('error','Unrecognized type in POST request: '.$type);return $this->response->setJSON(['error'=>'Unrecognized type in POST request']);}}if($this->request->getMethod()==='get'){log_message('debug','Handling GET request for type: '.$type);if($type==='Schedule'){log_message('debug','Loading view for Schedule');try{$response=$this->renderTheme('ManagementModule\Views\Marketing\Schedule\Add',$this->data);log_message('debug','View for Schedule loaded successfully');return $response;}catch(\Exception $e){log_message('error','Failed to load view for Schedule: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to load view for Schedule']);}}elseif($type==='Campaign'){log_message('debug','Loading view for Campaign');try{$response=$this->renderTheme('ManagementModule\Views\Marketing\Campaign\Add',$this->data);log_message('debug','View for Campaign loaded successfully');return $response;}catch(\Exception $e){log_message('error','Failed to load view for Campaign: '.$e->getMessage());return $this->response->setJSON(['error'=>'Failed to load view for Campaign']);}}else{log_message('error','Unrecognized type in GET request: '.$type);return $this->response->setJSON(['error'=>'Unrecognized type in GET request']);}}}else{log_message('warning','No type provided; redirecting to /Management/Marketing');return redirect()->to('/Management/Marketing')->with('error','No type provided');}}public function addSchedule(){if($this->request->getMethod()==='post'){$additionalInfo=$this->request->getPost('additional_info');$jsonData=null;if(!empty($additionalInfo)){$jsonData=json_decode($additionalInfo,true);if(json_last_error()!==JSON_ERROR_NONE){return redirect()->back()->withInput()->with('error','Invalid JSON format in Additional Information.');}}$scheduleData=['day'=>$this->request->getPost('day'),'time'=>$this->request->getPost('time'),'activity'=>$this->request->getPost('activity'),'link'=>$this->request->getPost('link'),'additional_info'=>json_encode($jsonData)];$this->marketingModel->addMarketingSchedule($scheduleData);return redirect()->to(base_url('Management/Marketing/Schedule'))->with('success','New schedule added successfully.');}$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Schedule\Add');}public function addSubscriber(){helper('email');$rawRequestBody=$this->request->getBody();$jsonData=json_decode($rawRequestBody,true);$marketingModel=new MarketingModel();$subscriberData=['email'=>$jsonData['email'],'category'=>$jsonData['category'],'referral'=>$jsonData['referral'],'beta'=>$this->siteSettings->beta,'date'=>date('Y-m-d H:i:s'),'hostTime'=>date('Y-m-d H:i:s'),'time'=>date('H:i:s'),'user_id'=>session('user_id'),'user_ip'=>$this->request->getIPAddress()];if($marketingModel->addSubscriber($subscriberData)){$emailService=\Config\Services::email();$emailService->setTo($subscriberData['email']);$emailService->setSubject('ðŸŽ‰ Welcome to Investorâ€™s Talk | MyMI Wallet');$emailService->setMessage(view('emails/welcomeInvestor',['siteSettings'=>$this->siteSettings,'socialMedia'=>config('SocialMedia'),]));if($emailService->send()){log_message('info','Management/MarketingController L346 - $emailService: '.print_r($emailService,true));return $this->response->setJSON(['success'=>true,'message'=>'Subscriber email sent successfully']);}else{log_message('error','Management/MarketingController L346 - Error Submitting: $emailService: '.print_r($emailService,true));return $this->response->setJSON(['success'=>false,'message'=>'Failed to send Welcome Email']);}}else{return $this->response->setJSON(['success'=>false,'message'=>'Failed to add subscriber']);}}public function approveBufferItem($id){$this->marketingModel->updateBufferStatus($id,'approved');return $this->respond(['status'=>'success','message'=>'Approved']);}public function approveLogo(){$symbol=$this->request->getPost('symbol');$imageUrl=$this->request->getPost('imageUrl');try{$this->marketingModel->saveApprovedLogo($symbol,$imageUrl);return $this->response->setJSON(['success'=>true,'message'=>'Logo approved successfully.',]);}catch(\Exception $e){log_message('error','Failed to approve logo: '.$e->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to approve logo.',]);}}public function approveAndDownloadLogo(){$imageUrl=$this->request->getPost('selectedImage');$symbol=$this->request->getPost('symbol');try{$imageContent=file_get_contents($imageUrl);$imagePath=WRITEPATH.'uploads/Company-Logos/'.$symbol.'.png';file_put_contents($imagePath,$imageContent);$publicPath=FCPATH.'assets/images/Company-Logos/'.$symbol.'.png';rename($imagePath,$publicPath);return redirect()->to('/Management/Marketing/upcomingEarnings')->with('success','Logo approved and saved successfully.');}catch(\Exception $e){log_message('error','Failed to download or save logo: '.$e->getMessage());return redirect()->back()->with('error','Failed to save the logo.');}}public function approveContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['status'=>'approved']);return redirect()->back()->with('success','Content approved successfully.');}public function blogs(){$this->data['pageTitle']='MyMI Blogs | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['blogs']=$this->marketingModel->getBlogs();$this->data['totalBlogs']=$this->marketingModel->countBlogs();$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Blogs',$this->data);}public function campaigns(){$this->data['pageTitle']='Marketing Campaigns | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['getActiveCampaigns']=$this->marketing['department']['getActiveCampaigns'];$this->data['getActivePriorityCampaigns']=$this->marketing['department']['getActivePriorityCampaigns'];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\campaigns',$this->data);}public function contentGenerator(){try{$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\contentGenerator',$this->data);}catch(\Throwable $th){log_message('error','MarketingController contentGenerator error: '.$th->getMessage());}}public function contentReview(){$generatedContent=$this->session->get('generatedContent');if(empty($generatedContent)){return redirect()->to('/Management/Marketing')->with('error','No generated content available for review.');}return $this->renderTheme('ManagementModule\Views\Marketing\Content_Review',['generatedContent'=>$generatedContent]);}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);log_message('debug','âœ… Content digest completed.');}public function cronFetchAndStoreEmails(){try{log_message('debug','Starting cronFetchAndStoreEmails');$this->marketingService->scrapeAndStoreEmailsToTemp();log_message('debug','Finished cronFetchAndStoreEmails');return $this->respond(['status'=>'success']);}catch(\Throwable $e){log_message('error','cronFetchAndStoreEmails Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();log_message('debug','âœ… Inbox scrape completed.');}public function cronFetchMarketingEmails(){log_message('info','CRON: Starting Marketing Email Fetch');$service=new MarketingService();$emailsFetched=$this->getMyMIMarketing()->fetchAndStoreEmails('newsletters');log_message('info','CRON: Fetched '.$emailsFetched.' marketing emails');return $this->respond(['status'=>'success','fetched'=>$emailsFetched]);}public function cronGenerateContentFromTemp(){try{log_message('debug','Starting cronGenerateContentFromTemp');$this->marketingService->generateFinalContentFromTemp();log_message('debug','Finished cronGenerateContentFromTemp');return $this->respond(['status'=>'success']);}catch(\Throwable $e){log_message('error','cronGenerateContentFromTemp Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function cronSendDailyLog(){date_default_timezone_set('America/Chicago');$contentData=$this->getLogsOrFallback();$emailView=view('emails/daily_log_summary',['contentData'=>$contentData['data'],'contentType'=>$contentData['type'],]);$subject=($contentData['type']==='logs')?'Daily Log Summary for '.date('F j, Y'):'Fallback Content - Daily Summary '.date('F j, Y');$this->email->setTo('community@mymiwallet.com')->setSubject($subject)->setMessage($emailView)->send();$this->email->setTo('team@mymiwallet.com')->setSubject('Reminder: Daily Log Email Pending Confirmation')->setMessage('The daily log email is scheduled to be sent at 3 PM CST. Please review the content to ensure everything is accurate.')->send();}public function edit($id=null){if($id===null){throw new \CodeIgniter\Exceptions\PageNotFoundException('Exchange ID not provided');}$tokenData=$this->marketingModel->getExchangeTokenById($id);if(!$tokenData){throw new \CodeIgniter\Exceptions\PageNotFoundException('Token not found');}if($this->request->getMethod()==='post'){$validation=\Config\Services::validation();$validation->setRules(['coin_name'=>'required','market_cap'=>'required|numeric','website'=>'required|valid_url','discord'=>'permit_empty|valid_url','facebook'=>'permit_empty|valid_url','telegram'=>'permit_empty|valid_url','twitter'=>'permit_empty|valid_url',]);if($validation->withRequest($this->request)->run()){$updatedData=['coin_name'=>$this->request->getPost('coin_name'),'market_cap'=>$this->request->getPost('market_cap'),'website'=>$this->request->getPost('website'),'discord'=>$this->request->getPost('discord'),'facebook'=>$this->request->getPost('facebook'),'telegram'=>$this->request->getPost('telegram'),'twitter'=>$this->request->getPost('twitter'),];if($this->marketingModel->updateExchangeToken($id,$updatedData)){$this->session->setFlashdata('success','Exchange token updated successfully');}else{$this->session->setFlashdata('error','Failed to update the exchange token');}return redirect()->to(site_url('Management/Marketing/Exchanges/Edit/'.$id));}else{$this->session->setFlashdata('validation_errors',$validation->getErrors());}}return $this->renderTheme('ManagementModule\Views\Marketing\Exchanges\edit',['token'=>$tokenData,'validation'=>$this->session->getFlashdata('validation_errors'),'redirectURL'=>site_url('Management/Marketing/Exchanges'),]);}public function editContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}return $this->renderTheme('ManagementModule\Views\Marketing\Content_Edit',['content'=>$content]);}public function fetchBufferPaginated(){$page=(int) $this->request->getGet('page')?:1;$limit=(int) $this->request->getGet('limit')?:20;$data=$this->marketingModel->fetchBufferPaginated($page,$limit);return $this->respond($data);}public function fetchLatestSummaries(){$generatedSummaries=$this->marketingModel->getLatestGeneratedSummaries(25);return $this->renderTheme('ManagementModule\Views\Marketing\resources\generatedSummaries',['generatedSummaries'=>$generatedSummaries]);}public function fetchMissingLogos(){$postData=$this->request->getJSON(true);$csrfName=csrf_token();$csrfHash=csrf_hash();if(!isset($postData[$csrfName])||$postData[$csrfName]!==$csrfHash){log_message('error','fetchMissingLogos: CSRF validation failed');return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['error'=>'Invalid CSRF token.']);}$symbols=$postData['symbols']?? null;if(empty($symbols)||!is_array($symbols)){log_message('error','fetchMissingLogos: Invalid symbols input');return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['error'=>'Invalid symbols input.']);}$results=[];foreach($symbols as $symbol){$results[]=['symbol'=>$symbol,'status'=>'not_found',];}return $this->response->setHeader('X-CSRF-Token-Name',$csrfName)->setHeader('X-CSRF-Token-Hash',$csrfHash)->setJSON(['results'=>$results]);}public function financialNews(){$symbols=$this->investmentModel->getAllSymbolsByEarnings();$approvedLogos=$this->marketingModel->getApprovedLogos();$existingSymbols=array_column($approvedLogos,'symbol');$missingSymbols=array_filter($symbols,function($symbol)use($existingSymbols){return!in_array($symbol['symbol'],$existingSymbols);});$this->data['approvedLogos']=$approvedLogos ??[];$this->data['missingSymbols']=$missingSymbols ??[];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\financialNews',$this->data);}public function generateAudio(){$text=$this->request->getPost('text');$fileName=$this->request->getPost('fileName')?:uniqid('tts_',true);$directory=WRITEPATH.'uploads/';$outputFile=$directory.$fileName.'.mp3';if(empty($text)){return $this->response->setJSON(['status'=>'error','message'=>'Text cannot be empty.',]);}if(!is_dir($directory)){mkdir($directory,0777,true);}$command=sprintf('python3 gtts_script.py %s %s',escapeshellarg($text),escapeshellarg($outputFile));exec($command,$output,$status);if($status===0&&file_exists($outputFile)){$fileUrl=base_url('uploads/'.basename($outputFile));return $this->response->setJSON(['status'=>'success','message'=>'Audio file generated successfully.','file_url'=>$fileUrl,]);}else{return $this->response->setJSON(['status'=>'error','message'=>'Failed to generate audio.',]);}}private function generateAutomatedContent(){$scraperContent=$this->marketingModel->getRecentScrapes();$tempContent=$this->marketingModel->getRecentTempScrapes();$campaigns=$this->marketingModel->getActiveCampaignsLimited(50);$allContent=array_merge($scraperContent,$tempContent,$campaigns);$generatedContent=[];foreach($allContent as $content){$generatedContent[]=$this->getMarketingService()->generateContentFromPost($content->title ?? 'Untitled',$content->content ?? '',$content->tags?explode(',',$content->tags):[]);}foreach($generatedContent as $content){$slug=$this->marketingModel->createSlug($content['title']);$this->db->table('bf_marketing_blog_posts')->insert(['title'=>$content['title']?? 'Generated Content','content'=>$content['summary']?? '','slug'=>$slug,'tags'=>implode(',',$content['keywords']??[]),'created_on'=>date('Y-m-d H:i:s'),]);$this->marketingModel->saveDailyLog(['title'=>$content['title'],'content'=>$content['summary'],'type'=>'Automated','tags'=>implode(',',$content['keywords']),'date_time'=>date('Y-m-d H:i:s'),'author_information'=>'MyMI Automated System','created_on'=>date('Y-m-d H:i:s'),]);}return $generatedContent;}public function generateContent($platform,$postId){$post=$this->marketingModel->getSchedulePostById($postId);if(!$post){return redirect()->back()->with('error','Post not found.');}$content=$this->getMyMIMarketing()->generateContentFromGPT($post['subjects'],$post['descriptions'],$platform);$contentData=['post_id'=>$postId,'platform'=>$platform,'generated_content'=>$content,];$this->marketingModel->storeGeneratedContent($contentData);return redirect()->to("\Management\Marketing\Schedule")->with('success','Content generated successfully.');}public function generateContentDigestFromStored(){log_message('info','Marketing: Starting summary generation from stored marketing emails.');$model=new MarketingModel();$records=$model->getRecentUnprocessedTempEmails(5);$results=[];foreach($records as $record){if(empty($record['content'])||strlen($record['content'])<1000){log_message('debug',"âš ï¸ Skipping record ID {$record['id']} due to insufficient content length.");continue;}if(empty($record['title'])||empty($record['content'])){log_message('debug','Skipped record due to missing title/content ID: '.$record['id']);continue;}try{$summary=$this->getMarketingService()->generateContentFromRaw($record['title'],$record['content']);$model->storeFinalMarketingContent(['source_id'=>$record['id'],'title'=>$record['title'],'summary'=>$summary,'created_at'=>date('Y-m-d H:i:s')]);$model->markTempRecordAsProcessed($record['id']);$results[]=$record['title'];}catch(\Throwable $e){log_message('error','Failed to process record ID '.$record['id'].': '.$e->getMessage());}}return $this->respond(['status'=>'complete','processed_titles'=>$results]);}public function generateContentFromTweet($tweetId){$tweet=$this->marketingModel->getTweetById($tweetId);if(!$tweet){return $this->failNotFound('Tweet not found');}$generatedContent=$this->getMyMIMarketing()->generateContentFromTweets([$tweet]);$this->marketingModel->storeGeneratedContent(['tweet_id'=>$tweetId,'content'=>json_encode($generatedContent),'created_at'=>date('Y-m-d H:i:s')]);$this->getMyMIMarketing()->postToTwitter($generatedContent['platform_content']['Twitter']);return $this->respond(['message'=>'Content generated and posted successfully']);}public function generateDailyContentDigest(){log_message('debug','ðŸ§  Start Memory Usage: '.memory_get_usage(true));@ini_set('memory_limit','768M');$limit=5;$summary=[];$rawRecords=$this->marketingModel->getLatestUnprocessedEmails($limit);foreach($rawRecords as $record){$content=$record['content']?? '';if(empty($content)||strlen($content)<500){log_message('debug',"â­ï¸ Skipped record ID {$record['id']} - insufficient content.");continue;}$contentSize=strlen($content);log_message('debug','ðŸ“Œ Processing record ID '.$record['id'].' with content size: '.$contentSize);log_message('debug','Management/MarketingController L770 - $record Array: '.print_r($record,true));if($contentSize===0){log_message('debug',"â­ï¸ Skipped record ID {$record['id']} - empty content.");continue;}try{gc_collect_cycles();$processed=$this->getMarketingService()->generateContentFromRaw($record);if($processed===null){log_message('debug',"âš ï¸ Skipped record ID {$record['id']} - generateContentFromRaw() returned null.");continue;}$this->marketingModel->saveFinalizedMarketingContent($processed);$summary[]=['title'=>$processed['headline'],'summary'=>$processed['summary'],'subtopics'=>$processed['subtopics'],'platform_posts'=>$processed['posts'],];}catch(\Throwable $e){log_message('error',"âŒ generateDailyContentDigest failed on record ID {$record['id']}: {$e->getMessage()}");}}$this->marketingModel->markEmailsAsProcessed(array_column($rawRecords,'id'));log_message('debug','ðŸ Peak Memory Usage: '.memory_get_peak_usage(true));return $this->response->setJSON(['digest'=>$summary]);}public function generateNewsletterContent(){$emailContents=$this->marketingModel->getEmailContentsForNewsletter();$content=$this->getMyMIMarketing()->generateNewsletterContent($emailContents);$newsletterData=['title'=>'Monthly Financial Newsletter - '.date('F Y'),'content'=>$content,'status'=>'draft','created_at'=>date('Y-m-d H:i:s'),];$this->marketingModel->storeNewsletterDraft($newsletterData);return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Newsletter content generated successfully');}private function generateSummarizedFallbackContent($contentArray){$summarizedContent=[];$summarizer=new \App\Libraries\ContentSummarizer();foreach($contentArray as $content){$summarizedContent[]=['title'=>$content->title ?? 'Untitled','summary'=>$summarizer->summarize($content->content ?? '',200),'url'=>$content->url ?? null,];}return $summarizer->combineSummaries($summarizedContent);}private function getLogsOrFallback(){$logs=$this->marketingModel->getDailyLogsByDate(date('Y-m-d'));if(!empty($logs)){return['type'=>'logs','data'=>$logs];}$scrapedContent=$this->marketingModel->getRecentScrapes();$campaigns=$this->marketingModel->getActiveCampaignsLimited(50);$combinedContent=array_merge($scrapedContent,$campaigns['result']);$fallbackContent=$this->generateSummarizedFallbackContent($combinedContent);foreach($fallbackContent as $content){$this->marketingModel->saveDailyLog(['title'=>$content['title']?? 'Automated Content','content'=>$content['summary']?? '','type'=>'Automated','tags'=>implode(',',$content['keywords']??[]),'date_time'=>date('Y-m-d H:i:s'),'author_information'=>'MyMI Automated System','created_on'=>date('Y-m-d H:i:s'),]);}return['type'=>'fallback','data'=>$fallbackContent];}public function getRecentScrapes(){try{$scrapes=$this->marketingModel->getRecentScrapes();return $this->response->setJSON(['success'=>true,'scrapes'=>$scrapes]);}catch(\Throwable $th){log_message('error','getRecentScrapes: Exception - '.$th->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to fetch recent scrapes.']);}}private function handleMediaUpload($mediaFiles){$uploadedMedia=[];foreach($mediaFiles as $file){if($file->isValid()&&!$file->hasMoved()){$newFileName=$file->getRandomName();$file->move(WRITEPATH.'uploads/media/',$newFileName);$uploadedMedia[]=['file_name'=>$file->getClientName(),'file_path'=>WRITEPATH.'uploads/media/'.$newFileName,'file_size'=>$file->getSize(),'file_type'=>$file->getMimeType(),];}}return $uploadedMedia;}public function ideas(){$this->data['pageTitle']='Marketing Campaigns | Management | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['getActiveIdeas']=$this->marketingModel->getActiveIdeas();$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\ideas',$this->data);}public function importScheduleCSV(){if($this->request->getMethod()==='post'){$file=$this->request->getFile('csv_file');if($file->isValid()&&!$file->hasMoved()){$filePath=WRITEPATH.'uploads/'.$file->store();$csvData=array_map('str_getcsv',file($filePath));foreach($csvData as $row){$scheduleData=['day'=>$row[0],'time'=>$row[1],'activity'=>$row[2],];$scheduleId=$this->marketingModel->addMarketingSchedule($scheduleData);$campaignData=['sched_id'=>$scheduleId,'title'=>$row[3],'platform'=>$row[4],'content'=>$row[5],];$this->marketingModel->addMarketingCampaign($campaignData);}return redirect()->back()->with('success','Schedule and campaigns imported successfully.');}return redirect()->back()->with('error','Invalid CSV file.');}return $this->renderTheme('ManagementModule\Views\Marketing\importCSV');}public function previewBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Item not found.");return $this->renderTheme('ManagementModule\Views\Marketing\modals\bufferPreview',['item'=>$record]);}public function previewGeneratedPost($id){try{$post=$this->marketingModel->find($id);if(!$post){return $this->failNotFound('Post not found.');}return $this->renderTheme('App\Modules\Management\Views\Marketing\modals/previewGeneratedPost',['post'=>$post]);}catch(\Throwable $e){log_message('error','âŒ Failed to load post preview: '.$e->getMessage());return $this->failServerError('Unable to preview post.');}}public function previewPendingSummaries(){try{$pendingSummaries=$this->marketingModel->getPendingScraperSummaries(10);return $this->renderTheme('App\Modules\Management\Views\Marketing\partials\previewPendingSummaries',['pendingSummaries'=>$pendingSummaries]);}catch(\Throwable $e){log_message('error','âŒ previewPendingSummaries failed: '.$e->getMessage());return $this->failServerError('Could not load summaries.');}}public function previewVideoScript($id){$post=$this->marketingModel->getGeneratedPostById($id);if(!$post)return $this->failNotFound('Post not found.');$posts=json_decode($post['posts'],true);$videoScript=$posts['video']?? 'No video script generated yet.';return $this->renderTheme('MarketingModule\Views\Marketing\modals\video_preview_modal',['title'=>$post['title'],'videoScript'=>$videoScript,]);}public function processScheduledPosts(){$currentTimestamp=date('Y-m-d H:i:s');$scheduledPosts=$this->marketingModel->getPendingScheduledPosts($currentTimestamp);foreach($scheduledPosts as $post){$payload=['platform'=>$post->platform,'content'=>$post->content,'media_url'=>$post->media_url,];try{$response=$this->sendToZapier($post->zapier_webhook_url,$payload);if($response->getStatusCode()===200){$this->marketingModel->updatePostStatus($post->id,'posted');}else{throw new Exception("Zapier response error: {$response->getBody()}");}}catch(Exception $e){$this->handlePostFailure($post,$e->getMessage());}}}private function sendToZapier($webhookUrl,$payload){$client=new \GuzzleHttp\Client();return $client->post($webhookUrl,['headers'=>['Content-Type'=>'application/json'],'json'=>$payload,]);}private function handlePostFailure($post,$error){$this->marketingModel->incrementRetryCount($post->id);log_message('error',"Failed to post to Zapier for Post ID {$post->id}: {$error}");if($post->retry_count>=3){$this->marketingModel->updatePostStatus($post->id,'failed');}}public function postCreator(){try{$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\index',$this->data);}catch(\Throwable $th){log_message('error','MarketingController postCreator error: '.$th->getMessage());}}public function promote(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['exchangeAssets']=[];$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\Promote',$this->data);}public function publishBlog($blogId){$blog=$this->marketingModel->getBlogPostDetails($blogId);if(!$blog){return redirect()->back()->with('error','Blog post not found.');}$this->marketingModel->update($blogId,['status'=>'published']);return redirect()->to('/Management/Marketing/Blogs')->with('success','Blog published successfully.');}public function rejectBufferItem($id){$this->marketingModel->updateBufferStatus($id,'rejected');return $this->respond(['status'=>'success','message'=>'Rejected']);}public function rejectContent($id){$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['status'=>'rejected']);return redirect()->back()->with('success','Content rejected successfully.');}public function reviewBuffer(){$buffer=$this->marketingModel->getBufferItems();$this->data['pageTitle']='Marketing Buffer Dashboard';$this->data['buffer']=$buffer;return $this->renderTheme('ManagementModule\Views\Marketing\BufferDashboard',$this->data);}public function runContentGeneration(){$generatedContent=$this->generateAutomatedContent();$this->session->set('generatedContent',$generatedContent);return redirect()->to('/Management/Marketing/ContentReview')->with('success',count($generatedContent).' content items generated successfully. Please review and approve.');}private function sanitizeContent($content){$content=preg_replace('#<script(.*?)>(.*?)</script>#is','',$content);$content=preg_replace('#<style(.*?)>(.*?)</style>#is','',$content);$content=strip_tags($content);$content=preg_replace('/\s+/',' ',$content);return trim($content);}private function saveCampaign($formData){$data=['title'=>$formData['title'],'description'=>$formData['description'],];$this->marketingModel->addMarketingCampaign($data);}public function saveContentEdit($id){$postData=$this->request->getPost();$content=$this->marketingModel->find($id);if(!$content){return redirect()->back()->with('error','Content not found.');}$this->marketingModel->update($id,['content'=>$postData['content'],'status'=>'pending',]);return redirect()->to('/Management/Marketing/ContentReview')->with('success','Content updated successfully.');}private function saveSchedule($formData){$scheduleModel=new \App\Models\ScheduleModel();$data=['title'=>$formData['title'],'description'=>$formData['description'],];$scheduleModel->insert($data);}public function schedule($day=null){if(!empty($day)){$this->data['marketingSchedule']=$this->marketingModel->getScheduleByDay($day);foreach($this->data['marketingSchedule']as&$schedule){$schedule['campaigns']=$this->marketingModel->getCampaignsBySchedId($schedule['id']);}$this->data['scheduleByDay']='Yes';}else{$this->data['marketingSchedule']=$this->marketingModel->getUpcomingSchedule();foreach($this->data['marketingSchedule']as&$schedule){$schedule['campaigns']=$this->marketingModel->getCampaignsBySchedId($schedule['id']);}$this->data['scheduleByDay']='No';}$this->commonData();$this->data['pageTitle']='Daily Schedule | Management | MyMI Wallet';return $this->renderTheme('ManagementModule\Views\Marketing\Schedule',$this->data);}public function scheduleNewsletterCampaign(){$newsletterDraft=$this->marketingModel->getLatestNewsletterDraft();if(!$newsletterDraft){return $this->response->setJSON(['success'=>false,'message'=>'No newsletter draft found']);}$campaignData=['title'=>$newsletterDraft['title'],'content'=>$newsletterDraft['content'],'status'=>'scheduled','send_date'=>$this->request->getPost('send_date'),'target_audience'=>'all_users','created_at'=>date('Y-m-d H:i:s'),];if($this->marketingModel->scheduleNewsletterCampaign($campaignData)){return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Newsletter campaign scheduled successfully');}else{return redirect()->back()->with('error','Failed to schedule newsletter campaign');}}private function scrapeGoogleSearch($query){$searchUrl='https://www.google.com/search?q='.urlencode($query);$client=new Client();try{$response=$client->get($searchUrl);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$dom=new \DOMDocument();libxml_use_internal_errors(true);$dom->loadHTML($html);libxml_clear_errors();$xpath=new \DOMXPath($dom);$results=[];foreach($xpath->query('//a[@href]')as $link){$href=$link->getAttribute('href');if(strpos($href,'/url?q=')===0){$href=substr($href,7,strpos($href,'&')-7);$text=$link->nodeValue;$results[]=['href'=>$href,'text'=>$text];}}return $results;}else{log_message('error','scrapeGoogleSearch: Could not retrieve content, HTTP status code - '.$response->getStatusCode());return['error'=>'Could not retrieve content, HTTP status code - '.$response->getStatusCode()];}}catch(RequestException $e){log_message('error','scrapeGoogleSearch: RequestException - '.$e->getMessage());return['error'=>'RequestException error: '.$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeGoogleSearch: General error - '.$e->getMessage());return['error'=>'General error: '.$e->getMessage()];}return[];}public function scrapeLink(){$rawRequestBody=$this->request->getBody();$jsonData=json_decode($rawRequestBody,true);$url=$jsonData['url']?? null;if(!$url){log_message('error','scrapeLink: URL is missing');return $this->response->setJSON(['success'=>false,'message'=>'URL is required.']);}try{log_message('debug','scrapeLink: Scraping URL - '.$url);$scrapedData=$this->scrapeWebsiteWithFallback($url);if(isset($scrapedData['error'])){log_message('error','scrapeLink: '.$scrapedData['error']);return $this->response->setJSON(['success'=>true,'message'=>'Partially scraped data, proceeding with available data.']);}if(!empty($scrapedData['content'])){$this->marketingModel->storeTempScrapedData(['title'=>$scrapedData['title'],'content'=>$scrapedData['content'],'links'=>json_encode($scrapedData['links']),'url'=>$scrapedData['url'],'scraped_at'=>date('Y-m-d H:i:s'),'modified_on'=>date('Y-m-d H:i:s'),]);return $this->response->setJSON(['success'=>true,'message'=>'Scraped data stored successfully.','data'=>$scrapedData]);}else{log_message('error','scrapeLink: Scraped data is empty');return $this->response->setJSON(['success'=>false,'message'=>'Scraping failed. Please check the URL and try again.']);}}catch(\Throwable $th){log_message('error','scrapeLink: Exception - '.$th->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'An error occurred during scraping.']);}}private function scrapeLinks($links){$scrapedLinksData=[];foreach($links as $link){$url=filter_var($link['href'],FILTER_SANITIZE_URL);if(filter_var($url,FILTER_VALIDATE_URL)){$scrapedData=$this->scrapeWebsite($url);if(!empty($scrapedData['content'])){$scrapedLinksData[]=$scrapedData;}}}return $scrapedLinksData;}private function scrapeWebsite($url){$client=new Client();try{$response=$client->get($url,['stream'=>true,'headers'=>['User-Agent'=>'MyMI Wallet Bot'],'timeout'=>10,'http_errors'=>false ]);if($response->getStatusCode()==200){$html=$response->getBody()->getContents();$dom=HtmlDomParser::str_get_html($html);if($dom instanceof \voku\helper\HtmlDomParser){$title=$dom->find('title',0)->text ?? 'No title found';$bodyNode=$dom->find('body',0);$bodyContent=$bodyNode?$this->sanitizeContent($bodyNode->innerHtml()):'No body content found';$links=[];foreach($dom->find('a')as $link){$href=$link->getAttribute('href');$text=$link->text;$links[]=['href'=>$href,'text'=>$text];}log_message('debug','scrapeWebsite: Scraping successful for URL - '.$url);return['title'=>$title,'content'=>$bodyContent,'links'=>$links,'url'=>$url];}else{log_message('error','scrapeWebsite: DOM parsing failed for URL - '.$url);return['error'=>'DOM parsing failed.'];}}else{log_message('error','scrapeWebsite: Could not retrieve content, HTTP status code - '.$response->getStatusCode());return['error'=>'Could not retrieve content, HTTP status code - '.$response->getStatusCode()];}}catch(RequestException $e){if($e->hasResponse()&&$e->getResponse()->getStatusCode()==401){log_message('error','scrapeWebsite: Unauthorized access for URL - '.$url);return['error'=>'Unauthorized access. Skipping URL.'];}log_message('error','scrapeWebsite: RequestException - '.$e->getMessage());return['error'=>'RequestException error: '.$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeWebsite: General error - '.$e->getMessage());return['error'=>'General error: '.$e->getMessage()];}}private function scrapeWebsiteWithFallback($url){try{log_message('debug','scrapeWebsiteWithFallback: Scraping URL - '.$url);$scrapedData=$this->scrapeWebsite($url);if(empty($scrapedData['content'])){log_message('debug','scrapeWebsiteWithFallback: Scraped data is empty, performing Google search fallback');$googleSearchResults=$this->scrapeGoogleSearch($url);$scrapedLinksData=$this->scrapeLinks($googleSearchResults);$scrapedData['google_search_results']=$scrapedLinksData;}return $scrapedData;}catch(RequestException $e){log_message('error','scrapeWebsiteWithFallback: RequestException - '.$e->getMessage());return['error'=>$e->getMessage()];}catch(\Exception $e){log_message('error','scrapeWebsiteWithFallback: General error - '.$e->getMessage());return['error'=>$e->getMessage()];}}public function searchAndApproveLogo($symbol){$query=$symbol.' logo png transparent';$searchUrl='https://www.google.com/search?q='.urlencode($query).'&tbm=isch';try{$response=$this->client->request('GET',$searchUrl);$htmlContent=$response->getBody()->getContents();$dom=new \DOMDocument();@$dom->loadHTML($htmlContent);$xpath=new \DOMXPath($dom);$imageNodes=$xpath->query('//img');$imageUrls=[];foreach($imageNodes as $imageNode){$src=$imageNode->getAttribute('src');if($src){$imageUrls[]=$src;}}return $this->renderTheme('ManagementModule\Views\Marketing\approve_logo',['symbol'=>$symbol,'imageUrls'=>$imageUrls,]);}catch(RequestException $e){log_message('error','Google Search Request Failed: '.$e->getMessage());return redirect()->back()->with('error','Failed to fetch logo suggestions.');}}public function sendScheduledNewsletter(){$campaigns=$this->marketingModel->getScheduledCampaigns();foreach($campaigns as $campaign){$this->getMyMIMarketing()->sendNewsletter($campaign['content'],$campaign['target_audience']);$this->marketingModel->updateCampaignStatus($campaign['id'],'sent');}return redirect()->to(site_url('Management/Marketing/Content/Listing'))->with('success','Scheduled newsletters sent successfully');}public function standaloneAddSubscriber(){$this->data['pageTitle']='Add Subscriber | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneAddSubscriber',$this->data);}public function standaloneScrape(){$this->data['pageTitle']='Quick Scraper | Management | MyMI Wallet';$this->commonData();return $this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneScraper',$this->data);}private function storeScrapedData($scrapedData){$db=\Config\Database::connect();$builder=$db->table('bf_marketing_temp_scraper');$data=['title'=>$scrapedData['title'],'content'=>$scrapedData['content'],'links'=>json_encode($scrapedData['links']),'url'=>$scrapedData['url'],'created_at'=>date('Y-m-d H:i:s'),'updated_at'=>date('Y-m-d H:i:s'),];$builder->insert($data);}public function submitContent(){$request=service('request');$validationRules=['campaignName'=>'required|min_length[3]','promotionalLinks'=>'required','facebookMessage'=>'required','linkedinMessage'=>'required','discordMessage'=>'required','stockTwitsMessage'=>'required','tiktokMessage'=>'required','youtubeMessage'=>'required','emailMessage'=>'required',];if(!$this->validate($validationRules)){return redirect()->back()->with('errors',$this->validator->getErrors())->withInput();}$campaignData=['name'=>$request->getPost('campaignName'),'promotional_links'=>json_encode($request->getPost('promotionalLinks')),'facebook_message'=>$request->getPost('facebookMessage'),'linkedin_message'=>$request->getPost('linkedinMessage'),'discord_message'=>$request->getPost('discordMessage'),'stocktwits_message'=>$request->getPost('stockTwitsMessage'),'tiktok_message'=>$request->getPost('tiktokMessage'),'youtube_message'=>$request->getPost('youtubeMessage'),'email_message'=>$request->getPost('emailMessage'),'additional_info'=>$request->getPost('additionalInfo'),'created_on'=>date('Y-m-d H:i:s'),'status'=>1,'stage'=>'draft',];$marketingModel=new MarketingModel();if($marketingModel->insert($campaignData)){return redirect()->to('/Marketing/Success')->with('success','Marketing content submitted successfully.');}else{return redirect()->back()->with('error','Failed to submit marketing content.')->withInput();}}public function submitDailyLog(){$data=['title'=>$this->request->getPost('subject'),'content'=>$this->request->getPost('log_content'),'subcontent'=>json_encode($this->request->getPost('subcontent')),'tags'=>$this->request->getPost('tags'),'type'=>$this->request->getPost('content_type'),'url'=>$this->request->getPost('url'),'author_information'=>$this->request->getPost('author_information'),'date_time'=>$this->request->getPost('date_time'),'trade_alert_subcategory'=>$this->request->getPost('trade_alert_subcategory'),'created_on'=>date('Y-m-d H:i:s'),];if($this->marketingModel->saveDailyLog($data)){return $this->response->setJSON(['success'=>true,'message'=>'Daily log submitted successfully!']);}else{return $this->response->setJSON(['success'=>false,'message'=>'Failed to submit daily log.']);}}public function submitLargeContent(){log_message('debug','submitLargeContent method called');try{$subject=$this->request->getPost('subject');$url=$this->request->getPost('url');$content=$this->request->getPost('large_content');$tags=$this->request->getPost('tags');$uploadedFiles=$this->request->getFiles();$contentType=$this->request->getPost('content_type');$mediaAssets=$this->handleMediaUpload($uploadedFiles['media_assets']);if(empty($content)||strlen($content)<50){throw new \Exception('Content too short or empty');}$generatedContent=$this->getMyMIMarketing()->generateContentFromLargeText($content,$tags);$keywords=is_array($generatedContent['keywords'])?$generatedContent['keywords']:[];$this->marketingModel->storeScrapedContent(['status'=>'pending','type'=>$contentType,'url'=>$url,'title'=>$subject,'summary'=>$generatedContent['summary'],'content'=>$content,'keywords'=>implode(', ',$keywords),'created_on'=>date('Y-m-d H:i:s'),]);return $this->response->setJSON(['success'=>true]);}catch(\Exception $e){log_message('error','submitLargeContent error: '.$e->getMessage());return $this->response->setJSON(['success'=>false,'message'=>'Failed to submit content.']);}}public function submitLargeContentForm(){$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->commonData();$this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneLargeContentForm',$this->data);}public function submitMarketingCampaign(){helper(['form','url']);$data=['name'=>$this->request->getPost('campaignName'),'assigned_to'=>$this->request->getPost('assigned_to'),'promotional_links'=>json_encode($this->request->getPost('promotionalLinks')),'facebook_message'=>htmlentities($this->request->getPost('facebookMessage'),ENT_QUOTES,'UTF-8'),'linkedin_message'=>htmlentities($this->request->getPost('linkedinMessage'),ENT_QUOTES,'UTF-8'),'discord_message'=>htmlentities($this->request->getPost('discordMessage'),ENT_QUOTES,'UTF-8'),'stocktwits_message'=>htmlentities($this->request->getPost('stocktwitsMessage'),ENT_QUOTES,'UTF-8'),'tiktok_message'=>htmlentities($this->request->getPost('tiktokMessage'),ENT_QUOTES,'UTF-8'),'youtube_message'=>htmlentities($this->request->getPost('youtubeMessage'),ENT_QUOTES,'UTF-8'),'email_message'=>htmlentities($this->request->getPost('emailMessage'),ENT_QUOTES,'UTF-8'),'additional_info'=>htmlentities($this->request->getPost('additionalInfo'),ENT_QUOTES,'UTF-8'),'overall_campaign_description'=>htmlentities($this->request->getPost('overall_campaign_description'),ENT_QUOTES,'UTF-8'),'voice_script'=>htmlentities($this->request->getPost('voice_script'),ENT_QUOTES,'UTF-8')];if($this->validate(['name'=>'required','facebook_message'=>'required',])){$this->marketingModel->submitCampaignContent($data);return redirect()->to('/dashboard')->with('success','Campaign submitted successfully.');}else{return redirect()->back()->withInput()->with('errors',$this->validator->getErrors());}}public function submitMarketIdeas(){if($this->request->getMethod()==='post'){$data=['title'=>$this->request->getPost('title'),'description'=>htmlentities($this->request->getPost('description'),ENT_QUOTES,'UTF-8'),'created_by'=>session()->get('user_id'),'assigned_to'=>$this->request->getPost('assigned_to'),'priority'=>$this->request->getPost('priority'),'status'=>'draft','platforms'=>json_encode($this->request->getPost('platforms')),'additional_info'=>htmlentities($this->request->getPost('additional_info'),ENT_QUOTES,'UTF-8'),];$uploadedFiles=$this->request->getFiles();$filePaths=[];if($uploadedFiles&&isset($uploadedFiles['imageFiles'])){foreach($uploadedFiles['imageFiles']as $file){if($file->isValid()&&!$file->hasMoved()){$newName=$file->getRandomName();$file->move(FCPATH.'public/assets/images/Marketing/Ideas',$newName);$filePaths[]=base_url('assets/images/Marketing/Ideas/'.$newName);}}}if(!empty($filePaths)){$data['image_paths']=json_encode($filePaths);}if($this->validate(['title'=>'required','description'=>'required'])){$this->marketingModel->submitIdea($data);return redirect()->back()->with('success','Idea submitted successfully.');}else{return redirect()->back()->withInput()->with('errors',$this->validator->getErrors());}}}public function topCommunities($channel=null){$this->commonData();$MyMIExchange=new MyMIExchange();$exchangeTokens=$MyMIExchange->getSolanaTokens();if(!empty($channel)){if($channel==='Discord'){$this->data['tokens']=$exchangeTokens['discord'];$this->data['pageTitle']='Discord Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\discord',$this->data);}elseif($channel==='Facebook'){$this->data['tokens']=$exchangeTokens['facebook'];$this->data['pageTitle']='Facebook Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\facebook',$this->data);}elseif($channel==='Twitter'){$this->data['tokens']=$exchangeTokens['x_twitter'];$this->data['pageTitle']='Twitter Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\twitter',$this->data);}elseif($channel==='Website'){$this->data['tokens']=$exchangeTokens['website'];$this->data['pageTitle']='Website Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\website',$this->data);}else{$this->data['tokens']=$exchangeTokens['all'];$this->data['pageTitle']='All Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\all_tokens',$this->data);}}else{$this->data['tokens']=$exchangeTokens['all'];$this->data['pageTitle']='All Communities';$this->renderTheme('ManagementModule\Views\Marketing\Exchanges\includes\all_tokens',$this->data);}}public function triggerPostAutogenOnEmpty(){$today=date('Y-m-d');$existing=$this->marketingModel->getLatestGeneratedSummaries(5,$today);if(!empty($existing)){return $this->response->setJSON(['status'=>'skipped','message'=>'Summaries already exist for today.']);}try{$this->getMyMIMarketing()->generateFromTempScraper(5);return $this->response->setJSON(['status'=>'generated','message'=>'Generated new summaries.']);}catch(\Throwable $e){log_message('error','triggerPostAutogenOnEmpty error: '.$e->getMessage());return $this->failServerError('Failed to generate summaries.');}}public function twitterDashboard(){$data=['pageTitle'=>'Twitter Dashboard','hashtags'=>$this->request->getPost('hashtags')?? '','tweets'=>[]];if($this->request->getMethod()==='post'){$hashtags=$this->request->getPost('hashtags');$tweets=$this->getMyMIMarketing()->fetchTweets($hashtags);$data['tweets']=$tweets;}return $this->renderTheme('Management/Marketing/Twitter',$data);}public function upcomingEarnings(){$model=new \App\Models\EarningsModel();$upcomingEarnings=$model->getUpcomingEarnings();$this->data['upcomingEarnings']=$upcomingEarnings;return $this->renderTheme('ManagementModule\Views\Marketing\upcoming_earnings',$this->data);}public function updatePlatformToggle($id){$post=$this->request->getJSON(true);$platform=$post['platform'];$enabled=(bool) $post['enabled'];$record=$this->marketingModel->getBufferItem($id);$platforms=json_decode($record['platforms']?? '{}',true);$platforms[$platform]=$enabled;$this->marketingModel->updateBufferItem($id,['platforms'=>json_encode($platforms)]);return $this->respond(['status'=>'success']);}public function viewBlog($slug){$blogPost=$this->marketingModel->getBlogPostBySlug($slug);if(!$blogPost){throw new \CodeIgniter\Exceptions\PageNotFoundException('Blog post not found');}return $this->renderTheme('blog/view',['blogPost'=>$blogPost]);}public function viewCampaign($campaign_id){$campaignModel=new CampaignModel();$campaign=$this->marketingModel->getCampaignsById($campaign_id);if(!$campaign){throw new \CodeIgniter\Exceptions\PageNotFoundException("Campaign not found");}return $this->renderTheme('ManagementModule\Views\Marketing\Campaigns\View',['campaign'=>$campaign]);}public function viewDailyLogs($date=null){$date=$this->siteSettings->date ?? date('Y-m-d');$this->data['pageTitle']='Marketing Daily Log | '.$date.' | MyMI Wallet';$this->data['reporting']=$this->getMyMIAnalytics()->reporting();$this->data['logs']=$this->marketingModel->getDailyLogsByDate($date);$this->commonData();return $this->renderTheme('ManagementModul\Views\Marketing\Daily_Logs',['logs'=>$logs,'date'=>$date]);}public function viewEmail($titleEncoded=null,$messageId=null){log_message('debug','ðŸ“§ ManagementController::viewEmail called');try{if(empty($messageId)){return redirect()->back()->with('error','Invalid email identifier.');}$emailRecord=$this->marketingModel->getEmailByMessageId($messageId);if(!$emailRecord){return redirect()->back()->with('error','Email not found.');}$socialMediaPosts=$this->getMarketingService()->generateContentFromRaw($emailRecord);$emailRecord['social_media']=$socialMediaPosts['posts']??[];return $this->renderTheme('Management/Marketing/EmailDetail',['email'=>$emailRecord]);}catch(\Throwable $e){log_message('error','âŒ viewEmail() failed: '.$e->getMessage());return $this->failServerError('Unable to load email.');}}public function viewGeneratedContent(){$contentData=$this->marketingModel->getLastGeneratedContent();$platformsContent=json_decode($contentData['platforms_content'],true);$this->data['pageTitle']='MyMI Marketing | Management | MyMI Wallet';$this->data['platforms_content']=$platformsContent;$this->commonData();$this->renderTheme('ManagementModule\Views\Marketing\resources\standaloneGeneratedContent',$this->data);}public function viewGeneratedSummaries(){$this->data['pageTitle']='Generated Summaries';$this->data['generatedSummaries']=$this->marketingModel->getLatestGeneratedSummaries(25);$this->renderTheme('ManagementModule\Views\Marketing\resources\generatedSummaries',$this->data);}} ?><?php namespace App\Modules\APIs\Controllers;use CodeIgniter\API\ResponseTrait;use CodeIgniter\Controller;use App\Libraries\{BaseLoader,MyMIMarketing};use App\Services\MarketingService;use App\Models\MarketingModel;class MarketingController extends Controller{use ResponseTrait;use BaseLoader;protected $MyMIMarketing;protected $marketingService;protected $marketingModel;public function __construct(){$this->MyMIMarketing=new MyMIMarketing();$this->marketingModel=new MarketingModel();}public function approveBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Record not found.");$this->marketingModel->updateBufferItem($id,['status'=>'approved']);$posts=$this->MyMIMarketing->generateSocialPost($record);$this->MyMIMarketing->distributeContent('discord',$posts['discord']);$this->MyMIMarketing->distributeContent('linkedin',$posts['linkedin']);return $this->respond(['status'=>'success','message'=>'Content approved & promoted!']);}public function cronAnalyzeContent(){log_message('debug','ðŸ§  Starting content digest analysis...');$this->getMyMIMarketing()->generateFromTempScraper(5);return $this->respond(['status'=>'success','message'=>'Content analysis completed.']);}public function cronFetchAndGenerateNews(){try{$this->MyMIMarketing->cronFetchAndGenerateNews();return $this->respond(['status'=>'success','message'=>'News fetched and generated.']);}catch(\Throwable $e){return $this->failServerError($e->getMessage());}}public function cronFetchInbox(){log_message('debug','ðŸ“¨ Starting inbox scrape...');$this->getMyMIMarketing()->scrapeInboxAndStore();return $this->respond(['status'=>'success','message'=>'Inbox scraped.']);}public function cronFetchMarketingEmails(){log_message('info','ðŸ“¬ CRON: Fetching marketing emails via inbox scrape');try{$result=$this->getMyMIMarketing()->scrapeInboxAndStore();return $this->respond(['status'=>'success','message'=>'Marketing inbox scrape completed.','result'=>$result]);}catch(\Throwable $e){log_message('error','âŒ cronFetchMarketingEmails() failed: '.$e->getMessage());return $this->failServerError('Inbox fetch failed: '.$e->getMessage());}}public function distributeHighScoreContent(){try{$this->getMyMIMarketing()->autoSendToZapier(80);return $this->respond(['status'=>'success','message'=>'Top scoring posts sent to Zapier']);}catch(\Throwable $e){return $this->failServerError($e->getMessage());}}public function exportBufferPosts(){helper('text');$model=new \App\Models\MarketingModel();$bufferPosts=$model->fetchBufferPostsForScoring();$filename='buffer-posts-'.date('Ymd_His').'.csv';$csvHeader=['ID','Keyword','Summary','Score','Tag Score','Category','Status','Created At'];$csvData=[$csvHeader];foreach($bufferPosts as $post){$csvData[]=[$post['id'],$post['keyword'],word_limiter(strip_tags($post['summary']),10),$post['score'],$post['tag_score'],$post['category'],$post['status'],$post['created_at']?? '',];}header('Content-Type: text/csv');header("Content-Disposition: attachment; filename=\"$filename\"");$f=fopen('php://output','w');foreach($csvData as $row){fputcsv($f,$row);}fclose($f);exit;}public function fetchBufferPaginated(){$request=service('request');$page=(int) $request->getGet('page')?? 1;$limit=(int) $request->getGet('limit')?? 20;$keyword=$request->getGet('keyword');$category=$request->getGet('category');$minTagScore=$request->getGet('min_tag_score')?? 0;$onlySuggested=(bool) $request->getGet('only_suggested');$result=$this->marketingModel->fetchBufferPaginatedWithFilters(['page'=>$page,'limit'=>$limit,'keyword'=>$keyword,'category'=>$category,'min_tag_score'=>$minTagScore,'only_suggested'=>$onlySuggested]);return $this->respond(['status'=>'success','data'=>$result['data'],'pagination'=>$result['pagination']]);}public function fetchGeneratedSummaries(){try{$summaries=$this->marketingModel->getRecentPosts(5);return $this->respond(['status'=>'success','summaries'=>$summaries,]);}catch(\Throwable $e){log_message('error','âŒ fetchGeneratedSummaries Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function fetchGeneratedSummariesBlock(){try{helper('text');$todaysStory=$this->marketingModel->where('DATE(created_at)',date('Y-m-d'))->orderBy('created_at','desc')->findAll();return $this->renderTheme('App\Modules\Management\Views\Marketing\index/generatedSummariesBlock',['todaysStory'=>$todaysStory]);}catch(\Throwable $e){log_message('error','âŒ Failed to fetch summaries block: '.$e->getMessage());return $this->failServerError('Unable to refresh summaries.');}}public function generateContentFromScraper(){try{$this->getMyMIMarketing()->generateFromTempScraper(25);return $this->respond(['status'=>'success','message'=>'Content generated from scraper.']);}catch(\Throwable $e){log_message('error','âŒ generateContentFromScraper Error: '.$e->getMessage());return $this->failServerError($e->getMessage());}}public function generateContentDigestFromStored(){$records=$this->marketingModel->getRecentUnprocessedTempEmails(5);$processedTitles=[];foreach($records as $record){$recordId=$record['id']?? 0;try{if(empty($record['title'])){$record['title']='Fallback Title - ID '.$recordId;}$insertResult=$this->getMyMIMarketing()->generateContentAndInsert($record);if($insertResult){$this->marketingModel->markTempScraperProcessed($recordId);$processedTitles[]=$insertResult['title'];log_message('info',"âœ… Inserted content for ID {$recordId}");}else{log_message('warning',"âš ï¸ Skipped record ID {$recordId} â€” summary not stored");}}catch(\Throwable $e){log_message('error',"âŒ Exception on record ID {$recordId}: {$e->getMessage()}");}}return $this->respond(['status'=>'complete','processed_titles'=>$processedTitles]);}public function generateDailyContentDigest(){@ini_set('memory_limit','768M');$records=$this->marketingModel->getValidUnprocessedEmails(5);$insertedSummaries=[];foreach($records as $record){if(!is_array($record)){log_message('error','âŒ Invalid record structure: Expected array, got '.gettype($record));continue;}try{log_message('debug','ðŸ” Processing record ID '.$record['id']);$result=$this->getMyMIMarketing()->generateContentAndInsert($record);if($result){$this->marketingModel->markTempScraperProcessed($record['id']);$insertedSummaries[]=$result['title']?? '(no title)';log_message('info',"âœ… Successfully processed and inserted record ID {$record['id']}");}else{log_message('warning',"âš ï¸ Skipped or failed to insert record ID {$record['id']}");}}catch(\Throwable $e){log_message('error',"âŒ Exception on record ID {$record['id']}: ".$e->getMessage());}}return $this->respond(['status'=>'success','inserted'=>$insertedSummaries]);}public function generatePostsFromSummary($summaryId=null){try{$summary=$this->marketingModel->find($summaryId);if(!$summary){return $this->failNotFound('Summary not found.');}$decodedTitleRaw=$summary['title']?? '';$decodedSummaryRaw=$summary['summary']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$decodedSummary=quoted_printable_decode($decodedSummaryRaw);$decodedSummary=preg_replace('/=\r?\n/','',$decodedSummary);$decodedSummary=html_entity_decode($decodedSummary,ENT_QUOTES|ENT_HTML5,'UTF-8');$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$decodedTitle);$cleanedSummary=html_entity_decode(strip_tags($decodedSummary));$keywords=$this->MyMIMarketing->extractKeywords($cleanedSummary);$posts=$this->MyMIMarketing->generateSocialPosts($cleanedSummary,$keywords);$this->marketingModel->update($summaryId,['keywords'=>json_encode($keywords),'posts'=>json_encode($posts),]);return $this->respond(['status'=>'success','message'=>'Content generated and stored successfully.','original'=>$summary,'cleaned'=>['title'=>$cleanTitle,'summary'=>$cleanedSummary,'keywords'=>$keywords,'posts'=>$posts,],]);}catch(\Throwable $e){log_message('error','âŒ generatePostsFromSummary() failed: '.$e->getMessage());return $this->failServerError('Error generating posts.');}}public function generateScheduledPosts(){helper('text');$marketingModel=new MarketingModel();$marketing=new MyMIMarketing();$buffer=$marketingModel->getTopBufferPosts(3,6.5);if(empty($buffer)){return $this->respond(['status'=>'empty','message'=>'No queued posts available.']);}foreach($buffer as $post){$marketingModel->updateBufferItem($post['id'],['status'=>'promoted']);$generated=$marketing->generateSocialPost($post);if(json_decode($post['platforms'])->discord ?? false){$marketing->distributeContent('discord',$generated['discord']);}if(json_decode($post['platforms'])->linkedin ?? false){$marketing->distributeContent('linkedin',$generated['linkedin']);}$marketing->notifyModerators($post);}return $this->respond(['status'=>'success','message'=>'Posts published!']);}public function generateVoiceScriptManually(){try{log_message('info','ðŸŽ¤ generateVoiceScriptManually() triggered.');$script=$this->getMyMIMarketing()->generateVoiceoverScript();return $this->response->setJSON(['status'=>'success','script'=>$script]);}catch(\Throwable $e){log_message('error','âŒ Error in generateVoiceScriptManually: '.$e->getMessage());return $this->response->setJSON(['status'=>'error','message'=>$e->getMessage()]);}}public function massResendActivationEmails(){$userModel=new \App\Models\UserModel();$users=$userModel->getPendingActivationUsers();$activator=service('activator');$success=0;$failure=0;foreach($users as $user){if($activator->send($user)){$success++;}else{$failure++;}}return $this->respond(['status'=>'success','message'=>"$success emails sent, $failure failed."]);}public function monitorKeywordsAndScrape(){log_message('info','ðŸ§  Keyword Monitor Started');$keywords=$this->getMyMIMarketing()->getKeywordCandidates();if(empty($keywords)){return $this->respond(['status'=>'no_keywords']);}$results=[];foreach($keywords as $keyword){try{$scrapedData=$this->getMyMIMarketing()->scrapeGoogleSearch($keyword);if(!empty($scrapedData)){$summary=$this->getMyMIMarketing()->generateContentFromScrapedData($scrapedData,'generic');if($summary){$score=$this->getMyMIMarketing()->scoreKeywordRelevance($keyword,$summary);$results[]=['keyword'=>$keyword,'summary'=>$summary,'score'=>$score];$this->marketingModel->storeFinalMarketingContent(['source_id'=>null,'title'=>"Keyword: $keyword",'summary'=>$summary,'keywords'=>$keyword,'score'=>$score,'created_at'=>date('Y-m-d H:i:s')]);}}}catch(\Throwable $e){log_message('error',"âŒ Failed keyword scrape for {$keyword}: ".$e->getMessage());}}return $this->respond(['status'=>'complete','processed'=>$results]);}public function processMarketingTempEmails($limit=5,$mode='daily',$id=null){try{log_message('debug',"ðŸ§  Running unified email processor with mode={$mode}, limit={$limit}, id={$id}");if($id){$record=$this->marketingModel->getEmailRecordById($id);if(!$record||empty($record['content'])){return $this->failNotFound("No valid temp email record found for ID {$id}");}$cleanText=strip_tags($record['content']);$summary=$this->getMyMIMarketing()->summarizeText($cleanText);$keywords=$this->getMyMIMarketing()->extractKeywords($cleanText);if(empty($summary)||empty($keywords)){return $this->fail("Failed to generate summary or keywords for record ID {$id}");}$testPosts=['discord'=>"ðŸ’¬ *{$record['title']}*: {$summary} #".implode(' #',$keywords),'linkedin'=>"ðŸ“¢ {$record['title']} â€” {$summary}",'email'=>"Subject: {$record['title']}\n\n{$summary}",'x'=>substr($summary,0,250).'...'];$generated=['summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts];$this->marketingModel->insertFinalScraper($record,$generated);$this->marketingModel->markTempScraperProcessed($id);return $this->respond(['status'=>'success','message'=>"âœ… Test record stored for ID {$id}",'summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts]);}$records=($mode==='backfill')?$this->marketingModel->getOlderUnprocessedEmails($limit):$this->marketingModel->getValidUnprocessedEmails($limit);$results=[];foreach($records as $record){$recordId=$record['id']?? 0;if(empty($record['title'])){$record['title']="Fallback Title - ID {$recordId}";}try{$insert=$this->getMyMIMarketing()->generateContentAndInsert($record);if($insert){$this->marketingModel->markTempScraperProcessed($recordId);log_message('info',"âœ… Inserted record ID {$recordId}");$results[]=$insert['title'];}else{log_message('warning',"âš ï¸ Skipped ID {$recordId} â€” No summary generated.");}}catch(\Throwable $e){log_message('error',"âŒ Exception on ID {$recordId}: ".$e->getMessage());}}return $this->respond(['status'=>'success','mode'=>$mode,'inserted'=>$results]);}catch(\Throwable $e){return $this->failServerError("ðŸ”¥ Unified content processor failed: ".$e->getMessage());}}public function rankBufferPostsDaily(){$marketingModel=new MarketingModel();$marketing=new MyMIMarketing();$threshold=getenv('MARKETING_TFIDF_THRESHOLD')?:7.5;$pendingPosts=$marketingModel->getPendingBufferItems();foreach($pendingPosts as $post){$scoreData=$marketing->getTopKeywordScores(['summary'=>$post['summary'],]);$update=['score'=>$scoreData['score']?? 0,'tag_score'=>$scoreData['tag_score']?? 0,'tfidf_score'=>$scoreData['tfidf_score']?? 0,'auto_suggest'=>($scoreData['tfidf_score']?? 0)>=$threshold?1:0,];$marketingModel->updateBufferItem($post['id'],$update);}return $this->respond(['status'=>'success','message'=>'Buffer ranks updated.']);}public function rejectBufferItem($id){$record=$this->marketingModel->findBufferItem($id);if(!$record)return $this->failNotFound("Record not found.");$this->marketingModel->updateBufferItem($id,['status'=>'rejected']);return $this->respond(['status'=>'success','message'=>'Content rejected.']);}public function runBackfillForTempEmails(){try{log_message('info','[ðŸ”„ Backfill] Starting backfill for unprocessed temp emails...');$unprocessedRecords=$this->marketingModel->where('status',null)->orWhere('status','')->findAll(25);if(empty($unprocessedRecords)){return $this->respond(['status'=>'complete','message'=>'No unprocessed records found.']);}$processedTitles=[];foreach($unprocessedRecords as $record){try{$result=$this->MyMIMarketing->generateContentAndInsert($record);if($result){$this->marketingModel->markTempScraperProcessed($record['id']);$processedTitles[]=$result['title'];}}catch(\Throwable $e){log_message('error','[âŒ Backfill Error] ID '.$record['id'].' â€” '.$e->getMessage());}}return $this->respond(['status'=>'success','processed'=>$processedTitles]);}catch(\Throwable $e){return $this->failServerError('[ðŸ”¥ Backfill Failure] '.$e->getMessage());}}public function testGenerateFromTempEmail($id){try{helper('text');$record=$this->marketingModel->getEmailRecordById($id);if(!$record||empty($record['content'])){return $this->failNotFound("No valid temp email record found for ID {$id}");}log_message('info',"ðŸ§ª Starting test content generation for temp record ID: {$id}");$cleanText=strip_tags($record['content']);$summary=$this->getMyMIMarketing()->summarizeText($cleanText);$summary=quoted_printable_decode($summary);$summary=mb_convert_encoding($summary,'UTF-8','UTF-8');$keywords=$this->getMyMIMarketing()->extractKeywords($cleanText);if(empty($summary)||empty($keywords)){return $this->fail("Failed to generate summary or keywords for record ID {$id}");}$decodedTitleRaw=$record['title']?? '';$decodedTitle=$this->getMyMIMarketing()->decodeMimeHeaderSafe($decodedTitleRaw);$cleanTitle=preg_replace('/[^\p{L}\p{N}\s:;\-]/u','',$decodedTitle);$testPosts=['discord'=>"ðŸ’¬ *{$cleanTitle}*: {$summary} #".implode(' #',$keywords),'linkedin'=>"ðŸ“¢ {$cleanTitle} â€” {$summary}",'email'=>"Subject: {$cleanTitle}\n\n{$summary}",'x'=>substr($summary,0,250).'...',];$generated=['summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts];$this->marketingModel->insertFinalScraper($record,$generated);$this->marketingModel->markTempScraperProcessed($id);log_message('info',"âœ… Test record stored in bf_marketing_scraper for temp ID {$id}");return $this->respond(['status'=>'success','message'=>"Content generated and stored successfully.",'summary'=>$summary,'keywords'=>$keywords,'posts'=>$testPosts]);}catch(\Throwable $e){log_message('critical',"âŒ testGenerateFromTempEmail({$id}) failed: ".$e->getMessage());return $this->failServerError("An error occurred: ".$e->getMessage());}}public function testTfIdfEdgeCases(){$cases=['Empty String'=>'','Whitespace Only'=>'     ','Single Word'=>'Bitcoin','HTML Only'=>'<div><p></p></div>','Malformed UTF-8'=>"\xB1\x31",'Link-Only Spam'=>'http://marketwatch.com https://example.com','Token Noise'=>str_repeat('$$$!!!@@@###',10),];$results=[];foreach($cases as $label=>$input){try{log_message('info',"ðŸ§ª Running TF-IDF Test Case: $label");$cleanInput=is_string($input)?strip_tags(trim($input)):'';if(strlen($cleanInput)<10||substr_count($cleanInput,' ')<2){log_message('debug',"âš ï¸ Skipping test: $label â€” input too short or lacks structure.");$results[$label]='[Skipped â€” Too short or unstructured]';continue;}$summary=$this->MyMIMarketing->summarizeText($cleanInput);log_message('debug',"Result - Summary: $summary");$results[$label]=$summary;}catch(\Throwable $e){log_message('error',"âŒ $label threw error: ".$e->getMessage());$results[$label]='[Error: '.$e->getMessage().']';}}return $this->renderTheme('App\Modules\Management\Views\Marketing\debugTfIdfResults',['results'=>$results,]);}public function triggerPostAutogenOnEmpty(){try{$existingPosts=$this->marketingModel->where('DATE(scraped_at)',date('Y-m-d'))->countAllResults();if($existingPosts===0){log_message('debug','[ðŸª„ AutoGen Trigger] No posts found for today. Running fallback generatorâ€¦');$this->marketingService->generatePostsFromTodaysSummaries();return $this->respond(['status'=>'success','message'=>'No posts found. Generated fresh content.']);}else{return $this->respond(['status'=>'success','message'=>'Posts already exist for today. No action taken.']);}}catch(\Throwable $e){log_message('error','[âŒ AutoGen Trigger Error] '.$e->getMessage());return $this->respond(['status'=>'error','message'=>'Failed to trigger autogen.','error'=>$e->getMessage()]);}}public function updateBufferScheduleInterval($id){$data=$this->request->getJSON(true);$interval=(int)($data['interval']?? 0);$updated=$this->marketingModel->updateBufferItem($id,['schedule_interval'=>$interval,'scheduled_at'=>null ]);if($updated){return $this->respond(['status'=>'success']);}else{return $this->fail('Failed to update interval.');}}public function updatePlatformToggle($id){$data=$this->request->getJSON(true);$platform=$data['platform'];$enabled=$data['enabled'];$record=$this->marketingModel->find($id);if(!$record){return $this->failNotFound("Record not found.");}$platforms=json_decode($record['platforms']?? '{}',true);$platforms[$platform]=$enabled;$this->marketingModel->update($id,['platforms'=>json_encode($platforms)]);return $this->respond(['status'=>'success']);}} ?><?php namespace App\Libraries;use App\Config\{SiteSettings,SocialMedia};use App\Libraries\{BaseLoader,MyMIInvestments};use App\Libraries\Traits\TextProcessor;use App\Models\{AnalyticalModel,MarketingModel};use App\Services\{EmailService,MarketingService,SolanaService};use CodeIgniter\HTTP\RequestInterface;use CodeIgniter\Session\Session;use Myth\Auth\Authorization\GroupModel;use Exception;use HTMLPurifier;use HTMLPurifier_Config;use Phpml\FeatureExtraction\TokenCountVectorizer;use Phpml\Tokenization\WhitespaceTokenizer;use Phpml\FeatureExtraction\TfIdfTransformer;use NlpTools\Tokenizers\WhitespaceTokenizer as NlpWhitespaceTokenizer;use NlpTools\Similarity\CosineSimilarity;use Facebook\Facebook;use Abraham\TwitterOAuth\TwitterOAuth;use Happyr\LinkedIn\LinkedIn;use Discord\Discord;use Discord\Parts\Channel\Message;use GuzzleHttp\Client;use Scrapemax\ScrapemaxClient;use Pscrape\Pscrape\Scrape as PscrapeScraper;use Symfony\Component\DomCrawler\Crawler;use Google\Cloud\TextToSpeech\V1\TextToSpeechClient;use Google\Cloud\TextToSpeech\V1\SynthesisInput;use Google\Cloud\TextToSpeech\V1\VoiceSelectionParams;use Google\Cloud\TextToSpeech\V1\AudioConfig;use Google\Cloud\TextToSpeech\V1\AudioEncoding;class MyMIMarketing{use BaseLoader;use TextProcessor;protected $auth;protected $cuID;protected $data;protected $debug;protected $logger;protected $request;protected $session;protected $uri;protected $APIs;protected $emailService;protected $solanaService;protected $siteSettings;protected $marketingModel;protected $analyticalModel;protected $socialMedia;protected $facebook;protected $twitter;protected $linkedin;protected $discord;protected $scrapemax;protected $pscrape;public function __construct(){$this->auth=service('authentication');$this->logger=service('logger');$this->request=service('request');$this->session=service('session');$this->uri=$this->request->getUri();$this->APIs=config('APIs');$this->socialMedia=config('SocialMedia');$this->siteSettings=config('SiteSettings');$this->debug=$this->siteSettings->debug;$this->socialMedia=config('SocialMedia');$this->marketingModel=new MarketingModel();$this->analyticalModel=new AnalyticalModel();$this->emailService=service('email');$this->solanaService=new SolanaService();$this->scrapemax=new ScrapemaxClient('https://api.scrapemax.com',$this->APIs->scrapemax_api_key);$this->pscrape=new PscrapeScraper();}public function marketing(){$department=$this->department();$links=$this->social_media();return['links'=>$links,'department'=>$department];}public function distributeTradeAlert($alert,$action='BUY'){$message=$this->generateTradeAlertMessage($alert,$action);$this->postToDiscord($message);$this->postToTwitter($message);$this->postToFacebook($message);$this->postToLinkedIn($message);}public function generateRandomMarketingContent(array $tradeAlert):array{$intros=["ðŸš¨ Breaking Market Update!","ðŸ“¢ Urgent Trade Alert!","ðŸ”¥ High-Momentum Stock Pick!","ðŸš€ Skyrocketing Stocks!","ðŸ’° Smart Money Moves!","âš¡ Quick Market Insight!","ðŸ“ˆ Bullish Breakout Alert!","ðŸ“Š Technical Setup Unfolding!","ðŸ§ Deep Market Analysis!","ðŸ’¡ Pro-Level Trading Insight!"];$emoticons=['ðŸš€','ðŸ”¥','ðŸ’°','ðŸ“ˆ','ðŸ“Š','âš¡','âœ…','ðŸ¤–','ðŸŽ¯','ðŸ”'];$outros=["ðŸ“Š Stay ahead of the markets!","â³ Don't miss this setup!","ðŸ’° Trade smart & maximize gains!","ðŸš€ Follow for more trade alerts!","ðŸ“ˆ Watch this ticker closely!","ðŸ”¥ This could be the next big mover!","ðŸ’¡ Insights that matter. Stay tuned!","ðŸ’Ž Precision trading at its best!","âš¡ More insights coming soon!","ðŸ“¢ Tap in for more premium setups!"];$intro=$intros[array_rand($intros)];$outro=$outros[array_rand($outros)];$emote1=$emoticons[array_rand($emoticons)];$emote2=$emoticons[array_rand($emoticons)];$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$tradeDesc=trim($tradeAlert['trade_description']?? '');$news=trim($tradeAlert['financial_news']?? '');$details=trim($tradeAlert['details']?? '');$price=number_format($tradeAlert['price']?? 0,2);$link=trim($tradeAlert['tv_chart']?? $tradeAlert['tv_chart_link']?? '');$chartText=(!empty($link))?"ðŸ“‰ Chart: [View Here]({$link})\n":'';$fixedLength=strlen($intro)+strlen($outro)+strlen($emote1)+strlen($emote2)+strlen($chartText)+12;$maxMessageLength=2000-$fixedLength;$coreMessage="Trade Alert for **{$ticker}** ({$company}):\n"."Price: \${$price}\n"."Signal: {$tradeDesc}\n"."News: {$news}\n"."Details: {$details}\n".$chartText;if(strlen($coreMessage)>$maxMessageLength){$coreMessage=substr($coreMessage,0,$maxMessageLength-3)."...";}$finalMessage="{$emote1} {$intro}\n{$coreMessage}\n{$outro} {$emote2}";return['twitter'=>substr($finalMessage,0,280),'facebook'=>substr($finalMessage,0,2000),'linkedin'=>substr($finalMessage,0,2000),'discord'=>substr($finalMessage,0,2000)];}public function generateEmailContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$news=$tradeAlert['financial_news']?? '';$details=$tradeAlert['details']?? '';$content="Email Alert for {$ticker} ({$company}):\n"."Current Price: \${$price}\n"."Trade Signal: {$tradeDesc}\n"."Latest News: {$news}\n"."Analysis Details: {$details}\n"."For more information, visit our website.";return $content;}public function generateBlogContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$news=$tradeAlert['financial_news']?? '';$details=$tradeAlert['details']?? '';$content="Blog Post: In-depth Market Analysis on {$ticker} ({$company})\n\n"."Current Price: \${$price}\n\n"."Trade Analysis: {$tradeDesc}\n\n"."Financial News: {$news}\n\n"."Detailed Analysis: {$details}\n\n"."Stay tuned for more insights!";return $content;}public function generateVoiceoverScriptContent(array $tradeAlert):string{$ticker=strtoupper(trim($tradeAlert['ticker']?? 'N/A'));$company=$tradeAlert['company']?? 'Unknown Company';$price=number_format($tradeAlert['price']?? 0,2);$tradeDesc=$tradeAlert['trade_description']?? '';$script="Voiceover Script:\n"."Welcome to today's market update. Our focus is on {$ticker} from {$company}.\n"."The current trading price is \${$price}.\n"."Trade insight: {$tradeDesc}.\n"."Thank you for watching. Stay tuned for more updates.";return $script;}public function generateTradeAlertEmailContent(array $tradeAlert):string{$defaultTemplate=<<<S
app/Modules/User/Controllers/TradeTracker.php:139:            $link = $this->request->getPost('link');
app/Modules/User/Controllers/TradeTracker.php:198:            $link = $symbol_type . '/' . $exchange . '/' . $symbol;
app/Modules/User/Controllers/TradeTracker.php:212:            if ($this->trackerModel->add_trade($submitted_date, $submitted_time, $trade_date, $trade_time, $user_type, $user_id, $username, $email, $trading_account, $trade_type, $purchase_type, $symbol_type, $exchange, $symbol, $company, $link, $current_price, $sell_price, $position_size, $total_trade_cost, $net_gains, $percent_change, $option_type, $expiration, $option_price, $strike, $details)) {
app/Modules/User/Controllers/TradeTracker.php:261:            $link = $request->getPost('link');
app/Modules/User/Controllers/TradeTracker.php:404:            $link = $this->request->getPost('link');
app/Modules/User/Controllers/TradeTracker.php:443:                'link' => $link,
app/Modules/User/Controllers/EmailController.php:23:        $link = rtrim(getenv('APP_URL') ?: site_url(), '/') . '/Account/verify-email/' . $token;
app/Modules/User/Controllers/EmailController.php:28:        $email->setMessage("Click to verify: {$link}");
app/Modules/Management/Views/Marketing/dashboard.txt:2418:                foreach ($xpath->query('//a[@href]') as $link) {
app/Modules/Management/Views/Marketing/dashboard.txt:2419:                    $href = $link->getAttribute('href');
app/Modules/Management/Views/Marketing/dashboard.txt:2422:                        $text = $link->nodeValue;
app/Modules/Management/Views/Marketing/dashboard.txt:2483:        foreach ($links as $link) {
app/Modules/Management/Views/Marketing/dashboard.txt:2484:            $url = filter_var($link['href'], FILTER_SANITIZE_URL);
app/Modules/Management/Views/Marketing/dashboard.txt:2515:                    foreach ($dom->find('a') as $link) {
app/Modules/Management/Views/Marketing/dashboard.txt:2516:                        $href = $link->getAttribute('href');
app/Modules/Management/Views/Marketing/dashboard.txt:2517:                        $text = $link->text;
app/Modules/Management/Views/Marketing/dashboard.txt:3161:        $link = trim($tradeAlert['tv_chart'] ?? $tradeAlert['tv_chart_link'] ?? '');
app/Modules/Management/Views/Marketing/dashboard.txt:3164:        $chartText = (!empty($link)) ? "ðŸ“‰ Chart: [View Here]({$link})\n" : '';
app/Modules/Management/Views/Marketing/Campaigns/Overview.php:68:                                        <?php foreach ($campaign['promotional_links'] as $link): ?>
app/Modules/Management/Views/Marketing/Campaigns/Overview.php:69:                                            <a href="<?= $link; ?>" target="_blank"><?= $link; ?></a><br>
app/Modules/Management/Views/Marketing/Campaigns/View.php:96:                                                <?php foreach ($campaignContent['promotional_links'] as $link): ?>
app/Modules/Management/Views/Marketing/Campaigns/View.php:98:                                                        <a href="<?= esc($link) ?>" target="_blank"><?= esc($link) ?></a>
app/Modules/Management/Views/Web_Design/Edit_Dashboard.php:11:    $link	   = $dashInfo['dashboard_link'];
app/Modules/Management/Views/Web_Design/Edit_Dashboard.php:33:							<td><a href="<?php echo site_url('/') . $link; ?>"><?php echo $link; ?></a></td>
app/Modules/Management/Controllers/MarketingController.php:1651:                foreach ($xpath->query('//a[@href]') as $link) {
app/Modules/Management/Controllers/MarketingController.php:1652:                    $href = $link->getAttribute('href');
app/Modules/Management/Controllers/MarketingController.php:1655:                        $text = $link->nodeValue;
app/Modules/Management/Controllers/MarketingController.php:1718:        foreach ($links as $link) {
app/Modules/Management/Controllers/MarketingController.php:1719:            $url = filter_var($link['href'], FILTER_SANITIZE_URL);
app/Modules/Management/Controllers/MarketingController.php:1750:                    foreach ($dom->find('a') as $link) {
app/Modules/Management/Controllers/MarketingController.php:1751:                        $href = $link->getAttribute('href');
app/Modules/Management/Controllers/MarketingController.php:1752:                        $text = $link->text;
app/Modules/Management/Controllers/MarketingController.11202024.php:765:                foreach ($xpath->query('//a[@href]') as $link) {
app/Modules/Management/Controllers/MarketingController.11202024.php:766:                    $href = $link->getAttribute('href');
app/Modules/Management/Controllers/MarketingController.11202024.php:769:                        $text = $link->nodeValue;
app/Modules/Management/Controllers/MarketingController.11202024.php:832:        foreach ($links as $link) {
app/Modules/Management/Controllers/MarketingController.11202024.php:833:            $url = filter_var($link['href'], FILTER_SANITIZE_URL);
app/Modules/Management/Controllers/MarketingController.11202024.php:857:                    foreach ($dom->find('a') as $link) {
app/Modules/Management/Controllers/MarketingController.11202024.php:858:                        $href = $link->getAttribute('href');
app/Modules/Management/Controllers/MarketingController.11202024.php:859:                        $text = $link->text;
app/Modules/Management/Controllers/MarketingController-07012024.php:352:                    foreach ($dom->find('a') as $link) {
app/Modules/Management/Controllers/MarketingController-07012024.php:353:                        $href = $link->getAttribute('href');
app/Modules/Management/Controllers/MarketingController-07012024.php:354:                        $text = $link->text;
app/Modules/Management/Controllers/MarketingController-07012024.php:394:                foreach ($xpath->query('//a[@href]') as $link) {
app/Modules/Management/Controllers/MarketingController-07012024.php:395:                    $href = $link->getAttribute('href');
app/Modules/Management/Controllers/MarketingController-07012024.php:398:                        $text = $link->nodeValue;
app/Modules/Management/Controllers/MarketingController-07012024.php:420:        foreach ($links as $link) {
app/Modules/Management/Controllers/MarketingController-07012024.php:421:            $url = filter_var($link['href'], FILTER_SANITIZE_URL);
app/Modules/Marketing_New/Controllers/ScraperController.php:64:                foreach ($xpath->query('//a[@href]') as $link) {
app/Modules/Marketing_New/Controllers/ScraperController.php:65:                    $href = $link->getAttribute('href');
app/Modules/Marketing_New/Controllers/ScraperController.php:68:                        $text = $link->nodeValue;
app/Modules/Marketing_New/Libraries/ContentGenerator.php:29:        $link = $data['url'];
app/Modules/Marketing_New/Libraries/ContentGenerator.php:31:        $facebookContent = "Check out this article: $title\n$summary\nRead more: $link";
app/Modules/Marketing_New/Libraries/ContentGenerator.php:32:        $twitterContent = "New article: $title\n$summary\n$link";
app/Modules/Marketing_New/Libraries/ContentGenerator.php:33:        $linkedinContent = "Article: $title\nSummary: $summary\n$link";
app/Modules/Marketing_New/Libraries/ContentGenerator.php:34:        $discordContent = "Hey everyone, check out this new article: $title\n$summary\n$link";

## QA Notes
- SafeSiteURI now logs and coerces null relative paths globally, preventing the previous `CodeIgniter\HTTP\SiteURI::stringifyRelativePath()` fatal.
- Monitor logs for the warning once per offending call; remove log_message line if noise becomes an issue.